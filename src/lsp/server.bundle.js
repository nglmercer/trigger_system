import{createRequire as FF}from"node:module";var VF=Object.create;var{getPrototypeOf:BF,defineProperty:pY,getOwnPropertyNames:LF}=Object;var AF=Object.prototype.hasOwnProperty;var p8=(X,Z,Q)=>{Q=X!=null?VF(BF(X)):{};let G=Z||!X||!X.__esModule?pY(Q,"default",{value:X,enumerable:!0}):Q;for(let J of LF(X))if(!AF.call(G,J))pY(G,J,{get:()=>X[J],enumerable:!0});return G};var D=(X,Z)=>()=>(Z||X((Z={exports:{}}).exports,Z),Z.exports);var p0=FF(import.meta.url);var d8=D((iY)=>{Object.defineProperty(iY,"__esModule",{value:!0});iY.thenable=iY.typedArray=iY.stringArray=iY.array=iY.func=iY.error=iY.number=iY.string=iY.boolean=void 0;function OF(X){return X===!0||X===!1}iY.boolean=OF;function dY(X){return typeof X==="string"||X instanceof String}iY.string=dY;function wF(X){return typeof X==="number"||X instanceof Number}iY.number=wF;function KF(X){return X instanceof Error}iY.error=KF;function lY(X){return typeof X==="function"}iY.func=lY;function cY(X){return Array.isArray(X)}iY.array=cY;function MF(X){return cY(X)&&X.every((Z)=>dY(Z))}iY.stringArray=MF;function NF(X,Z){return Array.isArray(X)&&X.every(Z)}iY.typedArray=NF;function TF(X){return X&&lY(X.then)}iY.thenable=TF});var W9=D((rY)=>{Object.defineProperty(rY,"__esModule",{value:!0});rY.stringArray=rY.array=rY.func=rY.error=rY.number=rY.string=rY.boolean=void 0;function SF(X){return X===!0||X===!1}rY.boolean=SF;function nY(X){return typeof X==="string"||X instanceof String}rY.string=nY;function bF(X){return typeof X==="number"||X instanceof Number}rY.number=bF;function RF(X){return X instanceof Error}rY.error=RF;function yF(X){return typeof X==="function"}rY.func=yF;function sY(X){return Array.isArray(X)}rY.array=sY;function fF(X){return sY(X)&&X.every((Z)=>nY(Z))}rY.stringArray=fF});var iQ=D((T$)=>{Object.defineProperty(T$,"__esModule",{value:!0});T$.Message=T$.NotificationType9=T$.NotificationType8=T$.NotificationType7=T$.NotificationType6=T$.NotificationType5=T$.NotificationType4=T$.NotificationType3=T$.NotificationType2=T$.NotificationType1=T$.NotificationType0=T$.NotificationType=T$.RequestType9=T$.RequestType8=T$.RequestType7=T$.RequestType6=T$.RequestType5=T$.RequestType4=T$.RequestType3=T$.RequestType2=T$.RequestType1=T$.RequestType=T$.RequestType0=T$.AbstractMessageSignature=T$.ParameterStructures=T$.ResponseError=T$.ErrorCodes=void 0;var h6=W9(),lQ;(function(X){X.ParseError=-32700,X.InvalidRequest=-32600,X.MethodNotFound=-32601,X.InvalidParams=-32602,X.InternalError=-32603,X.jsonrpcReservedErrorRangeStart=-32099,X.serverErrorStart=-32099,X.MessageWriteError=-32099,X.MessageReadError=-32098,X.PendingResponseRejected=-32097,X.ConnectionInactive=-32096,X.ServerNotInitialized=-32002,X.UnknownErrorCode=-32001,X.jsonrpcReservedErrorRangeEnd=-32000,X.serverErrorEnd=-32000})(lQ||(T$.ErrorCodes=lQ={}));class cQ extends Error{constructor(X,Z,Q){super(Z);this.code=h6.number(X)?X:lQ.UnknownErrorCode,this.data=Q,Object.setPrototypeOf(this,cQ.prototype)}toJson(){let X={code:this.code,message:this.message};if(this.data!==void 0)X.data=this.data;return X}}T$.ResponseError=cQ;class l0{constructor(X){this.kind=X}static is(X){return X===l0.auto||X===l0.byName||X===l0.byPosition}toString(){return this.kind}}T$.ParameterStructures=l0;l0.auto=new l0("auto");l0.byPosition=new l0("byPosition");l0.byName=new l0("byName");class j0{constructor(X,Z){this.method=X,this.numberOfParams=Z}get parameterStructures(){return l0.auto}}T$.AbstractMessageSignature=j0;class eY extends j0{constructor(X){super(X,0)}}T$.RequestType0=eY;class X$ extends j0{constructor(X,Z=l0.auto){super(X,1);this._parameterStructures=Z}get parameterStructures(){return this._parameterStructures}}T$.RequestType=X$;class Z$ extends j0{constructor(X,Z=l0.auto){super(X,1);this._parameterStructures=Z}get parameterStructures(){return this._parameterStructures}}T$.RequestType1=Z$;class Q$ extends j0{constructor(X){super(X,2)}}T$.RequestType2=Q$;class G$ extends j0{constructor(X){super(X,3)}}T$.RequestType3=G$;class J$ extends j0{constructor(X){super(X,4)}}T$.RequestType4=J$;class Y$ extends j0{constructor(X){super(X,5)}}T$.RequestType5=Y$;class $$ extends j0{constructor(X){super(X,6)}}T$.RequestType6=$$;class z$ extends j0{constructor(X){super(X,7)}}T$.RequestType7=z$;class H$ extends j0{constructor(X){super(X,8)}}T$.RequestType8=H$;class U$ extends j0{constructor(X){super(X,9)}}T$.RequestType9=U$;class W$ extends j0{constructor(X,Z=l0.auto){super(X,1);this._parameterStructures=Z}get parameterStructures(){return this._parameterStructures}}T$.NotificationType=W$;class V$ extends j0{constructor(X){super(X,0)}}T$.NotificationType0=V$;class B$ extends j0{constructor(X,Z=l0.auto){super(X,1);this._parameterStructures=Z}get parameterStructures(){return this._parameterStructures}}T$.NotificationType1=B$;class L$ extends j0{constructor(X){super(X,2)}}T$.NotificationType2=L$;class A$ extends j0{constructor(X){super(X,3)}}T$.NotificationType3=A$;class F$ extends j0{constructor(X){super(X,4)}}T$.NotificationType4=F$;class O$ extends j0{constructor(X){super(X,5)}}T$.NotificationType5=O$;class w$ extends j0{constructor(X){super(X,6)}}T$.NotificationType6=w$;class K$ extends j0{constructor(X){super(X,7)}}T$.NotificationType7=K$;class M$ extends j0{constructor(X){super(X,8)}}T$.NotificationType8=M$;class N$ extends j0{constructor(X){super(X,9)}}T$.NotificationType9=N$;var tY;(function(X){function Z(J){let Y=J;return Y&&h6.string(Y.method)&&(h6.string(Y.id)||h6.number(Y.id))}X.isRequest=Z;function Q(J){let Y=J;return Y&&h6.string(Y.method)&&J.id===void 0}X.isNotification=Q;function G(J){let Y=J;return Y&&(Y.result!==void 0||!!Y.error)&&(h6.string(Y.id)||h6.number(Y.id)||Y.id===null)}X.isResponse=G})(tY||(T$.Message=tY={}))});var nQ=D((j$)=>{var E$;Object.defineProperty(j$,"__esModule",{value:!0});j$.LRUCache=j$.LinkedMap=j$.Touch=void 0;var c0;(function(X){X.None=0,X.First=1,X.AsOld=X.First,X.Last=2,X.AsNew=X.Last})(c0||(j$.Touch=c0={}));class oQ{constructor(){this[E$]="LinkedMap",this._map=new Map,this._head=void 0,this._tail=void 0,this._size=0,this._state=0}clear(){this._map.clear(),this._head=void 0,this._tail=void 0,this._size=0,this._state++}isEmpty(){return!this._head&&!this._tail}get size(){return this._size}get first(){return this._head?.value}get last(){return this._tail?.value}has(X){return this._map.has(X)}get(X,Z=c0.None){let Q=this._map.get(X);if(!Q)return;if(Z!==c0.None)this.touch(Q,Z);return Q.value}set(X,Z,Q=c0.None){let G=this._map.get(X);if(G){if(G.value=Z,Q!==c0.None)this.touch(G,Q)}else{switch(G={key:X,value:Z,next:void 0,previous:void 0},Q){case c0.None:this.addItemLast(G);break;case c0.First:this.addItemFirst(G);break;case c0.Last:this.addItemLast(G);break;default:this.addItemLast(G);break}this._map.set(X,G),this._size++}return this}delete(X){return!!this.remove(X)}remove(X){let Z=this._map.get(X);if(!Z)return;return this._map.delete(X),this.removeItem(Z),this._size--,Z.value}shift(){if(!this._head&&!this._tail)return;if(!this._head||!this._tail)throw Error("Invalid list");let X=this._head;return this._map.delete(X.key),this.removeItem(X),this._size--,X.value}forEach(X,Z){let Q=this._state,G=this._head;while(G){if(Z)X.bind(Z)(G.value,G.key,this);else X(G.value,G.key,this);if(this._state!==Q)throw Error("LinkedMap got modified during iteration.");G=G.next}}keys(){let X=this._state,Z=this._head,Q={[Symbol.iterator]:()=>{return Q},next:()=>{if(this._state!==X)throw Error("LinkedMap got modified during iteration.");if(Z){let G={value:Z.key,done:!1};return Z=Z.next,G}else return{value:void 0,done:!0}}};return Q}values(){let X=this._state,Z=this._head,Q={[Symbol.iterator]:()=>{return Q},next:()=>{if(this._state!==X)throw Error("LinkedMap got modified during iteration.");if(Z){let G={value:Z.value,done:!1};return Z=Z.next,G}else return{value:void 0,done:!0}}};return Q}entries(){let X=this._state,Z=this._head,Q={[Symbol.iterator]:()=>{return Q},next:()=>{if(this._state!==X)throw Error("LinkedMap got modified during iteration.");if(Z){let G={value:[Z.key,Z.value],done:!1};return Z=Z.next,G}else return{value:void 0,done:!0}}};return Q}[(E$=Symbol.toStringTag,Symbol.iterator)](){return this.entries()}trimOld(X){if(X>=this.size)return;if(X===0){this.clear();return}let Z=this._head,Q=this.size;while(Z&&Q>X)this._map.delete(Z.key),Z=Z.next,Q--;if(this._head=Z,this._size=Q,Z)Z.previous=void 0;this._state++}addItemFirst(X){if(!this._head&&!this._tail)this._tail=X;else if(!this._head)throw Error("Invalid list");else X.next=this._head,this._head.previous=X;this._head=X,this._state++}addItemLast(X){if(!this._head&&!this._tail)this._head=X;else if(!this._tail)throw Error("Invalid list");else X.previous=this._tail,this._tail.next=X;this._tail=X,this._state++}removeItem(X){if(X===this._head&&X===this._tail)this._head=void 0,this._tail=void 0;else if(X===this._head){if(!X.next)throw Error("Invalid list");X.next.previous=void 0,this._head=X.next}else if(X===this._tail){if(!X.previous)throw Error("Invalid list");X.previous.next=void 0,this._tail=X.previous}else{let{next:Z,previous:Q}=X;if(!Z||!Q)throw Error("Invalid list");Z.previous=Q,Q.next=Z}X.next=void 0,X.previous=void 0,this._state++}touch(X,Z){if(!this._head||!this._tail)throw Error("Invalid list");if(Z!==c0.First&&Z!==c0.Last)return;if(Z===c0.First){if(X===this._head)return;let{next:Q,previous:G}=X;if(X===this._tail)G.next=void 0,this._tail=G;else Q.previous=G,G.next=Q;X.previous=void 0,X.next=this._head,this._head.previous=X,this._head=X,this._state++}else if(Z===c0.Last){if(X===this._tail)return;let{next:Q,previous:G}=X;if(X===this._head)Q.previous=void 0,this._head=Q;else Q.previous=G,G.next=Q;X.next=void 0,X.previous=this._tail,this._tail.next=X,this._tail=X,this._state++}}toJSON(){let X=[];return this.forEach((Z,Q)=>{X.push([Q,Z])}),X}fromJSON(X){this.clear();for(let[Z,Q]of X)this.set(Z,Q)}}j$.LinkedMap=oQ;class P$ extends oQ{constructor(X,Z=1){super();this._limit=X,this._ratio=Math.min(Math.max(0,Z),1)}get limit(){return this._limit}set limit(X){this._limit=X,this.checkTrim()}get ratio(){return this._ratio}set ratio(X){this._ratio=Math.min(Math.max(0,X),1),this.checkTrim()}get(X,Z=c0.AsNew){return super.get(X,Z)}peek(X){return super.get(X,c0.None)}set(X,Z){return super.set(X,Z,c0.Last),this.checkTrim(),this}checkTrim(){if(this.size>this._limit)this.trimOld(Math.round(this._limit*this._ratio))}}j$.LRUCache=P$});var S$=D((_$)=>{Object.defineProperty(_$,"__esModule",{value:!0});_$.Disposable=void 0;var I$;(function(X){function Z(Q){return{dispose:Q}}X.create=Z})(I$||(_$.Disposable=I$={}))});var V6=D((b$)=>{Object.defineProperty(b$,"__esModule",{value:!0});var sQ;function rQ(){if(sQ===void 0)throw Error("No runtime abstraction layer installed");return sQ}(function(X){function Z(Q){if(Q===void 0)throw Error("No runtime abstraction layer provided");sQ=Q}X.install=Z})(rQ||(rQ={}));b$.default=rQ});var V9=D((f$)=>{Object.defineProperty(f$,"__esModule",{value:!0});f$.Emitter=f$.Event=void 0;var OO=V6(),R$;(function(X){let Z={dispose(){}};X.None=function(){return Z}})(R$||(f$.Event=R$={}));class y${add(X,Z=null,Q){if(!this._callbacks)this._callbacks=[],this._contexts=[];if(this._callbacks.push(X),this._contexts.push(Z),Array.isArray(Q))Q.push({dispose:()=>this.remove(X,Z)})}remove(X,Z=null){if(!this._callbacks)return;let Q=!1;for(let G=0,J=this._callbacks.length;G<J;G++)if(this._callbacks[G]===X)if(this._contexts[G]===Z){this._callbacks.splice(G,1),this._contexts.splice(G,1);return}else Q=!0;if(Q)throw Error("When adding a listener with a context, you should remove it with the same context")}invoke(...X){if(!this._callbacks)return[];let Z=[],Q=this._callbacks.slice(0),G=this._contexts.slice(0);for(let J=0,Y=Q.length;J<Y;J++)try{Z.push(Q[J].apply(G[J],X))}catch($){(0,OO.default)().console.error($)}return Z}isEmpty(){return!this._callbacks||this._callbacks.length===0}dispose(){this._callbacks=void 0,this._contexts=void 0}}class l8{constructor(X){this._options=X}get event(){if(!this._event)this._event=(X,Z,Q)=>{if(!this._callbacks)this._callbacks=new y$;if(this._options&&this._options.onFirstListenerAdd&&this._callbacks.isEmpty())this._options.onFirstListenerAdd(this);this._callbacks.add(X,Z);let G={dispose:()=>{if(!this._callbacks)return;if(this._callbacks.remove(X,Z),G.dispose=l8._noop,this._options&&this._options.onLastListenerRemove&&this._callbacks.isEmpty())this._options.onLastListenerRemove(this)}};if(Array.isArray(Q))Q.push(G);return G};return this._event}fire(X){if(this._callbacks)this._callbacks.invoke.call(this._callbacks,X)}dispose(){if(this._callbacks)this._callbacks.dispose(),this._callbacks=void 0}}f$.Emitter=l8;l8._noop=function(){}});var i8=D((v$)=>{Object.defineProperty(v$,"__esModule",{value:!0});v$.CancellationTokenSource=v$.CancellationToken=void 0;var KO=V6(),MO=W9(),aQ=V9(),c8;(function(X){X.None=Object.freeze({isCancellationRequested:!1,onCancellationRequested:aQ.Event.None}),X.Cancelled=Object.freeze({isCancellationRequested:!0,onCancellationRequested:aQ.Event.None});function Z(Q){let G=Q;return G&&(G===X.None||G===X.Cancelled||MO.boolean(G.isCancellationRequested)&&!!G.onCancellationRequested)}X.is=Z})(c8||(v$.CancellationToken=c8={}));var NO=Object.freeze(function(X,Z){let Q=(0,KO.default)().timer.setTimeout(X.bind(Z),0);return{dispose(){Q.dispose()}}});class tQ{constructor(){this._isCancelled=!1}cancel(){if(!this._isCancelled){if(this._isCancelled=!0,this._emitter)this._emitter.fire(void 0),this.dispose()}}get isCancellationRequested(){return this._isCancelled}get onCancellationRequested(){if(this._isCancelled)return NO;if(!this._emitter)this._emitter=new aQ.Emitter;return this._emitter.event}dispose(){if(this._emitter)this._emitter.dispose(),this._emitter=void 0}}class x${get token(){if(!this._token)this._token=new tQ;return this._token}cancel(){if(!this._token)this._token=c8.Cancelled;else this._token.cancel()}dispose(){if(!this._token)this._token=c8.None;else if(this._token instanceof tQ)this._token.dispose()}}v$.CancellationTokenSource=x$});var c$=D((d$)=>{Object.defineProperty(d$,"__esModule",{value:!0});d$.SharedArrayReceiverStrategy=d$.SharedArraySenderStrategy=void 0;var qO=i8(),AZ;(function(X){X.Continue=0,X.Cancelled=1})(AZ||(AZ={}));class g${constructor(){this.buffers=new Map}enableCancellation(X){if(X.id===null)return;let Z=new SharedArrayBuffer(4),Q=new Int32Array(Z,0,1);Q[0]=AZ.Continue,this.buffers.set(X.id,Z),X.$cancellationData=Z}async sendCancellation(X,Z){let Q=this.buffers.get(Z);if(Q===void 0)return;let G=new Int32Array(Q,0,1);Atomics.store(G,0,AZ.Cancelled)}cleanup(X){this.buffers.delete(X)}dispose(){this.buffers.clear()}}d$.SharedArraySenderStrategy=g$;class u${constructor(X){this.data=new Int32Array(X,0,1)}get isCancellationRequested(){return Atomics.load(this.data,0)===AZ.Cancelled}get onCancellationRequested(){throw Error("Cancellation over SharedArrayBuffer doesn't support cancellation events")}}class m${constructor(X){this.token=new u$(X)}cancel(){}dispose(){}}class p${constructor(){this.kind="request"}createCancellationTokenSource(X){let Z=X.$cancellationData;if(Z===void 0)return new qO.CancellationTokenSource;return new m$(Z)}}d$.SharedArrayReceiverStrategy=p$});var eQ=D((o$)=>{Object.defineProperty(o$,"__esModule",{value:!0});o$.Semaphore=void 0;var PO=V6();class i${constructor(X=1){if(X<=0)throw Error("Capacity must be greater than 0");this._capacity=X,this._active=0,this._waiting=[]}lock(X){return new Promise((Z,Q)=>{this._waiting.push({thunk:X,resolve:Z,reject:Q}),this.runNext()})}get active(){return this._active}runNext(){if(this._waiting.length===0||this._active===this._capacity)return;(0,PO.default)().timer.setImmediate(()=>this.doRunNext())}doRunNext(){if(this._waiting.length===0||this._active===this._capacity)return;let X=this._waiting.shift();if(this._active++,this._active>this._capacity)throw Error("To many thunks active");try{let Z=X.thunk();if(Z instanceof Promise)Z.then((Q)=>{this._active--,X.resolve(Q),this.runNext()},(Q)=>{this._active--,X.reject(Q),this.runNext()});else this._active--,X.resolve(Z),this.runNext()}catch(Z){this._active--,X.reject(Z),this.runNext()}}}o$.Semaphore=i$});var e$=D((a$)=>{Object.defineProperty(a$,"__esModule",{value:!0});a$.ReadableStreamMessageReader=a$.AbstractMessageReader=a$.MessageReader=void 0;var ZG=V6(),B9=W9(),XG=V9(),jO=eQ(),s$;(function(X){function Z(Q){let G=Q;return G&&B9.func(G.listen)&&B9.func(G.dispose)&&B9.func(G.onError)&&B9.func(G.onClose)&&B9.func(G.onPartialMessage)}X.is=Z})(s$||(a$.MessageReader=s$={}));class GG{constructor(){this.errorEmitter=new XG.Emitter,this.closeEmitter=new XG.Emitter,this.partialMessageEmitter=new XG.Emitter}dispose(){this.errorEmitter.dispose(),this.closeEmitter.dispose()}get onError(){return this.errorEmitter.event}fireError(X){this.errorEmitter.fire(this.asError(X))}get onClose(){return this.closeEmitter.event}fireClose(){this.closeEmitter.fire(void 0)}get onPartialMessage(){return this.partialMessageEmitter.event}firePartialMessage(X){this.partialMessageEmitter.fire(X)}asError(X){if(X instanceof Error)return X;else return Error(`Reader received error. Reason: ${B9.string(X.message)?X.message:"unknown"}`)}}a$.AbstractMessageReader=GG;var QG;(function(X){function Z(Q){let G,J,Y,$=new Map,z,H=new Map;if(Q===void 0||typeof Q==="string")G=Q??"utf-8";else{if(G=Q.charset??"utf-8",Q.contentDecoder!==void 0)Y=Q.contentDecoder,$.set(Y.name,Y);if(Q.contentDecoders!==void 0)for(let U of Q.contentDecoders)$.set(U.name,U);if(Q.contentTypeDecoder!==void 0)z=Q.contentTypeDecoder,H.set(z.name,z);if(Q.contentTypeDecoders!==void 0)for(let U of Q.contentTypeDecoders)H.set(U.name,U)}if(z===void 0)z=(0,ZG.default)().applicationJson.decoder,H.set(z.name,z);return{charset:G,contentDecoder:Y,contentDecoders:$,contentTypeDecoder:z,contentTypeDecoders:H}}X.fromOptions=Z})(QG||(QG={}));class r$ extends GG{constructor(X,Z){super();this.readable=X,this.options=QG.fromOptions(Z),this.buffer=(0,ZG.default)().messageBuffer.create(this.options.charset),this._partialMessageTimeout=1e4,this.nextMessageLength=-1,this.messageToken=0,this.readSemaphore=new jO.Semaphore(1)}set partialMessageTimeout(X){this._partialMessageTimeout=X}get partialMessageTimeout(){return this._partialMessageTimeout}listen(X){this.nextMessageLength=-1,this.messageToken=0,this.partialMessageTimer=void 0,this.callback=X;let Z=this.readable.onData((Q)=>{this.onData(Q)});return this.readable.onError((Q)=>this.fireError(Q)),this.readable.onClose(()=>this.fireClose()),Z}onData(X){try{this.buffer.append(X);while(!0){if(this.nextMessageLength===-1){let Q=this.buffer.tryReadHeaders(!0);if(!Q)return;let G=Q.get("content-length");if(!G){this.fireError(Error(`Header must provide a Content-Length property.
${JSON.stringify(Object.fromEntries(Q))}`));return}let J=parseInt(G);if(isNaN(J)){this.fireError(Error(`Content-Length value must be a number. Got ${G}`));return}this.nextMessageLength=J}let Z=this.buffer.tryReadBody(this.nextMessageLength);if(Z===void 0){this.setPartialMessageTimer();return}this.clearPartialMessageTimer(),this.nextMessageLength=-1,this.readSemaphore.lock(async()=>{let Q=this.options.contentDecoder!==void 0?await this.options.contentDecoder.decode(Z):Z,G=await this.options.contentTypeDecoder.decode(Q,this.options);this.callback(G)}).catch((Q)=>{this.fireError(Q)})}}catch(Z){this.fireError(Z)}}clearPartialMessageTimer(){if(this.partialMessageTimer)this.partialMessageTimer.dispose(),this.partialMessageTimer=void 0}setPartialMessageTimer(){if(this.clearPartialMessageTimer(),this._partialMessageTimeout<=0)return;this.partialMessageTimer=(0,ZG.default)().timer.setTimeout((X,Z)=>{if(this.partialMessageTimer=void 0,X===this.messageToken)this.firePartialMessage({messageToken:X,waitingTime:Z}),this.setPartialMessageTimer()},this._partialMessageTimeout,this.messageToken,this._partialMessageTimeout)}}a$.ReadableStreamMessageReader=r$});var z3=D((Y3)=>{Object.defineProperty(Y3,"__esModule",{value:!0});Y3.WriteableStreamMessageWriter=Y3.AbstractMessageWriter=Y3.MessageWriter=void 0;var X3=V6(),FZ=W9(),_O=eQ(),Z3=V9(),CO="Content-Length: ",Q3=`\r
`,G3;(function(X){function Z(Q){let G=Q;return G&&FZ.func(G.dispose)&&FZ.func(G.onClose)&&FZ.func(G.onError)&&FZ.func(G.write)}X.is=Z})(G3||(Y3.MessageWriter=G3={}));class YG{constructor(){this.errorEmitter=new Z3.Emitter,this.closeEmitter=new Z3.Emitter}dispose(){this.errorEmitter.dispose(),this.closeEmitter.dispose()}get onError(){return this.errorEmitter.event}fireError(X,Z,Q){this.errorEmitter.fire([this.asError(X),Z,Q])}get onClose(){return this.closeEmitter.event}fireClose(){this.closeEmitter.fire(void 0)}asError(X){if(X instanceof Error)return X;else return Error(`Writer received error. Reason: ${FZ.string(X.message)?X.message:"unknown"}`)}}Y3.AbstractMessageWriter=YG;var JG;(function(X){function Z(Q){if(Q===void 0||typeof Q==="string")return{charset:Q??"utf-8",contentTypeEncoder:(0,X3.default)().applicationJson.encoder};else return{charset:Q.charset??"utf-8",contentEncoder:Q.contentEncoder,contentTypeEncoder:Q.contentTypeEncoder??(0,X3.default)().applicationJson.encoder}}X.fromOptions=Z})(JG||(JG={}));class J3 extends YG{constructor(X,Z){super();this.writable=X,this.options=JG.fromOptions(Z),this.errorCount=0,this.writeSemaphore=new _O.Semaphore(1),this.writable.onError((Q)=>this.fireError(Q)),this.writable.onClose(()=>this.fireClose())}async write(X){return this.writeSemaphore.lock(async()=>{return this.options.contentTypeEncoder.encode(X,this.options).then((Q)=>{if(this.options.contentEncoder!==void 0)return this.options.contentEncoder.encode(Q);else return Q}).then((Q)=>{let G=[];return G.push(CO,Q.byteLength.toString(),Q3),G.push(Q3),this.doWrite(X,G,Q)},(Q)=>{throw this.fireError(Q),Q})})}async doWrite(X,Z,Q){try{return await this.writable.write(Z.join(""),"ascii"),this.writable.write(Q)}catch(G){return this.handleError(G,X),Promise.reject(G)}}handleError(X,Z){this.errorCount++,this.fireError(X,Z,this.errorCount)}end(){this.writable.end()}}Y3.WriteableStreamMessageWriter=J3});var V3=D((U3)=>{Object.defineProperty(U3,"__esModule",{value:!0});U3.AbstractMessageBuffer=void 0;var RO=13,yO=10,fO=`\r
`;class H3{constructor(X="utf-8"){this._encoding=X,this._chunks=[],this._totalLength=0}get encoding(){return this._encoding}append(X){let Z=typeof X==="string"?this.fromString(X,this._encoding):X;this._chunks.push(Z),this._totalLength+=Z.byteLength}tryReadHeaders(X=!1){if(this._chunks.length===0)return;let Z=0,Q=0,G=0,J=0;X:while(Q<this._chunks.length){let H=this._chunks[Q];G=0;Z:while(G<H.length){switch(H[G]){case RO:switch(Z){case 0:Z=1;break;case 2:Z=3;break;default:Z=0}break;case yO:switch(Z){case 1:Z=2;break;case 3:Z=4,G++;break X;default:Z=0}break;default:Z=0}G++}J+=H.byteLength,Q++}if(Z!==4)return;let Y=this._read(J+G),$=new Map,z=this.toString(Y,"ascii").split(fO);if(z.length<2)return $;for(let H=0;H<z.length-2;H++){let U=z[H],L=U.indexOf(":");if(L===-1)throw Error(`Message header must separate key and value using ':'
${U}`);let A=U.substr(0,L),F=U.substr(L+1).trim();$.set(X?A.toLowerCase():A,F)}return $}tryReadBody(X){if(this._totalLength<X)return;return this._read(X)}get numberOfBytes(){return this._totalLength}_read(X){if(X===0)return this.emptyBuffer();if(X>this._totalLength)throw Error("Cannot read so many bytes!");if(this._chunks[0].byteLength===X){let J=this._chunks[0];return this._chunks.shift(),this._totalLength-=X,this.asNative(J)}if(this._chunks[0].byteLength>X){let J=this._chunks[0],Y=this.asNative(J,X);return this._chunks[0]=J.slice(X),this._totalLength-=X,Y}let Z=this.allocNative(X),Q=0,G=0;while(X>0){let J=this._chunks[G];if(J.byteLength>X){let Y=J.slice(0,X);Z.set(Y,Q),Q+=X,this._chunks[G]=J.slice(X),this._totalLength-=X,X-=X}else Z.set(J,Q),Q+=J.byteLength,this._chunks.shift(),this._totalLength-=J.byteLength,X-=J.byteLength}return Z}}U3.AbstractMessageBuffer=H3});var q3=D((w3)=>{Object.defineProperty(w3,"__esModule",{value:!0});w3.createMessageConnection=w3.ConnectionOptions=w3.MessageStrategy=w3.CancellationStrategy=w3.CancellationSenderStrategy=w3.CancellationReceiverStrategy=w3.RequestCancellationReceiverStrategy=w3.IdCancellationReceiverStrategy=w3.ConnectionStrategy=w3.ConnectionError=w3.ConnectionErrors=w3.LogTraceNotification=w3.SetTraceNotification=w3.TraceFormat=w3.TraceValues=w3.Trace=w3.NullLogger=w3.ProgressType=w3.ProgressToken=void 0;var B3=V6(),I0=W9(),o=iQ(),L3=nQ(),OZ=V9(),$G=i8(),MZ;(function(X){X.type=new o.NotificationType("$/cancelRequest")})(MZ||(MZ={}));var zG;(function(X){function Z(Q){return typeof Q==="string"||typeof Q==="number"}X.is=Z})(zG||(w3.ProgressToken=zG={}));var wZ;(function(X){X.type=new o.NotificationType("$/progress")})(wZ||(wZ={}));class O3{constructor(){}}w3.ProgressType=O3;var HG;(function(X){function Z(Q){return I0.func(Q)}X.is=Z})(HG||(HG={}));w3.NullLogger=Object.freeze({error:()=>{},warn:()=>{},info:()=>{},log:()=>{}});var V0;(function(X){X[X.Off=0]="Off",X[X.Messages=1]="Messages",X[X.Compact=2]="Compact",X[X.Verbose=3]="Verbose"})(V0||(w3.Trace=V0={}));var A3;(function(X){X.Off="off",X.Messages="messages",X.Compact="compact",X.Verbose="verbose"})(A3||(w3.TraceValues=A3={}));(function(X){function Z(G){if(!I0.string(G))return X.Off;switch(G=G.toLowerCase(),G){case"off":return X.Off;case"messages":return X.Messages;case"compact":return X.Compact;case"verbose":return X.Verbose;default:return X.Off}}X.fromString=Z;function Q(G){switch(G){case X.Off:return"off";case X.Messages:return"messages";case X.Compact:return"compact";case X.Verbose:return"verbose";default:return"off"}}X.toString=Q})(V0||(w3.Trace=V0={}));var UX;(function(X){X.Text="text",X.JSON="json"})(UX||(w3.TraceFormat=UX={}));(function(X){function Z(Q){if(!I0.string(Q))return X.Text;if(Q=Q.toLowerCase(),Q==="json")return X.JSON;else return X.Text}X.fromString=Z})(UX||(w3.TraceFormat=UX={}));var UG;(function(X){X.type=new o.NotificationType("$/setTrace")})(UG||(w3.SetTraceNotification=UG={}));var o8;(function(X){X.type=new o.NotificationType("$/logTrace")})(o8||(w3.LogTraceNotification=o8={}));var KZ;(function(X){X[X.Closed=1]="Closed",X[X.Disposed=2]="Disposed",X[X.AlreadyListening=3]="AlreadyListening"})(KZ||(w3.ConnectionErrors=KZ={}));class L9 extends Error{constructor(X,Z){super(Z);this.code=X,Object.setPrototypeOf(this,L9.prototype)}}w3.ConnectionError=L9;var WG;(function(X){function Z(Q){let G=Q;return G&&I0.func(G.cancelUndispatched)}X.is=Z})(WG||(w3.ConnectionStrategy=WG={}));var n8;(function(X){function Z(Q){let G=Q;return G&&(G.kind===void 0||G.kind==="id")&&I0.func(G.createCancellationTokenSource)&&(G.dispose===void 0||I0.func(G.dispose))}X.is=Z})(n8||(w3.IdCancellationReceiverStrategy=n8={}));var VG;(function(X){function Z(Q){let G=Q;return G&&G.kind==="request"&&I0.func(G.createCancellationTokenSource)&&(G.dispose===void 0||I0.func(G.dispose))}X.is=Z})(VG||(w3.RequestCancellationReceiverStrategy=VG={}));var s8;(function(X){X.Message=Object.freeze({createCancellationTokenSource(Q){return new $G.CancellationTokenSource}});function Z(Q){return n8.is(Q)||VG.is(Q)}X.is=Z})(s8||(w3.CancellationReceiverStrategy=s8={}));var r8;(function(X){X.Message=Object.freeze({sendCancellation(Q,G){return Q.sendNotification(MZ.type,{id:G})},cleanup(Q){}});function Z(Q){let G=Q;return G&&I0.func(G.sendCancellation)&&I0.func(G.cleanup)}X.is=Z})(r8||(w3.CancellationSenderStrategy=r8={}));var a8;(function(X){X.Message=Object.freeze({receiver:s8.Message,sender:r8.Message});function Z(Q){let G=Q;return G&&s8.is(G.receiver)&&r8.is(G.sender)}X.is=Z})(a8||(w3.CancellationStrategy=a8={}));var t8;(function(X){function Z(Q){let G=Q;return G&&I0.func(G.handleMessage)}X.is=Z})(t8||(w3.MessageStrategy=t8={}));var F3;(function(X){function Z(Q){let G=Q;return G&&(a8.is(G.cancellationStrategy)||WG.is(G.connectionStrategy)||t8.is(G.messageStrategy))}X.is=Z})(F3||(w3.ConnectionOptions=F3={}));var _X;(function(X){X[X.New=1]="New",X[X.Listening=2]="Listening",X[X.Closed=3]="Closed",X[X.Disposed=4]="Disposed"})(_X||(_X={}));function kO(X,Z,Q,G){let J=Q!==void 0?Q:w3.NullLogger,Y=0,$=0,z=0,H="2.0",U=void 0,L=new Map,A=void 0,F=new Map,j=new Map,R,T=new L3.LinkedMap,P=new Map,y=new Set,M=new Map,K=V0.Off,_=UX.Text,x,m=_X.New,n=new OZ.Emitter,u=new OZ.Emitter,A0=new OZ.Emitter,m0=new OZ.Emitter,s0=new OZ.Emitter,$0=G&&G.cancellationStrategy?G.cancellationStrategy:a8.Message;function sX(O){if(O===null)throw Error("Can't send requests with id null since the response can't be correlated.");return"req-"+O.toString()}function J9(O){if(O===null)return"res-unknown-"+(++z).toString();else return"res-"+O.toString()}function I8(){return"not-"+(++$).toString()}function dQ(O,C){if(o.Message.isRequest(C))O.set(sX(C.id),C);else if(o.Message.isResponse(C))O.set(J9(C.id),C);else O.set(I8(),C)}function zZ(O){return}function HZ(){return m===_X.Listening}function k6(){return m===_X.Closed}function rX(){return m===_X.Disposed}function Y9(){if(m===_X.New||m===_X.Listening)m=_X.Closed,u.fire(void 0)}function x6(O){n.fire([O,void 0,void 0])}function _8(O){n.fire(O)}X.onClose(Y9),X.onError(x6),Z.onClose(Y9),Z.onError(_8);function UZ(){if(R||T.size===0)return;R=(0,B3.default)().timer.setImmediate(()=>{R=void 0,C8()})}function WZ(O){if(o.Message.isRequest(O))b8(O);else if(o.Message.isNotification(O))y8(O);else if(o.Message.isResponse(O))R8(O);else $9(O)}function C8(){if(T.size===0)return;let O=T.shift();try{let C=G?.messageStrategy;if(t8.is(C))C.handleMessage(O,WZ);else WZ(O)}finally{UZ()}}let S8=(O)=>{try{if(o.Message.isNotification(O)&&O.method===MZ.type.method){let C=O.params.id,v=sX(C),p=T.get(v);if(o.Message.isRequest(p)){let B0=G?.connectionStrategy,T0=B0&&B0.cancelUndispatched?B0.cancelUndispatched(p,zZ):zZ(p);if(T0&&(T0.error!==void 0||T0.result!==void 0)){T.delete(v),M.delete(C),T0.id=p.id,v6(T0,O.method,Date.now()),Z.write(T0).catch(()=>J.error("Sending response for canceled message failed."));return}}let L0=M.get(C);if(L0!==void 0){L0.cancel(),z9(O);return}else y.add(C)}dQ(T,O)}finally{UZ()}};function b8(O){if(rX())return;function C(Q0,F0,U0){let S0={jsonrpc:H,id:O.id};if(Q0 instanceof o.ResponseError)S0.error=Q0.toJson();else S0.result=Q0===void 0?null:Q0;v6(S0,F0,U0),Z.write(S0).catch(()=>J.error("Sending response failed."))}function v(Q0,F0,U0){let S0={jsonrpc:H,id:O.id,error:Q0.toJson()};v6(S0,F0,U0),Z.write(S0).catch(()=>J.error("Sending response failed."))}function p(Q0,F0,U0){if(Q0===void 0)Q0=null;let S0={jsonrpc:H,id:O.id,result:Q0};v6(S0,F0,U0),Z.write(S0).catch(()=>J.error("Sending response failed."))}x8(O);let L0=L.get(O.method),B0,T0;if(L0)B0=L0.type,T0=L0.handler;let P0=Date.now();if(T0||U){let Q0=O.id??String(Date.now()),F0=n8.is($0.receiver)?$0.receiver.createCancellationTokenSource(Q0):$0.receiver.createCancellationTokenSource(O);if(O.id!==null&&y.has(O.id))F0.cancel();if(O.id!==null)M.set(Q0,F0);try{let U0;if(T0)if(O.params===void 0){if(B0!==void 0&&B0.numberOfParams!==0){v(new o.ResponseError(o.ErrorCodes.InvalidParams,`Request ${O.method} defines ${B0.numberOfParams} params but received none.`),O.method,P0);return}U0=T0(F0.token)}else if(Array.isArray(O.params)){if(B0!==void 0&&B0.parameterStructures===o.ParameterStructures.byName){v(new o.ResponseError(o.ErrorCodes.InvalidParams,`Request ${O.method} defines parameters by name but received parameters by position`),O.method,P0);return}U0=T0(...O.params,F0.token)}else{if(B0!==void 0&&B0.parameterStructures===o.ParameterStructures.byPosition){v(new o.ResponseError(o.ErrorCodes.InvalidParams,`Request ${O.method} defines parameters by position but received parameters by name`),O.method,P0);return}U0=T0(O.params,F0.token)}else if(U)U0=U(O.method,O.params,F0.token);let S0=U0;if(!U0)M.delete(Q0),p(U0,O.method,P0);else if(S0.then)S0.then((g0)=>{M.delete(Q0),C(g0,O.method,P0)},(g0)=>{if(M.delete(Q0),g0 instanceof o.ResponseError)v(g0,O.method,P0);else if(g0&&I0.string(g0.message))v(new o.ResponseError(o.ErrorCodes.InternalError,`Request ${O.method} failed with message: ${g0.message}`),O.method,P0);else v(new o.ResponseError(o.ErrorCodes.InternalError,`Request ${O.method} failed unexpectedly without providing any details.`),O.method,P0)});else M.delete(Q0),C(U0,O.method,P0)}catch(U0){if(M.delete(Q0),U0 instanceof o.ResponseError)C(U0,O.method,P0);else if(U0&&I0.string(U0.message))v(new o.ResponseError(o.ErrorCodes.InternalError,`Request ${O.method} failed with message: ${U0.message}`),O.method,P0);else v(new o.ResponseError(o.ErrorCodes.InternalError,`Request ${O.method} failed unexpectedly without providing any details.`),O.method,P0)}}else v(new o.ResponseError(o.ErrorCodes.MethodNotFound,`Unhandled method ${O.method}`),O.method,P0)}function R8(O){if(rX())return;if(O.id===null)if(O.error)J.error(`Received response message without id: Error is: 
${JSON.stringify(O.error,void 0,4)}`);else J.error("Received response message without id. No further error information provided.");else{let C=O.id,v=P.get(C);if(v8(O,v),v!==void 0){P.delete(C);try{if(O.error){let p=O.error;v.reject(new o.ResponseError(p.code,p.message,p.data))}else if(O.result!==void 0)v.resolve(O.result);else throw Error("Should never happen.")}catch(p){if(p.message)J.error(`Response handler '${v.method}' failed with message: ${p.message}`);else J.error(`Response handler '${v.method}' failed unexpectedly.`)}}}}function y8(O){if(rX())return;let C=void 0,v;if(O.method===MZ.type.method){let p=O.params.id;y.delete(p),z9(O);return}else{let p=F.get(O.method);if(p)v=p.handler,C=p.type}if(v||A)try{if(z9(O),v)if(O.params===void 0){if(C!==void 0){if(C.numberOfParams!==0&&C.parameterStructures!==o.ParameterStructures.byName)J.error(`Notification ${O.method} defines ${C.numberOfParams} params but received none.`)}v()}else if(Array.isArray(O.params)){let p=O.params;if(O.method===wZ.type.method&&p.length===2&&zG.is(p[0]))v({token:p[0],value:p[1]});else{if(C!==void 0){if(C.parameterStructures===o.ParameterStructures.byName)J.error(`Notification ${O.method} defines parameters by name but received parameters by position`);if(C.numberOfParams!==O.params.length)J.error(`Notification ${O.method} defines ${C.numberOfParams} params but received ${p.length} arguments`)}v(...p)}}else{if(C!==void 0&&C.parameterStructures===o.ParameterStructures.byPosition)J.error(`Notification ${O.method} defines parameters by position but received parameters by name`);v(O.params)}else if(A)A(O.method,O.params)}catch(p){if(p.message)J.error(`Notification handler '${O.method}' failed with message: ${p.message}`);else J.error(`Notification handler '${O.method}' failed unexpectedly.`)}else A0.fire(O)}function $9(O){if(!O){J.error("Received empty message.");return}J.error(`Received message which is neither a response nor a notification message:
${JSON.stringify(O,null,4)}`);let C=O;if(I0.string(C.id)||I0.number(C.id)){let v=C.id,p=P.get(v);if(p)p.reject(Error("The received response has neither a result nor an error property."))}}function jX(O){if(O===void 0||O===null)return;switch(K){case V0.Verbose:return JSON.stringify(O,null,4);case V0.Compact:return JSON.stringify(O);default:return}}function f8(O){if(K===V0.Off||!x)return;if(_===UX.Text){let C=void 0;if((K===V0.Verbose||K===V0.Compact)&&O.params)C=`Params: ${jX(O.params)}

`;x.log(`Sending request '${O.method} - (${O.id})'.`,C)}else aX("send-request",O)}function k8(O){if(K===V0.Off||!x)return;if(_===UX.Text){let C=void 0;if(K===V0.Verbose||K===V0.Compact)if(O.params)C=`Params: ${jX(O.params)}

`;else C=`No parameters provided.

`;x.log(`Sending notification '${O.method}'.`,C)}else aX("send-notification",O)}function v6(O,C,v){if(K===V0.Off||!x)return;if(_===UX.Text){let p=void 0;if(K===V0.Verbose||K===V0.Compact){if(O.error&&O.error.data)p=`Error data: ${jX(O.error.data)}

`;else if(O.result)p=`Result: ${jX(O.result)}

`;else if(O.error===void 0)p=`No result returned.

`}x.log(`Sending response '${C} - (${O.id})'. Processing request took ${Date.now()-v}ms`,p)}else aX("send-response",O)}function x8(O){if(K===V0.Off||!x)return;if(_===UX.Text){let C=void 0;if((K===V0.Verbose||K===V0.Compact)&&O.params)C=`Params: ${jX(O.params)}

`;x.log(`Received request '${O.method} - (${O.id})'.`,C)}else aX("receive-request",O)}function z9(O){if(K===V0.Off||!x||O.method===o8.type.method)return;if(_===UX.Text){let C=void 0;if(K===V0.Verbose||K===V0.Compact)if(O.params)C=`Params: ${jX(O.params)}

`;else C=`No parameters provided.

`;x.log(`Received notification '${O.method}'.`,C)}else aX("receive-notification",O)}function v8(O,C){if(K===V0.Off||!x)return;if(_===UX.Text){let v=void 0;if(K===V0.Verbose||K===V0.Compact){if(O.error&&O.error.data)v=`Error data: ${jX(O.error.data)}

`;else if(O.result)v=`Result: ${jX(O.result)}

`;else if(O.error===void 0)v=`No result returned.

`}if(C){let p=O.error?` Request failed: ${O.error.message} (${O.error.code}).`:"";x.log(`Received response '${C.method} - (${O.id})' in ${Date.now()-C.timerStart}ms.${p}`,v)}else x.log(`Received response ${O.id} without active response promise.`,v)}else aX("receive-response",O)}function aX(O,C){if(!x||K===V0.Off)return;let v={isLSPMessage:!0,type:O,message:C,timestamp:Date.now()};x.log(v)}function W6(){if(k6())throw new L9(KZ.Closed,"Connection is closed.");if(rX())throw new L9(KZ.Disposed,"Connection is disposed.")}function h8(){if(HZ())throw new L9(KZ.AlreadyListening,"Connection is already listening")}function g8(){if(!HZ())throw Error("Call listen() first.")}function hX(O){if(O===void 0)return null;else return O}function VZ(O){if(O===null)return;else return O}function BZ(O){return O!==void 0&&O!==null&&!Array.isArray(O)&&typeof O==="object"}function H9(O,C){switch(O){case o.ParameterStructures.auto:if(BZ(C))return VZ(C);else return[hX(C)];case o.ParameterStructures.byName:if(!BZ(C))throw Error("Received parameters by name but param is not an object literal.");return VZ(C);case o.ParameterStructures.byPosition:return[hX(C)];default:throw Error(`Unknown parameter structure ${O.toString()}`)}}function LZ(O,C){let v,p=O.numberOfParams;switch(p){case 0:v=void 0;break;case 1:v=H9(O.parameterStructures,C[0]);break;default:v=[];for(let L0=0;L0<C.length&&L0<p;L0++)v.push(hX(C[L0]));if(C.length<p)for(let L0=C.length;L0<p;L0++)v.push(null);break}return v}let tX={sendNotification:(O,...C)=>{W6();let v,p;if(I0.string(O)){v=O;let B0=C[0],T0=0,P0=o.ParameterStructures.auto;if(o.ParameterStructures.is(B0))T0=1,P0=B0;let Q0=C.length,F0=Q0-T0;switch(F0){case 0:p=void 0;break;case 1:p=H9(P0,C[T0]);break;default:if(P0===o.ParameterStructures.byName)throw Error(`Received ${F0} parameters for 'by Name' notification parameter structure.`);p=C.slice(T0,Q0).map((U0)=>hX(U0));break}}else{let B0=C;v=O.method,p=LZ(O,B0)}let L0={jsonrpc:H,method:v,params:p};return k8(L0),Z.write(L0).catch((B0)=>{throw J.error("Sending notification failed."),B0})},onNotification:(O,C)=>{W6();let v;if(I0.func(O))A=O;else if(C)if(I0.string(O))v=O,F.set(O,{type:void 0,handler:C});else v=O.method,F.set(O.method,{type:O,handler:C});return{dispose:()=>{if(v!==void 0)F.delete(v);else A=void 0}}},onProgress:(O,C,v)=>{if(j.has(C))throw Error(`Progress handler for token ${C} already registered`);return j.set(C,v),{dispose:()=>{j.delete(C)}}},sendProgress:(O,C,v)=>{return tX.sendNotification(wZ.type,{token:C,value:v})},onUnhandledProgress:m0.event,sendRequest:(O,...C)=>{W6(),g8();let v,p,L0=void 0;if(I0.string(O)){v=O;let Q0=C[0],F0=C[C.length-1],U0=0,S0=o.ParameterStructures.auto;if(o.ParameterStructures.is(Q0))U0=1,S0=Q0;let g0=C.length;if($G.CancellationToken.is(F0))g0=g0-1,L0=F0;let HX=g0-U0;switch(HX){case 0:p=void 0;break;case 1:p=H9(S0,C[U0]);break;default:if(S0===o.ParameterStructures.byName)throw Error(`Received ${HX} parameters for 'by Name' request parameter structure.`);p=C.slice(U0,g0).map((u8)=>hX(u8));break}}else{let Q0=C;v=O.method,p=LZ(O,Q0);let F0=O.numberOfParams;L0=$G.CancellationToken.is(Q0[F0])?Q0[F0]:void 0}let B0=Y++,T0;if(L0)T0=L0.onCancellationRequested(()=>{let Q0=$0.sender.sendCancellation(tX,B0);if(Q0===void 0)return J.log(`Received no promise from cancellation strategy when cancelling id ${B0}`),Promise.resolve();else return Q0.catch(()=>{J.log(`Sending cancellation messages for id ${B0} failed`)})});let P0={jsonrpc:H,id:B0,method:v,params:p};if(f8(P0),typeof $0.sender.enableCancellation==="function")$0.sender.enableCancellation(P0);return new Promise(async(Q0,F0)=>{let U0=(HX)=>{Q0(HX),$0.sender.cleanup(B0),T0?.dispose()},S0=(HX)=>{F0(HX),$0.sender.cleanup(B0),T0?.dispose()},g0={method:v,timerStart:Date.now(),resolve:U0,reject:S0};try{await Z.write(P0),P.set(B0,g0)}catch(HX){throw J.error("Sending request failed."),g0.reject(new o.ResponseError(o.ErrorCodes.MessageWriteError,HX.message?HX.message:"Unknown reason")),HX}})},onRequest:(O,C)=>{W6();let v=null;if(HG.is(O))v=void 0,U=O;else if(I0.string(O)){if(v=null,C!==void 0)v=O,L.set(O,{handler:C,type:void 0})}else if(C!==void 0)v=O.method,L.set(O.method,{type:O,handler:C});return{dispose:()=>{if(v===null)return;if(v!==void 0)L.delete(v);else U=void 0}}},hasPendingResponse:()=>{return P.size>0},trace:async(O,C,v)=>{let p=!1,L0=UX.Text;if(v!==void 0)if(I0.boolean(v))p=v;else p=v.sendNotification||!1,L0=v.traceFormat||UX.Text;if(K=O,_=L0,K===V0.Off)x=void 0;else x=C;if(p&&!k6()&&!rX())await tX.sendNotification(UG.type,{value:V0.toString(O)})},onError:n.event,onClose:u.event,onUnhandledNotification:A0.event,onDispose:s0.event,end:()=>{Z.end()},dispose:()=>{if(rX())return;m=_X.Disposed,s0.fire(void 0);let O=new o.ResponseError(o.ErrorCodes.PendingResponseRejected,"Pending response rejected since connection got disposed");for(let C of P.values())C.reject(O);if(P=new Map,M=new Map,y=new Set,T=new L3.LinkedMap,I0.func(Z.dispose))Z.dispose();if(I0.func(X.dispose))X.dispose()},listen:()=>{W6(),h8(),m=_X.Listening,X.listen(S8)},inspect:()=>{(0,B3.default)().console.log("inspect")}};return tX.onNotification(o8.type,(O)=>{if(K===V0.Off||!x)return;let C=K===V0.Verbose||K===V0.Compact;x.log(O.message,C?O.verbose:void 0)}),tX.onNotification(wZ.type,(O)=>{let C=j.get(O.token);if(C)C(O.value);else m0.fire(O)}),tX}w3.createMessageConnection=kO});var e8=D((d)=>{Object.defineProperty(d,"__esModule",{value:!0});d.ProgressType=d.ProgressToken=d.createMessageConnection=d.NullLogger=d.ConnectionOptions=d.ConnectionStrategy=d.AbstractMessageBuffer=d.WriteableStreamMessageWriter=d.AbstractMessageWriter=d.MessageWriter=d.ReadableStreamMessageReader=d.AbstractMessageReader=d.MessageReader=d.SharedArrayReceiverStrategy=d.SharedArraySenderStrategy=d.CancellationToken=d.CancellationTokenSource=d.Emitter=d.Event=d.Disposable=d.LRUCache=d.Touch=d.LinkedMap=d.ParameterStructures=d.NotificationType9=d.NotificationType8=d.NotificationType7=d.NotificationType6=d.NotificationType5=d.NotificationType4=d.NotificationType3=d.NotificationType2=d.NotificationType1=d.NotificationType0=d.NotificationType=d.ErrorCodes=d.ResponseError=d.RequestType9=d.RequestType8=d.RequestType7=d.RequestType6=d.RequestType5=d.RequestType4=d.RequestType3=d.RequestType2=d.RequestType1=d.RequestType0=d.RequestType=d.Message=d.RAL=void 0;d.MessageStrategy=d.CancellationStrategy=d.CancellationSenderStrategy=d.CancellationReceiverStrategy=d.ConnectionError=d.ConnectionErrors=d.LogTraceNotification=d.SetTraceNotification=d.TraceFormat=d.TraceValues=d.Trace=void 0;var K0=iQ();Object.defineProperty(d,"Message",{enumerable:!0,get:function(){return K0.Message}});Object.defineProperty(d,"RequestType",{enumerable:!0,get:function(){return K0.RequestType}});Object.defineProperty(d,"RequestType0",{enumerable:!0,get:function(){return K0.RequestType0}});Object.defineProperty(d,"RequestType1",{enumerable:!0,get:function(){return K0.RequestType1}});Object.defineProperty(d,"RequestType2",{enumerable:!0,get:function(){return K0.RequestType2}});Object.defineProperty(d,"RequestType3",{enumerable:!0,get:function(){return K0.RequestType3}});Object.defineProperty(d,"RequestType4",{enumerable:!0,get:function(){return K0.RequestType4}});Object.defineProperty(d,"RequestType5",{enumerable:!0,get:function(){return K0.RequestType5}});Object.defineProperty(d,"RequestType6",{enumerable:!0,get:function(){return K0.RequestType6}});Object.defineProperty(d,"RequestType7",{enumerable:!0,get:function(){return K0.RequestType7}});Object.defineProperty(d,"RequestType8",{enumerable:!0,get:function(){return K0.RequestType8}});Object.defineProperty(d,"RequestType9",{enumerable:!0,get:function(){return K0.RequestType9}});Object.defineProperty(d,"ResponseError",{enumerable:!0,get:function(){return K0.ResponseError}});Object.defineProperty(d,"ErrorCodes",{enumerable:!0,get:function(){return K0.ErrorCodes}});Object.defineProperty(d,"NotificationType",{enumerable:!0,get:function(){return K0.NotificationType}});Object.defineProperty(d,"NotificationType0",{enumerable:!0,get:function(){return K0.NotificationType0}});Object.defineProperty(d,"NotificationType1",{enumerable:!0,get:function(){return K0.NotificationType1}});Object.defineProperty(d,"NotificationType2",{enumerable:!0,get:function(){return K0.NotificationType2}});Object.defineProperty(d,"NotificationType3",{enumerable:!0,get:function(){return K0.NotificationType3}});Object.defineProperty(d,"NotificationType4",{enumerable:!0,get:function(){return K0.NotificationType4}});Object.defineProperty(d,"NotificationType5",{enumerable:!0,get:function(){return K0.NotificationType5}});Object.defineProperty(d,"NotificationType6",{enumerable:!0,get:function(){return K0.NotificationType6}});Object.defineProperty(d,"NotificationType7",{enumerable:!0,get:function(){return K0.NotificationType7}});Object.defineProperty(d,"NotificationType8",{enumerable:!0,get:function(){return K0.NotificationType8}});Object.defineProperty(d,"NotificationType9",{enumerable:!0,get:function(){return K0.NotificationType9}});Object.defineProperty(d,"ParameterStructures",{enumerable:!0,get:function(){return K0.ParameterStructures}});var BG=nQ();Object.defineProperty(d,"LinkedMap",{enumerable:!0,get:function(){return BG.LinkedMap}});Object.defineProperty(d,"LRUCache",{enumerable:!0,get:function(){return BG.LRUCache}});Object.defineProperty(d,"Touch",{enumerable:!0,get:function(){return BG.Touch}});var aO=S$();Object.defineProperty(d,"Disposable",{enumerable:!0,get:function(){return aO.Disposable}});var E3=V9();Object.defineProperty(d,"Event",{enumerable:!0,get:function(){return E3.Event}});Object.defineProperty(d,"Emitter",{enumerable:!0,get:function(){return E3.Emitter}});var P3=i8();Object.defineProperty(d,"CancellationTokenSource",{enumerable:!0,get:function(){return P3.CancellationTokenSource}});Object.defineProperty(d,"CancellationToken",{enumerable:!0,get:function(){return P3.CancellationToken}});var j3=c$();Object.defineProperty(d,"SharedArraySenderStrategy",{enumerable:!0,get:function(){return j3.SharedArraySenderStrategy}});Object.defineProperty(d,"SharedArrayReceiverStrategy",{enumerable:!0,get:function(){return j3.SharedArrayReceiverStrategy}});var LG=e$();Object.defineProperty(d,"MessageReader",{enumerable:!0,get:function(){return LG.MessageReader}});Object.defineProperty(d,"AbstractMessageReader",{enumerable:!0,get:function(){return LG.AbstractMessageReader}});Object.defineProperty(d,"ReadableStreamMessageReader",{enumerable:!0,get:function(){return LG.ReadableStreamMessageReader}});var AG=z3();Object.defineProperty(d,"MessageWriter",{enumerable:!0,get:function(){return AG.MessageWriter}});Object.defineProperty(d,"AbstractMessageWriter",{enumerable:!0,get:function(){return AG.AbstractMessageWriter}});Object.defineProperty(d,"WriteableStreamMessageWriter",{enumerable:!0,get:function(){return AG.WriteableStreamMessageWriter}});var tO=V3();Object.defineProperty(d,"AbstractMessageBuffer",{enumerable:!0,get:function(){return tO.AbstractMessageBuffer}});var d0=q3();Object.defineProperty(d,"ConnectionStrategy",{enumerable:!0,get:function(){return d0.ConnectionStrategy}});Object.defineProperty(d,"ConnectionOptions",{enumerable:!0,get:function(){return d0.ConnectionOptions}});Object.defineProperty(d,"NullLogger",{enumerable:!0,get:function(){return d0.NullLogger}});Object.defineProperty(d,"createMessageConnection",{enumerable:!0,get:function(){return d0.createMessageConnection}});Object.defineProperty(d,"ProgressToken",{enumerable:!0,get:function(){return d0.ProgressToken}});Object.defineProperty(d,"ProgressType",{enumerable:!0,get:function(){return d0.ProgressType}});Object.defineProperty(d,"Trace",{enumerable:!0,get:function(){return d0.Trace}});Object.defineProperty(d,"TraceValues",{enumerable:!0,get:function(){return d0.TraceValues}});Object.defineProperty(d,"TraceFormat",{enumerable:!0,get:function(){return d0.TraceFormat}});Object.defineProperty(d,"SetTraceNotification",{enumerable:!0,get:function(){return d0.SetTraceNotification}});Object.defineProperty(d,"LogTraceNotification",{enumerable:!0,get:function(){return d0.LogTraceNotification}});Object.defineProperty(d,"ConnectionErrors",{enumerable:!0,get:function(){return d0.ConnectionErrors}});Object.defineProperty(d,"ConnectionError",{enumerable:!0,get:function(){return d0.ConnectionError}});Object.defineProperty(d,"CancellationReceiverStrategy",{enumerable:!0,get:function(){return d0.CancellationReceiverStrategy}});Object.defineProperty(d,"CancellationSenderStrategy",{enumerable:!0,get:function(){return d0.CancellationSenderStrategy}});Object.defineProperty(d,"CancellationStrategy",{enumerable:!0,get:function(){return d0.CancellationStrategy}});Object.defineProperty(d,"MessageStrategy",{enumerable:!0,get:function(){return d0.MessageStrategy}});var eO=V6();d.RAL=eO.default});var b3=D((S3)=>{Object.defineProperty(S3,"__esModule",{value:!0});var D3=p0("util"),X6=e8();class X4 extends X6.AbstractMessageBuffer{constructor(X="utf-8"){super(X)}emptyBuffer(){return X4.emptyBuffer}fromString(X,Z){return Buffer.from(X,Z)}toString(X,Z){if(X instanceof Buffer)return X.toString(Z);else return new D3.TextDecoder(Z).decode(X)}asNative(X,Z){if(Z===void 0)return X instanceof Buffer?X:Buffer.from(X);else return X instanceof Buffer?X.slice(0,Z):Buffer.from(X,0,Z)}allocNative(X){return Buffer.allocUnsafe(X)}}X4.emptyBuffer=Buffer.allocUnsafe(0);class I3{constructor(X){this.stream=X}onClose(X){return this.stream.on("close",X),X6.Disposable.create(()=>this.stream.off("close",X))}onError(X){return this.stream.on("error",X),X6.Disposable.create(()=>this.stream.off("error",X))}onEnd(X){return this.stream.on("end",X),X6.Disposable.create(()=>this.stream.off("end",X))}onData(X){return this.stream.on("data",X),X6.Disposable.create(()=>this.stream.off("data",X))}}class _3{constructor(X){this.stream=X}onClose(X){return this.stream.on("close",X),X6.Disposable.create(()=>this.stream.off("close",X))}onError(X){return this.stream.on("error",X),X6.Disposable.create(()=>this.stream.off("error",X))}onEnd(X){return this.stream.on("end",X),X6.Disposable.create(()=>this.stream.off("end",X))}write(X,Z){return new Promise((Q,G)=>{let J=(Y)=>{if(Y===void 0||Y===null)Q();else G(Y)};if(typeof X==="string")this.stream.write(X,Z,J);else this.stream.write(X,J)})}end(){this.stream.end()}}var C3=Object.freeze({messageBuffer:Object.freeze({create:(X)=>new X4(X)}),applicationJson:Object.freeze({encoder:Object.freeze({name:"application/json",encode:(X,Z)=>{try{return Promise.resolve(Buffer.from(JSON.stringify(X,void 0,0),Z.charset))}catch(Q){return Promise.reject(Q)}}}),decoder:Object.freeze({name:"application/json",decode:(X,Z)=>{try{if(X instanceof Buffer)return Promise.resolve(JSON.parse(X.toString(Z.charset)));else return Promise.resolve(JSON.parse(new D3.TextDecoder(Z.charset).decode(X)))}catch(Q){return Promise.reject(Q)}}})}),stream:Object.freeze({asReadableStream:(X)=>new I3(X),asWritableStream:(X)=>new _3(X)}),console,timer:Object.freeze({setTimeout(X,Z,...Q){let G=setTimeout(X,Z,...Q);return{dispose:()=>clearTimeout(G)}},setImmediate(X,...Z){let Q=setImmediate(X,...Z);return{dispose:()=>clearImmediate(Q)}},setInterval(X,Z,...Q){let G=setInterval(X,Z,...Q);return{dispose:()=>clearInterval(G)}}})});function FG(){return C3}(function(X){function Z(){X6.RAL.install(C3)}X.install=Z})(FG||(FG={}));S3.default=FG});var B6=D((Y0)=>{var Jw=Y0&&Y0.__createBinding||(Object.create?function(X,Z,Q,G){if(G===void 0)G=Q;var J=Object.getOwnPropertyDescriptor(Z,Q);if(!J||("get"in J?!Z.__esModule:J.writable||J.configurable))J={enumerable:!0,get:function(){return Z[Q]}};Object.defineProperty(X,G,J)}:function(X,Z,Q,G){if(G===void 0)G=Q;X[G]=Z[Q]}),Yw=Y0&&Y0.__exportStar||function(X,Z){for(var Q in X)if(Q!=="default"&&!Object.prototype.hasOwnProperty.call(Z,Q))Jw(Z,X,Q)};Object.defineProperty(Y0,"__esModule",{value:!0});Y0.createMessageConnection=Y0.createServerSocketTransport=Y0.createClientSocketTransport=Y0.createServerPipeTransport=Y0.createClientPipeTransport=Y0.generateRandomPipeName=Y0.StreamMessageWriter=Y0.StreamMessageReader=Y0.SocketMessageWriter=Y0.SocketMessageReader=Y0.PortMessageWriter=Y0.PortMessageReader=Y0.IPCMessageWriter=Y0.IPCMessageReader=void 0;var A9=b3();A9.default.install();var R3=p0("path"),$w=p0("os"),zw=p0("crypto"),Z4=p0("net"),WX=e8();Yw(e8(),Y0);class f3 extends WX.AbstractMessageReader{constructor(X){super();this.process=X;let Z=this.process;Z.on("error",(Q)=>this.fireError(Q)),Z.on("close",()=>this.fireClose())}listen(X){return this.process.on("message",X),WX.Disposable.create(()=>this.process.off("message",X))}}Y0.IPCMessageReader=f3;class k3 extends WX.AbstractMessageWriter{constructor(X){super();this.process=X,this.errorCount=0;let Z=this.process;Z.on("error",(Q)=>this.fireError(Q)),Z.on("close",()=>this.fireClose)}write(X){try{if(typeof this.process.send==="function")this.process.send(X,void 0,void 0,(Z)=>{if(Z)this.errorCount++,this.handleError(Z,X);else this.errorCount=0});return Promise.resolve()}catch(Z){return this.handleError(Z,X),Promise.reject(Z)}}handleError(X,Z){this.errorCount++,this.fireError(X,Z,this.errorCount)}end(){}}Y0.IPCMessageWriter=k3;class x3 extends WX.AbstractMessageReader{constructor(X){super();this.onData=new WX.Emitter,X.on("close",()=>this.fireClose),X.on("error",(Z)=>this.fireError(Z)),X.on("message",(Z)=>{this.onData.fire(Z)})}listen(X){return this.onData.event(X)}}Y0.PortMessageReader=x3;class v3 extends WX.AbstractMessageWriter{constructor(X){super();this.port=X,this.errorCount=0,X.on("close",()=>this.fireClose()),X.on("error",(Z)=>this.fireError(Z))}write(X){try{return this.port.postMessage(X),Promise.resolve()}catch(Z){return this.handleError(Z,X),Promise.reject(Z)}}handleError(X,Z){this.errorCount++,this.fireError(X,Z,this.errorCount)}end(){}}Y0.PortMessageWriter=v3;class F9 extends WX.ReadableStreamMessageReader{constructor(X,Z="utf-8"){super((0,A9.default)().stream.asReadableStream(X),Z)}}Y0.SocketMessageReader=F9;class O9 extends WX.WriteableStreamMessageWriter{constructor(X,Z){super((0,A9.default)().stream.asWritableStream(X),Z);this.socket=X}dispose(){super.dispose(),this.socket.destroy()}}Y0.SocketMessageWriter=O9;class OG extends WX.ReadableStreamMessageReader{constructor(X,Z){super((0,A9.default)().stream.asReadableStream(X),Z)}}Y0.StreamMessageReader=OG;class wG extends WX.WriteableStreamMessageWriter{constructor(X,Z){super((0,A9.default)().stream.asWritableStream(X),Z)}}Y0.StreamMessageWriter=wG;var y3=process.env.XDG_RUNTIME_DIR,Hw=new Map([["linux",107],["darwin",103]]);function Uw(){let X=(0,zw.randomBytes)(21).toString("hex");if(process.platform==="win32")return`\\\\.\\pipe\\vscode-jsonrpc-${X}-sock`;let Z;if(y3)Z=R3.join(y3,`vscode-ipc-${X}.sock`);else Z=R3.join($w.tmpdir(),`vscode-${X}.sock`);let Q=Hw.get(process.platform);if(Q!==void 0&&Z.length>Q)(0,A9.default)().console.warn(`WARNING: IPC handle "${Z}" is longer than ${Q} characters.`);return Z}Y0.generateRandomPipeName=Uw;function Ww(X,Z="utf-8"){let Q,G=new Promise((J,Y)=>{Q=J});return new Promise((J,Y)=>{let $=(0,Z4.createServer)((z)=>{$.close(),Q([new F9(z,Z),new O9(z,Z)])});$.on("error",Y),$.listen(X,()=>{$.removeListener("error",Y),J({onConnected:()=>{return G}})})})}Y0.createClientPipeTransport=Ww;function Vw(X,Z="utf-8"){let Q=(0,Z4.createConnection)(X);return[new F9(Q,Z),new O9(Q,Z)]}Y0.createServerPipeTransport=Vw;function Bw(X,Z="utf-8"){let Q,G=new Promise((J,Y)=>{Q=J});return new Promise((J,Y)=>{let $=(0,Z4.createServer)((z)=>{$.close(),Q([new F9(z,Z),new O9(z,Z)])});$.on("error",Y),$.listen(X,"127.0.0.1",()=>{$.removeListener("error",Y),J({onConnected:()=>{return G}})})})}Y0.createClientSocketTransport=Bw;function Lw(X,Z="utf-8"){let Q=(0,Z4.createConnection)(X,"127.0.0.1");return[new F9(Q,Z),new O9(Q,Z)]}Y0.createServerSocketTransport=Lw;function Aw(X){let Z=X;return Z.read!==void 0&&Z.addListener!==void 0}function Fw(X){let Z=X;return Z.write!==void 0&&Z.addListener!==void 0}function Ow(X,Z,Q,G){if(!Q)Q=WX.NullLogger;let J=Aw(X)?new OG(X):X,Y=Fw(Z)?new wG(Z):Z;if(WX.ConnectionStrategy.is(G))G={connectionStrategy:G};return(0,WX.createMessageConnection)(J,Y,Q,G)}Y0.createMessageConnection=Ow});var G4=D((h3,Q4)=>{(function(X){if(typeof Q4==="object"&&typeof Q4.exports==="object"){var Z=X(p0,h3);if(Z!==void 0)Q4.exports=Z}else if(typeof define==="function"&&define.amd)define(["require","exports"],X)})(function(X,Z){Object.defineProperty(Z,"__esModule",{value:!0}),Z.TextDocument=Z.EOL=Z.WorkspaceFolder=Z.InlineCompletionContext=Z.SelectedCompletionInfo=Z.InlineCompletionTriggerKind=Z.InlineCompletionList=Z.InlineCompletionItem=Z.StringValue=Z.InlayHint=Z.InlayHintLabelPart=Z.InlayHintKind=Z.InlineValueContext=Z.InlineValueEvaluatableExpression=Z.InlineValueVariableLookup=Z.InlineValueText=Z.SemanticTokens=Z.SemanticTokenModifiers=Z.SemanticTokenTypes=Z.SelectionRange=Z.DocumentLink=Z.FormattingOptions=Z.CodeLens=Z.CodeAction=Z.CodeActionContext=Z.CodeActionTriggerKind=Z.CodeActionKind=Z.DocumentSymbol=Z.WorkspaceSymbol=Z.SymbolInformation=Z.SymbolTag=Z.SymbolKind=Z.DocumentHighlight=Z.DocumentHighlightKind=Z.SignatureInformation=Z.ParameterInformation=Z.Hover=Z.MarkedString=Z.CompletionList=Z.CompletionItem=Z.CompletionItemLabelDetails=Z.InsertTextMode=Z.InsertReplaceEdit=Z.CompletionItemTag=Z.InsertTextFormat=Z.CompletionItemKind=Z.MarkupContent=Z.MarkupKind=Z.TextDocumentItem=Z.OptionalVersionedTextDocumentIdentifier=Z.VersionedTextDocumentIdentifier=Z.TextDocumentIdentifier=Z.WorkspaceChange=Z.WorkspaceEdit=Z.DeleteFile=Z.RenameFile=Z.CreateFile=Z.TextDocumentEdit=Z.AnnotatedTextEdit=Z.ChangeAnnotationIdentifier=Z.ChangeAnnotation=Z.TextEdit=Z.Command=Z.Diagnostic=Z.CodeDescription=Z.DiagnosticTag=Z.DiagnosticSeverity=Z.DiagnosticRelatedInformation=Z.FoldingRange=Z.FoldingRangeKind=Z.ColorPresentation=Z.ColorInformation=Z.Color=Z.LocationLink=Z.Location=Z.Range=Z.Position=Z.uinteger=Z.integer=Z.URI=Z.DocumentUri=void 0;var Q;(function(V){function w(N){return typeof N==="string"}V.is=w})(Q||(Z.DocumentUri=Q={}));var G;(function(V){function w(N){return typeof N==="string"}V.is=w})(G||(Z.URI=G={}));var J;(function(V){V.MIN_VALUE=-2147483648,V.MAX_VALUE=2147483647;function w(N){return typeof N==="number"&&V.MIN_VALUE<=N&&N<=V.MAX_VALUE}V.is=w})(J||(Z.integer=J={}));var Y;(function(V){V.MIN_VALUE=0,V.MAX_VALUE=2147483647;function w(N){return typeof N==="number"&&V.MIN_VALUE<=N&&N<=V.MAX_VALUE}V.is=w})(Y||(Z.uinteger=Y={}));var $;(function(V){function w(B,W){if(B===Number.MAX_VALUE)B=Y.MAX_VALUE;if(W===Number.MAX_VALUE)W=Y.MAX_VALUE;return{line:B,character:W}}V.create=w;function N(B){var W=B;return E.objectLiteral(W)&&E.uinteger(W.line)&&E.uinteger(W.character)}V.is=N})($||(Z.Position=$={}));var z;(function(V){function w(B,W,q,b){if(E.uinteger(B)&&E.uinteger(W)&&E.uinteger(q)&&E.uinteger(b))return{start:$.create(B,W),end:$.create(q,b)};else if($.is(B)&&$.is(W))return{start:B,end:W};else throw Error("Range#create called with invalid arguments[".concat(B,", ").concat(W,", ").concat(q,", ").concat(b,"]"))}V.create=w;function N(B){var W=B;return E.objectLiteral(W)&&$.is(W.start)&&$.is(W.end)}V.is=N})(z||(Z.Range=z={}));var H;(function(V){function w(B,W){return{uri:B,range:W}}V.create=w;function N(B){var W=B;return E.objectLiteral(W)&&z.is(W.range)&&(E.string(W.uri)||E.undefined(W.uri))}V.is=N})(H||(Z.Location=H={}));var U;(function(V){function w(B,W,q,b){return{targetUri:B,targetRange:W,targetSelectionRange:q,originSelectionRange:b}}V.create=w;function N(B){var W=B;return E.objectLiteral(W)&&z.is(W.targetRange)&&E.string(W.targetUri)&&z.is(W.targetSelectionRange)&&(z.is(W.originSelectionRange)||E.undefined(W.originSelectionRange))}V.is=N})(U||(Z.LocationLink=U={}));var L;(function(V){function w(B,W,q,b){return{red:B,green:W,blue:q,alpha:b}}V.create=w;function N(B){var W=B;return E.objectLiteral(W)&&E.numberRange(W.red,0,1)&&E.numberRange(W.green,0,1)&&E.numberRange(W.blue,0,1)&&E.numberRange(W.alpha,0,1)}V.is=N})(L||(Z.Color=L={}));var A;(function(V){function w(B,W){return{range:B,color:W}}V.create=w;function N(B){var W=B;return E.objectLiteral(W)&&z.is(W.range)&&L.is(W.color)}V.is=N})(A||(Z.ColorInformation=A={}));var F;(function(V){function w(B,W,q){return{label:B,textEdit:W,additionalTextEdits:q}}V.create=w;function N(B){var W=B;return E.objectLiteral(W)&&E.string(W.label)&&(E.undefined(W.textEdit)||x.is(W))&&(E.undefined(W.additionalTextEdits)||E.typedArray(W.additionalTextEdits,x.is))}V.is=N})(F||(Z.ColorPresentation=F={}));var j;(function(V){V.Comment="comment",V.Imports="imports",V.Region="region"})(j||(Z.FoldingRangeKind=j={}));var R;(function(V){function w(B,W,q,b,e,b0){var w0={startLine:B,endLine:W};if(E.defined(q))w0.startCharacter=q;if(E.defined(b))w0.endCharacter=b;if(E.defined(e))w0.kind=e;if(E.defined(b0))w0.collapsedText=b0;return w0}V.create=w;function N(B){var W=B;return E.objectLiteral(W)&&E.uinteger(W.startLine)&&E.uinteger(W.startLine)&&(E.undefined(W.startCharacter)||E.uinteger(W.startCharacter))&&(E.undefined(W.endCharacter)||E.uinteger(W.endCharacter))&&(E.undefined(W.kind)||E.string(W.kind))}V.is=N})(R||(Z.FoldingRange=R={}));var T;(function(V){function w(B,W){return{location:B,message:W}}V.create=w;function N(B){var W=B;return E.defined(W)&&H.is(W.location)&&E.string(W.message)}V.is=N})(T||(Z.DiagnosticRelatedInformation=T={}));var P;(function(V){V.Error=1,V.Warning=2,V.Information=3,V.Hint=4})(P||(Z.DiagnosticSeverity=P={}));var y;(function(V){V.Unnecessary=1,V.Deprecated=2})(y||(Z.DiagnosticTag=y={}));var M;(function(V){function w(N){var B=N;return E.objectLiteral(B)&&E.string(B.href)}V.is=w})(M||(Z.CodeDescription=M={}));var K;(function(V){function w(B,W,q,b,e,b0){var w0={range:B,message:W};if(E.defined(q))w0.severity=q;if(E.defined(b))w0.code=b;if(E.defined(e))w0.source=e;if(E.defined(b0))w0.relatedInformation=b0;return w0}V.create=w;function N(B){var W,q=B;return E.defined(q)&&z.is(q.range)&&E.string(q.message)&&(E.number(q.severity)||E.undefined(q.severity))&&(E.integer(q.code)||E.string(q.code)||E.undefined(q.code))&&(E.undefined(q.codeDescription)||E.string((W=q.codeDescription)===null||W===void 0?void 0:W.href))&&(E.string(q.source)||E.undefined(q.source))&&(E.undefined(q.relatedInformation)||E.typedArray(q.relatedInformation,T.is))}V.is=N})(K||(Z.Diagnostic=K={}));var _;(function(V){function w(B,W){var q=[];for(var b=2;b<arguments.length;b++)q[b-2]=arguments[b];var e={title:B,command:W};if(E.defined(q)&&q.length>0)e.arguments=q;return e}V.create=w;function N(B){var W=B;return E.defined(W)&&E.string(W.title)&&E.string(W.command)}V.is=N})(_||(Z.Command=_={}));var x;(function(V){function w(q,b){return{range:q,newText:b}}V.replace=w;function N(q,b){return{range:{start:q,end:q},newText:b}}V.insert=N;function B(q){return{range:q,newText:""}}V.del=B;function W(q){var b=q;return E.objectLiteral(b)&&E.string(b.newText)&&z.is(b.range)}V.is=W})(x||(Z.TextEdit=x={}));var m;(function(V){function w(B,W,q){var b={label:B};if(W!==void 0)b.needsConfirmation=W;if(q!==void 0)b.description=q;return b}V.create=w;function N(B){var W=B;return E.objectLiteral(W)&&E.string(W.label)&&(E.boolean(W.needsConfirmation)||W.needsConfirmation===void 0)&&(E.string(W.description)||W.description===void 0)}V.is=N})(m||(Z.ChangeAnnotation=m={}));var n;(function(V){function w(N){var B=N;return E.string(B)}V.is=w})(n||(Z.ChangeAnnotationIdentifier=n={}));var u;(function(V){function w(q,b,e){return{range:q,newText:b,annotationId:e}}V.replace=w;function N(q,b,e){return{range:{start:q,end:q},newText:b,annotationId:e}}V.insert=N;function B(q,b){return{range:q,newText:"",annotationId:b}}V.del=B;function W(q){var b=q;return x.is(b)&&(m.is(b.annotationId)||n.is(b.annotationId))}V.is=W})(u||(Z.AnnotatedTextEdit=u={}));var A0;(function(V){function w(B,W){return{textDocument:B,edits:W}}V.create=w;function N(B){var W=B;return E.defined(W)&&k6.is(W.textDocument)&&Array.isArray(W.edits)}V.is=N})(A0||(Z.TextDocumentEdit=A0={}));var m0;(function(V){function w(B,W,q){var b={kind:"create",uri:B};if(W!==void 0&&(W.overwrite!==void 0||W.ignoreIfExists!==void 0))b.options=W;if(q!==void 0)b.annotationId=q;return b}V.create=w;function N(B){var W=B;return W&&W.kind==="create"&&E.string(W.uri)&&(W.options===void 0||(W.options.overwrite===void 0||E.boolean(W.options.overwrite))&&(W.options.ignoreIfExists===void 0||E.boolean(W.options.ignoreIfExists)))&&(W.annotationId===void 0||n.is(W.annotationId))}V.is=N})(m0||(Z.CreateFile=m0={}));var s0;(function(V){function w(B,W,q,b){var e={kind:"rename",oldUri:B,newUri:W};if(q!==void 0&&(q.overwrite!==void 0||q.ignoreIfExists!==void 0))e.options=q;if(b!==void 0)e.annotationId=b;return e}V.create=w;function N(B){var W=B;return W&&W.kind==="rename"&&E.string(W.oldUri)&&E.string(W.newUri)&&(W.options===void 0||(W.options.overwrite===void 0||E.boolean(W.options.overwrite))&&(W.options.ignoreIfExists===void 0||E.boolean(W.options.ignoreIfExists)))&&(W.annotationId===void 0||n.is(W.annotationId))}V.is=N})(s0||(Z.RenameFile=s0={}));var $0;(function(V){function w(B,W,q){var b={kind:"delete",uri:B};if(W!==void 0&&(W.recursive!==void 0||W.ignoreIfNotExists!==void 0))b.options=W;if(q!==void 0)b.annotationId=q;return b}V.create=w;function N(B){var W=B;return W&&W.kind==="delete"&&E.string(W.uri)&&(W.options===void 0||(W.options.recursive===void 0||E.boolean(W.options.recursive))&&(W.options.ignoreIfNotExists===void 0||E.boolean(W.options.ignoreIfNotExists)))&&(W.annotationId===void 0||n.is(W.annotationId))}V.is=N})($0||(Z.DeleteFile=$0={}));var sX;(function(V){function w(N){var B=N;return B&&(B.changes!==void 0||B.documentChanges!==void 0)&&(B.documentChanges===void 0||B.documentChanges.every(function(W){if(E.string(W.kind))return m0.is(W)||s0.is(W)||$0.is(W);else return A0.is(W)}))}V.is=w})(sX||(Z.WorkspaceEdit=sX={}));var J9=function(){function V(w,N){this.edits=w,this.changeAnnotations=N}return V.prototype.insert=function(w,N,B){var W,q;if(B===void 0)W=x.insert(w,N);else if(n.is(B))q=B,W=u.insert(w,N,B);else this.assertChangeAnnotations(this.changeAnnotations),q=this.changeAnnotations.manage(B),W=u.insert(w,N,q);if(this.edits.push(W),q!==void 0)return q},V.prototype.replace=function(w,N,B){var W,q;if(B===void 0)W=x.replace(w,N);else if(n.is(B))q=B,W=u.replace(w,N,B);else this.assertChangeAnnotations(this.changeAnnotations),q=this.changeAnnotations.manage(B),W=u.replace(w,N,q);if(this.edits.push(W),q!==void 0)return q},V.prototype.delete=function(w,N){var B,W;if(N===void 0)B=x.del(w);else if(n.is(N))W=N,B=u.del(w,N);else this.assertChangeAnnotations(this.changeAnnotations),W=this.changeAnnotations.manage(N),B=u.del(w,W);if(this.edits.push(B),W!==void 0)return W},V.prototype.add=function(w){this.edits.push(w)},V.prototype.all=function(){return this.edits},V.prototype.clear=function(){this.edits.splice(0,this.edits.length)},V.prototype.assertChangeAnnotations=function(w){if(w===void 0)throw Error("Text edit change is not configured to manage change annotations.")},V}(),I8=function(){function V(w){this._annotations=w===void 0?Object.create(null):w,this._counter=0,this._size=0}return V.prototype.all=function(){return this._annotations},Object.defineProperty(V.prototype,"size",{get:function(){return this._size},enumerable:!1,configurable:!0}),V.prototype.manage=function(w,N){var B;if(n.is(w))B=w;else B=this.nextId(),N=w;if(this._annotations[B]!==void 0)throw Error("Id ".concat(B," is already in use."));if(N===void 0)throw Error("No annotation provided for id ".concat(B));return this._annotations[B]=N,this._size++,B},V.prototype.nextId=function(){return this._counter++,this._counter.toString()},V}(),dQ=function(){function V(w){var N=this;if(this._textEditChanges=Object.create(null),w!==void 0){if(this._workspaceEdit=w,w.documentChanges)this._changeAnnotations=new I8(w.changeAnnotations),w.changeAnnotations=this._changeAnnotations.all(),w.documentChanges.forEach(function(B){if(A0.is(B)){var W=new J9(B.edits,N._changeAnnotations);N._textEditChanges[B.textDocument.uri]=W}});else if(w.changes)Object.keys(w.changes).forEach(function(B){var W=new J9(w.changes[B]);N._textEditChanges[B]=W})}else this._workspaceEdit={}}return Object.defineProperty(V.prototype,"edit",{get:function(){if(this.initDocumentChanges(),this._changeAnnotations!==void 0)if(this._changeAnnotations.size===0)this._workspaceEdit.changeAnnotations=void 0;else this._workspaceEdit.changeAnnotations=this._changeAnnotations.all();return this._workspaceEdit},enumerable:!1,configurable:!0}),V.prototype.getTextEditChange=function(w){if(k6.is(w)){if(this.initDocumentChanges(),this._workspaceEdit.documentChanges===void 0)throw Error("Workspace edit is not configured for document changes.");var N={uri:w.uri,version:w.version},B=this._textEditChanges[N.uri];if(!B){var W=[],q={textDocument:N,edits:W};this._workspaceEdit.documentChanges.push(q),B=new J9(W,this._changeAnnotations),this._textEditChanges[N.uri]=B}return B}else{if(this.initChanges(),this._workspaceEdit.changes===void 0)throw Error("Workspace edit is not configured for normal text edit changes.");var B=this._textEditChanges[w];if(!B){var W=[];this._workspaceEdit.changes[w]=W,B=new J9(W),this._textEditChanges[w]=B}return B}},V.prototype.initDocumentChanges=function(){if(this._workspaceEdit.documentChanges===void 0&&this._workspaceEdit.changes===void 0)this._changeAnnotations=new I8,this._workspaceEdit.documentChanges=[],this._workspaceEdit.changeAnnotations=this._changeAnnotations.all()},V.prototype.initChanges=function(){if(this._workspaceEdit.documentChanges===void 0&&this._workspaceEdit.changes===void 0)this._workspaceEdit.changes=Object.create(null)},V.prototype.createFile=function(w,N,B){if(this.initDocumentChanges(),this._workspaceEdit.documentChanges===void 0)throw Error("Workspace edit is not configured for document changes.");var W;if(m.is(N)||n.is(N))W=N;else B=N;var q,b;if(W===void 0)q=m0.create(w,B);else b=n.is(W)?W:this._changeAnnotations.manage(W),q=m0.create(w,B,b);if(this._workspaceEdit.documentChanges.push(q),b!==void 0)return b},V.prototype.renameFile=function(w,N,B,W){if(this.initDocumentChanges(),this._workspaceEdit.documentChanges===void 0)throw Error("Workspace edit is not configured for document changes.");var q;if(m.is(B)||n.is(B))q=B;else W=B;var b,e;if(q===void 0)b=s0.create(w,N,W);else e=n.is(q)?q:this._changeAnnotations.manage(q),b=s0.create(w,N,W,e);if(this._workspaceEdit.documentChanges.push(b),e!==void 0)return e},V.prototype.deleteFile=function(w,N,B){if(this.initDocumentChanges(),this._workspaceEdit.documentChanges===void 0)throw Error("Workspace edit is not configured for document changes.");var W;if(m.is(N)||n.is(N))W=N;else B=N;var q,b;if(W===void 0)q=$0.create(w,B);else b=n.is(W)?W:this._changeAnnotations.manage(W),q=$0.create(w,B,b);if(this._workspaceEdit.documentChanges.push(q),b!==void 0)return b},V}();Z.WorkspaceChange=dQ;var zZ;(function(V){function w(B){return{uri:B}}V.create=w;function N(B){var W=B;return E.defined(W)&&E.string(W.uri)}V.is=N})(zZ||(Z.TextDocumentIdentifier=zZ={}));var HZ;(function(V){function w(B,W){return{uri:B,version:W}}V.create=w;function N(B){var W=B;return E.defined(W)&&E.string(W.uri)&&E.integer(W.version)}V.is=N})(HZ||(Z.VersionedTextDocumentIdentifier=HZ={}));var k6;(function(V){function w(B,W){return{uri:B,version:W}}V.create=w;function N(B){var W=B;return E.defined(W)&&E.string(W.uri)&&(W.version===null||E.integer(W.version))}V.is=N})(k6||(Z.OptionalVersionedTextDocumentIdentifier=k6={}));var rX;(function(V){function w(B,W,q,b){return{uri:B,languageId:W,version:q,text:b}}V.create=w;function N(B){var W=B;return E.defined(W)&&E.string(W.uri)&&E.string(W.languageId)&&E.integer(W.version)&&E.string(W.text)}V.is=N})(rX||(Z.TextDocumentItem=rX={}));var Y9;(function(V){V.PlainText="plaintext",V.Markdown="markdown";function w(N){var B=N;return B===V.PlainText||B===V.Markdown}V.is=w})(Y9||(Z.MarkupKind=Y9={}));var x6;(function(V){function w(N){var B=N;return E.objectLiteral(N)&&Y9.is(B.kind)&&E.string(B.value)}V.is=w})(x6||(Z.MarkupContent=x6={}));var _8;(function(V){V.Text=1,V.Method=2,V.Function=3,V.Constructor=4,V.Field=5,V.Variable=6,V.Class=7,V.Interface=8,V.Module=9,V.Property=10,V.Unit=11,V.Value=12,V.Enum=13,V.Keyword=14,V.Snippet=15,V.Color=16,V.File=17,V.Reference=18,V.Folder=19,V.EnumMember=20,V.Constant=21,V.Struct=22,V.Event=23,V.Operator=24,V.TypeParameter=25})(_8||(Z.CompletionItemKind=_8={}));var UZ;(function(V){V.PlainText=1,V.Snippet=2})(UZ||(Z.InsertTextFormat=UZ={}));var WZ;(function(V){V.Deprecated=1})(WZ||(Z.CompletionItemTag=WZ={}));var C8;(function(V){function w(B,W,q){return{newText:B,insert:W,replace:q}}V.create=w;function N(B){var W=B;return W&&E.string(W.newText)&&z.is(W.insert)&&z.is(W.replace)}V.is=N})(C8||(Z.InsertReplaceEdit=C8={}));var S8;(function(V){V.asIs=1,V.adjustIndentation=2})(S8||(Z.InsertTextMode=S8={}));var b8;(function(V){function w(N){var B=N;return B&&(E.string(B.detail)||B.detail===void 0)&&(E.string(B.description)||B.description===void 0)}V.is=w})(b8||(Z.CompletionItemLabelDetails=b8={}));var R8;(function(V){function w(N){return{label:N}}V.create=w})(R8||(Z.CompletionItem=R8={}));var y8;(function(V){function w(N,B){return{items:N?N:[],isIncomplete:!!B}}V.create=w})(y8||(Z.CompletionList=y8={}));var $9;(function(V){function w(B){return B.replace(/[\\`*_{}[\]()#+\-.!]/g,"\\$&")}V.fromPlainText=w;function N(B){var W=B;return E.string(W)||E.objectLiteral(W)&&E.string(W.language)&&E.string(W.value)}V.is=N})($9||(Z.MarkedString=$9={}));var jX;(function(V){function w(N){var B=N;return!!B&&E.objectLiteral(B)&&(x6.is(B.contents)||$9.is(B.contents)||E.typedArray(B.contents,$9.is))&&(N.range===void 0||z.is(N.range))}V.is=w})(jX||(Z.Hover=jX={}));var f8;(function(V){function w(N,B){return B?{label:N,documentation:B}:{label:N}}V.create=w})(f8||(Z.ParameterInformation=f8={}));var k8;(function(V){function w(N,B){var W=[];for(var q=2;q<arguments.length;q++)W[q-2]=arguments[q];var b={label:N};if(E.defined(B))b.documentation=B;if(E.defined(W))b.parameters=W;else b.parameters=[];return b}V.create=w})(k8||(Z.SignatureInformation=k8={}));var v6;(function(V){V.Text=1,V.Read=2,V.Write=3})(v6||(Z.DocumentHighlightKind=v6={}));var x8;(function(V){function w(N,B){var W={range:N};if(E.number(B))W.kind=B;return W}V.create=w})(x8||(Z.DocumentHighlight=x8={}));var z9;(function(V){V.File=1,V.Module=2,V.Namespace=3,V.Package=4,V.Class=5,V.Method=6,V.Property=7,V.Field=8,V.Constructor=9,V.Enum=10,V.Interface=11,V.Function=12,V.Variable=13,V.Constant=14,V.String=15,V.Number=16,V.Boolean=17,V.Array=18,V.Object=19,V.Key=20,V.Null=21,V.EnumMember=22,V.Struct=23,V.Event=24,V.Operator=25,V.TypeParameter=26})(z9||(Z.SymbolKind=z9={}));var v8;(function(V){V.Deprecated=1})(v8||(Z.SymbolTag=v8={}));var aX;(function(V){function w(N,B,W,q,b){var e={name:N,kind:B,location:{uri:q,range:W}};if(b)e.containerName=b;return e}V.create=w})(aX||(Z.SymbolInformation=aX={}));var W6;(function(V){function w(N,B,W,q){return q!==void 0?{name:N,kind:B,location:{uri:W,range:q}}:{name:N,kind:B,location:{uri:W}}}V.create=w})(W6||(Z.WorkspaceSymbol=W6={}));var h8;(function(V){function w(B,W,q,b,e,b0){var w0={name:B,detail:W,kind:q,range:b,selectionRange:e};if(b0!==void 0)w0.children=b0;return w0}V.create=w;function N(B){var W=B;return W&&E.string(W.name)&&E.number(W.kind)&&z.is(W.range)&&z.is(W.selectionRange)&&(W.detail===void 0||E.string(W.detail))&&(W.deprecated===void 0||E.boolean(W.deprecated))&&(W.children===void 0||Array.isArray(W.children))&&(W.tags===void 0||Array.isArray(W.tags))}V.is=N})(h8||(Z.DocumentSymbol=h8={}));var g8;(function(V){V.Empty="",V.QuickFix="quickfix",V.Refactor="refactor",V.RefactorExtract="refactor.extract",V.RefactorInline="refactor.inline",V.RefactorRewrite="refactor.rewrite",V.Source="source",V.SourceOrganizeImports="source.organizeImports",V.SourceFixAll="source.fixAll"})(g8||(Z.CodeActionKind=g8={}));var hX;(function(V){V.Invoked=1,V.Automatic=2})(hX||(Z.CodeActionTriggerKind=hX={}));var VZ;(function(V){function w(B,W,q){var b={diagnostics:B};if(W!==void 0&&W!==null)b.only=W;if(q!==void 0&&q!==null)b.triggerKind=q;return b}V.create=w;function N(B){var W=B;return E.defined(W)&&E.typedArray(W.diagnostics,K.is)&&(W.only===void 0||E.typedArray(W.only,E.string))&&(W.triggerKind===void 0||W.triggerKind===hX.Invoked||W.triggerKind===hX.Automatic)}V.is=N})(VZ||(Z.CodeActionContext=VZ={}));var BZ;(function(V){function w(B,W,q){var b={title:B},e=!0;if(typeof W==="string")e=!1,b.kind=W;else if(_.is(W))b.command=W;else b.edit=W;if(e&&q!==void 0)b.kind=q;return b}V.create=w;function N(B){var W=B;return W&&E.string(W.title)&&(W.diagnostics===void 0||E.typedArray(W.diagnostics,K.is))&&(W.kind===void 0||E.string(W.kind))&&(W.edit!==void 0||W.command!==void 0)&&(W.command===void 0||_.is(W.command))&&(W.isPreferred===void 0||E.boolean(W.isPreferred))&&(W.edit===void 0||sX.is(W.edit))}V.is=N})(BZ||(Z.CodeAction=BZ={}));var H9;(function(V){function w(B,W){var q={range:B};if(E.defined(W))q.data=W;return q}V.create=w;function N(B){var W=B;return E.defined(W)&&z.is(W.range)&&(E.undefined(W.command)||_.is(W.command))}V.is=N})(H9||(Z.CodeLens=H9={}));var LZ;(function(V){function w(B,W){return{tabSize:B,insertSpaces:W}}V.create=w;function N(B){var W=B;return E.defined(W)&&E.uinteger(W.tabSize)&&E.boolean(W.insertSpaces)}V.is=N})(LZ||(Z.FormattingOptions=LZ={}));var tX;(function(V){function w(B,W,q){return{range:B,target:W,data:q}}V.create=w;function N(B){var W=B;return E.defined(W)&&z.is(W.range)&&(E.undefined(W.target)||E.string(W.target))}V.is=N})(tX||(Z.DocumentLink=tX={}));var O;(function(V){function w(B,W){return{range:B,parent:W}}V.create=w;function N(B){var W=B;return E.objectLiteral(W)&&z.is(W.range)&&(W.parent===void 0||V.is(W.parent))}V.is=N})(O||(Z.SelectionRange=O={}));var C;(function(V){V.namespace="namespace",V.type="type",V.class="class",V.enum="enum",V.interface="interface",V.struct="struct",V.typeParameter="typeParameter",V.parameter="parameter",V.variable="variable",V.property="property",V.enumMember="enumMember",V.event="event",V.function="function",V.method="method",V.macro="macro",V.keyword="keyword",V.modifier="modifier",V.comment="comment",V.string="string",V.number="number",V.regexp="regexp",V.operator="operator",V.decorator="decorator"})(C||(Z.SemanticTokenTypes=C={}));var v;(function(V){V.declaration="declaration",V.definition="definition",V.readonly="readonly",V.static="static",V.deprecated="deprecated",V.abstract="abstract",V.async="async",V.modification="modification",V.documentation="documentation",V.defaultLibrary="defaultLibrary"})(v||(Z.SemanticTokenModifiers=v={}));var p;(function(V){function w(N){var B=N;return E.objectLiteral(B)&&(B.resultId===void 0||typeof B.resultId==="string")&&Array.isArray(B.data)&&(B.data.length===0||typeof B.data[0]==="number")}V.is=w})(p||(Z.SemanticTokens=p={}));var L0;(function(V){function w(B,W){return{range:B,text:W}}V.create=w;function N(B){var W=B;return W!==void 0&&W!==null&&z.is(W.range)&&E.string(W.text)}V.is=N})(L0||(Z.InlineValueText=L0={}));var B0;(function(V){function w(B,W,q){return{range:B,variableName:W,caseSensitiveLookup:q}}V.create=w;function N(B){var W=B;return W!==void 0&&W!==null&&z.is(W.range)&&E.boolean(W.caseSensitiveLookup)&&(E.string(W.variableName)||W.variableName===void 0)}V.is=N})(B0||(Z.InlineValueVariableLookup=B0={}));var T0;(function(V){function w(B,W){return{range:B,expression:W}}V.create=w;function N(B){var W=B;return W!==void 0&&W!==null&&z.is(W.range)&&(E.string(W.expression)||W.expression===void 0)}V.is=N})(T0||(Z.InlineValueEvaluatableExpression=T0={}));var P0;(function(V){function w(B,W){return{frameId:B,stoppedLocation:W}}V.create=w;function N(B){var W=B;return E.defined(W)&&z.is(B.stoppedLocation)}V.is=N})(P0||(Z.InlineValueContext=P0={}));var Q0;(function(V){V.Type=1,V.Parameter=2;function w(N){return N===1||N===2}V.is=w})(Q0||(Z.InlayHintKind=Q0={}));var F0;(function(V){function w(B){return{value:B}}V.create=w;function N(B){var W=B;return E.objectLiteral(W)&&(W.tooltip===void 0||E.string(W.tooltip)||x6.is(W.tooltip))&&(W.location===void 0||H.is(W.location))&&(W.command===void 0||_.is(W.command))}V.is=N})(F0||(Z.InlayHintLabelPart=F0={}));var U0;(function(V){function w(B,W,q){var b={position:B,label:W};if(q!==void 0)b.kind=q;return b}V.create=w;function N(B){var W=B;return E.objectLiteral(W)&&$.is(W.position)&&(E.string(W.label)||E.typedArray(W.label,F0.is))&&(W.kind===void 0||Q0.is(W.kind))&&W.textEdits===void 0||E.typedArray(W.textEdits,x.is)&&(W.tooltip===void 0||E.string(W.tooltip)||x6.is(W.tooltip))&&(W.paddingLeft===void 0||E.boolean(W.paddingLeft))&&(W.paddingRight===void 0||E.boolean(W.paddingRight))}V.is=N})(U0||(Z.InlayHint=U0={}));var S0;(function(V){function w(N){return{kind:"snippet",value:N}}V.createSnippet=w})(S0||(Z.StringValue=S0={}));var g0;(function(V){function w(N,B,W,q){return{insertText:N,filterText:B,range:W,command:q}}V.create=w})(g0||(Z.InlineCompletionItem=g0={}));var HX;(function(V){function w(N){return{items:N}}V.create=w})(HX||(Z.InlineCompletionList=HX={}));var u8;(function(V){V.Invoked=0,V.Automatic=1})(u8||(Z.InlineCompletionTriggerKind=u8={}));var vY;(function(V){function w(N,B){return{range:N,text:B}}V.create=w})(vY||(Z.SelectedCompletionInfo=vY={}));var hY;(function(V){function w(N,B){return{triggerKind:N,selectedCompletionInfo:B}}V.create=w})(hY||(Z.InlineCompletionContext=hY={}));var gY;(function(V){function w(N){var B=N;return E.objectLiteral(B)&&G.is(B.uri)&&E.string(B.name)}V.is=w})(gY||(Z.WorkspaceFolder=gY={})),Z.EOL=[`
`,`\r
`,"\r"];var uY;(function(V){function w(q,b,e,b0){return new WF(q,b,e,b0)}V.create=w;function N(q){var b=q;return E.defined(b)&&E.string(b.uri)&&(E.undefined(b.languageId)||E.string(b.languageId))&&E.uinteger(b.lineCount)&&E.func(b.getText)&&E.func(b.positionAt)&&E.func(b.offsetAt)?!0:!1}V.is=N;function B(q,b){var e=q.getText(),b0=W(b,function(U9,m8){var mY=U9.range.start.line-m8.range.start.line;if(mY===0)return U9.range.start.character-m8.range.start.character;return mY}),w0=e.length;for(var DX=b0.length-1;DX>=0;DX--){var IX=b0[DX],eX=q.offsetAt(IX.range.start),J0=q.offsetAt(IX.range.end);if(J0<=w0)e=e.substring(0,eX)+IX.newText+e.substring(J0,e.length);else throw Error("Overlapping edit");w0=eX}return e}V.applyEdits=B;function W(q,b){if(q.length<=1)return q;var e=q.length/2|0,b0=q.slice(0,e),w0=q.slice(e);W(b0,b),W(w0,b);var DX=0,IX=0,eX=0;while(DX<b0.length&&IX<w0.length){var J0=b(b0[DX],w0[IX]);if(J0<=0)q[eX++]=b0[DX++];else q[eX++]=w0[IX++]}while(DX<b0.length)q[eX++]=b0[DX++];while(IX<w0.length)q[eX++]=w0[IX++];return q}})(uY||(Z.TextDocument=uY={}));var WF=function(){function V(w,N,B,W){this._uri=w,this._languageId=N,this._version=B,this._content=W,this._lineOffsets=void 0}return Object.defineProperty(V.prototype,"uri",{get:function(){return this._uri},enumerable:!1,configurable:!0}),Object.defineProperty(V.prototype,"languageId",{get:function(){return this._languageId},enumerable:!1,configurable:!0}),Object.defineProperty(V.prototype,"version",{get:function(){return this._version},enumerable:!1,configurable:!0}),V.prototype.getText=function(w){if(w){var N=this.offsetAt(w.start),B=this.offsetAt(w.end);return this._content.substring(N,B)}return this._content},V.prototype.update=function(w,N){this._content=w.text,this._version=N,this._lineOffsets=void 0},V.prototype.getLineOffsets=function(){if(this._lineOffsets===void 0){var w=[],N=this._content,B=!0;for(var W=0;W<N.length;W++){if(B)w.push(W),B=!1;var q=N.charAt(W);if(B=q==="\r"||q===`
`,q==="\r"&&W+1<N.length&&N.charAt(W+1)===`
`)W++}if(B&&N.length>0)w.push(N.length);this._lineOffsets=w}return this._lineOffsets},V.prototype.positionAt=function(w){w=Math.max(Math.min(w,this._content.length),0);var N=this.getLineOffsets(),B=0,W=N.length;if(W===0)return $.create(0,w);while(B<W){var q=Math.floor((B+W)/2);if(N[q]>w)W=q;else B=q+1}var b=B-1;return $.create(b,w-N[b])},V.prototype.offsetAt=function(w){var N=this.getLineOffsets();if(w.line>=N.length)return this._content.length;else if(w.line<0)return 0;var B=N[w.line],W=w.line+1<N.length?N[w.line+1]:this._content.length;return Math.max(Math.min(B+w.character,W),B)},Object.defineProperty(V.prototype,"lineCount",{get:function(){return this.getLineOffsets().length},enumerable:!1,configurable:!0}),V}(),E;(function(V){var w=Object.prototype.toString;function N(J0){return typeof J0<"u"}V.defined=N;function B(J0){return typeof J0>"u"}V.undefined=B;function W(J0){return J0===!0||J0===!1}V.boolean=W;function q(J0){return w.call(J0)==="[object String]"}V.string=q;function b(J0){return w.call(J0)==="[object Number]"}V.number=b;function e(J0,U9,m8){return w.call(J0)==="[object Number]"&&U9<=J0&&J0<=m8}V.numberRange=e;function b0(J0){return w.call(J0)==="[object Number]"&&-2147483648<=J0&&J0<=2147483647}V.integer=b0;function w0(J0){return w.call(J0)==="[object Number]"&&0<=J0&&J0<=2147483647}V.uinteger=w0;function DX(J0){return w.call(J0)==="[object Function]"}V.func=DX;function IX(J0){return J0!==null&&typeof J0==="object"}V.objectLiteral=IX;function eX(J0,U9){return Array.isArray(J0)&&J0.every(U9)}V.typedArray=eX})(E||(E={}))})});var D0=D((c3)=>{Object.defineProperty(c3,"__esModule",{value:!0});c3.ProtocolNotificationType=c3.ProtocolNotificationType0=c3.ProtocolRequestType=c3.ProtocolRequestType0=c3.RegistrationType=c3.MessageDirection=void 0;var w9=B6(),g3;(function(X){X.clientToServer="clientToServer",X.serverToClient="serverToClient",X.both="both"})(g3||(c3.MessageDirection=g3={}));class u3{constructor(X){this.method=X}}c3.RegistrationType=u3;class m3 extends w9.RequestType0{constructor(X){super(X)}}c3.ProtocolRequestType0=m3;class p3 extends w9.RequestType{constructor(X){super(X,w9.ParameterStructures.byName)}}c3.ProtocolRequestType=p3;class d3 extends w9.NotificationType0{constructor(X){super(X)}}c3.ProtocolNotificationType0=d3;class l3 extends w9.NotificationType{constructor(X){super(X,w9.ParameterStructures.byName)}}c3.ProtocolNotificationType=l3});var J4=D((s3)=>{Object.defineProperty(s3,"__esModule",{value:!0});s3.objectLiteral=s3.typedArray=s3.stringArray=s3.array=s3.func=s3.error=s3.number=s3.string=s3.boolean=void 0;function qw(X){return X===!0||X===!1}s3.boolean=qw;function o3(X){return typeof X==="string"||X instanceof String}s3.string=o3;function Ew(X){return typeof X==="number"||X instanceof Number}s3.number=Ew;function Pw(X){return X instanceof Error}s3.error=Pw;function jw(X){return typeof X==="function"}s3.func=jw;function n3(X){return Array.isArray(X)}s3.array=n3;function Dw(X){return n3(X)&&X.every((Z)=>o3(Z))}s3.stringArray=Dw;function Iw(X,Z){return Array.isArray(X)&&X.every(Z)}s3.typedArray=Iw;function _w(X){return X!==null&&typeof X==="object"}s3.objectLiteral=_w});var Z5=D((e3)=>{Object.defineProperty(e3,"__esModule",{value:!0});e3.ImplementationRequest=void 0;var a3=D0(),t3;(function(X){X.method="textDocument/implementation",X.messageDirection=a3.MessageDirection.clientToServer,X.type=new a3.ProtocolRequestType(X.method)})(t3||(e3.ImplementationRequest=t3={}))});var $5=D((J5)=>{Object.defineProperty(J5,"__esModule",{value:!0});J5.TypeDefinitionRequest=void 0;var Q5=D0(),G5;(function(X){X.method="textDocument/typeDefinition",X.messageDirection=Q5.MessageDirection.clientToServer,X.type=new Q5.ProtocolRequestType(X.method)})(G5||(J5.TypeDefinitionRequest=G5={}))});var V5=D((U5)=>{Object.defineProperty(U5,"__esModule",{value:!0});U5.DidChangeWorkspaceFoldersNotification=U5.WorkspaceFoldersRequest=void 0;var Y4=D0(),z5;(function(X){X.method="workspace/workspaceFolders",X.messageDirection=Y4.MessageDirection.serverToClient,X.type=new Y4.ProtocolRequestType0(X.method)})(z5||(U5.WorkspaceFoldersRequest=z5={}));var H5;(function(X){X.method="workspace/didChangeWorkspaceFolders",X.messageDirection=Y4.MessageDirection.clientToServer,X.type=new Y4.ProtocolNotificationType(X.method)})(H5||(U5.DidChangeWorkspaceFoldersNotification=H5={}))});var O5=D((A5)=>{Object.defineProperty(A5,"__esModule",{value:!0});A5.ConfigurationRequest=void 0;var B5=D0(),L5;(function(X){X.method="workspace/configuration",X.messageDirection=B5.MessageDirection.serverToClient,X.type=new B5.ProtocolRequestType(X.method)})(L5||(A5.ConfigurationRequest=L5={}))});var T5=D((M5)=>{Object.defineProperty(M5,"__esModule",{value:!0});M5.ColorPresentationRequest=M5.DocumentColorRequest=void 0;var $4=D0(),w5;(function(X){X.method="textDocument/documentColor",X.messageDirection=$4.MessageDirection.clientToServer,X.type=new $4.ProtocolRequestType(X.method)})(w5||(M5.DocumentColorRequest=w5={}));var K5;(function(X){X.method="textDocument/colorPresentation",X.messageDirection=$4.MessageDirection.clientToServer,X.type=new $4.ProtocolRequestType(X.method)})(K5||(M5.ColorPresentationRequest=K5={}))});var D5=D((P5)=>{Object.defineProperty(P5,"__esModule",{value:!0});P5.FoldingRangeRefreshRequest=P5.FoldingRangeRequest=void 0;var z4=D0(),q5;(function(X){X.method="textDocument/foldingRange",X.messageDirection=z4.MessageDirection.clientToServer,X.type=new z4.ProtocolRequestType(X.method)})(q5||(P5.FoldingRangeRequest=q5={}));var E5;(function(X){X.method="workspace/foldingRange/refresh",X.messageDirection=z4.MessageDirection.serverToClient,X.type=new z4.ProtocolRequestType0(X.method)})(E5||(P5.FoldingRangeRefreshRequest=E5={}))});var b5=D((C5)=>{Object.defineProperty(C5,"__esModule",{value:!0});C5.DeclarationRequest=void 0;var I5=D0(),_5;(function(X){X.method="textDocument/declaration",X.messageDirection=I5.MessageDirection.clientToServer,X.type=new I5.ProtocolRequestType(X.method)})(_5||(C5.DeclarationRequest=_5={}))});var x5=D((f5)=>{Object.defineProperty(f5,"__esModule",{value:!0});f5.SelectionRangeRequest=void 0;var R5=D0(),y5;(function(X){X.method="textDocument/selectionRange",X.messageDirection=R5.MessageDirection.clientToServer,X.type=new R5.ProtocolRequestType(X.method)})(y5||(f5.SelectionRangeRequest=y5={}))});var p5=D((u5)=>{Object.defineProperty(u5,"__esModule",{value:!0});u5.WorkDoneProgressCancelNotification=u5.WorkDoneProgressCreateRequest=u5.WorkDoneProgress=void 0;var uw=B6(),H4=D0(),v5;(function(X){X.type=new uw.ProgressType;function Z(Q){return Q===X.type}X.is=Z})(v5||(u5.WorkDoneProgress=v5={}));var h5;(function(X){X.method="window/workDoneProgress/create",X.messageDirection=H4.MessageDirection.serverToClient,X.type=new H4.ProtocolRequestType(X.method)})(h5||(u5.WorkDoneProgressCreateRequest=h5={}));var g5;(function(X){X.method="window/workDoneProgress/cancel",X.messageDirection=H4.MessageDirection.clientToServer,X.type=new H4.ProtocolNotificationType(X.method)})(g5||(u5.WorkDoneProgressCancelNotification=g5={}))});var n5=D((i5)=>{Object.defineProperty(i5,"__esModule",{value:!0});i5.CallHierarchyOutgoingCallsRequest=i5.CallHierarchyIncomingCallsRequest=i5.CallHierarchyPrepareRequest=void 0;var K9=D0(),d5;(function(X){X.method="textDocument/prepareCallHierarchy",X.messageDirection=K9.MessageDirection.clientToServer,X.type=new K9.ProtocolRequestType(X.method)})(d5||(i5.CallHierarchyPrepareRequest=d5={}));var l5;(function(X){X.method="callHierarchy/incomingCalls",X.messageDirection=K9.MessageDirection.clientToServer,X.type=new K9.ProtocolRequestType(X.method)})(l5||(i5.CallHierarchyIncomingCallsRequest=l5={}));var c5;(function(X){X.method="callHierarchy/outgoingCalls",X.messageDirection=K9.MessageDirection.clientToServer,X.type=new K9.ProtocolRequestType(X.method)})(c5||(i5.CallHierarchyOutgoingCallsRequest=c5={}))});var Qz=D((Xz)=>{Object.defineProperty(Xz,"__esModule",{value:!0});Xz.SemanticTokensRefreshRequest=Xz.SemanticTokensRangeRequest=Xz.SemanticTokensDeltaRequest=Xz.SemanticTokensRequest=Xz.SemanticTokensRegistrationType=Xz.TokenFormat=void 0;var Z6=D0(),s5;(function(X){X.Relative="relative"})(s5||(Xz.TokenFormat=s5={}));var NZ;(function(X){X.method="textDocument/semanticTokens",X.type=new Z6.RegistrationType(X.method)})(NZ||(Xz.SemanticTokensRegistrationType=NZ={}));var r5;(function(X){X.method="textDocument/semanticTokens/full",X.messageDirection=Z6.MessageDirection.clientToServer,X.type=new Z6.ProtocolRequestType(X.method),X.registrationMethod=NZ.method})(r5||(Xz.SemanticTokensRequest=r5={}));var a5;(function(X){X.method="textDocument/semanticTokens/full/delta",X.messageDirection=Z6.MessageDirection.clientToServer,X.type=new Z6.ProtocolRequestType(X.method),X.registrationMethod=NZ.method})(a5||(Xz.SemanticTokensDeltaRequest=a5={}));var t5;(function(X){X.method="textDocument/semanticTokens/range",X.messageDirection=Z6.MessageDirection.clientToServer,X.type=new Z6.ProtocolRequestType(X.method),X.registrationMethod=NZ.method})(t5||(Xz.SemanticTokensRangeRequest=t5={}));var e5;(function(X){X.method="workspace/semanticTokens/refresh",X.messageDirection=Z6.MessageDirection.serverToClient,X.type=new Z6.ProtocolRequestType0(X.method)})(e5||(Xz.SemanticTokensRefreshRequest=e5={}))});var zz=D((Yz)=>{Object.defineProperty(Yz,"__esModule",{value:!0});Yz.ShowDocumentRequest=void 0;var Gz=D0(),Jz;(function(X){X.method="window/showDocument",X.messageDirection=Gz.MessageDirection.serverToClient,X.type=new Gz.ProtocolRequestType(X.method)})(Jz||(Yz.ShowDocumentRequest=Jz={}))});var Bz=D((Wz)=>{Object.defineProperty(Wz,"__esModule",{value:!0});Wz.LinkedEditingRangeRequest=void 0;var Hz=D0(),Uz;(function(X){X.method="textDocument/linkedEditingRange",X.messageDirection=Hz.MessageDirection.clientToServer,X.type=new Hz.ProtocolRequestType(X.method)})(Uz||(Wz.LinkedEditingRangeRequest=Uz={}))});var qz=D((Nz)=>{Object.defineProperty(Nz,"__esModule",{value:!0});Nz.WillDeleteFilesRequest=Nz.DidDeleteFilesNotification=Nz.DidRenameFilesNotification=Nz.WillRenameFilesRequest=Nz.DidCreateFilesNotification=Nz.WillCreateFilesRequest=Nz.FileOperationPatternKind=void 0;var LX=D0(),Lz;(function(X){X.file="file",X.folder="folder"})(Lz||(Nz.FileOperationPatternKind=Lz={}));var Az;(function(X){X.method="workspace/willCreateFiles",X.messageDirection=LX.MessageDirection.clientToServer,X.type=new LX.ProtocolRequestType(X.method)})(Az||(Nz.WillCreateFilesRequest=Az={}));var Fz;(function(X){X.method="workspace/didCreateFiles",X.messageDirection=LX.MessageDirection.clientToServer,X.type=new LX.ProtocolNotificationType(X.method)})(Fz||(Nz.DidCreateFilesNotification=Fz={}));var Oz;(function(X){X.method="workspace/willRenameFiles",X.messageDirection=LX.MessageDirection.clientToServer,X.type=new LX.ProtocolRequestType(X.method)})(Oz||(Nz.WillRenameFilesRequest=Oz={}));var wz;(function(X){X.method="workspace/didRenameFiles",X.messageDirection=LX.MessageDirection.clientToServer,X.type=new LX.ProtocolNotificationType(X.method)})(wz||(Nz.DidRenameFilesNotification=wz={}));var Kz;(function(X){X.method="workspace/didDeleteFiles",X.messageDirection=LX.MessageDirection.clientToServer,X.type=new LX.ProtocolNotificationType(X.method)})(Kz||(Nz.DidDeleteFilesNotification=Kz={}));var Mz;(function(X){X.method="workspace/willDeleteFiles",X.messageDirection=LX.MessageDirection.clientToServer,X.type=new LX.ProtocolRequestType(X.method)})(Mz||(Nz.WillDeleteFilesRequest=Mz={}))});var Cz=D((Iz)=>{Object.defineProperty(Iz,"__esModule",{value:!0});Iz.MonikerRequest=Iz.MonikerKind=Iz.UniquenessLevel=void 0;var Ez=D0(),Pz;(function(X){X.document="document",X.project="project",X.group="group",X.scheme="scheme",X.global="global"})(Pz||(Iz.UniquenessLevel=Pz={}));var jz;(function(X){X.$import="import",X.$export="export",X.local="local"})(jz||(Iz.MonikerKind=jz={}));var Dz;(function(X){X.method="textDocument/moniker",X.messageDirection=Ez.MessageDirection.clientToServer,X.type=new Ez.ProtocolRequestType(X.method)})(Dz||(Iz.MonikerRequest=Dz={}))});var kz=D((yz)=>{Object.defineProperty(yz,"__esModule",{value:!0});yz.TypeHierarchySubtypesRequest=yz.TypeHierarchySupertypesRequest=yz.TypeHierarchyPrepareRequest=void 0;var M9=D0(),Sz;(function(X){X.method="textDocument/prepareTypeHierarchy",X.messageDirection=M9.MessageDirection.clientToServer,X.type=new M9.ProtocolRequestType(X.method)})(Sz||(yz.TypeHierarchyPrepareRequest=Sz={}));var bz;(function(X){X.method="typeHierarchy/supertypes",X.messageDirection=M9.MessageDirection.clientToServer,X.type=new M9.ProtocolRequestType(X.method)})(bz||(yz.TypeHierarchySupertypesRequest=bz={}));var Rz;(function(X){X.method="typeHierarchy/subtypes",X.messageDirection=M9.MessageDirection.clientToServer,X.type=new M9.ProtocolRequestType(X.method)})(Rz||(yz.TypeHierarchySubtypesRequest=Rz={}))});var uz=D((hz)=>{Object.defineProperty(hz,"__esModule",{value:!0});hz.InlineValueRefreshRequest=hz.InlineValueRequest=void 0;var U4=D0(),xz;(function(X){X.method="textDocument/inlineValue",X.messageDirection=U4.MessageDirection.clientToServer,X.type=new U4.ProtocolRequestType(X.method)})(xz||(hz.InlineValueRequest=xz={}));var vz;(function(X){X.method="workspace/inlineValue/refresh",X.messageDirection=U4.MessageDirection.serverToClient,X.type=new U4.ProtocolRequestType0(X.method)})(vz||(hz.InlineValueRefreshRequest=vz={}))});var iz=D((lz)=>{Object.defineProperty(lz,"__esModule",{value:!0});lz.InlayHintRefreshRequest=lz.InlayHintResolveRequest=lz.InlayHintRequest=void 0;var N9=D0(),mz;(function(X){X.method="textDocument/inlayHint",X.messageDirection=N9.MessageDirection.clientToServer,X.type=new N9.ProtocolRequestType(X.method)})(mz||(lz.InlayHintRequest=mz={}));var pz;(function(X){X.method="inlayHint/resolve",X.messageDirection=N9.MessageDirection.clientToServer,X.type=new N9.ProtocolRequestType(X.method)})(pz||(lz.InlayHintResolveRequest=pz={}));var dz;(function(X){X.method="workspace/inlayHint/refresh",X.messageDirection=N9.MessageDirection.serverToClient,X.type=new N9.ProtocolRequestType0(X.method)})(dz||(lz.InlayHintRefreshRequest=dz={}))});var Z1=D((ez)=>{Object.defineProperty(ez,"__esModule",{value:!0});ez.DiagnosticRefreshRequest=ez.WorkspaceDiagnosticRequest=ez.DocumentDiagnosticRequest=ez.DocumentDiagnosticReportKind=ez.DiagnosticServerCancellationData=void 0;var tz=B6(),UK=J4(),T9=D0(),oz;(function(X){function Z(Q){let G=Q;return G&&UK.boolean(G.retriggerRequest)}X.is=Z})(oz||(ez.DiagnosticServerCancellationData=oz={}));var nz;(function(X){X.Full="full",X.Unchanged="unchanged"})(nz||(ez.DocumentDiagnosticReportKind=nz={}));var sz;(function(X){X.method="textDocument/diagnostic",X.messageDirection=T9.MessageDirection.clientToServer,X.type=new T9.ProtocolRequestType(X.method),X.partialResult=new tz.ProgressType})(sz||(ez.DocumentDiagnosticRequest=sz={}));var rz;(function(X){X.method="workspace/diagnostic",X.messageDirection=T9.MessageDirection.clientToServer,X.type=new T9.ProtocolRequestType(X.method),X.partialResult=new tz.ProgressType})(rz||(ez.WorkspaceDiagnosticRequest=rz={}));var az;(function(X){X.method="workspace/diagnostic/refresh",X.messageDirection=T9.MessageDirection.serverToClient,X.type=new T9.ProtocolRequestType0(X.method)})(az||(ez.DiagnosticRefreshRequest=az={}))});var W1=D((H1)=>{Object.defineProperty(H1,"__esModule",{value:!0});H1.DidCloseNotebookDocumentNotification=H1.DidSaveNotebookDocumentNotification=H1.DidChangeNotebookDocumentNotification=H1.NotebookCellArrayChange=H1.DidOpenNotebookDocumentNotification=H1.NotebookDocumentSyncRegistrationType=H1.NotebookDocument=H1.NotebookCell=H1.ExecutionSummary=H1.NotebookCellKind=void 0;var TZ=G4(),CX=J4(),gX=D0(),KG;(function(X){X.Markup=1,X.Code=2;function Z(Q){return Q===1||Q===2}X.is=Z})(KG||(H1.NotebookCellKind=KG={}));var MG;(function(X){function Z(J,Y){let $={executionOrder:J};if(Y===!0||Y===!1)$.success=Y;return $}X.create=Z;function Q(J){let Y=J;return CX.objectLiteral(Y)&&TZ.uinteger.is(Y.executionOrder)&&(Y.success===void 0||CX.boolean(Y.success))}X.is=Q;function G(J,Y){if(J===Y)return!0;if(J===null||J===void 0||Y===null||Y===void 0)return!1;return J.executionOrder===Y.executionOrder&&J.success===Y.success}X.equals=G})(MG||(H1.ExecutionSummary=MG={}));var W4;(function(X){function Z(Y,$){return{kind:Y,document:$}}X.create=Z;function Q(Y){let $=Y;return CX.objectLiteral($)&&KG.is($.kind)&&TZ.DocumentUri.is($.document)&&($.metadata===void 0||CX.objectLiteral($.metadata))}X.is=Q;function G(Y,$){let z=new Set;if(Y.document!==$.document)z.add("document");if(Y.kind!==$.kind)z.add("kind");if(Y.executionSummary!==$.executionSummary)z.add("executionSummary");if((Y.metadata!==void 0||$.metadata!==void 0)&&!J(Y.metadata,$.metadata))z.add("metadata");if((Y.executionSummary!==void 0||$.executionSummary!==void 0)&&!MG.equals(Y.executionSummary,$.executionSummary))z.add("executionSummary");return z}X.diff=G;function J(Y,$){if(Y===$)return!0;if(Y===null||Y===void 0||$===null||$===void 0)return!1;if(typeof Y!==typeof $)return!1;if(typeof Y!=="object")return!1;let z=Array.isArray(Y),H=Array.isArray($);if(z!==H)return!1;if(z&&H){if(Y.length!==$.length)return!1;for(let U=0;U<Y.length;U++)if(!J(Y[U],$[U]))return!1}if(CX.objectLiteral(Y)&&CX.objectLiteral($)){let U=Object.keys(Y),L=Object.keys($);if(U.length!==L.length)return!1;if(U.sort(),L.sort(),!J(U,L))return!1;for(let A=0;A<U.length;A++){let F=U[A];if(!J(Y[F],$[F]))return!1}}return!0}})(W4||(H1.NotebookCell=W4={}));var Q1;(function(X){function Z(G,J,Y,$){return{uri:G,notebookType:J,version:Y,cells:$}}X.create=Z;function Q(G){let J=G;return CX.objectLiteral(J)&&CX.string(J.uri)&&TZ.integer.is(J.version)&&CX.typedArray(J.cells,W4.is)}X.is=Q})(Q1||(H1.NotebookDocument=Q1={}));var q9;(function(X){X.method="notebookDocument/sync",X.messageDirection=gX.MessageDirection.clientToServer,X.type=new gX.RegistrationType(X.method)})(q9||(H1.NotebookDocumentSyncRegistrationType=q9={}));var G1;(function(X){X.method="notebookDocument/didOpen",X.messageDirection=gX.MessageDirection.clientToServer,X.type=new gX.ProtocolNotificationType(X.method),X.registrationMethod=q9.method})(G1||(H1.DidOpenNotebookDocumentNotification=G1={}));var J1;(function(X){function Z(G){let J=G;return CX.objectLiteral(J)&&TZ.uinteger.is(J.start)&&TZ.uinteger.is(J.deleteCount)&&(J.cells===void 0||CX.typedArray(J.cells,W4.is))}X.is=Z;function Q(G,J,Y){let $={start:G,deleteCount:J};if(Y!==void 0)$.cells=Y;return $}X.create=Q})(J1||(H1.NotebookCellArrayChange=J1={}));var Y1;(function(X){X.method="notebookDocument/didChange",X.messageDirection=gX.MessageDirection.clientToServer,X.type=new gX.ProtocolNotificationType(X.method),X.registrationMethod=q9.method})(Y1||(H1.DidChangeNotebookDocumentNotification=Y1={}));var $1;(function(X){X.method="notebookDocument/didSave",X.messageDirection=gX.MessageDirection.clientToServer,X.type=new gX.ProtocolNotificationType(X.method),X.registrationMethod=q9.method})($1||(H1.DidSaveNotebookDocumentNotification=$1={}));var z1;(function(X){X.method="notebookDocument/didClose",X.messageDirection=gX.MessageDirection.clientToServer,X.type=new gX.ProtocolNotificationType(X.method),X.registrationMethod=q9.method})(z1||(H1.DidCloseNotebookDocumentNotification=z1={}))});var F1=D((L1)=>{Object.defineProperty(L1,"__esModule",{value:!0});L1.InlineCompletionRequest=void 0;var V1=D0(),B1;(function(X){X.method="textDocument/inlineCompletion",X.messageDirection=V1.MessageDirection.clientToServer,X.type=new V1.ProtocolRequestType(X.method)})(B1||(L1.InlineCompletionRequest=B1={}))});var CH=D((c)=>{Object.defineProperty(c,"__esModule",{value:!0});c.WorkspaceSymbolRequest=c.CodeActionResolveRequest=c.CodeActionRequest=c.DocumentSymbolRequest=c.DocumentHighlightRequest=c.ReferencesRequest=c.DefinitionRequest=c.SignatureHelpRequest=c.SignatureHelpTriggerKind=c.HoverRequest=c.CompletionResolveRequest=c.CompletionRequest=c.CompletionTriggerKind=c.PublishDiagnosticsNotification=c.WatchKind=c.RelativePattern=c.FileChangeType=c.DidChangeWatchedFilesNotification=c.WillSaveTextDocumentWaitUntilRequest=c.WillSaveTextDocumentNotification=c.TextDocumentSaveReason=c.DidSaveTextDocumentNotification=c.DidCloseTextDocumentNotification=c.DidChangeTextDocumentNotification=c.TextDocumentContentChangeEvent=c.DidOpenTextDocumentNotification=c.TextDocumentSyncKind=c.TelemetryEventNotification=c.LogMessageNotification=c.ShowMessageRequest=c.ShowMessageNotification=c.MessageType=c.DidChangeConfigurationNotification=c.ExitNotification=c.ShutdownRequest=c.InitializedNotification=c.InitializeErrorCodes=c.InitializeRequest=c.WorkDoneProgressOptions=c.TextDocumentRegistrationOptions=c.StaticRegistrationOptions=c.PositionEncodingKind=c.FailureHandlingKind=c.ResourceOperationKind=c.UnregistrationRequest=c.RegistrationRequest=c.DocumentSelector=c.NotebookCellTextDocumentFilter=c.NotebookDocumentFilter=c.TextDocumentFilter=void 0;c.MonikerRequest=c.MonikerKind=c.UniquenessLevel=c.WillDeleteFilesRequest=c.DidDeleteFilesNotification=c.WillRenameFilesRequest=c.DidRenameFilesNotification=c.WillCreateFilesRequest=c.DidCreateFilesNotification=c.FileOperationPatternKind=c.LinkedEditingRangeRequest=c.ShowDocumentRequest=c.SemanticTokensRegistrationType=c.SemanticTokensRefreshRequest=c.SemanticTokensRangeRequest=c.SemanticTokensDeltaRequest=c.SemanticTokensRequest=c.TokenFormat=c.CallHierarchyPrepareRequest=c.CallHierarchyOutgoingCallsRequest=c.CallHierarchyIncomingCallsRequest=c.WorkDoneProgressCancelNotification=c.WorkDoneProgressCreateRequest=c.WorkDoneProgress=c.SelectionRangeRequest=c.DeclarationRequest=c.FoldingRangeRefreshRequest=c.FoldingRangeRequest=c.ColorPresentationRequest=c.DocumentColorRequest=c.ConfigurationRequest=c.DidChangeWorkspaceFoldersNotification=c.WorkspaceFoldersRequest=c.TypeDefinitionRequest=c.ImplementationRequest=c.ApplyWorkspaceEditRequest=c.ExecuteCommandRequest=c.PrepareRenameRequest=c.RenameRequest=c.PrepareSupportDefaultBehavior=c.DocumentOnTypeFormattingRequest=c.DocumentRangesFormattingRequest=c.DocumentRangeFormattingRequest=c.DocumentFormattingRequest=c.DocumentLinkResolveRequest=c.DocumentLinkRequest=c.CodeLensRefreshRequest=c.CodeLensResolveRequest=c.CodeLensRequest=c.WorkspaceSymbolResolveRequest=void 0;c.InlineCompletionRequest=c.DidCloseNotebookDocumentNotification=c.DidSaveNotebookDocumentNotification=c.DidChangeNotebookDocumentNotification=c.NotebookCellArrayChange=c.DidOpenNotebookDocumentNotification=c.NotebookDocumentSyncRegistrationType=c.NotebookDocument=c.NotebookCell=c.ExecutionSummary=c.NotebookCellKind=c.DiagnosticRefreshRequest=c.WorkspaceDiagnosticRequest=c.DocumentDiagnosticRequest=c.DocumentDiagnosticReportKind=c.DiagnosticServerCancellationData=c.InlayHintRefreshRequest=c.InlayHintResolveRequest=c.InlayHintRequest=c.InlineValueRefreshRequest=c.InlineValueRequest=c.TypeHierarchySupertypesRequest=c.TypeHierarchySubtypesRequest=c.TypeHierarchyPrepareRequest=void 0;var k=D0(),O1=G4(),u0=J4(),EK=Z5();Object.defineProperty(c,"ImplementationRequest",{enumerable:!0,get:function(){return EK.ImplementationRequest}});var PK=$5();Object.defineProperty(c,"TypeDefinitionRequest",{enumerable:!0,get:function(){return PK.TypeDefinitionRequest}});var PH=V5();Object.defineProperty(c,"WorkspaceFoldersRequest",{enumerable:!0,get:function(){return PH.WorkspaceFoldersRequest}});Object.defineProperty(c,"DidChangeWorkspaceFoldersNotification",{enumerable:!0,get:function(){return PH.DidChangeWorkspaceFoldersNotification}});var jK=O5();Object.defineProperty(c,"ConfigurationRequest",{enumerable:!0,get:function(){return jK.ConfigurationRequest}});var jH=T5();Object.defineProperty(c,"DocumentColorRequest",{enumerable:!0,get:function(){return jH.DocumentColorRequest}});Object.defineProperty(c,"ColorPresentationRequest",{enumerable:!0,get:function(){return jH.ColorPresentationRequest}});var DH=D5();Object.defineProperty(c,"FoldingRangeRequest",{enumerable:!0,get:function(){return DH.FoldingRangeRequest}});Object.defineProperty(c,"FoldingRangeRefreshRequest",{enumerable:!0,get:function(){return DH.FoldingRangeRefreshRequest}});var DK=b5();Object.defineProperty(c,"DeclarationRequest",{enumerable:!0,get:function(){return DK.DeclarationRequest}});var IK=x5();Object.defineProperty(c,"SelectionRangeRequest",{enumerable:!0,get:function(){return IK.SelectionRangeRequest}});var PG=p5();Object.defineProperty(c,"WorkDoneProgress",{enumerable:!0,get:function(){return PG.WorkDoneProgress}});Object.defineProperty(c,"WorkDoneProgressCreateRequest",{enumerable:!0,get:function(){return PG.WorkDoneProgressCreateRequest}});Object.defineProperty(c,"WorkDoneProgressCancelNotification",{enumerable:!0,get:function(){return PG.WorkDoneProgressCancelNotification}});var jG=n5();Object.defineProperty(c,"CallHierarchyIncomingCallsRequest",{enumerable:!0,get:function(){return jG.CallHierarchyIncomingCallsRequest}});Object.defineProperty(c,"CallHierarchyOutgoingCallsRequest",{enumerable:!0,get:function(){return jG.CallHierarchyOutgoingCallsRequest}});Object.defineProperty(c,"CallHierarchyPrepareRequest",{enumerable:!0,get:function(){return jG.CallHierarchyPrepareRequest}});var E9=Qz();Object.defineProperty(c,"TokenFormat",{enumerable:!0,get:function(){return E9.TokenFormat}});Object.defineProperty(c,"SemanticTokensRequest",{enumerable:!0,get:function(){return E9.SemanticTokensRequest}});Object.defineProperty(c,"SemanticTokensDeltaRequest",{enumerable:!0,get:function(){return E9.SemanticTokensDeltaRequest}});Object.defineProperty(c,"SemanticTokensRangeRequest",{enumerable:!0,get:function(){return E9.SemanticTokensRangeRequest}});Object.defineProperty(c,"SemanticTokensRefreshRequest",{enumerable:!0,get:function(){return E9.SemanticTokensRefreshRequest}});Object.defineProperty(c,"SemanticTokensRegistrationType",{enumerable:!0,get:function(){return E9.SemanticTokensRegistrationType}});var _K=zz();Object.defineProperty(c,"ShowDocumentRequest",{enumerable:!0,get:function(){return _K.ShowDocumentRequest}});var CK=Bz();Object.defineProperty(c,"LinkedEditingRangeRequest",{enumerable:!0,get:function(){return CK.LinkedEditingRangeRequest}});var g6=qz();Object.defineProperty(c,"FileOperationPatternKind",{enumerable:!0,get:function(){return g6.FileOperationPatternKind}});Object.defineProperty(c,"DidCreateFilesNotification",{enumerable:!0,get:function(){return g6.DidCreateFilesNotification}});Object.defineProperty(c,"WillCreateFilesRequest",{enumerable:!0,get:function(){return g6.WillCreateFilesRequest}});Object.defineProperty(c,"DidRenameFilesNotification",{enumerable:!0,get:function(){return g6.DidRenameFilesNotification}});Object.defineProperty(c,"WillRenameFilesRequest",{enumerable:!0,get:function(){return g6.WillRenameFilesRequest}});Object.defineProperty(c,"DidDeleteFilesNotification",{enumerable:!0,get:function(){return g6.DidDeleteFilesNotification}});Object.defineProperty(c,"WillDeleteFilesRequest",{enumerable:!0,get:function(){return g6.WillDeleteFilesRequest}});var DG=Cz();Object.defineProperty(c,"UniquenessLevel",{enumerable:!0,get:function(){return DG.UniquenessLevel}});Object.defineProperty(c,"MonikerKind",{enumerable:!0,get:function(){return DG.MonikerKind}});Object.defineProperty(c,"MonikerRequest",{enumerable:!0,get:function(){return DG.MonikerRequest}});var IG=kz();Object.defineProperty(c,"TypeHierarchyPrepareRequest",{enumerable:!0,get:function(){return IG.TypeHierarchyPrepareRequest}});Object.defineProperty(c,"TypeHierarchySubtypesRequest",{enumerable:!0,get:function(){return IG.TypeHierarchySubtypesRequest}});Object.defineProperty(c,"TypeHierarchySupertypesRequest",{enumerable:!0,get:function(){return IG.TypeHierarchySupertypesRequest}});var IH=uz();Object.defineProperty(c,"InlineValueRequest",{enumerable:!0,get:function(){return IH.InlineValueRequest}});Object.defineProperty(c,"InlineValueRefreshRequest",{enumerable:!0,get:function(){return IH.InlineValueRefreshRequest}});var _G=iz();Object.defineProperty(c,"InlayHintRequest",{enumerable:!0,get:function(){return _G.InlayHintRequest}});Object.defineProperty(c,"InlayHintResolveRequest",{enumerable:!0,get:function(){return _G.InlayHintResolveRequest}});Object.defineProperty(c,"InlayHintRefreshRequest",{enumerable:!0,get:function(){return _G.InlayHintRefreshRequest}});var qZ=Z1();Object.defineProperty(c,"DiagnosticServerCancellationData",{enumerable:!0,get:function(){return qZ.DiagnosticServerCancellationData}});Object.defineProperty(c,"DocumentDiagnosticReportKind",{enumerable:!0,get:function(){return qZ.DocumentDiagnosticReportKind}});Object.defineProperty(c,"DocumentDiagnosticRequest",{enumerable:!0,get:function(){return qZ.DocumentDiagnosticRequest}});Object.defineProperty(c,"WorkspaceDiagnosticRequest",{enumerable:!0,get:function(){return qZ.WorkspaceDiagnosticRequest}});Object.defineProperty(c,"DiagnosticRefreshRequest",{enumerable:!0,get:function(){return qZ.DiagnosticRefreshRequest}});var uX=W1();Object.defineProperty(c,"NotebookCellKind",{enumerable:!0,get:function(){return uX.NotebookCellKind}});Object.defineProperty(c,"ExecutionSummary",{enumerable:!0,get:function(){return uX.ExecutionSummary}});Object.defineProperty(c,"NotebookCell",{enumerable:!0,get:function(){return uX.NotebookCell}});Object.defineProperty(c,"NotebookDocument",{enumerable:!0,get:function(){return uX.NotebookDocument}});Object.defineProperty(c,"NotebookDocumentSyncRegistrationType",{enumerable:!0,get:function(){return uX.NotebookDocumentSyncRegistrationType}});Object.defineProperty(c,"DidOpenNotebookDocumentNotification",{enumerable:!0,get:function(){return uX.DidOpenNotebookDocumentNotification}});Object.defineProperty(c,"NotebookCellArrayChange",{enumerable:!0,get:function(){return uX.NotebookCellArrayChange}});Object.defineProperty(c,"DidChangeNotebookDocumentNotification",{enumerable:!0,get:function(){return uX.DidChangeNotebookDocumentNotification}});Object.defineProperty(c,"DidSaveNotebookDocumentNotification",{enumerable:!0,get:function(){return uX.DidSaveNotebookDocumentNotification}});Object.defineProperty(c,"DidCloseNotebookDocumentNotification",{enumerable:!0,get:function(){return uX.DidCloseNotebookDocumentNotification}});var SK=F1();Object.defineProperty(c,"InlineCompletionRequest",{enumerable:!0,get:function(){return SK.InlineCompletionRequest}});var NG;(function(X){function Z(Q){let G=Q;return u0.string(G)||(u0.string(G.language)||u0.string(G.scheme)||u0.string(G.pattern))}X.is=Z})(NG||(c.TextDocumentFilter=NG={}));var TG;(function(X){function Z(Q){let G=Q;return u0.objectLiteral(G)&&(u0.string(G.notebookType)||u0.string(G.scheme)||u0.string(G.pattern))}X.is=Z})(TG||(c.NotebookDocumentFilter=TG={}));var qG;(function(X){function Z(Q){let G=Q;return u0.objectLiteral(G)&&(u0.string(G.notebook)||TG.is(G.notebook))&&(G.language===void 0||u0.string(G.language))}X.is=Z})(qG||(c.NotebookCellTextDocumentFilter=qG={}));var EG;(function(X){function Z(Q){if(!Array.isArray(Q))return!1;for(let G of Q)if(!u0.string(G)&&!NG.is(G)&&!qG.is(G))return!1;return!0}X.is=Z})(EG||(c.DocumentSelector=EG={}));var w1;(function(X){X.method="client/registerCapability",X.messageDirection=k.MessageDirection.serverToClient,X.type=new k.ProtocolRequestType(X.method)})(w1||(c.RegistrationRequest=w1={}));var K1;(function(X){X.method="client/unregisterCapability",X.messageDirection=k.MessageDirection.serverToClient,X.type=new k.ProtocolRequestType(X.method)})(K1||(c.UnregistrationRequest=K1={}));var M1;(function(X){X.Create="create",X.Rename="rename",X.Delete="delete"})(M1||(c.ResourceOperationKind=M1={}));var N1;(function(X){X.Abort="abort",X.Transactional="transactional",X.TextOnlyTransactional="textOnlyTransactional",X.Undo="undo"})(N1||(c.FailureHandlingKind=N1={}));var T1;(function(X){X.UTF8="utf-8",X.UTF16="utf-16",X.UTF32="utf-32"})(T1||(c.PositionEncodingKind=T1={}));var q1;(function(X){function Z(Q){let G=Q;return G&&u0.string(G.id)&&G.id.length>0}X.hasId=Z})(q1||(c.StaticRegistrationOptions=q1={}));var E1;(function(X){function Z(Q){let G=Q;return G&&(G.documentSelector===null||EG.is(G.documentSelector))}X.is=Z})(E1||(c.TextDocumentRegistrationOptions=E1={}));var P1;(function(X){function Z(G){let J=G;return u0.objectLiteral(J)&&(J.workDoneProgress===void 0||u0.boolean(J.workDoneProgress))}X.is=Z;function Q(G){let J=G;return J&&u0.boolean(J.workDoneProgress)}X.hasWorkDoneProgress=Q})(P1||(c.WorkDoneProgressOptions=P1={}));var j1;(function(X){X.method="initialize",X.messageDirection=k.MessageDirection.clientToServer,X.type=new k.ProtocolRequestType(X.method)})(j1||(c.InitializeRequest=j1={}));var D1;(function(X){X.unknownProtocolVersion=1})(D1||(c.InitializeErrorCodes=D1={}));var I1;(function(X){X.method="initialized",X.messageDirection=k.MessageDirection.clientToServer,X.type=new k.ProtocolNotificationType(X.method)})(I1||(c.InitializedNotification=I1={}));var _1;(function(X){X.method="shutdown",X.messageDirection=k.MessageDirection.clientToServer,X.type=new k.ProtocolRequestType0(X.method)})(_1||(c.ShutdownRequest=_1={}));var C1;(function(X){X.method="exit",X.messageDirection=k.MessageDirection.clientToServer,X.type=new k.ProtocolNotificationType0(X.method)})(C1||(c.ExitNotification=C1={}));var S1;(function(X){X.method="workspace/didChangeConfiguration",X.messageDirection=k.MessageDirection.clientToServer,X.type=new k.ProtocolNotificationType(X.method)})(S1||(c.DidChangeConfigurationNotification=S1={}));var b1;(function(X){X.Error=1,X.Warning=2,X.Info=3,X.Log=4,X.Debug=5})(b1||(c.MessageType=b1={}));var R1;(function(X){X.method="window/showMessage",X.messageDirection=k.MessageDirection.serverToClient,X.type=new k.ProtocolNotificationType(X.method)})(R1||(c.ShowMessageNotification=R1={}));var y1;(function(X){X.method="window/showMessageRequest",X.messageDirection=k.MessageDirection.serverToClient,X.type=new k.ProtocolRequestType(X.method)})(y1||(c.ShowMessageRequest=y1={}));var f1;(function(X){X.method="window/logMessage",X.messageDirection=k.MessageDirection.serverToClient,X.type=new k.ProtocolNotificationType(X.method)})(f1||(c.LogMessageNotification=f1={}));var k1;(function(X){X.method="telemetry/event",X.messageDirection=k.MessageDirection.serverToClient,X.type=new k.ProtocolNotificationType(X.method)})(k1||(c.TelemetryEventNotification=k1={}));var x1;(function(X){X.None=0,X.Full=1,X.Incremental=2})(x1||(c.TextDocumentSyncKind=x1={}));var v1;(function(X){X.method="textDocument/didOpen",X.messageDirection=k.MessageDirection.clientToServer,X.type=new k.ProtocolNotificationType(X.method)})(v1||(c.DidOpenTextDocumentNotification=v1={}));var h1;(function(X){function Z(G){let J=G;return J!==void 0&&J!==null&&typeof J.text==="string"&&J.range!==void 0&&(J.rangeLength===void 0||typeof J.rangeLength==="number")}X.isIncremental=Z;function Q(G){let J=G;return J!==void 0&&J!==null&&typeof J.text==="string"&&J.range===void 0&&J.rangeLength===void 0}X.isFull=Q})(h1||(c.TextDocumentContentChangeEvent=h1={}));var g1;(function(X){X.method="textDocument/didChange",X.messageDirection=k.MessageDirection.clientToServer,X.type=new k.ProtocolNotificationType(X.method)})(g1||(c.DidChangeTextDocumentNotification=g1={}));var u1;(function(X){X.method="textDocument/didClose",X.messageDirection=k.MessageDirection.clientToServer,X.type=new k.ProtocolNotificationType(X.method)})(u1||(c.DidCloseTextDocumentNotification=u1={}));var m1;(function(X){X.method="textDocument/didSave",X.messageDirection=k.MessageDirection.clientToServer,X.type=new k.ProtocolNotificationType(X.method)})(m1||(c.DidSaveTextDocumentNotification=m1={}));var p1;(function(X){X.Manual=1,X.AfterDelay=2,X.FocusOut=3})(p1||(c.TextDocumentSaveReason=p1={}));var d1;(function(X){X.method="textDocument/willSave",X.messageDirection=k.MessageDirection.clientToServer,X.type=new k.ProtocolNotificationType(X.method)})(d1||(c.WillSaveTextDocumentNotification=d1={}));var l1;(function(X){X.method="textDocument/willSaveWaitUntil",X.messageDirection=k.MessageDirection.clientToServer,X.type=new k.ProtocolRequestType(X.method)})(l1||(c.WillSaveTextDocumentWaitUntilRequest=l1={}));var c1;(function(X){X.method="workspace/didChangeWatchedFiles",X.messageDirection=k.MessageDirection.clientToServer,X.type=new k.ProtocolNotificationType(X.method)})(c1||(c.DidChangeWatchedFilesNotification=c1={}));var i1;(function(X){X.Created=1,X.Changed=2,X.Deleted=3})(i1||(c.FileChangeType=i1={}));var o1;(function(X){function Z(Q){let G=Q;return u0.objectLiteral(G)&&(O1.URI.is(G.baseUri)||O1.WorkspaceFolder.is(G.baseUri))&&u0.string(G.pattern)}X.is=Z})(o1||(c.RelativePattern=o1={}));var n1;(function(X){X.Create=1,X.Change=2,X.Delete=4})(n1||(c.WatchKind=n1={}));var s1;(function(X){X.method="textDocument/publishDiagnostics",X.messageDirection=k.MessageDirection.serverToClient,X.type=new k.ProtocolNotificationType(X.method)})(s1||(c.PublishDiagnosticsNotification=s1={}));var r1;(function(X){X.Invoked=1,X.TriggerCharacter=2,X.TriggerForIncompleteCompletions=3})(r1||(c.CompletionTriggerKind=r1={}));var a1;(function(X){X.method="textDocument/completion",X.messageDirection=k.MessageDirection.clientToServer,X.type=new k.ProtocolRequestType(X.method)})(a1||(c.CompletionRequest=a1={}));var t1;(function(X){X.method="completionItem/resolve",X.messageDirection=k.MessageDirection.clientToServer,X.type=new k.ProtocolRequestType(X.method)})(t1||(c.CompletionResolveRequest=t1={}));var e1;(function(X){X.method="textDocument/hover",X.messageDirection=k.MessageDirection.clientToServer,X.type=new k.ProtocolRequestType(X.method)})(e1||(c.HoverRequest=e1={}));var XH;(function(X){X.Invoked=1,X.TriggerCharacter=2,X.ContentChange=3})(XH||(c.SignatureHelpTriggerKind=XH={}));var ZH;(function(X){X.method="textDocument/signatureHelp",X.messageDirection=k.MessageDirection.clientToServer,X.type=new k.ProtocolRequestType(X.method)})(ZH||(c.SignatureHelpRequest=ZH={}));var QH;(function(X){X.method="textDocument/definition",X.messageDirection=k.MessageDirection.clientToServer,X.type=new k.ProtocolRequestType(X.method)})(QH||(c.DefinitionRequest=QH={}));var GH;(function(X){X.method="textDocument/references",X.messageDirection=k.MessageDirection.clientToServer,X.type=new k.ProtocolRequestType(X.method)})(GH||(c.ReferencesRequest=GH={}));var JH;(function(X){X.method="textDocument/documentHighlight",X.messageDirection=k.MessageDirection.clientToServer,X.type=new k.ProtocolRequestType(X.method)})(JH||(c.DocumentHighlightRequest=JH={}));var YH;(function(X){X.method="textDocument/documentSymbol",X.messageDirection=k.MessageDirection.clientToServer,X.type=new k.ProtocolRequestType(X.method)})(YH||(c.DocumentSymbolRequest=YH={}));var $H;(function(X){X.method="textDocument/codeAction",X.messageDirection=k.MessageDirection.clientToServer,X.type=new k.ProtocolRequestType(X.method)})($H||(c.CodeActionRequest=$H={}));var zH;(function(X){X.method="codeAction/resolve",X.messageDirection=k.MessageDirection.clientToServer,X.type=new k.ProtocolRequestType(X.method)})(zH||(c.CodeActionResolveRequest=zH={}));var HH;(function(X){X.method="workspace/symbol",X.messageDirection=k.MessageDirection.clientToServer,X.type=new k.ProtocolRequestType(X.method)})(HH||(c.WorkspaceSymbolRequest=HH={}));var UH;(function(X){X.method="workspaceSymbol/resolve",X.messageDirection=k.MessageDirection.clientToServer,X.type=new k.ProtocolRequestType(X.method)})(UH||(c.WorkspaceSymbolResolveRequest=UH={}));var WH;(function(X){X.method="textDocument/codeLens",X.messageDirection=k.MessageDirection.clientToServer,X.type=new k.ProtocolRequestType(X.method)})(WH||(c.CodeLensRequest=WH={}));var VH;(function(X){X.method="codeLens/resolve",X.messageDirection=k.MessageDirection.clientToServer,X.type=new k.ProtocolRequestType(X.method)})(VH||(c.CodeLensResolveRequest=VH={}));var BH;(function(X){X.method="workspace/codeLens/refresh",X.messageDirection=k.MessageDirection.serverToClient,X.type=new k.ProtocolRequestType0(X.method)})(BH||(c.CodeLensRefreshRequest=BH={}));var LH;(function(X){X.method="textDocument/documentLink",X.messageDirection=k.MessageDirection.clientToServer,X.type=new k.ProtocolRequestType(X.method)})(LH||(c.DocumentLinkRequest=LH={}));var AH;(function(X){X.method="documentLink/resolve",X.messageDirection=k.MessageDirection.clientToServer,X.type=new k.ProtocolRequestType(X.method)})(AH||(c.DocumentLinkResolveRequest=AH={}));var FH;(function(X){X.method="textDocument/formatting",X.messageDirection=k.MessageDirection.clientToServer,X.type=new k.ProtocolRequestType(X.method)})(FH||(c.DocumentFormattingRequest=FH={}));var OH;(function(X){X.method="textDocument/rangeFormatting",X.messageDirection=k.MessageDirection.clientToServer,X.type=new k.ProtocolRequestType(X.method)})(OH||(c.DocumentRangeFormattingRequest=OH={}));var wH;(function(X){X.method="textDocument/rangesFormatting",X.messageDirection=k.MessageDirection.clientToServer,X.type=new k.ProtocolRequestType(X.method)})(wH||(c.DocumentRangesFormattingRequest=wH={}));var KH;(function(X){X.method="textDocument/onTypeFormatting",X.messageDirection=k.MessageDirection.clientToServer,X.type=new k.ProtocolRequestType(X.method)})(KH||(c.DocumentOnTypeFormattingRequest=KH={}));var MH;(function(X){X.Identifier=1})(MH||(c.PrepareSupportDefaultBehavior=MH={}));var NH;(function(X){X.method="textDocument/rename",X.messageDirection=k.MessageDirection.clientToServer,X.type=new k.ProtocolRequestType(X.method)})(NH||(c.RenameRequest=NH={}));var TH;(function(X){X.method="textDocument/prepareRename",X.messageDirection=k.MessageDirection.clientToServer,X.type=new k.ProtocolRequestType(X.method)})(TH||(c.PrepareRenameRequest=TH={}));var qH;(function(X){X.method="workspace/executeCommand",X.messageDirection=k.MessageDirection.clientToServer,X.type=new k.ProtocolRequestType(X.method)})(qH||(c.ExecuteCommandRequest=qH={}));var EH;(function(X){X.method="workspace/applyEdit",X.messageDirection=k.MessageDirection.serverToClient,X.type=new k.ProtocolRequestType("workspace/applyEdit")})(EH||(c.ApplyWorkspaceEditRequest=EH={}))});var yH=D((bH)=>{Object.defineProperty(bH,"__esModule",{value:!0});bH.createProtocolConnection=void 0;var SH=B6();function dM(X,Z,Q,G){if(SH.ConnectionStrategy.is(G))G={connectionStrategy:G};return(0,SH.createMessageConnection)(X,Z,Q,G)}bH.createProtocolConnection=dM});var kH=D((t0)=>{var lM=t0&&t0.__createBinding||(Object.create?function(X,Z,Q,G){if(G===void 0)G=Q;var J=Object.getOwnPropertyDescriptor(Z,Q);if(!J||("get"in J?!Z.__esModule:J.writable||J.configurable))J={enumerable:!0,get:function(){return Z[Q]}};Object.defineProperty(X,G,J)}:function(X,Z,Q,G){if(G===void 0)G=Q;X[G]=Z[Q]}),V4=t0&&t0.__exportStar||function(X,Z){for(var Q in X)if(Q!=="default"&&!Object.prototype.hasOwnProperty.call(Z,Q))lM(Z,X,Q)};Object.defineProperty(t0,"__esModule",{value:!0});t0.LSPErrorCodes=t0.createProtocolConnection=void 0;V4(B6(),t0);V4(G4(),t0);V4(D0(),t0);V4(CH(),t0);var cM=yH();Object.defineProperty(t0,"createProtocolConnection",{enumerable:!0,get:function(){return cM.createProtocolConnection}});var fH;(function(X){X.lspReservedErrorRangeStart=-32899,X.RequestFailed=-32803,X.ServerCancelled=-32802,X.ContentModified=-32801,X.RequestCancelled=-32800,X.lspReservedErrorRangeEnd=-32800})(fH||(t0.LSPErrorCodes=fH={}))});var R0=D((mX)=>{var iM=mX&&mX.__createBinding||(Object.create?function(X,Z,Q,G){if(G===void 0)G=Q;var J=Object.getOwnPropertyDescriptor(Z,Q);if(!J||("get"in J?!Z.__esModule:J.writable||J.configurable))J={enumerable:!0,get:function(){return Z[Q]}};Object.defineProperty(X,G,J)}:function(X,Z,Q,G){if(G===void 0)G=Q;X[G]=Z[Q]}),xH=mX&&mX.__exportStar||function(X,Z){for(var Q in X)if(Q!=="default"&&!Object.prototype.hasOwnProperty.call(Z,Q))iM(Z,X,Q)};Object.defineProperty(mX,"__esModule",{value:!0});mX.createProtocolConnection=void 0;var oM=B6();xH(B6(),mX);xH(kH(),mX);function nM(X,Z,Q,G){return(0,oM.createMessageConnection)(X,Z,Q,G)}mX.createProtocolConnection=nM});var CG=D((gH)=>{Object.defineProperty(gH,"__esModule",{value:!0});gH.generateUuid=gH.parse=gH.isUUID=gH.v4=gH.empty=void 0;class B4{constructor(X){this._value=X}asHex(){return this._value}equals(X){return this.asHex()===X.asHex()}}class Z0 extends B4{static _oneOf(X){return X[Math.floor(X.length*Math.random())]}static _randomHex(){return Z0._oneOf(Z0._chars)}constructor(){super([Z0._randomHex(),Z0._randomHex(),Z0._randomHex(),Z0._randomHex(),Z0._randomHex(),Z0._randomHex(),Z0._randomHex(),Z0._randomHex(),"-",Z0._randomHex(),Z0._randomHex(),Z0._randomHex(),Z0._randomHex(),"-","4",Z0._randomHex(),Z0._randomHex(),Z0._randomHex(),"-",Z0._oneOf(Z0._timeHighBits),Z0._randomHex(),Z0._randomHex(),Z0._randomHex(),"-",Z0._randomHex(),Z0._randomHex(),Z0._randomHex(),Z0._randomHex(),Z0._randomHex(),Z0._randomHex(),Z0._randomHex(),Z0._randomHex(),Z0._randomHex(),Z0._randomHex(),Z0._randomHex(),Z0._randomHex()].join(""))}}Z0._chars=["0","1","2","3","4","5","6","6","7","8","9","a","b","c","d","e","f"];Z0._timeHighBits=["8","9","a","b"];gH.empty=new B4("00000000-0000-0000-0000-000000000000");function vH(){return new Z0}gH.v4=vH;var sM=/^[0-9a-f]{8}-[0-9a-f]{4}-[0-9a-f]{4}-[0-9a-f]{4}-[0-9a-f]{12}$/i;function hH(X){return sM.test(X)}gH.isUUID=hH;function rM(X){if(!hH(X))throw Error("invalid uuid");return new B4(X)}gH.parse=rM;function aM(){return vH().asHex()}gH.generateUuid=aM});var lH=D((pH)=>{Object.defineProperty(pH,"__esModule",{value:!0});pH.attachPartialResult=pH.ProgressFeature=pH.attachWorkDone=void 0;var L6=R0(),QN=CG();class A6{constructor(X,Z){this._connection=X,this._token=Z,A6.Instances.set(this._token,this)}begin(X,Z,Q,G){let J={kind:"begin",title:X,percentage:Z,message:Q,cancellable:G};this._connection.sendProgress(L6.WorkDoneProgress.type,this._token,J)}report(X,Z){let Q={kind:"report"};if(typeof X==="number"){if(Q.percentage=X,Z!==void 0)Q.message=Z}else Q.message=X;this._connection.sendProgress(L6.WorkDoneProgress.type,this._token,Q)}done(){A6.Instances.delete(this._token),this._connection.sendProgress(L6.WorkDoneProgress.type,this._token,{kind:"end"})}}A6.Instances=new Map;class SG extends A6{constructor(X,Z){super(X,Z);this._source=new L6.CancellationTokenSource}get token(){return this._source.token}done(){this._source.dispose(),super.done()}cancel(){this._source.cancel()}}class L4{constructor(){}begin(){}report(){}done(){}}class bG extends L4{constructor(){super();this._source=new L6.CancellationTokenSource}get token(){return this._source.token}done(){this._source.dispose()}cancel(){this._source.cancel()}}function GN(X,Z){if(Z===void 0||Z.workDoneToken===void 0)return new L4;let Q=Z.workDoneToken;return delete Z.workDoneToken,new A6(X,Q)}pH.attachWorkDone=GN;var JN=(X)=>{return class extends X{constructor(){super();this._progressSupported=!1}initialize(Z){if(super.initialize(Z),Z?.window?.workDoneProgress===!0)this._progressSupported=!0,this.connection.onNotification(L6.WorkDoneProgressCancelNotification.type,(Q)=>{let G=A6.Instances.get(Q.token);if(G instanceof SG||G instanceof bG)G.cancel()})}attachWorkDoneProgress(Z){if(Z===void 0)return new L4;else return new A6(this.connection,Z)}createWorkDoneProgress(){if(this._progressSupported){let Z=(0,QN.generateUuid)();return this.connection.sendRequest(L6.WorkDoneProgressCreateRequest.type,{token:Z}).then(()=>{return new SG(this.connection,Z)})}else return Promise.resolve(new bG)}}};pH.ProgressFeature=JN;var RG;(function(X){X.type=new L6.ProgressType})(RG||(RG={}));class mH{constructor(X,Z){this._connection=X,this._token=Z}report(X){this._connection.sendProgress(RG.type,this._token,X)}}function YN(X,Z){if(Z===void 0||Z.partialResultToken===void 0)return;let Q=Z.partialResultToken;return delete Z.partialResultToken,new mH(X,Q)}pH.attachPartialResult=YN});var oH=D((cH)=>{Object.defineProperty(cH,"__esModule",{value:!0});cH.ConfigurationFeature=void 0;var HN=R0(),UN=d8(),WN=(X)=>{return class extends X{getConfiguration(Z){if(!Z)return this._getConfiguration({});else if(UN.string(Z))return this._getConfiguration({section:Z});else return this._getConfiguration(Z)}_getConfiguration(Z){let Q={items:Array.isArray(Z)?Z:[Z]};return this.connection.sendRequest(HN.ConfigurationRequest.type,Q).then((G)=>{if(Array.isArray(G))return Array.isArray(Z)?G:G[0];else return Array.isArray(Z)?[]:null})}}};cH.ConfigurationFeature=WN});var rH=D((nH)=>{Object.defineProperty(nH,"__esModule",{value:!0});nH.WorkspaceFoldersFeature=void 0;var A4=R0(),VN=(X)=>{return class extends X{constructor(){super();this._notificationIsAutoRegistered=!1}initialize(Z){super.initialize(Z);let Q=Z.workspace;if(Q&&Q.workspaceFolders)this._onDidChangeWorkspaceFolders=new A4.Emitter,this.connection.onNotification(A4.DidChangeWorkspaceFoldersNotification.type,(G)=>{this._onDidChangeWorkspaceFolders.fire(G.event)})}fillServerCapabilities(Z){super.fillServerCapabilities(Z);let Q=Z.workspace?.workspaceFolders?.changeNotifications;this._notificationIsAutoRegistered=Q===!0||typeof Q==="string"}getWorkspaceFolders(){return this.connection.sendRequest(A4.WorkspaceFoldersRequest.type)}get onDidChangeWorkspaceFolders(){if(!this._onDidChangeWorkspaceFolders)throw Error("Client doesn't support sending workspace folder change events.");if(!this._notificationIsAutoRegistered&&!this._unregistration)this._unregistration=this.connection.client.register(A4.DidChangeWorkspaceFoldersNotification.type);return this._onDidChangeWorkspaceFolders.event}}};nH.WorkspaceFoldersFeature=VN});var eH=D((aH)=>{Object.defineProperty(aH,"__esModule",{value:!0});aH.CallHierarchyFeature=void 0;var yG=R0(),BN=(X)=>{return class extends X{get callHierarchy(){return{onPrepare:(Z)=>{return this.connection.onRequest(yG.CallHierarchyPrepareRequest.type,(Q,G)=>{return Z(Q,G,this.attachWorkDoneProgress(Q),void 0)})},onIncomingCalls:(Z)=>{let Q=yG.CallHierarchyIncomingCallsRequest.type;return this.connection.onRequest(Q,(G,J)=>{return Z(G,J,this.attachWorkDoneProgress(G),this.attachPartialResultProgress(Q,G))})},onOutgoingCalls:(Z)=>{let Q=yG.CallHierarchyOutgoingCallsRequest.type;return this.connection.onRequest(Q,(G,J)=>{return Z(G,J,this.attachWorkDoneProgress(G),this.attachPartialResultProgress(Q,G))})}}}}};aH.CallHierarchyFeature=BN});var kG=D((ZU)=>{Object.defineProperty(ZU,"__esModule",{value:!0});ZU.SemanticTokensBuilder=ZU.SemanticTokensDiff=ZU.SemanticTokensFeature=void 0;var F4=R0(),LN=(X)=>{return class extends X{get semanticTokens(){return{refresh:()=>{return this.connection.sendRequest(F4.SemanticTokensRefreshRequest.type)},on:(Z)=>{let Q=F4.SemanticTokensRequest.type;return this.connection.onRequest(Q,(G,J)=>{return Z(G,J,this.attachWorkDoneProgress(G),this.attachPartialResultProgress(Q,G))})},onDelta:(Z)=>{let Q=F4.SemanticTokensDeltaRequest.type;return this.connection.onRequest(Q,(G,J)=>{return Z(G,J,this.attachWorkDoneProgress(G),this.attachPartialResultProgress(Q,G))})},onRange:(Z)=>{let Q=F4.SemanticTokensRangeRequest.type;return this.connection.onRequest(Q,(G,J)=>{return Z(G,J,this.attachWorkDoneProgress(G),this.attachPartialResultProgress(Q,G))})}}}}};ZU.SemanticTokensFeature=LN;class fG{constructor(X,Z){this.originalSequence=X,this.modifiedSequence=Z}computeDiff(){let X=this.originalSequence.length,Z=this.modifiedSequence.length,Q=0;while(Q<Z&&Q<X&&this.originalSequence[Q]===this.modifiedSequence[Q])Q++;if(Q<Z&&Q<X){let G=X-1,J=Z-1;while(G>=Q&&J>=Q&&this.originalSequence[G]===this.modifiedSequence[J])G--,J--;if(G<Q||J<Q)G++,J++;let Y=G-Q+1,$=this.modifiedSequence.slice(Q,J+1);if($.length===1&&$[0]===this.originalSequence[G])return[{start:Q,deleteCount:Y-1}];else return[{start:Q,deleteCount:Y,data:$}]}else if(Q<Z)return[{start:Q,deleteCount:0,data:this.modifiedSequence.slice(Q)}];else if(Q<X)return[{start:Q,deleteCount:X-Q}];else return[]}}ZU.SemanticTokensDiff=fG;class XU{constructor(){this._prevData=void 0,this.initialize()}initialize(){this._id=Date.now(),this._prevLine=0,this._prevChar=0,this._data=[],this._dataLen=0}push(X,Z,Q,G,J){let Y=X,$=Z;if(this._dataLen>0){if(Y-=this._prevLine,Y===0)$-=this._prevChar}this._data[this._dataLen++]=Y,this._data[this._dataLen++]=$,this._data[this._dataLen++]=Q,this._data[this._dataLen++]=G,this._data[this._dataLen++]=J,this._prevLine=X,this._prevChar=Z}get id(){return this._id.toString()}previousResult(X){if(this.id===X)this._prevData=this._data;this.initialize()}build(){return this._prevData=void 0,{resultId:this.id,data:this._data}}canBuildEdits(){return this._prevData!==void 0}buildEdits(){if(this._prevData!==void 0)return{resultId:this.id,edits:new fG(this._prevData,this._data).computeDiff()};else return this.build()}}ZU.SemanticTokensBuilder=XU});var YU=D((GU)=>{Object.defineProperty(GU,"__esModule",{value:!0});GU.ShowDocumentFeature=void 0;var ON=R0(),wN=(X)=>{return class extends X{showDocument(Z){return this.connection.sendRequest(ON.ShowDocumentRequest.type,Z)}}};GU.ShowDocumentFeature=wN});var HU=D(($U)=>{Object.defineProperty($U,"__esModule",{value:!0});$U.FileOperationsFeature=void 0;var P9=R0(),KN=(X)=>{return class extends X{onDidCreateFiles(Z){return this.connection.onNotification(P9.DidCreateFilesNotification.type,(Q)=>{Z(Q)})}onDidRenameFiles(Z){return this.connection.onNotification(P9.DidRenameFilesNotification.type,(Q)=>{Z(Q)})}onDidDeleteFiles(Z){return this.connection.onNotification(P9.DidDeleteFilesNotification.type,(Q)=>{Z(Q)})}onWillCreateFiles(Z){return this.connection.onRequest(P9.WillCreateFilesRequest.type,(Q,G)=>{return Z(Q,G)})}onWillRenameFiles(Z){return this.connection.onRequest(P9.WillRenameFilesRequest.type,(Q,G)=>{return Z(Q,G)})}onWillDeleteFiles(Z){return this.connection.onRequest(P9.WillDeleteFilesRequest.type,(Q,G)=>{return Z(Q,G)})}}};$U.FileOperationsFeature=KN});var VU=D((UU)=>{Object.defineProperty(UU,"__esModule",{value:!0});UU.LinkedEditingRangeFeature=void 0;var MN=R0(),NN=(X)=>{return class extends X{onLinkedEditingRange(Z){return this.connection.onRequest(MN.LinkedEditingRangeRequest.type,(Q,G)=>{return Z(Q,G,this.attachWorkDoneProgress(Q),void 0)})}}};UU.LinkedEditingRangeFeature=NN});var AU=D((BU)=>{Object.defineProperty(BU,"__esModule",{value:!0});BU.TypeHierarchyFeature=void 0;var xG=R0(),TN=(X)=>{return class extends X{get typeHierarchy(){return{onPrepare:(Z)=>{return this.connection.onRequest(xG.TypeHierarchyPrepareRequest.type,(Q,G)=>{return Z(Q,G,this.attachWorkDoneProgress(Q),void 0)})},onSupertypes:(Z)=>{let Q=xG.TypeHierarchySupertypesRequest.type;return this.connection.onRequest(Q,(G,J)=>{return Z(G,J,this.attachWorkDoneProgress(G),this.attachPartialResultProgress(Q,G))})},onSubtypes:(Z)=>{let Q=xG.TypeHierarchySubtypesRequest.type;return this.connection.onRequest(Q,(G,J)=>{return Z(G,J,this.attachWorkDoneProgress(G),this.attachPartialResultProgress(Q,G))})}}}}};BU.TypeHierarchyFeature=TN});var KU=D((OU)=>{Object.defineProperty(OU,"__esModule",{value:!0});OU.InlineValueFeature=void 0;var FU=R0(),qN=(X)=>{return class extends X{get inlineValue(){return{refresh:()=>{return this.connection.sendRequest(FU.InlineValueRefreshRequest.type)},on:(Z)=>{return this.connection.onRequest(FU.InlineValueRequest.type,(Q,G)=>{return Z(Q,G,this.attachWorkDoneProgress(Q))})}}}}};OU.InlineValueFeature=qN});var qU=D((NU)=>{Object.defineProperty(NU,"__esModule",{value:!0});NU.FoldingRangeFeature=void 0;var MU=R0(),EN=(X)=>{return class extends X{get foldingRange(){return{refresh:()=>{return this.connection.sendRequest(MU.FoldingRangeRefreshRequest.type)},on:(Z)=>{let Q=MU.FoldingRangeRequest.type;return this.connection.onRequest(Q,(G,J)=>{return Z(G,J,this.attachWorkDoneProgress(G),this.attachPartialResultProgress(Q,G))})}}}}};NU.FoldingRangeFeature=EN});var jU=D((EU)=>{Object.defineProperty(EU,"__esModule",{value:!0});EU.InlayHintFeature=void 0;var vG=R0(),PN=(X)=>{return class extends X{get inlayHint(){return{refresh:()=>{return this.connection.sendRequest(vG.InlayHintRefreshRequest.type)},on:(Z)=>{return this.connection.onRequest(vG.InlayHintRequest.type,(Q,G)=>{return Z(Q,G,this.attachWorkDoneProgress(Q))})},resolve:(Z)=>{return this.connection.onRequest(vG.InlayHintResolveRequest.type,(Q,G)=>{return Z(Q,G)})}}}}};EU.InlayHintFeature=PN});var _U=D((DU)=>{Object.defineProperty(DU,"__esModule",{value:!0});DU.DiagnosticFeature=void 0;var EZ=R0(),jN=(X)=>{return class extends X{get diagnostics(){return{refresh:()=>{return this.connection.sendRequest(EZ.DiagnosticRefreshRequest.type)},on:(Z)=>{return this.connection.onRequest(EZ.DocumentDiagnosticRequest.type,(Q,G)=>{return Z(Q,G,this.attachWorkDoneProgress(Q),this.attachPartialResultProgress(EZ.DocumentDiagnosticRequest.partialResult,Q))})},onWorkspace:(Z)=>{return this.connection.onRequest(EZ.WorkspaceDiagnosticRequest.type,(Q,G)=>{return Z(Q,G,this.attachWorkDoneProgress(Q),this.attachPartialResultProgress(EZ.WorkspaceDiagnosticRequest.partialResult,Q))})}}}}};DU.DiagnosticFeature=jN});var hG=D((SU)=>{Object.defineProperty(SU,"__esModule",{value:!0});SU.TextDocuments=void 0;var u6=R0();class CU{constructor(X){this._configuration=X,this._syncedDocuments=new Map,this._onDidChangeContent=new u6.Emitter,this._onDidOpen=new u6.Emitter,this._onDidClose=new u6.Emitter,this._onDidSave=new u6.Emitter,this._onWillSave=new u6.Emitter}get onDidOpen(){return this._onDidOpen.event}get onDidChangeContent(){return this._onDidChangeContent.event}get onWillSave(){return this._onWillSave.event}onWillSaveWaitUntil(X){this._willSaveWaitUntil=X}get onDidSave(){return this._onDidSave.event}get onDidClose(){return this._onDidClose.event}get(X){return this._syncedDocuments.get(X)}all(){return Array.from(this._syncedDocuments.values())}keys(){return Array.from(this._syncedDocuments.keys())}listen(X){X.__textDocumentSync=u6.TextDocumentSyncKind.Incremental;let Z=[];return Z.push(X.onDidOpenTextDocument((Q)=>{let G=Q.textDocument,J=this._configuration.create(G.uri,G.languageId,G.version,G.text);this._syncedDocuments.set(G.uri,J);let Y=Object.freeze({document:J});this._onDidOpen.fire(Y),this._onDidChangeContent.fire(Y)})),Z.push(X.onDidChangeTextDocument((Q)=>{let{textDocument:G,contentChanges:J}=Q;if(J.length===0)return;let{version:Y}=G;if(Y===null||Y===void 0)throw Error(`Received document change event for ${G.uri} without valid version identifier`);let $=this._syncedDocuments.get(G.uri);if($!==void 0)$=this._configuration.update($,J,Y),this._syncedDocuments.set(G.uri,$),this._onDidChangeContent.fire(Object.freeze({document:$}))})),Z.push(X.onDidCloseTextDocument((Q)=>{let G=this._syncedDocuments.get(Q.textDocument.uri);if(G!==void 0)this._syncedDocuments.delete(Q.textDocument.uri),this._onDidClose.fire(Object.freeze({document:G}))})),Z.push(X.onWillSaveTextDocument((Q)=>{let G=this._syncedDocuments.get(Q.textDocument.uri);if(G!==void 0)this._onWillSave.fire(Object.freeze({document:G,reason:Q.reason}))})),Z.push(X.onWillSaveTextDocumentWaitUntil((Q,G)=>{let J=this._syncedDocuments.get(Q.textDocument.uri);if(J!==void 0&&this._willSaveWaitUntil)return this._willSaveWaitUntil(Object.freeze({document:J,reason:Q.reason}),G);else return[]})),Z.push(X.onDidSaveTextDocument((Q)=>{let G=this._syncedDocuments.get(Q.textDocument.uri);if(G!==void 0)this._onDidSave.fire(Object.freeze({document:G}))})),u6.Disposable.create(()=>{Z.forEach((Q)=>Q.dispose())})}}SU.TextDocuments=CU});var gG=D((fU)=>{Object.defineProperty(fU,"__esModule",{value:!0});fU.NotebookDocuments=fU.NotebookSyncFeature=void 0;var AX=R0(),RU=hG(),DN=(X)=>{return class extends X{get synchronization(){return{onDidOpenNotebookDocument:(Z)=>{return this.connection.onNotification(AX.DidOpenNotebookDocumentNotification.type,(Q)=>{Z(Q)})},onDidChangeNotebookDocument:(Z)=>{return this.connection.onNotification(AX.DidChangeNotebookDocumentNotification.type,(Q)=>{Z(Q)})},onDidSaveNotebookDocument:(Z)=>{return this.connection.onNotification(AX.DidSaveNotebookDocumentNotification.type,(Q)=>{Z(Q)})},onDidCloseNotebookDocument:(Z)=>{return this.connection.onNotification(AX.DidCloseNotebookDocumentNotification.type,(Q)=>{Z(Q)})}}}}};fU.NotebookSyncFeature=DN;class j9{onDidOpenTextDocument(X){return this.openHandler=X,AX.Disposable.create(()=>{this.openHandler=void 0})}openTextDocument(X){this.openHandler&&this.openHandler(X)}onDidChangeTextDocument(X){return this.changeHandler=X,AX.Disposable.create(()=>{this.changeHandler=X})}changeTextDocument(X){this.changeHandler&&this.changeHandler(X)}onDidCloseTextDocument(X){return this.closeHandler=X,AX.Disposable.create(()=>{this.closeHandler=void 0})}closeTextDocument(X){this.closeHandler&&this.closeHandler(X)}onWillSaveTextDocument(){return j9.NULL_DISPOSE}onWillSaveTextDocumentWaitUntil(){return j9.NULL_DISPOSE}onDidSaveTextDocument(){return j9.NULL_DISPOSE}}j9.NULL_DISPOSE=Object.freeze({dispose:()=>{}});class yU{constructor(X){if(X instanceof RU.TextDocuments)this._cellTextDocuments=X;else this._cellTextDocuments=new RU.TextDocuments(X);this.notebookDocuments=new Map,this.notebookCellMap=new Map,this._onDidOpen=new AX.Emitter,this._onDidChange=new AX.Emitter,this._onDidSave=new AX.Emitter,this._onDidClose=new AX.Emitter}get cellTextDocuments(){return this._cellTextDocuments}getCellTextDocument(X){return this._cellTextDocuments.get(X.document)}getNotebookDocument(X){return this.notebookDocuments.get(X)}getNotebookCell(X){let Z=this.notebookCellMap.get(X);return Z&&Z[0]}findNotebookDocumentForCell(X){let Z=typeof X==="string"?X:X.document,Q=this.notebookCellMap.get(Z);return Q&&Q[1]}get onDidOpen(){return this._onDidOpen.event}get onDidSave(){return this._onDidSave.event}get onDidChange(){return this._onDidChange.event}get onDidClose(){return this._onDidClose.event}listen(X){let Z=new j9,Q=[];return Q.push(this.cellTextDocuments.listen(Z)),Q.push(X.notebooks.synchronization.onDidOpenNotebookDocument((G)=>{this.notebookDocuments.set(G.notebookDocument.uri,G.notebookDocument);for(let J of G.cellTextDocuments)Z.openTextDocument({textDocument:J});this.updateCellMap(G.notebookDocument),this._onDidOpen.fire(G.notebookDocument)})),Q.push(X.notebooks.synchronization.onDidChangeNotebookDocument((G)=>{let J=this.notebookDocuments.get(G.notebookDocument.uri);if(J===void 0)return;J.version=G.notebookDocument.version;let Y=J.metadata,$=!1,z=G.change;if(z.metadata!==void 0)$=!0,J.metadata=z.metadata;let H=[],U=[],L=[],A=[];if(z.cells!==void 0){let P=z.cells;if(P.structure!==void 0){let y=P.structure.array;if(J.cells.splice(y.start,y.deleteCount,...y.cells!==void 0?y.cells:[]),P.structure.didOpen!==void 0)for(let M of P.structure.didOpen)Z.openTextDocument({textDocument:M}),H.push(M.uri);if(P.structure.didClose)for(let M of P.structure.didClose)Z.closeTextDocument({textDocument:M}),U.push(M.uri)}if(P.data!==void 0){let y=new Map(P.data.map((M)=>[M.document,M]));for(let M=0;M<=J.cells.length;M++){let K=y.get(J.cells[M].document);if(K!==void 0){let _=J.cells.splice(M,1,K);if(L.push({old:_[0],new:K}),y.delete(K.document),y.size===0)break}}}if(P.textContent!==void 0)for(let y of P.textContent)Z.changeTextDocument({textDocument:y.document,contentChanges:y.changes}),A.push(y.document.uri)}this.updateCellMap(J);let F={notebookDocument:J};if($)F.metadata={old:Y,new:J.metadata};let j=[];for(let P of H)j.push(this.getNotebookCell(P));let R=[];for(let P of U)R.push(this.getNotebookCell(P));let T=[];for(let P of A)T.push(this.getNotebookCell(P));if(j.length>0||R.length>0||L.length>0||T.length>0)F.cells={added:j,removed:R,changed:{data:L,textContent:T}};if(F.metadata!==void 0||F.cells!==void 0)this._onDidChange.fire(F)})),Q.push(X.notebooks.synchronization.onDidSaveNotebookDocument((G)=>{let J=this.notebookDocuments.get(G.notebookDocument.uri);if(J===void 0)return;this._onDidSave.fire(J)})),Q.push(X.notebooks.synchronization.onDidCloseNotebookDocument((G)=>{let J=this.notebookDocuments.get(G.notebookDocument.uri);if(J===void 0)return;this._onDidClose.fire(J);for(let Y of G.cellTextDocuments)Z.closeTextDocument({textDocument:Y});this.notebookDocuments.delete(G.notebookDocument.uri);for(let Y of J.cells)this.notebookCellMap.delete(Y.document)})),AX.Disposable.create(()=>{Q.forEach((G)=>G.dispose())})}updateCellMap(X){for(let Z of X.cells)this.notebookCellMap.set(Z.document,[Z,X])}}fU.NotebookDocuments=yU});var hU=D((xU)=>{Object.defineProperty(xU,"__esModule",{value:!0});xU.MonikerFeature=void 0;var _N=R0(),CN=(X)=>{return class extends X{get moniker(){return{on:(Z)=>{let Q=_N.MonikerRequest.type;return this.connection.onRequest(Q,(G,J)=>{return Z(G,J,this.attachWorkDoneProgress(G),this.attachPartialResultProgress(Q,G))})}}}}};xU.MonikerFeature=CN});var sG=D((QW)=>{Object.defineProperty(QW,"__esModule",{value:!0});QW.createConnection=QW.combineFeatures=QW.combineNotebooksFeatures=QW.combineLanguagesFeatures=QW.combineWorkspaceFeatures=QW.combineWindowFeatures=QW.combineClientFeatures=QW.combineTracerFeatures=QW.combineTelemetryFeatures=QW.combineConsoleFeatures=QW._NotebooksImpl=QW._LanguagesImpl=QW.BulkUnregistration=QW.BulkRegistration=QW.ErrorMessageTracker=void 0;var g=R0(),FX=d8(),mG=CG(),a=lH(),SN=oH(),bN=rH(),RN=eH(),yN=kG(),fN=YU(),kN=HU(),xN=VU(),vN=AU(),hN=KU(),gN=qU(),uN=jU(),mN=_U(),pN=gG(),dN=hU();function uG(X){if(X===null)return;return X}class cU{constructor(){this._messages=Object.create(null)}add(X){let Z=this._messages[X];if(!Z)Z=0;Z++,this._messages[X]=Z}sendErrors(X){Object.keys(this._messages).forEach((Z)=>{X.window.showErrorMessage(Z)})}}QW.ErrorMessageTracker=cU;class pG{constructor(){}rawAttach(X){this._rawConnection=X}attach(X){this._connection=X}get connection(){if(!this._connection)throw Error("Remote is not attached to a connection yet.");return this._connection}fillServerCapabilities(X){}initialize(X){}error(X){this.send(g.MessageType.Error,X)}warn(X){this.send(g.MessageType.Warning,X)}info(X){this.send(g.MessageType.Info,X)}log(X){this.send(g.MessageType.Log,X)}debug(X){this.send(g.MessageType.Debug,X)}send(X,Z){if(this._rawConnection)this._rawConnection.sendNotification(g.LogMessageNotification.type,{type:X,message:Z}).catch(()=>{(0,g.RAL)().console.error("Sending log message failed")})}}class iU{constructor(){}attach(X){this._connection=X}get connection(){if(!this._connection)throw Error("Remote is not attached to a connection yet.");return this._connection}initialize(X){}fillServerCapabilities(X){}showErrorMessage(X,...Z){let Q={type:g.MessageType.Error,message:X,actions:Z};return this.connection.sendRequest(g.ShowMessageRequest.type,Q).then(uG)}showWarningMessage(X,...Z){let Q={type:g.MessageType.Warning,message:X,actions:Z};return this.connection.sendRequest(g.ShowMessageRequest.type,Q).then(uG)}showInformationMessage(X,...Z){let Q={type:g.MessageType.Info,message:X,actions:Z};return this.connection.sendRequest(g.ShowMessageRequest.type,Q).then(uG)}}var gU=(0,fN.ShowDocumentFeature)((0,a.ProgressFeature)(iU)),uU;(function(X){function Z(){return new iG}X.create=Z})(uU||(QW.BulkRegistration=uU={}));class iG{constructor(){this._registrations=[],this._registered=new Set}add(X,Z){let Q=FX.string(X)?X:X.method;if(this._registered.has(Q))throw Error(`${Q} is already added to this registration`);let G=mG.generateUuid();this._registrations.push({id:G,method:Q,registerOptions:Z||{}}),this._registered.add(Q)}asRegistrationParams(){return{registrations:this._registrations}}}var mU;(function(X){function Z(){return new O4(void 0,[])}X.create=Z})(mU||(QW.BulkUnregistration=mU={}));class O4{constructor(X,Z){this._connection=X,this._unregistrations=new Map,Z.forEach((Q)=>{this._unregistrations.set(Q.method,Q)})}get isAttached(){return!!this._connection}attach(X){this._connection=X}add(X){this._unregistrations.set(X.method,X)}dispose(){let X=[];for(let Q of this._unregistrations.values())X.push(Q);let Z={unregisterations:X};this._connection.sendRequest(g.UnregistrationRequest.type,Z).catch(()=>{this._connection.console.info("Bulk unregistration failed.")})}disposeSingle(X){let Z=FX.string(X)?X:X.method,Q=this._unregistrations.get(Z);if(!Q)return!1;let G={unregisterations:[Q]};return this._connection.sendRequest(g.UnregistrationRequest.type,G).then(()=>{this._unregistrations.delete(Z)},(J)=>{this._connection.console.info(`Un-registering request handler for ${Q.id} failed.`)}),!0}}class dG{attach(X){this._connection=X}get connection(){if(!this._connection)throw Error("Remote is not attached to a connection yet.");return this._connection}initialize(X){}fillServerCapabilities(X){}register(X,Z,Q){if(X instanceof iG)return this.registerMany(X);else if(X instanceof O4)return this.registerSingle1(X,Z,Q);else return this.registerSingle2(X,Z)}registerSingle1(X,Z,Q){let G=FX.string(Z)?Z:Z.method,J=mG.generateUuid(),Y={registrations:[{id:J,method:G,registerOptions:Q||{}}]};if(!X.isAttached)X.attach(this.connection);return this.connection.sendRequest(g.RegistrationRequest.type,Y).then(($)=>{return X.add({id:J,method:G}),X},($)=>{return this.connection.console.info(`Registering request handler for ${G} failed.`),Promise.reject($)})}registerSingle2(X,Z){let Q=FX.string(X)?X:X.method,G=mG.generateUuid(),J={registrations:[{id:G,method:Q,registerOptions:Z||{}}]};return this.connection.sendRequest(g.RegistrationRequest.type,J).then((Y)=>{return g.Disposable.create(()=>{this.unregisterSingle(G,Q).catch(()=>{this.connection.console.info(`Un-registering capability with id ${G} failed.`)})})},(Y)=>{return this.connection.console.info(`Registering request handler for ${Q} failed.`),Promise.reject(Y)})}unregisterSingle(X,Z){let Q={unregisterations:[{id:X,method:Z}]};return this.connection.sendRequest(g.UnregistrationRequest.type,Q).catch(()=>{this.connection.console.info(`Un-registering request handler for ${X} failed.`)})}registerMany(X){let Z=X.asRegistrationParams();return this.connection.sendRequest(g.RegistrationRequest.type,Z).then(()=>{return new O4(this._connection,Z.registrations.map((Q)=>{return{id:Q.id,method:Q.method}}))},(Q)=>{return this.connection.console.info("Bulk registration failed."),Promise.reject(Q)})}}class oU{constructor(){}attach(X){this._connection=X}get connection(){if(!this._connection)throw Error("Remote is not attached to a connection yet.");return this._connection}initialize(X){}fillServerCapabilities(X){}applyEdit(X){function Z(G){return G&&!!G.edit}let Q=Z(X)?X:{edit:X};return this.connection.sendRequest(g.ApplyWorkspaceEditRequest.type,Q)}}var pU=(0,kN.FileOperationsFeature)((0,bN.WorkspaceFoldersFeature)((0,SN.ConfigurationFeature)(oU)));class lG{constructor(){this._trace=g.Trace.Off}attach(X){this._connection=X}get connection(){if(!this._connection)throw Error("Remote is not attached to a connection yet.");return this._connection}initialize(X){}fillServerCapabilities(X){}set trace(X){this._trace=X}log(X,Z){if(this._trace===g.Trace.Off)return;this.connection.sendNotification(g.LogTraceNotification.type,{message:X,verbose:this._trace===g.Trace.Verbose?Z:void 0}).catch(()=>{})}}class cG{constructor(){}attach(X){this._connection=X}get connection(){if(!this._connection)throw Error("Remote is not attached to a connection yet.");return this._connection}initialize(X){}fillServerCapabilities(X){}logEvent(X){this.connection.sendNotification(g.TelemetryEventNotification.type,X).catch(()=>{this.connection.console.log("Sending TelemetryEventNotification failed")})}}class oG{constructor(){}attach(X){this._connection=X}get connection(){if(!this._connection)throw Error("Remote is not attached to a connection yet.");return this._connection}initialize(X){}fillServerCapabilities(X){}attachWorkDoneProgress(X){return(0,a.attachWorkDone)(this.connection,X)}attachPartialResultProgress(X,Z){return(0,a.attachPartialResult)(this.connection,Z)}}QW._LanguagesImpl=oG;var dU=(0,gN.FoldingRangeFeature)((0,dN.MonikerFeature)((0,mN.DiagnosticFeature)((0,uN.InlayHintFeature)((0,hN.InlineValueFeature)((0,vN.TypeHierarchyFeature)((0,xN.LinkedEditingRangeFeature)((0,yN.SemanticTokensFeature)((0,RN.CallHierarchyFeature)(oG)))))))));class nG{constructor(){}attach(X){this._connection=X}get connection(){if(!this._connection)throw Error("Remote is not attached to a connection yet.");return this._connection}initialize(X){}fillServerCapabilities(X){}attachWorkDoneProgress(X){return(0,a.attachWorkDone)(this.connection,X)}attachPartialResultProgress(X,Z){return(0,a.attachPartialResult)(this.connection,Z)}}QW._NotebooksImpl=nG;var lU=(0,pN.NotebookSyncFeature)(nG);function nU(X,Z){return function(Q){return Z(X(Q))}}QW.combineConsoleFeatures=nU;function sU(X,Z){return function(Q){return Z(X(Q))}}QW.combineTelemetryFeatures=sU;function rU(X,Z){return function(Q){return Z(X(Q))}}QW.combineTracerFeatures=rU;function aU(X,Z){return function(Q){return Z(X(Q))}}QW.combineClientFeatures=aU;function tU(X,Z){return function(Q){return Z(X(Q))}}QW.combineWindowFeatures=tU;function eU(X,Z){return function(Q){return Z(X(Q))}}QW.combineWorkspaceFeatures=eU;function XW(X,Z){return function(Q){return Z(X(Q))}}QW.combineLanguagesFeatures=XW;function ZW(X,Z){return function(Q){return Z(X(Q))}}QW.combineNotebooksFeatures=ZW;function lN(X,Z){function Q(J,Y,$){if(J&&Y)return $(J,Y);else if(J)return J;else return Y}return{__brand:"features",console:Q(X.console,Z.console,nU),tracer:Q(X.tracer,Z.tracer,rU),telemetry:Q(X.telemetry,Z.telemetry,sU),client:Q(X.client,Z.client,aU),window:Q(X.window,Z.window,tU),workspace:Q(X.workspace,Z.workspace,eU),languages:Q(X.languages,Z.languages,XW),notebooks:Q(X.notebooks,Z.notebooks,ZW)}}QW.combineFeatures=lN;function cN(X,Z,Q){let G=Q&&Q.console?new(Q.console(pG)):new pG,J=X(G);G.rawAttach(J);let Y=Q&&Q.tracer?new(Q.tracer(lG)):new lG,$=Q&&Q.telemetry?new(Q.telemetry(cG)):new cG,z=Q&&Q.client?new(Q.client(dG)):new dG,H=Q&&Q.window?new(Q.window(gU)):new gU,U=Q&&Q.workspace?new(Q.workspace(pU)):new pU,L=Q&&Q.languages?new(Q.languages(dU)):new dU,A=Q&&Q.notebooks?new(Q.notebooks(lU)):new lU,F=[G,Y,$,z,H,U,L,A];function j(M){if(M instanceof Promise)return M;else if(FX.thenable(M))return new Promise((K,_)=>{M.then((x)=>K(x),(x)=>_(x))});else return Promise.resolve(M)}let R=void 0,T=void 0,P=void 0,y={listen:()=>J.listen(),sendRequest:(M,...K)=>J.sendRequest(FX.string(M)?M:M.method,...K),onRequest:(M,K)=>J.onRequest(M,K),sendNotification:(M,K)=>{let _=FX.string(M)?M:M.method;return J.sendNotification(_,K)},onNotification:(M,K)=>J.onNotification(M,K),onProgress:J.onProgress,sendProgress:J.sendProgress,onInitialize:(M)=>{return T=M,{dispose:()=>{T=void 0}}},onInitialized:(M)=>J.onNotification(g.InitializedNotification.type,M),onShutdown:(M)=>{return R=M,{dispose:()=>{R=void 0}}},onExit:(M)=>{return P=M,{dispose:()=>{P=void 0}}},get console(){return G},get telemetry(){return $},get tracer(){return Y},get client(){return z},get window(){return H},get workspace(){return U},get languages(){return L},get notebooks(){return A},onDidChangeConfiguration:(M)=>J.onNotification(g.DidChangeConfigurationNotification.type,M),onDidChangeWatchedFiles:(M)=>J.onNotification(g.DidChangeWatchedFilesNotification.type,M),__textDocumentSync:void 0,onDidOpenTextDocument:(M)=>J.onNotification(g.DidOpenTextDocumentNotification.type,M),onDidChangeTextDocument:(M)=>J.onNotification(g.DidChangeTextDocumentNotification.type,M),onDidCloseTextDocument:(M)=>J.onNotification(g.DidCloseTextDocumentNotification.type,M),onWillSaveTextDocument:(M)=>J.onNotification(g.WillSaveTextDocumentNotification.type,M),onWillSaveTextDocumentWaitUntil:(M)=>J.onRequest(g.WillSaveTextDocumentWaitUntilRequest.type,M),onDidSaveTextDocument:(M)=>J.onNotification(g.DidSaveTextDocumentNotification.type,M),sendDiagnostics:(M)=>J.sendNotification(g.PublishDiagnosticsNotification.type,M),onHover:(M)=>J.onRequest(g.HoverRequest.type,(K,_)=>{return M(K,_,(0,a.attachWorkDone)(J,K),void 0)}),onCompletion:(M)=>J.onRequest(g.CompletionRequest.type,(K,_)=>{return M(K,_,(0,a.attachWorkDone)(J,K),(0,a.attachPartialResult)(J,K))}),onCompletionResolve:(M)=>J.onRequest(g.CompletionResolveRequest.type,M),onSignatureHelp:(M)=>J.onRequest(g.SignatureHelpRequest.type,(K,_)=>{return M(K,_,(0,a.attachWorkDone)(J,K),void 0)}),onDeclaration:(M)=>J.onRequest(g.DeclarationRequest.type,(K,_)=>{return M(K,_,(0,a.attachWorkDone)(J,K),(0,a.attachPartialResult)(J,K))}),onDefinition:(M)=>J.onRequest(g.DefinitionRequest.type,(K,_)=>{return M(K,_,(0,a.attachWorkDone)(J,K),(0,a.attachPartialResult)(J,K))}),onTypeDefinition:(M)=>J.onRequest(g.TypeDefinitionRequest.type,(K,_)=>{return M(K,_,(0,a.attachWorkDone)(J,K),(0,a.attachPartialResult)(J,K))}),onImplementation:(M)=>J.onRequest(g.ImplementationRequest.type,(K,_)=>{return M(K,_,(0,a.attachWorkDone)(J,K),(0,a.attachPartialResult)(J,K))}),onReferences:(M)=>J.onRequest(g.ReferencesRequest.type,(K,_)=>{return M(K,_,(0,a.attachWorkDone)(J,K),(0,a.attachPartialResult)(J,K))}),onDocumentHighlight:(M)=>J.onRequest(g.DocumentHighlightRequest.type,(K,_)=>{return M(K,_,(0,a.attachWorkDone)(J,K),(0,a.attachPartialResult)(J,K))}),onDocumentSymbol:(M)=>J.onRequest(g.DocumentSymbolRequest.type,(K,_)=>{return M(K,_,(0,a.attachWorkDone)(J,K),(0,a.attachPartialResult)(J,K))}),onWorkspaceSymbol:(M)=>J.onRequest(g.WorkspaceSymbolRequest.type,(K,_)=>{return M(K,_,(0,a.attachWorkDone)(J,K),(0,a.attachPartialResult)(J,K))}),onWorkspaceSymbolResolve:(M)=>J.onRequest(g.WorkspaceSymbolResolveRequest.type,M),onCodeAction:(M)=>J.onRequest(g.CodeActionRequest.type,(K,_)=>{return M(K,_,(0,a.attachWorkDone)(J,K),(0,a.attachPartialResult)(J,K))}),onCodeActionResolve:(M)=>J.onRequest(g.CodeActionResolveRequest.type,(K,_)=>{return M(K,_)}),onCodeLens:(M)=>J.onRequest(g.CodeLensRequest.type,(K,_)=>{return M(K,_,(0,a.attachWorkDone)(J,K),(0,a.attachPartialResult)(J,K))}),onCodeLensResolve:(M)=>J.onRequest(g.CodeLensResolveRequest.type,(K,_)=>{return M(K,_)}),onDocumentFormatting:(M)=>J.onRequest(g.DocumentFormattingRequest.type,(K,_)=>{return M(K,_,(0,a.attachWorkDone)(J,K),void 0)}),onDocumentRangeFormatting:(M)=>J.onRequest(g.DocumentRangeFormattingRequest.type,(K,_)=>{return M(K,_,(0,a.attachWorkDone)(J,K),void 0)}),onDocumentOnTypeFormatting:(M)=>J.onRequest(g.DocumentOnTypeFormattingRequest.type,(K,_)=>{return M(K,_)}),onRenameRequest:(M)=>J.onRequest(g.RenameRequest.type,(K,_)=>{return M(K,_,(0,a.attachWorkDone)(J,K),void 0)}),onPrepareRename:(M)=>J.onRequest(g.PrepareRenameRequest.type,(K,_)=>{return M(K,_)}),onDocumentLinks:(M)=>J.onRequest(g.DocumentLinkRequest.type,(K,_)=>{return M(K,_,(0,a.attachWorkDone)(J,K),(0,a.attachPartialResult)(J,K))}),onDocumentLinkResolve:(M)=>J.onRequest(g.DocumentLinkResolveRequest.type,(K,_)=>{return M(K,_)}),onDocumentColor:(M)=>J.onRequest(g.DocumentColorRequest.type,(K,_)=>{return M(K,_,(0,a.attachWorkDone)(J,K),(0,a.attachPartialResult)(J,K))}),onColorPresentation:(M)=>J.onRequest(g.ColorPresentationRequest.type,(K,_)=>{return M(K,_,(0,a.attachWorkDone)(J,K),(0,a.attachPartialResult)(J,K))}),onFoldingRanges:(M)=>J.onRequest(g.FoldingRangeRequest.type,(K,_)=>{return M(K,_,(0,a.attachWorkDone)(J,K),(0,a.attachPartialResult)(J,K))}),onSelectionRanges:(M)=>J.onRequest(g.SelectionRangeRequest.type,(K,_)=>{return M(K,_,(0,a.attachWorkDone)(J,K),(0,a.attachPartialResult)(J,K))}),onExecuteCommand:(M)=>J.onRequest(g.ExecuteCommandRequest.type,(K,_)=>{return M(K,_,(0,a.attachWorkDone)(J,K),void 0)}),dispose:()=>J.dispose()};for(let M of F)M.attach(y);return J.onRequest(g.InitializeRequest.type,(M)=>{if(Z.initialize(M),FX.string(M.trace))Y.trace=g.Trace.fromString(M.trace);for(let K of F)K.initialize(M.capabilities);if(T){let K=T(M,new g.CancellationTokenSource().token,(0,a.attachWorkDone)(J,M),void 0);return j(K).then((_)=>{if(_ instanceof g.ResponseError)return _;let x=_;if(!x)x={capabilities:{}};let m=x.capabilities;if(!m)m={},x.capabilities=m;if(m.textDocumentSync===void 0||m.textDocumentSync===null)m.textDocumentSync=FX.number(y.__textDocumentSync)?y.__textDocumentSync:g.TextDocumentSyncKind.None;else if(!FX.number(m.textDocumentSync)&&!FX.number(m.textDocumentSync.change))m.textDocumentSync.change=FX.number(y.__textDocumentSync)?y.__textDocumentSync:g.TextDocumentSyncKind.None;for(let n of F)n.fillServerCapabilities(m);return x})}else{let K={capabilities:{textDocumentSync:g.TextDocumentSyncKind.None}};for(let _ of F)_.fillServerCapabilities(K.capabilities);return K}}),J.onRequest(g.ShutdownRequest.type,()=>{if(Z.shutdownReceived=!0,R)return R(new g.CancellationTokenSource().token);else return}),J.onNotification(g.ExitNotification.type,()=>{try{if(P)P()}finally{if(Z.shutdownReceived)Z.exit(0);else Z.exit(1)}}),J.onNotification(g.SetTraceNotification.type,(M)=>{Y.trace=g.Trace.fromString(M.value)}),y}QW.createConnection=cN});var $W=D((JW)=>{var __filename="C:\\Users\\mm\\Documents\\bun proyects\\bun_plugins\\src\\trigger_system\\node_modules\\vscode-languageserver\\lib\\node\\files.js";Object.defineProperty(JW,"__esModule",{value:!0});JW.resolveModulePath=JW.FileSystem=JW.resolveGlobalYarnPath=JW.resolveGlobalNodePath=JW.resolve=JW.uriToFilePath=void 0;var $T=p0("url"),SX=p0("path"),rG=p0("fs"),XJ=p0("child_process");function zT(X){let Z=$T.parse(X);if(Z.protocol!=="file:"||!Z.path)return;let Q=Z.path.split("/");for(var G=0,J=Q.length;G<J;G++)Q[G]=decodeURIComponent(Q[G]);if(process.platform==="win32"&&Q.length>1){let Y=Q[0],$=Q[1];if(Y.length===0&&$.length>1&&$[1]===":")Q.shift()}return SX.normalize(Q.join("/"))}JW.uriToFilePath=zT;function aG(){return process.platform==="win32"}function w4(X,Z,Q,G){let Y=["var p = process;","p.on('message',function(m){","if(m.c==='e'){","p.exit(0);","}","else if(m.c==='rs'){","try{","var r=require.resolve(m.a);","p.send({c:'r',s:true,r:r});","}","catch(err){","p.send({c:'r',s:false});","}","}","});"].join("");return new Promise(($,z)=>{let H=process.env,U=Object.create(null);if(Object.keys(H).forEach((L)=>U[L]=H[L]),Z&&rG.existsSync(Z)){if(U.NODE_PATH)U.NODE_PATH=Z+SX.delimiter+U.NODE_PATH;else U.NODE_PATH=Z;if(G)G(`NODE_PATH value is: ${U.NODE_PATH}`)}U.ELECTRON_RUN_AS_NODE="1";try{let L=(0,XJ.fork)("",[],{cwd:Q,env:U,execArgv:["-e",Y]});if(L.pid===void 0){z(Error(`Starting process to resolve node module  ${X} failed`));return}L.on("error",(F)=>{z(F)}),L.on("message",(F)=>{if(F.c==="r")if(L.send({c:"e"}),F.s)$(F.r);else z(Error(`Failed to resolve module: ${X}`))});let A={c:"rs",a:X};L.send(A)}catch(L){z(L)}})}JW.resolve=w4;function tG(X){let Z="npm",Q=Object.create(null);Object.keys(process.env).forEach((Y)=>Q[Y]=process.env[Y]),Q.NO_UPDATE_NOTIFIER="true";let G={encoding:"utf8",env:Q};if(aG())Z="npm.cmd",G.shell=!0;let J=()=>{};try{process.on("SIGPIPE",J);let Y=(0,XJ.spawnSync)(Z,["config","get","prefix"],G).stdout;if(!Y){if(X)X("'npm config get prefix' didn't return a value.");return}let $=Y.trim();if(X)X(`'npm config get prefix' value is: ${$}`);if($.length>0)if(aG())return SX.join($,"node_modules");else return SX.join($,"lib","node_modules");return}catch(Y){return}finally{process.removeListener("SIGPIPE",J)}}JW.resolveGlobalNodePath=tG;function HT(X){let Z="yarn",Q={encoding:"utf8"};if(aG())Z="yarn.cmd",Q.shell=!0;let G=()=>{};try{process.on("SIGPIPE",G);let J=(0,XJ.spawnSync)(Z,["global","dir","--json"],Q),Y=J.stdout;if(!Y){if(X){if(X("'yarn global dir' didn't return a value."),J.stderr)X(J.stderr)}return}let $=Y.trim().split(/\r?\n/);for(let z of $)try{let H=JSON.parse(z);if(H.type==="log")return SX.join(H.data,"node_modules")}catch(H){}return}catch(J){return}finally{process.removeListener("SIGPIPE",G)}}JW.resolveGlobalYarnPath=HT;var eG;(function(X){let Z=void 0;function Q(){if(Z!==void 0)return Z;if(process.platform==="win32")Z=!1;else Z=!rG.existsSync(__filename.toUpperCase())||!rG.existsSync(__filename.toLowerCase());return Z}X.isCaseSensitive=Q;function G(J,Y){if(Q())return SX.normalize(Y).indexOf(SX.normalize(J))===0;else return SX.normalize(Y).toLowerCase().indexOf(SX.normalize(J).toLowerCase())===0}X.isParent=G})(eG||(JW.FileSystem=eG={}));function UT(X,Z,Q,G){if(Q){if(!SX.isAbsolute(Q))Q=SX.join(X,Q);return w4(Z,Q,Q,G).then((J)=>{if(eG.isParent(Q,J))return J;else return Promise.reject(Error(`Failed to load ${Z} from node path location.`))}).then(void 0,(J)=>{return w4(Z,tG(G),X,G)})}else return w4(Z,tG(G),X,G)}JW.resolveModulePath=UT});var UW=D((zW)=>{Object.defineProperty(zW,"__esModule",{value:!0});zW.InlineCompletionFeature=void 0;var FT=R0(),OT=(X)=>{return class extends X{get inlineCompletion(){return{on:(Z)=>{return this.connection.onRequest(FT.InlineCompletionRequest.type,(Q,G)=>{return Z(Q,G,this.attachWorkDoneProgress(Q))})}}}}};zW.InlineCompletionFeature=OT});var BW=D((i0)=>{var wT=i0&&i0.__createBinding||(Object.create?function(X,Z,Q,G){if(G===void 0)G=Q;var J=Object.getOwnPropertyDescriptor(Z,Q);if(!J||("get"in J?!Z.__esModule:J.writable||J.configurable))J={enumerable:!0,get:function(){return Z[Q]}};Object.defineProperty(X,G,J)}:function(X,Z,Q,G){if(G===void 0)G=Q;X[G]=Z[Q]}),VW=i0&&i0.__exportStar||function(X,Z){for(var Q in X)if(Q!=="default"&&!Object.prototype.hasOwnProperty.call(Z,Q))wT(Z,X,Q)};Object.defineProperty(i0,"__esModule",{value:!0});i0.ProposedFeatures=i0.NotebookDocuments=i0.TextDocuments=i0.SemanticTokensBuilder=void 0;var KT=kG();Object.defineProperty(i0,"SemanticTokensBuilder",{enumerable:!0,get:function(){return KT.SemanticTokensBuilder}});var MT=UW();VW(R0(),i0);var NT=hG();Object.defineProperty(i0,"TextDocuments",{enumerable:!0,get:function(){return NT.TextDocuments}});var TT=gG();Object.defineProperty(i0,"NotebookDocuments",{enumerable:!0,get:function(){return TT.NotebookDocuments}});VW(sG(),i0);var WW;(function(X){X.all={__brand:"features",languages:MT.InlineCompletionFeature}})(WW||(i0.ProposedFeatures=WW={}))});var jZ=D((OX)=>{var qT=OX&&OX.__createBinding||(Object.create?function(X,Z,Q,G){if(G===void 0)G=Q;var J=Object.getOwnPropertyDescriptor(Z,Q);if(!J||("get"in J?!Z.__esModule:J.writable||J.configurable))J={enumerable:!0,get:function(){return Z[Q]}};Object.defineProperty(X,G,J)}:function(X,Z,Q,G){if(G===void 0)G=Q;X[G]=Z[Q]}),OW=OX&&OX.__exportStar||function(X,Z){for(var Q in X)if(Q!=="default"&&!Object.prototype.hasOwnProperty.call(Z,Q))qT(Z,X,Q)};Object.defineProperty(OX,"__esModule",{value:!0});OX.createConnection=OX.Files=void 0;var LW=p0("node:util"),ZJ=d8(),ET=sG(),PZ=$W(),m6=R0();OW(R0(),OX);OW(BW(),OX);var AW;(function(X){X.uriToFilePath=PZ.uriToFilePath,X.resolveGlobalNodePath=PZ.resolveGlobalNodePath,X.resolveGlobalYarnPath=PZ.resolveGlobalYarnPath,X.resolve=PZ.resolve,X.resolveModulePath=PZ.resolveModulePath})(AW||(OX.Files=AW={}));var FW;function K4(){if(FW===void 0)return;try{FW.end()}catch(X){}}var D9=!1,wW=void 0;function PT(){function Z(Q){try{let G=parseInt(Q);if(!isNaN(G))wW=setInterval(()=>{try{process.kill(G,0)}catch(J){K4(),process.exit(D9?0:1)}},3000)}catch(G){}}for(let Q=2;Q<process.argv.length;Q++){let G=process.argv[Q];if(G==="--clientProcessId"&&Q+1<process.argv.length){Z(process.argv[Q+1]);return}else{let J=G.split("=");if(J[0]==="--clientProcessId")Z(J[1])}}}PT();var jT={initialize:(X)=>{let Z=X.processId;if(ZJ.number(Z)&&wW===void 0)setInterval(()=>{try{process.kill(Z,0)}catch(Q){process.exit(D9?0:1)}},3000)},get shutdownReceived(){return D9},set shutdownReceived(X){D9=X},exit:(X)=>{K4(),process.exit(X)}};function DT(X,Z,Q,G){let J,Y,$,z;if(X!==void 0&&X.__brand==="features")J=X,X=Z,Z=Q,Q=G;if(m6.ConnectionStrategy.is(X)||m6.ConnectionOptions.is(X))z=X;else Y=X,$=Z,z=Q;return IT(Y,$,z,J)}OX.createConnection=DT;function IT(X,Z,Q,G){let J=!1;if(!X&&!Z&&process.argv.length>2){let H=void 0,U=void 0,L=process.argv.slice(2);for(let A=0;A<L.length;A++){let F=L[A];if(F==="--node-ipc"){X=new m6.IPCMessageReader(process),Z=new m6.IPCMessageWriter(process);break}else if(F==="--stdio"){J=!0,X=process.stdin,Z=process.stdout;break}else if(F==="--socket"){H=parseInt(L[A+1]);break}else if(F==="--pipe"){U=L[A+1];break}else{var Y=F.split("=");if(Y[0]==="--socket"){H=parseInt(Y[1]);break}else if(Y[0]==="--pipe"){U=Y[1];break}}}if(H){let A=(0,m6.createServerSocketTransport)(H);X=A[0],Z=A[1]}else if(U){let A=(0,m6.createServerPipeTransport)(U);X=A[0],Z=A[1]}}var $="Use arguments of createConnection or set command line parameters: '--node-ipc', '--stdio' or '--socket={number}'";if(!X)throw Error("Connection input stream is not set. "+$);if(!Z)throw Error("Connection output stream is not set. "+$);if(ZJ.func(X.read)&&ZJ.func(X.on)){let H=X;H.on("end",()=>{K4(),process.exit(D9?0:1)}),H.on("close",()=>{K4(),process.exit(D9?0:1)})}let z=(H)=>{let U=(0,m6.createProtocolConnection)(X,Z,H,Q);if(J)_T(H);return U};return(0,ET.createConnection)(z,jT,G)}function _T(X){function Z(G){return G.map((J)=>typeof J==="string"?J:(0,LW.inspect)(J)).join(" ")}let Q=new Map;console.assert=function(J,...Y){if(J)return;if(Y.length===0)X.error("Assertion failed");else{let[$,...z]=Y;X.error(`Assertion failed: ${$} ${Z(z)}`)}},console.count=function(J="default"){let Y=String(J),$=Q.get(Y)??0;$+=1,Q.set(Y,$),X.log(`${Y}: ${Y}`)},console.countReset=function(J){if(J===void 0)Q.clear();else Q.delete(String(J))},console.debug=function(...J){X.log(Z(J))},console.dir=function(J,Y){X.log((0,LW.inspect)(J,Y))},console.log=function(...J){X.log(Z(J))},console.error=function(...J){X.error(Z(J))},console.trace=function(...J){let Y=Error().stack.replace(/(.+\n){2}/,""),$="Trace";if(J.length!==0)$+=`: ${Z(J)}`;X.log(`${$}
${Y}`)},console.warn=function(...J){X.warn(Z(J))}}});var z0=D((vT)=>{var GJ=Symbol.for("yaml.alias"),TW=Symbol.for("yaml.document"),M4=Symbol.for("yaml.map"),qW=Symbol.for("yaml.pair"),JJ=Symbol.for("yaml.scalar"),N4=Symbol.for("yaml.seq"),Q6=Symbol.for("yaml.node.type"),ST=(X)=>!!X&&typeof X==="object"&&X[Q6]===GJ,bT=(X)=>!!X&&typeof X==="object"&&X[Q6]===TW,RT=(X)=>!!X&&typeof X==="object"&&X[Q6]===M4,yT=(X)=>!!X&&typeof X==="object"&&X[Q6]===qW,EW=(X)=>!!X&&typeof X==="object"&&X[Q6]===JJ,fT=(X)=>!!X&&typeof X==="object"&&X[Q6]===N4;function PW(X){if(X&&typeof X==="object")switch(X[Q6]){case M4:case N4:return!0}return!1}function kT(X){if(X&&typeof X==="object")switch(X[Q6]){case GJ:case M4:case JJ:case N4:return!0}return!1}var xT=(X)=>(EW(X)||PW(X))&&!!X.anchor;vT.ALIAS=GJ;vT.DOC=TW;vT.MAP=M4;vT.NODE_TYPE=Q6;vT.PAIR=qW;vT.SCALAR=JJ;vT.SEQ=N4;vT.hasAnchor=xT;vT.isAlias=ST;vT.isCollection=PW;vT.isDocument=bT;vT.isMap=RT;vT.isNode=kT;vT.isPair=yT;vT.isScalar=EW;vT.isSeq=fT});var IZ=D((Xq)=>{var k0=z0(),e0=Symbol("break visit"),jW=Symbol("skip children"),pX=Symbol("remove node");function T4(X,Z){let Q=DW(Z);if(k0.isDocument(X)){if(_9(null,X.contents,Q,Object.freeze([X]))===pX)X.contents=null}else _9(null,X,Q,Object.freeze([]))}T4.BREAK=e0;T4.SKIP=jW;T4.REMOVE=pX;function _9(X,Z,Q,G){let J=IW(X,Z,Q,G);if(k0.isNode(J)||k0.isPair(J))return _W(X,G,J),_9(X,J,Q,G);if(typeof J!=="symbol"){if(k0.isCollection(Z)){G=Object.freeze(G.concat(Z));for(let Y=0;Y<Z.items.length;++Y){let $=_9(Y,Z.items[Y],Q,G);if(typeof $==="number")Y=$-1;else if($===e0)return e0;else if($===pX)Z.items.splice(Y,1),Y-=1}}else if(k0.isPair(Z)){G=Object.freeze(G.concat(Z));let Y=_9("key",Z.key,Q,G);if(Y===e0)return e0;else if(Y===pX)Z.key=null;let $=_9("value",Z.value,Q,G);if($===e0)return e0;else if($===pX)Z.value=null}}return J}async function q4(X,Z){let Q=DW(Z);if(k0.isDocument(X)){if(await C9(null,X.contents,Q,Object.freeze([X]))===pX)X.contents=null}else await C9(null,X,Q,Object.freeze([]))}q4.BREAK=e0;q4.SKIP=jW;q4.REMOVE=pX;async function C9(X,Z,Q,G){let J=await IW(X,Z,Q,G);if(k0.isNode(J)||k0.isPair(J))return _W(X,G,J),C9(X,J,Q,G);if(typeof J!=="symbol"){if(k0.isCollection(Z)){G=Object.freeze(G.concat(Z));for(let Y=0;Y<Z.items.length;++Y){let $=await C9(Y,Z.items[Y],Q,G);if(typeof $==="number")Y=$-1;else if($===e0)return e0;else if($===pX)Z.items.splice(Y,1),Y-=1}}else if(k0.isPair(Z)){G=Object.freeze(G.concat(Z));let Y=await C9("key",Z.key,Q,G);if(Y===e0)return e0;else if(Y===pX)Z.key=null;let $=await C9("value",Z.value,Q,G);if($===e0)return e0;else if($===pX)Z.value=null}}return J}function DW(X){if(typeof X==="object"&&(X.Collection||X.Node||X.Value))return Object.assign({Alias:X.Node,Map:X.Node,Scalar:X.Node,Seq:X.Node},X.Value&&{Map:X.Value,Scalar:X.Value,Seq:X.Value},X.Collection&&{Map:X.Collection,Seq:X.Collection},X);return X}function IW(X,Z,Q,G){if(typeof Q==="function")return Q(X,Z,G);if(k0.isMap(Z))return Q.Map?.(X,Z,G);if(k0.isSeq(Z))return Q.Seq?.(X,Z,G);if(k0.isPair(Z))return Q.Pair?.(X,Z,G);if(k0.isScalar(Z))return Q.Scalar?.(X,Z,G);if(k0.isAlias(Z))return Q.Alias?.(X,Z,G);return}function _W(X,Z,Q){let G=Z[Z.length-1];if(k0.isCollection(G))G.items[X]=Q;else if(k0.isPair(G))if(X==="key")G.key=Q;else G.value=Q;else if(k0.isDocument(G))G.contents=Q;else{let J=k0.isAlias(G)?"alias":"scalar";throw Error(`Cannot replace node with ${J} parent`)}}Xq.visit=T4;Xq.visitAsync=q4});var YJ=D(($q)=>{var CW=z0(),Gq=IZ(),Jq={"!":"%21",",":"%2C","[":"%5B","]":"%5D","{":"%7B","}":"%7D"},Yq=(X)=>X.replace(/[!,[\]{}]/g,(Z)=>Jq[Z]);class wX{constructor(X,Z){this.docStart=null,this.docEnd=!1,this.yaml=Object.assign({},wX.defaultYaml,X),this.tags=Object.assign({},wX.defaultTags,Z)}clone(){let X=new wX(this.yaml,this.tags);return X.docStart=this.docStart,X}atDocument(){let X=new wX(this.yaml,this.tags);switch(this.yaml.version){case"1.1":this.atNextDocument=!0;break;case"1.2":this.atNextDocument=!1,this.yaml={explicit:wX.defaultYaml.explicit,version:"1.2"},this.tags=Object.assign({},wX.defaultTags);break}return X}add(X,Z){if(this.atNextDocument)this.yaml={explicit:wX.defaultYaml.explicit,version:"1.1"},this.tags=Object.assign({},wX.defaultTags),this.atNextDocument=!1;let Q=X.trim().split(/[ \t]+/),G=Q.shift();switch(G){case"%TAG":{if(Q.length!==2){if(Z(0,"%TAG directive should contain exactly two parts"),Q.length<2)return!1}let[J,Y]=Q;return this.tags[J]=Y,!0}case"%YAML":{if(this.yaml.explicit=!0,Q.length!==1)return Z(0,"%YAML directive should contain exactly one part"),!1;let[J]=Q;if(J==="1.1"||J==="1.2")return this.yaml.version=J,!0;else{let Y=/^\d+\.\d+$/.test(J);return Z(6,`Unsupported YAML version ${J}`,Y),!1}}default:return Z(0,`Unknown directive ${G}`,!0),!1}}tagName(X,Z){if(X==="!")return"!";if(X[0]!=="!")return Z(`Not a valid tag: ${X}`),null;if(X[1]==="<"){let Y=X.slice(2,-1);if(Y==="!"||Y==="!!")return Z(`Verbatim tags aren't resolved, so ${X} is invalid.`),null;if(X[X.length-1]!==">")Z("Verbatim tags must end with a >");return Y}let[,Q,G]=X.match(/^(.*!)([^!]*)$/s);if(!G)Z(`The ${X} tag has no suffix`);let J=this.tags[Q];if(J)try{return J+decodeURIComponent(G)}catch(Y){return Z(String(Y)),null}if(Q==="!")return X;return Z(`Could not resolve tag: ${X}`),null}tagString(X){for(let[Z,Q]of Object.entries(this.tags))if(X.startsWith(Q))return Z+Yq(X.substring(Q.length));return X[0]==="!"?X:`!<${X}>`}toString(X){let Z=this.yaml.explicit?[`%YAML ${this.yaml.version||"1.2"}`]:[],Q=Object.entries(this.tags),G;if(X&&Q.length>0&&CW.isNode(X.contents)){let J={};Gq.visit(X.contents,(Y,$)=>{if(CW.isNode($)&&$.tag)J[$.tag]=!0}),G=Object.keys(J)}else G=[];for(let[J,Y]of Q){if(J==="!!"&&Y==="tag:yaml.org,2002:")continue;if(!X||G.some(($)=>$.startsWith(Y)))Z.push(`%TAG ${J} ${Y}`)}return Z.join(`
`)}}wX.defaultYaml={explicit:!1,version:"1.2"};wX.defaultTags={"!!":"tag:yaml.org,2002:"};$q.Directives=wX});var E4=D((Vq)=>{var SW=z0(),Hq=IZ();function Uq(X){if(/[\x00-\x19\s,[\]{}]/.test(X)){let Q=`Anchor must not contain whitespace or control characters: ${JSON.stringify(X)}`;throw Error(Q)}return!0}function bW(X){let Z=new Set;return Hq.visit(X,{Value(Q,G){if(G.anchor)Z.add(G.anchor)}}),Z}function RW(X,Z){for(let Q=1;;++Q){let G=`${X}${Q}`;if(!Z.has(G))return G}}function Wq(X,Z){let Q=[],G=new Map,J=null;return{onAnchor:(Y)=>{Q.push(Y),J??(J=bW(X));let $=RW(Z,J);return J.add($),$},setAnchors:()=>{for(let Y of Q){let $=G.get(Y);if(typeof $==="object"&&$.anchor&&(SW.isScalar($.node)||SW.isCollection($.node)))$.node.anchor=$.anchor;else{let z=Error("Failed to resolve repeated object (this should not happen)");throw z.source=Y,z}}},sourceObjects:G}}Vq.anchorIsValid=Uq;Vq.anchorNames=bW;Vq.createNodeAnchors=Wq;Vq.findNewAnchor=RW});var $J=D((Oq)=>{function _Z(X,Z,Q,G){if(G&&typeof G==="object")if(Array.isArray(G))for(let J=0,Y=G.length;J<Y;++J){let $=G[J],z=_Z(X,G,String(J),$);if(z===void 0)delete G[J];else if(z!==$)G[J]=z}else if(G instanceof Map)for(let J of Array.from(G.keys())){let Y=G.get(J),$=_Z(X,G,J,Y);if($===void 0)G.delete(J);else if($!==Y)G.set(J,$)}else if(G instanceof Set)for(let J of Array.from(G)){let Y=_Z(X,G,J,J);if(Y===void 0)G.delete(J);else if(Y!==J)G.delete(J),G.add(Y)}else for(let[J,Y]of Object.entries(G)){let $=_Z(X,G,J,Y);if($===void 0)delete G[J];else if($!==Y)G[J]=$}return X.call(Z,Q,G)}Oq.applyReviver=_Z});var F6=D((Mq)=>{var Kq=z0();function yW(X,Z,Q){if(Array.isArray(X))return X.map((G,J)=>yW(G,String(J),Q));if(X&&typeof X.toJSON==="function"){if(!Q||!Kq.hasAnchor(X))return X.toJSON(Z,Q);let G={aliasCount:0,count:1,res:void 0};Q.anchors.set(X,G),Q.onCreate=(Y)=>{G.res=Y,delete Q.onCreate};let J=X.toJSON(Z,Q);if(Q.onCreate)Q.onCreate(J);return J}if(typeof X==="bigint"&&!Q?.keep)return Number(X);return X}Mq.toJS=yW});var P4=D((Eq)=>{var Tq=$J(),fW=z0(),qq=F6();class kW{constructor(X){Object.defineProperty(this,fW.NODE_TYPE,{value:X})}clone(){let X=Object.create(Object.getPrototypeOf(this),Object.getOwnPropertyDescriptors(this));if(this.range)X.range=this.range.slice();return X}toJS(X,{mapAsMap:Z,maxAliasCount:Q,onAnchor:G,reviver:J}={}){if(!fW.isDocument(X))throw TypeError("A document argument is required");let Y={anchors:new Map,doc:X,keep:!0,mapAsMap:Z===!0,mapKeyWarned:!1,maxAliasCount:typeof Q==="number"?Q:100},$=qq.toJS(this,"",Y);if(typeof G==="function")for(let{count:z,res:H}of Y.anchors.values())G(H,z);return typeof J==="function"?Tq.applyReviver(J,{"":$},"",$):$}}Eq.NodeBase=kW});var CZ=D((Cq)=>{var jq=E4(),Dq=IZ(),S9=z0(),Iq=P4(),_q=F6();class xW extends Iq.NodeBase{constructor(X){super(S9.ALIAS);this.source=X,Object.defineProperty(this,"tag",{set(){throw Error("Alias nodes cannot have tags")}})}resolve(X,Z){let Q;if(Z?.aliasResolveCache)Q=Z.aliasResolveCache;else if(Q=[],Dq.visit(X,{Node:(J,Y)=>{if(S9.isAlias(Y)||S9.hasAnchor(Y))Q.push(Y)}}),Z)Z.aliasResolveCache=Q;let G=void 0;for(let J of Q){if(J===this)break;if(J.anchor===this.source)G=J}return G}toJSON(X,Z){if(!Z)return{source:this.source};let{anchors:Q,doc:G,maxAliasCount:J}=Z,Y=this.resolve(G,Z);if(!Y){let z=`Unresolved alias (the anchor must be set before the alias): ${this.source}`;throw ReferenceError(z)}let $=Q.get(Y);if(!$)_q.toJS(Y,null,Z),$=Q.get(Y);if($?.res===void 0)throw ReferenceError("This should not happen: Alias anchor was not resolved?");if(J>=0){if($.count+=1,$.aliasCount===0)$.aliasCount=j4(G,Y,Q);if($.count*$.aliasCount>J)throw ReferenceError("Excessive alias count indicates a resource exhaustion attack")}return $.res}toString(X,Z,Q){let G=`*${this.source}`;if(X){if(jq.anchorIsValid(this.source),X.options.verifyAliasOrder&&!X.anchors.has(this.source)){let J=`Unresolved alias (the anchor must be set before the alias): ${this.source}`;throw Error(J)}if(X.implicitKey)return`${G} `}return G}}function j4(X,Z,Q){if(S9.isAlias(Z)){let G=Z.resolve(X),J=Q&&G&&Q.get(G);return J?J.count*J.aliasCount:0}else if(S9.isCollection(Z)){let G=0;for(let J of Z.items){let Y=j4(X,J,Q);if(Y>G)G=Y}return G}else if(S9.isPair(Z)){let G=j4(X,Z.key,Q),J=j4(X,Z.value,Q);return Math.max(G,J)}return 1}Cq.Alias=xW});var y0=D((kq)=>{var bq=z0(),Rq=P4(),yq=F6(),fq=(X)=>!X||typeof X!=="function"&&typeof X!=="object";class p6 extends Rq.NodeBase{constructor(X){super(bq.SCALAR);this.value=X}toJSON(X,Z){return Z?.keep?this.value:yq.toJS(this.value,X,Z)}toString(){return String(this.value)}}p6.BLOCK_FOLDED="BLOCK_FOLDED";p6.BLOCK_LITERAL="BLOCK_LITERAL";p6.PLAIN="PLAIN";p6.QUOTE_DOUBLE="QUOTE_DOUBLE";p6.QUOTE_SINGLE="QUOTE_SINGLE";kq.Scalar=p6;kq.isScalarValue=fq});var SZ=D((pq)=>{var hq=CZ(),d6=z0(),vW=y0(),gq="tag:yaml.org,2002:";function uq(X,Z,Q){if(Z){let G=Q.filter((Y)=>Y.tag===Z),J=G.find((Y)=>!Y.format)??G[0];if(!J)throw Error(`Tag ${Z} not found`);return J}return Q.find((G)=>G.identify?.(X)&&!G.format)}function mq(X,Z,Q){if(d6.isDocument(X))X=X.contents;if(d6.isNode(X))return X;if(d6.isPair(X)){let A=Q.schema[d6.MAP].createNode?.(Q.schema,null,Q);return A.items.push(X),A}if(X instanceof String||X instanceof Number||X instanceof Boolean||typeof BigInt<"u"&&X instanceof BigInt)X=X.valueOf();let{aliasDuplicateObjects:G,onAnchor:J,onTagObj:Y,schema:$,sourceObjects:z}=Q,H=void 0;if(G&&X&&typeof X==="object")if(H=z.get(X),H)return H.anchor??(H.anchor=J(X)),new hq.Alias(H.anchor);else H={anchor:null,node:null},z.set(X,H);if(Z?.startsWith("!!"))Z=gq+Z.slice(2);let U=uq(X,Z,$.tags);if(!U){if(X&&typeof X.toJSON==="function")X=X.toJSON();if(!X||typeof X!=="object"){let A=new vW.Scalar(X);if(H)H.node=A;return A}U=X instanceof Map?$[d6.MAP]:(Symbol.iterator in Object(X))?$[d6.SEQ]:$[d6.MAP]}if(Y)Y(U),delete Q.onTagObj;let L=U?.createNode?U.createNode(Q.schema,X,Q):typeof U?.nodeClass?.from==="function"?U.nodeClass.from(Q.schema,X,Q):new vW.Scalar(X);if(Z)L.tag=Z;else if(!U.default)L.tag=U.tag;if(H)H.node=L;return L}pq.createNode=mq});var D4=D((iq)=>{var lq=SZ(),dX=z0(),cq=P4();function zJ(X,Z,Q){let G=Q;for(let J=Z.length-1;J>=0;--J){let Y=Z[J];if(typeof Y==="number"&&Number.isInteger(Y)&&Y>=0){let $=[];$[Y]=G,G=$}else G=new Map([[Y,G]])}return lq.createNode(G,void 0,{aliasDuplicateObjects:!1,keepUndefined:!1,onAnchor:()=>{throw Error("This should not happen, please report a bug.")},schema:X,sourceObjects:new Map})}var hW=(X)=>X==null||typeof X==="object"&&!!X[Symbol.iterator]().next().done;class gW extends cq.NodeBase{constructor(X,Z){super(X);Object.defineProperty(this,"schema",{value:Z,configurable:!0,enumerable:!1,writable:!0})}clone(X){let Z=Object.create(Object.getPrototypeOf(this),Object.getOwnPropertyDescriptors(this));if(X)Z.schema=X;if(Z.items=Z.items.map((Q)=>dX.isNode(Q)||dX.isPair(Q)?Q.clone(X):Q),this.range)Z.range=this.range.slice();return Z}addIn(X,Z){if(hW(X))this.add(Z);else{let[Q,...G]=X,J=this.get(Q,!0);if(dX.isCollection(J))J.addIn(G,Z);else if(J===void 0&&this.schema)this.set(Q,zJ(this.schema,G,Z));else throw Error(`Expected YAML collection at ${Q}. Remaining path: ${G}`)}}deleteIn(X){let[Z,...Q]=X;if(Q.length===0)return this.delete(Z);let G=this.get(Z,!0);if(dX.isCollection(G))return G.deleteIn(Q);else throw Error(`Expected YAML collection at ${Z}. Remaining path: ${Q}`)}getIn(X,Z){let[Q,...G]=X,J=this.get(Q,!0);if(G.length===0)return!Z&&dX.isScalar(J)?J.value:J;else return dX.isCollection(J)?J.getIn(G,Z):void 0}hasAllNullValues(X){return this.items.every((Z)=>{if(!dX.isPair(Z))return!1;let Q=Z.value;return Q==null||X&&dX.isScalar(Q)&&Q.value==null&&!Q.commentBefore&&!Q.comment&&!Q.tag})}hasIn(X){let[Z,...Q]=X;if(Q.length===0)return this.has(Z);let G=this.get(Z,!0);return dX.isCollection(G)?G.hasIn(Q):!1}setIn(X,Z){let[Q,...G]=X;if(G.length===0)this.set(Q,Z);else{let J=this.get(Q,!0);if(dX.isCollection(J))J.setIn(G,Z);else if(J===void 0&&this.schema)this.set(Q,zJ(this.schema,G,Z));else throw Error(`Expected YAML collection at ${Q}. Remaining path: ${G}`)}}}iq.Collection=gW;iq.collectionFromPath=zJ;iq.isEmptyPath=hW});var bZ=D((tq)=>{var rq=(X)=>X.replace(/^(?!$)(?: $)?/gm,"#");function HJ(X,Z){if(/^\n+$/.test(X))return X.substring(1);return Z?X.replace(/^(?! *$)/gm,Z):X}var aq=(X,Z,Q)=>X.endsWith(`
`)?HJ(Q,Z):Q.includes(`
`)?`
`+HJ(Q,Z):(X.endsWith(" ")?"":" ")+Q;tq.indentComment=HJ;tq.lineComment=aq;tq.stringifyComment=rq});var mW=D((GE)=>{function QE(X,Z,Q="flow",{indentAtStart:G,lineWidth:J=80,minContentWidth:Y=20,onFold:$,onOverflow:z}={}){if(!J||J<0)return X;if(J<Y)Y=0;let H=Math.max(1+Y,1+J-Z.length);if(X.length<=H)return X;let U=[],L={},A=J-Z.length;if(typeof G==="number")if(G>J-Math.max(2,Y))U.push(0);else A=J-G;let F=void 0,j=void 0,R=!1,T=-1,P=-1,y=-1;if(Q==="block"){if(T=uW(X,T,Z.length),T!==-1)A=T+H}for(let K;K=X[T+=1];){if(Q==="quoted"&&K==="\\"){switch(P=T,X[T+1]){case"x":T+=3;break;case"u":T+=5;break;case"U":T+=9;break;default:T+=1}y=T}if(K===`
`){if(Q==="block")T=uW(X,T,Z.length);A=T+Z.length+H,F=void 0}else{if(K===" "&&j&&j!==" "&&j!==`
`&&j!=="\t"){let _=X[T+1];if(_&&_!==" "&&_!==`
`&&_!=="\t")F=T}if(T>=A)if(F)U.push(F),A=F+H,F=void 0;else if(Q==="quoted"){while(j===" "||j==="\t")j=K,K=X[T+=1],R=!0;let _=T>y+1?T-2:P-1;if(L[_])return X;U.push(_),L[_]=!0,A=_+H,F=void 0}else R=!0}j=K}if(R&&z)z();if(U.length===0)return X;if($)$();let M=X.slice(0,U[0]);for(let K=0;K<U.length;++K){let _=U[K],x=U[K+1]||X.length;if(_===0)M=`
${Z}${X.slice(0,x)}`;else{if(Q==="quoted"&&L[_])M+=`${X[_]}\\`;M+=`
${Z}${X.slice(_+1,x)}`}}return M}function uW(X,Z,Q){let G=Z,J=Z+1,Y=X[J];while(Y===" "||Y==="\t")if(Z<J+Q)Y=X[++Z];else{do Y=X[++Z];while(Y&&Y!==`
`);G=Z,J=Z+1,Y=X[J]}return G}GE.FOLD_BLOCK="block";GE.FOLD_FLOW="flow";GE.FOLD_QUOTED="quoted";GE.foldFlowLines=QE});var yZ=D((VE)=>{var bX=y0(),O6=mW(),_4=(X,Z)=>({indentAtStart:Z?X.indent.length:X.indentAtStart,lineWidth:X.options.lineWidth,minContentWidth:X.options.minContentWidth}),C4=(X)=>/^(%|---|\.\.\.)/m.test(X);function HE(X,Z,Q){if(!Z||Z<0)return!1;let G=Z-Q,J=X.length;if(J<=G)return!1;for(let Y=0,$=0;Y<J;++Y)if(X[Y]===`
`){if(Y-$>G)return!0;if($=Y+1,J-$<=G)return!1}return!0}function RZ(X,Z){let Q=JSON.stringify(X);if(Z.options.doubleQuotedAsJSON)return Q;let{implicitKey:G}=Z,J=Z.options.doubleQuotedMinMultiLineLength,Y=Z.indent||(C4(X)?"  ":""),$="",z=0;for(let H=0,U=Q[H];U;U=Q[++H]){if(U===" "&&Q[H+1]==="\\"&&Q[H+2]==="n")$+=Q.slice(z,H)+"\\ ",H+=1,z=H,U="\\";if(U==="\\")switch(Q[H+1]){case"u":{$+=Q.slice(z,H);let L=Q.substr(H+2,4);switch(L){case"0000":$+="\\0";break;case"0007":$+="\\a";break;case"000b":$+="\\v";break;case"001b":$+="\\e";break;case"0085":$+="\\N";break;case"00a0":$+="\\_";break;case"2028":$+="\\L";break;case"2029":$+="\\P";break;default:if(L.substr(0,2)==="00")$+="\\x"+L.substr(2);else $+=Q.substr(H,6)}H+=5,z=H+1}break;case"n":if(G||Q[H+2]==='"'||Q.length<J)H+=1;else{$+=Q.slice(z,H)+`

`;while(Q[H+2]==="\\"&&Q[H+3]==="n"&&Q[H+4]!=='"')$+=`
`,H+=2;if($+=Y,Q[H+2]===" ")$+="\\";H+=1,z=H+1}break;default:H+=1}}return $=z?$+Q.slice(z):Q,G?$:O6.foldFlowLines($,Y,O6.FOLD_QUOTED,_4(Z,!1))}function UJ(X,Z){if(Z.options.singleQuote===!1||Z.implicitKey&&X.includes(`
`)||/[ \t]\n|\n[ \t]/.test(X))return RZ(X,Z);let Q=Z.indent||(C4(X)?"  ":""),G="'"+X.replace(/'/g,"''").replace(/\n+/g,`$&
${Q}`)+"'";return Z.implicitKey?G:O6.foldFlowLines(G,Q,O6.FOLD_FLOW,_4(Z,!1))}function b9(X,Z){let{singleQuote:Q}=Z.options,G;if(Q===!1)G=RZ;else{let J=X.includes('"'),Y=X.includes("'");if(J&&!Y)G=UJ;else if(Y&&!J)G=RZ;else G=Q?UJ:RZ}return G(X,Z)}var WJ;try{WJ=new RegExp(`(^|(?<!
))
+(?!
|$)`,"g")}catch{WJ=/\n+(?!\n|$)/g}function I4({comment:X,type:Z,value:Q},G,J,Y){let{blockQuote:$,commentString:z,lineWidth:H}=G.options;if(!$||/\n[\t ]+$/.test(Q))return b9(Q,G);let U=G.indent||(G.forceBlockIndent||C4(Q)?"  ":""),L=$==="literal"?!0:$==="folded"||Z===bX.Scalar.BLOCK_FOLDED?!1:Z===bX.Scalar.BLOCK_LITERAL?!0:!HE(Q,H,U.length);if(!Q)return L?`|
`:`>
`;let A,F;for(F=Q.length;F>0;--F){let x=Q[F-1];if(x!==`
`&&x!=="\t"&&x!==" ")break}let j=Q.substring(F),R=j.indexOf(`
`);if(R===-1)A="-";else if(Q===j||R!==j.length-1){if(A="+",Y)Y()}else A="";if(j){if(Q=Q.slice(0,-j.length),j[j.length-1]===`
`)j=j.slice(0,-1);j=j.replace(WJ,`$&${U}`)}let T=!1,P,y=-1;for(P=0;P<Q.length;++P){let x=Q[P];if(x===" ")T=!0;else if(x===`
`)y=P;else break}let M=Q.substring(0,y<P?y+1:P);if(M)Q=Q.substring(M.length),M=M.replace(/\n+/g,`$&${U}`);let _=(T?U?"2":"1":"")+A;if(X){if(_+=" "+z(X.replace(/ ?[\r\n]+/g," ")),J)J()}if(!L){let x=Q.replace(/\n+/g,`
$&`).replace(/(?:^|\n)([\t ].*)(?:([\n\t ]*)\n(?![\n\t ]))?/g,"$1$2").replace(/\n+/g,`$&${U}`),m=!1,n=_4(G,!0);if($!=="folded"&&Z!==bX.Scalar.BLOCK_FOLDED)n.onOverflow=()=>{m=!0};let u=O6.foldFlowLines(`${M}${x}${j}`,U,O6.FOLD_BLOCK,n);if(!m)return`>${_}
${U}${u}`}return Q=Q.replace(/\n+/g,`$&${U}`),`|${_}
${U}${M}${Q}${j}`}function UE(X,Z,Q,G){let{type:J,value:Y}=X,{actualString:$,implicitKey:z,indent:H,indentStep:U,inFlow:L}=Z;if(z&&Y.includes(`
`)||L&&/[[\]{},]/.test(Y))return b9(Y,Z);if(/^[\n\t ,[\]{}#&*!|>'"%@`]|^[?-]$|^[?-][ \t]|[\n:][ \t]|[ \t]\n|[\n\t ]#|[\n\t :]$/.test(Y))return z||L||!Y.includes(`
`)?b9(Y,Z):I4(X,Z,Q,G);if(!z&&!L&&J!==bX.Scalar.PLAIN&&Y.includes(`
`))return I4(X,Z,Q,G);if(C4(Y)){if(H==="")return Z.forceBlockIndent=!0,I4(X,Z,Q,G);else if(z&&H===U)return b9(Y,Z)}let A=Y.replace(/\n+/g,`$&
${H}`);if($){let F=(T)=>T.default&&T.tag!=="tag:yaml.org,2002:str"&&T.test?.test(A),{compat:j,tags:R}=Z.doc.schema;if(R.some(F)||j?.some(F))return b9(Y,Z)}return z?A:O6.foldFlowLines(A,H,O6.FOLD_FLOW,_4(Z,!1))}function WE(X,Z,Q,G){let{implicitKey:J,inFlow:Y}=Z,$=typeof X.value==="string"?X:Object.assign({},X,{value:String(X.value)}),{type:z}=X;if(z!==bX.Scalar.QUOTE_DOUBLE){if(/[\x00-\x08\x0b-\x1f\x7f-\x9f\u{D800}-\u{DFFF}]/u.test($.value))z=bX.Scalar.QUOTE_DOUBLE}let H=(L)=>{switch(L){case bX.Scalar.BLOCK_FOLDED:case bX.Scalar.BLOCK_LITERAL:return J||Y?b9($.value,Z):I4($,Z,Q,G);case bX.Scalar.QUOTE_DOUBLE:return RZ($.value,Z);case bX.Scalar.QUOTE_SINGLE:return UJ($.value,Z);case bX.Scalar.PLAIN:return UE($,Z,Q,G);default:return null}},U=H(z);if(U===null){let{defaultKeyType:L,defaultStringType:A}=Z.options,F=J&&L||A;if(U=H(F),U===null)throw Error(`Unsupported default string type ${F}`)}return U}VE.stringifyString=WE});var fZ=D((NE)=>{var LE=E4(),w6=z0(),AE=bZ(),FE=yZ();function OE(X,Z){let Q=Object.assign({blockQuote:!0,commentString:AE.stringifyComment,defaultKeyType:null,defaultStringType:"PLAIN",directives:null,doubleQuotedAsJSON:!1,doubleQuotedMinMultiLineLength:40,falseStr:"false",flowCollectionPadding:!0,indentSeq:!0,lineWidth:80,minContentWidth:20,nullStr:"null",simpleKeys:!1,singleQuote:null,trueStr:"true",verifyAliasOrder:!0},X.schema.toStringOptions,Z),G;switch(Q.collectionStyle){case"block":G=!1;break;case"flow":G=!0;break;default:G=null}return{anchors:new Set,doc:X,flowCollectionPadding:Q.flowCollectionPadding?" ":"",indent:"",indentStep:typeof Q.indent==="number"?" ".repeat(Q.indent):"  ",inFlow:G,options:Q}}function wE(X,Z){if(Z.tag){let J=X.filter((Y)=>Y.tag===Z.tag);if(J.length>0)return J.find((Y)=>Y.format===Z.format)??J[0]}let Q=void 0,G;if(w6.isScalar(Z)){G=Z.value;let J=X.filter((Y)=>Y.identify?.(G));if(J.length>1){let Y=J.filter(($)=>$.test);if(Y.length>0)J=Y}Q=J.find((Y)=>Y.format===Z.format)??J.find((Y)=>!Y.format)}else G=Z,Q=X.find((J)=>J.nodeClass&&G instanceof J.nodeClass);if(!Q){let J=G?.constructor?.name??(G===null?"null":typeof G);throw Error(`Tag not resolved for ${J} value`)}return Q}function KE(X,Z,{anchors:Q,doc:G}){if(!G.directives)return"";let J=[],Y=(w6.isScalar(X)||w6.isCollection(X))&&X.anchor;if(Y&&LE.anchorIsValid(Y))Q.add(Y),J.push(`&${Y}`);let $=X.tag??(Z.default?null:Z.tag);if($)J.push(G.directives.tagString($));return J.join(" ")}function ME(X,Z,Q,G){if(w6.isPair(X))return X.toString(Z,Q,G);if(w6.isAlias(X)){if(Z.doc.directives)return X.toString(Z);if(Z.resolvedAliases?.has(X))throw TypeError("Cannot stringify circular structure without alias nodes");else{if(Z.resolvedAliases)Z.resolvedAliases.add(X);else Z.resolvedAliases=new Set([X]);X=X.resolve(Z.doc)}}let J=void 0,Y=w6.isNode(X)?X:Z.doc.createNode(X,{onTagObj:(H)=>J=H});J??(J=wE(Z.doc.schema.tags,Y));let $=KE(Y,J,Z);if($.length>0)Z.indentAtStart=(Z.indentAtStart??0)+$.length+1;let z=typeof J.stringify==="function"?J.stringify(Y,Z,Q,G):w6.isScalar(Y)?FE.stringifyString(Y,Z,Q,G):Y.toString(Z,Q,G);if(!$)return z;return w6.isScalar(Y)||z[0]==="{"||z[0]==="["?`${$} ${z}`:`${$}
${Z.indent}${z}`}NE.createStringifyContext=OE;NE.stringify=ME});var lW=D((PE)=>{var G6=z0(),pW=y0(),dW=fZ(),kZ=bZ();function EE({key:X,value:Z},Q,G,J){let{allNullValues:Y,doc:$,indent:z,indentStep:H,options:{commentString:U,indentSeq:L,simpleKeys:A}}=Q,F=G6.isNode(X)&&X.comment||null;if(A){if(F)throw Error("With simple keys, key nodes cannot have comments");if(G6.isCollection(X)||!G6.isNode(X)&&typeof X==="object")throw Error("With simple keys, collection cannot be used as a key value")}let j=!A&&(!X||F&&Z==null&&!Q.inFlow||G6.isCollection(X)||(G6.isScalar(X)?X.type===pW.Scalar.BLOCK_FOLDED||X.type===pW.Scalar.BLOCK_LITERAL:typeof X==="object"));Q=Object.assign({},Q,{allNullValues:!1,implicitKey:!j&&(A||!Y),indent:z+H});let R=!1,T=!1,P=dW.stringify(X,Q,()=>R=!0,()=>T=!0);if(!j&&!Q.inFlow&&P.length>1024){if(A)throw Error("With simple keys, single line scalar must not span more than 1024 characters");j=!0}if(Q.inFlow){if(Y||Z==null){if(R&&G)G();return P===""?"?":j?`? ${P}`:P}}else if(Y&&!A||Z==null&&j){if(P=`? ${P}`,F&&!R)P+=kZ.lineComment(P,Q.indent,U(F));else if(T&&J)J();return P}if(R)F=null;if(j){if(F)P+=kZ.lineComment(P,Q.indent,U(F));P=`? ${P}
${z}:`}else if(P=`${P}:`,F)P+=kZ.lineComment(P,Q.indent,U(F));let y,M,K;if(G6.isNode(Z))y=!!Z.spaceBefore,M=Z.commentBefore,K=Z.comment;else if(y=!1,M=null,K=null,Z&&typeof Z==="object")Z=$.createNode(Z);if(Q.implicitKey=!1,!j&&!F&&G6.isScalar(Z))Q.indentAtStart=P.length+1;if(T=!1,!L&&H.length>=2&&!Q.inFlow&&!j&&G6.isSeq(Z)&&!Z.flow&&!Z.tag&&!Z.anchor)Q.indent=Q.indent.substring(2);let _=!1,x=dW.stringify(Z,Q,()=>_=!0,()=>T=!0),m=" ";if(F||y||M){if(m=y?`
`:"",M){let n=U(M);m+=`
${kZ.indentComment(n,Q.indent)}`}if(x===""&&!Q.inFlow){if(m===`
`&&K)m=`

`}else m+=`
${Q.indent}`}else if(!j&&G6.isCollection(Z)){let n=x[0],u=x.indexOf(`
`),A0=u!==-1,m0=Q.inFlow??Z.flow??Z.items.length===0;if(A0||!m0){let s0=!1;if(A0&&(n==="&"||n==="!")){let $0=x.indexOf(" ");if(n==="&"&&$0!==-1&&$0<u&&x[$0+1]==="!")$0=x.indexOf(" ",$0+1);if($0===-1||u<$0)s0=!0}if(!s0)m=`
${Q.indent}`}}else if(x===""||x[0]===`
`)m="";if(P+=m+x,Q.inFlow){if(_&&G)G()}else if(K&&!_)P+=kZ.lineComment(P,Q.indent,U(K));else if(T&&J)J();return P}PE.stringifyPair=EE});var VJ=D((_E)=>{var cW=p0("process");function DE(X,...Z){if(X==="debug")console.log(...Z)}function IE(X,Z){if(X==="debug"||X==="warn")if(typeof cW.emitWarning==="function")cW.emitWarning(Z);else console.warn(Z)}_E.debug=DE;_E.warn=IE});var R4=D((RE)=>{var xZ=z0(),iW=y0(),S4="<<",b4={identify:(X)=>X===S4||typeof X==="symbol"&&X.description===S4,default:"key",tag:"tag:yaml.org,2002:merge",test:/^<<$/,resolve:()=>Object.assign(new iW.Scalar(Symbol(S4)),{addToJSMap:oW}),stringify:()=>S4},bE=(X,Z)=>(b4.identify(Z)||xZ.isScalar(Z)&&(!Z.type||Z.type===iW.Scalar.PLAIN)&&b4.identify(Z.value))&&X?.doc.schema.tags.some((Q)=>Q.tag===b4.tag&&Q.default);function oW(X,Z,Q){if(Q=X&&xZ.isAlias(Q)?Q.resolve(X.doc):Q,xZ.isSeq(Q))for(let G of Q.items)BJ(X,Z,G);else if(Array.isArray(Q))for(let G of Q)BJ(X,Z,G);else BJ(X,Z,Q)}function BJ(X,Z,Q){let G=X&&xZ.isAlias(Q)?Q.resolve(X.doc):Q;if(!xZ.isMap(G))throw Error("Merge sources must be maps or map aliases");let J=G.toJSON(null,X,Map);for(let[Y,$]of J)if(Z instanceof Map){if(!Z.has(Y))Z.set(Y,$)}else if(Z instanceof Set)Z.add(Y);else if(!Object.prototype.hasOwnProperty.call(Z,Y))Object.defineProperty(Z,Y,{value:$,writable:!0,enumerable:!0,configurable:!0});return Z}RE.addMergeToJSMap=oW;RE.isMergeKey=bE;RE.merge=b4});var AJ=D((uE)=>{var xE=VJ(),nW=R4(),vE=fZ(),sW=z0(),LJ=F6();function hE(X,Z,{key:Q,value:G}){if(sW.isNode(Q)&&Q.addToJSMap)Q.addToJSMap(X,Z,G);else if(nW.isMergeKey(X,Q))nW.addMergeToJSMap(X,Z,G);else{let J=LJ.toJS(Q,"",X);if(Z instanceof Map)Z.set(J,LJ.toJS(G,J,X));else if(Z instanceof Set)Z.add(J);else{let Y=gE(Q,J,X),$=LJ.toJS(G,Y,X);if(Y in Z)Object.defineProperty(Z,Y,{value:$,writable:!0,enumerable:!0,configurable:!0});else Z[Y]=$}}return Z}function gE(X,Z,Q){if(Z===null)return"";if(typeof Z!=="object")return String(Z);if(sW.isNode(X)&&Q?.doc){let G=vE.createStringifyContext(Q.doc,{});G.anchors=new Set;for(let Y of Q.anchors.keys())G.anchors.add(Y.anchor);G.inFlow=!0,G.inStringifyKey=!0;let J=X.toString(G);if(!Q.mapKeyWarned){let Y=JSON.stringify(J);if(Y.length>40)Y=Y.substring(0,36)+'..."';xE.warn(Q.doc.options.logLevel,`Keys with collection values will be stringified due to JS Object restrictions: ${Y}. Set mapAsMap: true to use object keys.`),Q.mapKeyWarned=!0}return J}return JSON.stringify(Z)}uE.addPairToJSMap=hE});var K6=D((cE)=>{var rW=SZ(),pE=lW(),dE=AJ(),y4=z0();function lE(X,Z,Q){let G=rW.createNode(X,void 0,Q),J=rW.createNode(Z,void 0,Q);return new f4(G,J)}class f4{constructor(X,Z=null){Object.defineProperty(this,y4.NODE_TYPE,{value:y4.PAIR}),this.key=X,this.value=Z}clone(X){let{key:Z,value:Q}=this;if(y4.isNode(Z))Z=Z.clone(X);if(y4.isNode(Q))Q=Q.clone(X);return new f4(Z,Q)}toJSON(X,Z){let Q=Z?.mapAsMap?new Map:{};return dE.addPairToJSMap(Z,Q,this)}toString(X,Z,Q){return X?.doc?pE.stringifyPair(this,X,Z,Q):JSON.stringify(this)}}cE.Pair=f4;cE.createPair=lE});var FJ=D((aE)=>{var l6=z0(),aW=fZ(),k4=bZ();function nE(X,Z,Q){return(Z.inFlow??X.flow?rE:sE)(X,Z,Q)}function sE({comment:X,items:Z},Q,{blockItemPrefix:G,flowChars:J,itemIndent:Y,onChompKeep:$,onComment:z}){let{indent:H,options:{commentString:U}}=Q,L=Object.assign({},Q,{indent:Y,type:null}),A=!1,F=[];for(let R=0;R<Z.length;++R){let T=Z[R],P=null;if(l6.isNode(T)){if(!A&&T.spaceBefore)F.push("");if(x4(Q,F,T.commentBefore,A),T.comment)P=T.comment}else if(l6.isPair(T)){let M=l6.isNode(T.key)?T.key:null;if(M){if(!A&&M.spaceBefore)F.push("");x4(Q,F,M.commentBefore,A)}}A=!1;let y=aW.stringify(T,L,()=>P=null,()=>A=!0);if(P)y+=k4.lineComment(y,Y,U(P));if(A&&P)A=!1;F.push(G+y)}let j;if(F.length===0)j=J.start+J.end;else{j=F[0];for(let R=1;R<F.length;++R){let T=F[R];j+=T?`
${H}${T}`:`
`}}if(X){if(j+=`
`+k4.indentComment(U(X),H),z)z()}else if(A&&$)$();return j}function rE({items:X},Z,{flowChars:Q,itemIndent:G}){let{indent:J,indentStep:Y,flowCollectionPadding:$,options:{commentString:z}}=Z;G+=Y;let H=Object.assign({},Z,{indent:G,inFlow:!0,type:null}),U=!1,L=0,A=[];for(let R=0;R<X.length;++R){let T=X[R],P=null;if(l6.isNode(T)){if(T.spaceBefore)A.push("");if(x4(Z,A,T.commentBefore,!1),T.comment)P=T.comment}else if(l6.isPair(T)){let M=l6.isNode(T.key)?T.key:null;if(M){if(M.spaceBefore)A.push("");if(x4(Z,A,M.commentBefore,!1),M.comment)U=!0}let K=l6.isNode(T.value)?T.value:null;if(K){if(K.comment)P=K.comment;if(K.commentBefore)U=!0}else if(T.value==null&&M?.comment)P=M.comment}if(P)U=!0;let y=aW.stringify(T,H,()=>P=null);if(R<X.length-1)y+=",";if(P)y+=k4.lineComment(y,G,z(P));if(!U&&(A.length>L||y.includes(`
`)))U=!0;A.push(y),L=A.length}let{start:F,end:j}=Q;if(A.length===0)return F+j;else{if(!U){let R=A.reduce((T,P)=>T+P.length+2,2);U=Z.options.lineWidth>0&&R>Z.options.lineWidth}if(U){let R=F;for(let T of A)R+=T?`
${Y}${J}${T}`:`
`;return`${R}
${J}${j}`}else return`${F}${$}${A.join(" ")}${$}${j}`}}function x4({indent:X,options:{commentString:Z}},Q,G,J){if(G&&J)G=G.replace(/^\n+/,"");if(G){let Y=k4.indentComment(Z(G),X);Q.push(Y.trimStart())}}aE.stringifyCollection=nE});var N6=D((GP)=>{var eE=FJ(),XP=AJ(),ZP=D4(),M6=z0(),v4=K6(),QP=y0();function vZ(X,Z){let Q=M6.isScalar(Z)?Z.value:Z;for(let G of X)if(M6.isPair(G)){if(G.key===Z||G.key===Q)return G;if(M6.isScalar(G.key)&&G.key.value===Q)return G}return}class tW extends ZP.Collection{static get tagName(){return"tag:yaml.org,2002:map"}constructor(X){super(M6.MAP,X);this.items=[]}static from(X,Z,Q){let{keepUndefined:G,replacer:J}=Q,Y=new this(X),$=(z,H)=>{if(typeof J==="function")H=J.call(Z,z,H);else if(Array.isArray(J)&&!J.includes(z))return;if(H!==void 0||G)Y.items.push(v4.createPair(z,H,Q))};if(Z instanceof Map)for(let[z,H]of Z)$(z,H);else if(Z&&typeof Z==="object")for(let z of Object.keys(Z))$(z,Z[z]);if(typeof X.sortMapEntries==="function")Y.items.sort(X.sortMapEntries);return Y}add(X,Z){let Q;if(M6.isPair(X))Q=X;else if(!X||typeof X!=="object"||!("key"in X))Q=new v4.Pair(X,X?.value);else Q=new v4.Pair(X.key,X.value);let G=vZ(this.items,Q.key),J=this.schema?.sortMapEntries;if(G){if(!Z)throw Error(`Key ${Q.key} already set`);if(M6.isScalar(G.value)&&QP.isScalarValue(Q.value))G.value.value=Q.value;else G.value=Q.value}else if(J){let Y=this.items.findIndex(($)=>J(Q,$)<0);if(Y===-1)this.items.push(Q);else this.items.splice(Y,0,Q)}else this.items.push(Q)}delete(X){let Z=vZ(this.items,X);if(!Z)return!1;return this.items.splice(this.items.indexOf(Z),1).length>0}get(X,Z){let G=vZ(this.items,X)?.value;return(!Z&&M6.isScalar(G)?G.value:G)??void 0}has(X){return!!vZ(this.items,X)}set(X,Z){this.add(new v4.Pair(X,Z),!0)}toJSON(X,Z,Q){let G=Q?new Q:Z?.mapAsMap?new Map:{};if(Z?.onCreate)Z.onCreate(G);for(let J of this.items)XP.addPairToJSMap(Z,G,J);return G}toString(X,Z,Q){if(!X)return JSON.stringify(this);for(let G of this.items)if(!M6.isPair(G))throw Error(`Map items must all be pairs; found ${JSON.stringify(G)} instead`);if(!X.allNullValues&&this.hasAllNullValues(!1))X=Object.assign({},X,{allNullValues:!0});return eE.stringifyCollection(this,X,{blockItemPrefix:"",flowChars:{start:"{",end:"}"},itemIndent:X.indent||"",onChompKeep:Q,onComment:Z})}}GP.YAMLMap=tW;GP.findPair=vZ});var R9=D((HP)=>{var $P=z0(),eW=N6(),zP={collection:"map",default:!0,nodeClass:eW.YAMLMap,tag:"tag:yaml.org,2002:map",resolve(X,Z){if(!$P.isMap(X))Z("Expected a mapping for this tag");return X},createNode:(X,Z,Q)=>eW.YAMLMap.from(X,Z,Q)};HP.map=zP});var T6=D((FP)=>{var WP=SZ(),VP=FJ(),BP=D4(),g4=z0(),LP=y0(),AP=F6();class XV extends BP.Collection{static get tagName(){return"tag:yaml.org,2002:seq"}constructor(X){super(g4.SEQ,X);this.items=[]}add(X){this.items.push(X)}delete(X){let Z=h4(X);if(typeof Z!=="number")return!1;return this.items.splice(Z,1).length>0}get(X,Z){let Q=h4(X);if(typeof Q!=="number")return;let G=this.items[Q];return!Z&&g4.isScalar(G)?G.value:G}has(X){let Z=h4(X);return typeof Z==="number"&&Z<this.items.length}set(X,Z){let Q=h4(X);if(typeof Q!=="number")throw Error(`Expected a valid index, not ${X}.`);let G=this.items[Q];if(g4.isScalar(G)&&LP.isScalarValue(Z))G.value=Z;else this.items[Q]=Z}toJSON(X,Z){let Q=[];if(Z?.onCreate)Z.onCreate(Q);let G=0;for(let J of this.items)Q.push(AP.toJS(J,String(G++),Z));return Q}toString(X,Z,Q){if(!X)return JSON.stringify(this);return VP.stringifyCollection(this,X,{blockItemPrefix:"- ",flowChars:{start:"[",end:"]"},itemIndent:(X.indent||"")+"  ",onChompKeep:Q,onComment:Z})}static from(X,Z,Q){let{replacer:G}=Q,J=new this(X);if(Z&&Symbol.iterator in Object(Z)){let Y=0;for(let $ of Z){if(typeof G==="function"){let z=Z instanceof Set?$:String(Y++);$=G.call(Z,z,$)}J.items.push(WP.createNode($,void 0,Q))}}return J}}function h4(X){let Z=g4.isScalar(X)?X.value:X;if(Z&&typeof Z==="string")Z=Number(Z);return typeof Z==="number"&&Number.isInteger(Z)&&Z>=0?Z:null}FP.YAMLSeq=XV});var y9=D((MP)=>{var wP=z0(),ZV=T6(),KP={collection:"seq",default:!0,nodeClass:ZV.YAMLSeq,tag:"tag:yaml.org,2002:seq",resolve(X,Z){if(!wP.isSeq(X))Z("Expected a sequence for this tag");return X},createNode:(X,Z,Q)=>ZV.YAMLSeq.from(X,Z,Q)};MP.seq=KP});var hZ=D((EP)=>{var TP=yZ(),qP={identify:(X)=>typeof X==="string",default:!0,tag:"tag:yaml.org,2002:str",resolve:(X)=>X,stringify(X,Z,Q,G){return Z=Object.assign({actualString:!0},Z),TP.stringifyString(X,Z,Q,G)}};EP.string=qP});var u4=D((jP)=>{var QV=y0(),GV={identify:(X)=>X==null,createNode:()=>new QV.Scalar(null),default:!0,tag:"tag:yaml.org,2002:null",test:/^(?:~|[Nn]ull|NULL)?$/,resolve:()=>new QV.Scalar(null),stringify:({source:X},Z)=>typeof X==="string"&&GV.test.test(X)?X:Z.options.nullStr};jP.nullTag=GV});var OJ=D((_P)=>{var IP=y0(),JV={identify:(X)=>typeof X==="boolean",default:!0,tag:"tag:yaml.org,2002:bool",test:/^(?:[Tt]rue|TRUE|[Ff]alse|FALSE)$/,resolve:(X)=>new IP.Scalar(X[0]==="t"||X[0]==="T"),stringify({source:X,value:Z},Q){if(X&&JV.test.test(X)){let G=X[0]==="t"||X[0]==="T";if(Z===G)return X}return Z?Q.options.trueStr:Q.options.falseStr}};_P.boolTag=JV});var f9=D((bP)=>{function SP({format:X,minFractionDigits:Z,tag:Q,value:G}){if(typeof G==="bigint")return String(G);let J=typeof G==="number"?G:Number(G);if(!isFinite(J))return isNaN(J)?".nan":J<0?"-.inf":".inf";let Y=Object.is(G,-0)?"-0":JSON.stringify(G);if(!X&&Z&&(!Q||Q==="tag:yaml.org,2002:float")&&/^\d/.test(Y)){let $=Y.indexOf(".");if($<0)$=Y.length,Y+=".";let z=Z-(Y.length-$-1);while(z-- >0)Y+="0"}return Y}bP.stringifyNumber=SP});var KJ=D((vP)=>{var yP=y0(),wJ=f9(),fP={identify:(X)=>typeof X==="number",default:!0,tag:"tag:yaml.org,2002:float",test:/^(?:[-+]?\.(?:inf|Inf|INF)|\.nan|\.NaN|\.NAN)$/,resolve:(X)=>X.slice(-3).toLowerCase()==="nan"?NaN:X[0]==="-"?Number.NEGATIVE_INFINITY:Number.POSITIVE_INFINITY,stringify:wJ.stringifyNumber},kP={identify:(X)=>typeof X==="number",default:!0,tag:"tag:yaml.org,2002:float",format:"EXP",test:/^[-+]?(?:\.[0-9]+|[0-9]+(?:\.[0-9]*)?)[eE][-+]?[0-9]+$/,resolve:(X)=>parseFloat(X),stringify(X){let Z=Number(X.value);return isFinite(Z)?Z.toExponential():wJ.stringifyNumber(X)}},xP={identify:(X)=>typeof X==="number",default:!0,tag:"tag:yaml.org,2002:float",test:/^[-+]?(?:\.[0-9]+|[0-9]+\.[0-9]*)$/,resolve(X){let Z=new yP.Scalar(parseFloat(X)),Q=X.indexOf(".");if(Q!==-1&&X[X.length-1]==="0")Z.minFractionDigits=X.length-Q-1;return Z},stringify:wJ.stringifyNumber};vP.float=xP;vP.floatExp=kP;vP.floatNaN=fP});var NJ=D((lP)=>{var YV=f9(),m4=(X)=>typeof X==="bigint"||Number.isInteger(X),MJ=(X,Z,Q,{intAsBigInt:G})=>G?BigInt(X):parseInt(X.substring(Z),Q);function $V(X,Z,Q){let{value:G}=X;if(m4(G)&&G>=0)return Q+G.toString(Z);return YV.stringifyNumber(X)}var mP={identify:(X)=>m4(X)&&X>=0,default:!0,tag:"tag:yaml.org,2002:int",format:"OCT",test:/^0o[0-7]+$/,resolve:(X,Z,Q)=>MJ(X,2,8,Q),stringify:(X)=>$V(X,8,"0o")},pP={identify:m4,default:!0,tag:"tag:yaml.org,2002:int",test:/^[-+]?[0-9]+$/,resolve:(X,Z,Q)=>MJ(X,0,10,Q),stringify:YV.stringifyNumber},dP={identify:(X)=>m4(X)&&X>=0,default:!0,tag:"tag:yaml.org,2002:int",format:"HEX",test:/^0x[0-9a-fA-F]+$/,resolve:(X,Z,Q)=>MJ(X,2,16,Q),stringify:(X)=>$V(X,16,"0x")};lP.int=pP;lP.intHex=dP;lP.intOct=mP});var zV=D((Xj)=>{var nP=R9(),sP=u4(),rP=y9(),aP=hZ(),tP=OJ(),TJ=KJ(),qJ=NJ(),eP=[nP.map,rP.seq,aP.string,sP.nullTag,tP.boolTag,qJ.intOct,qJ.int,qJ.intHex,TJ.floatNaN,TJ.floatExp,TJ.float];Xj.schema=eP});var UV=D((Hj)=>{var Qj=y0(),Gj=R9(),Jj=y9();function HV(X){return typeof X==="bigint"||Number.isInteger(X)}var p4=({value:X})=>JSON.stringify(X),Yj=[{identify:(X)=>typeof X==="string",default:!0,tag:"tag:yaml.org,2002:str",resolve:(X)=>X,stringify:p4},{identify:(X)=>X==null,createNode:()=>new Qj.Scalar(null),default:!0,tag:"tag:yaml.org,2002:null",test:/^null$/,resolve:()=>null,stringify:p4},{identify:(X)=>typeof X==="boolean",default:!0,tag:"tag:yaml.org,2002:bool",test:/^true$|^false$/,resolve:(X)=>X==="true",stringify:p4},{identify:HV,default:!0,tag:"tag:yaml.org,2002:int",test:/^-?(?:0|[1-9][0-9]*)$/,resolve:(X,Z,{intAsBigInt:Q})=>Q?BigInt(X):parseInt(X,10),stringify:({value:X})=>HV(X)?X.toString():JSON.stringify(X)},{identify:(X)=>typeof X==="number",default:!0,tag:"tag:yaml.org,2002:float",test:/^-?(?:0|[1-9][0-9]*)(?:\.[0-9]*)?(?:[eE][-+]?[0-9]+)?$/,resolve:(X)=>parseFloat(X),stringify:p4}],$j={default:!0,tag:"",test:/^/,resolve(X,Z){return Z(`Unresolved plain scalar ${JSON.stringify(X)}`),X}},zj=[Gj.map,Jj.seq].concat(Yj,$j);Hj.schema=zj});var PJ=D((Bj)=>{var gZ=p0("buffer"),EJ=y0(),Wj=yZ(),Vj={identify:(X)=>X instanceof Uint8Array,default:!1,tag:"tag:yaml.org,2002:binary",resolve(X,Z){if(typeof gZ.Buffer==="function")return gZ.Buffer.from(X,"base64");else if(typeof atob==="function"){let Q=atob(X.replace(/[\n\r]/g,"")),G=new Uint8Array(Q.length);for(let J=0;J<Q.length;++J)G[J]=Q.charCodeAt(J);return G}else return Z("This environment does not support reading binary tags; either Buffer or atob is required"),X},stringify({comment:X,type:Z,value:Q},G,J,Y){if(!Q)return"";let $=Q,z;if(typeof gZ.Buffer==="function")z=$ instanceof gZ.Buffer?$.toString("base64"):gZ.Buffer.from($.buffer).toString("base64");else if(typeof btoa==="function"){let H="";for(let U=0;U<$.length;++U)H+=String.fromCharCode($[U]);z=btoa(H)}else throw Error("This environment does not support writing binary tags; either Buffer or btoa is required");if(Z??(Z=EJ.Scalar.BLOCK_LITERAL),Z!==EJ.Scalar.QUOTE_DOUBLE){let H=Math.max(G.options.lineWidth-G.indent.length,G.options.minContentWidth),U=Math.ceil(z.length/H),L=Array(U);for(let A=0,F=0;A<U;++A,F+=H)L[A]=z.substr(F,H);z=L.join(Z===EJ.Scalar.BLOCK_LITERAL?`
`:" ")}return Wj.stringifyString({comment:X,type:Z,value:z},G,J,Y)}};Bj.binary=Vj});var l4=D((wj)=>{var d4=z0(),jJ=K6(),Aj=y0(),Fj=T6();function WV(X,Z){if(d4.isSeq(X))for(let Q=0;Q<X.items.length;++Q){let G=X.items[Q];if(d4.isPair(G))continue;else if(d4.isMap(G)){if(G.items.length>1)Z("Each pair must have its own sequence indicator");let J=G.items[0]||new jJ.Pair(new Aj.Scalar(null));if(G.commentBefore)J.key.commentBefore=J.key.commentBefore?`${G.commentBefore}
${J.key.commentBefore}`:G.commentBefore;if(G.comment){let Y=J.value??J.key;Y.comment=Y.comment?`${G.comment}
${Y.comment}`:G.comment}G=J}X.items[Q]=d4.isPair(G)?G:new jJ.Pair(G)}else Z("Expected a sequence for this tag");return X}function VV(X,Z,Q){let{replacer:G}=Q,J=new Fj.YAMLSeq(X);J.tag="tag:yaml.org,2002:pairs";let Y=0;if(Z&&Symbol.iterator in Object(Z))for(let $ of Z){if(typeof G==="function")$=G.call(Z,String(Y++),$);let z,H;if(Array.isArray($))if($.length===2)z=$[0],H=$[1];else throw TypeError(`Expected [key, value] tuple: ${$}`);else if($&&$ instanceof Object){let U=Object.keys($);if(U.length===1)z=U[0],H=$[z];else throw TypeError(`Expected tuple with one key, not ${U.length} keys`)}else z=$;J.items.push(jJ.createPair(z,H,Q))}return J}var Oj={collection:"seq",default:!1,tag:"tag:yaml.org,2002:pairs",resolve:WV,createNode:VV};wj.createPairs=VV;wj.pairs=Oj;wj.resolvePairs=WV});var IJ=D((Ej)=>{var BV=z0(),DJ=F6(),uZ=N6(),Tj=T6(),LV=l4();class c6 extends Tj.YAMLSeq{constructor(){super();this.add=uZ.YAMLMap.prototype.add.bind(this),this.delete=uZ.YAMLMap.prototype.delete.bind(this),this.get=uZ.YAMLMap.prototype.get.bind(this),this.has=uZ.YAMLMap.prototype.has.bind(this),this.set=uZ.YAMLMap.prototype.set.bind(this),this.tag=c6.tag}toJSON(X,Z){if(!Z)return super.toJSON(X);let Q=new Map;if(Z?.onCreate)Z.onCreate(Q);for(let G of this.items){let J,Y;if(BV.isPair(G))J=DJ.toJS(G.key,"",Z),Y=DJ.toJS(G.value,J,Z);else J=DJ.toJS(G,"",Z);if(Q.has(J))throw Error("Ordered maps must not include duplicate keys");Q.set(J,Y)}return Q}static from(X,Z,Q){let G=LV.createPairs(X,Z,Q),J=new this;return J.items=G.items,J}}c6.tag="tag:yaml.org,2002:omap";var qj={collection:"seq",identify:(X)=>X instanceof Map,nodeClass:c6,default:!1,tag:"tag:yaml.org,2002:omap",resolve(X,Z){let Q=LV.resolvePairs(X,Z),G=[];for(let{key:J}of Q.items)if(BV.isScalar(J))if(G.includes(J.value))Z(`Ordered maps must not include duplicate keys: ${J.value}`);else G.push(J.value);return Object.assign(new c6,Q)},createNode:(X,Z,Q)=>c6.from(X,Z,Q)};Ej.YAMLOMap=c6;Ej.omap=qj});var KV=D((Dj)=>{var AV=y0();function FV({value:X,source:Z},Q){if(Z&&(X?OV:wV).test.test(Z))return Z;return X?Q.options.trueStr:Q.options.falseStr}var OV={identify:(X)=>X===!0,default:!0,tag:"tag:yaml.org,2002:bool",test:/^(?:Y|y|[Yy]es|YES|[Tt]rue|TRUE|[Oo]n|ON)$/,resolve:()=>new AV.Scalar(!0),stringify:FV},wV={identify:(X)=>X===!1,default:!0,tag:"tag:yaml.org,2002:bool",test:/^(?:N|n|[Nn]o|NO|[Ff]alse|FALSE|[Oo]ff|OFF)$/,resolve:()=>new AV.Scalar(!1),stringify:FV};Dj.falseTag=wV;Dj.trueTag=OV});var MV=D((yj)=>{var Cj=y0(),_J=f9(),Sj={identify:(X)=>typeof X==="number",default:!0,tag:"tag:yaml.org,2002:float",test:/^(?:[-+]?\.(?:inf|Inf|INF)|\.nan|\.NaN|\.NAN)$/,resolve:(X)=>X.slice(-3).toLowerCase()==="nan"?NaN:X[0]==="-"?Number.NEGATIVE_INFINITY:Number.POSITIVE_INFINITY,stringify:_J.stringifyNumber},bj={identify:(X)=>typeof X==="number",default:!0,tag:"tag:yaml.org,2002:float",format:"EXP",test:/^[-+]?(?:[0-9][0-9_]*)?(?:\.[0-9_]*)?[eE][-+]?[0-9]+$/,resolve:(X)=>parseFloat(X.replace(/_/g,"")),stringify(X){let Z=Number(X.value);return isFinite(Z)?Z.toExponential():_J.stringifyNumber(X)}},Rj={identify:(X)=>typeof X==="number",default:!0,tag:"tag:yaml.org,2002:float",test:/^[-+]?(?:[0-9][0-9_]*)?\.[0-9_]*$/,resolve(X){let Z=new Cj.Scalar(parseFloat(X.replace(/_/g,""))),Q=X.indexOf(".");if(Q!==-1){let G=X.substring(Q+1).replace(/_/g,"");if(G[G.length-1]==="0")Z.minFractionDigits=G.length}return Z},stringify:_J.stringifyNumber};yj.float=Rj;yj.floatExp=bj;yj.floatNaN=Sj});var TV=D((mj)=>{var NV=f9(),mZ=(X)=>typeof X==="bigint"||Number.isInteger(X);function c4(X,Z,Q,{intAsBigInt:G}){let J=X[0];if(J==="-"||J==="+")Z+=1;if(X=X.substring(Z).replace(/_/g,""),G){switch(Q){case 2:X=`0b${X}`;break;case 8:X=`0o${X}`;break;case 16:X=`0x${X}`;break}let $=BigInt(X);return J==="-"?BigInt(-1)*$:$}let Y=parseInt(X,Q);return J==="-"?-1*Y:Y}function CJ(X,Z,Q){let{value:G}=X;if(mZ(G)){let J=G.toString(Z);return G<0?"-"+Q+J.substr(1):Q+J}return NV.stringifyNumber(X)}var vj={identify:mZ,default:!0,tag:"tag:yaml.org,2002:int",format:"BIN",test:/^[-+]?0b[0-1_]+$/,resolve:(X,Z,Q)=>c4(X,2,2,Q),stringify:(X)=>CJ(X,2,"0b")},hj={identify:mZ,default:!0,tag:"tag:yaml.org,2002:int",format:"OCT",test:/^[-+]?0[0-7_]+$/,resolve:(X,Z,Q)=>c4(X,1,8,Q),stringify:(X)=>CJ(X,8,"0")},gj={identify:mZ,default:!0,tag:"tag:yaml.org,2002:int",test:/^[-+]?[0-9][0-9_]*$/,resolve:(X,Z,Q)=>c4(X,0,10,Q),stringify:NV.stringifyNumber},uj={identify:mZ,default:!0,tag:"tag:yaml.org,2002:int",format:"HEX",test:/^[-+]?0x[0-9a-fA-F_]+$/,resolve:(X,Z,Q)=>c4(X,2,16,Q),stringify:(X)=>CJ(X,16,"0x")};mj.int=gj;mj.intBin=vj;mj.intHex=uj;mj.intOct=hj});var SJ=D((oj)=>{var n4=z0(),i4=K6(),o4=N6();class i6 extends o4.YAMLMap{constructor(X){super(X);this.tag=i6.tag}add(X){let Z;if(n4.isPair(X))Z=X;else if(X&&typeof X==="object"&&"key"in X&&"value"in X&&X.value===null)Z=new i4.Pair(X.key,null);else Z=new i4.Pair(X,null);if(!o4.findPair(this.items,Z.key))this.items.push(Z)}get(X,Z){let Q=o4.findPair(this.items,X);return!Z&&n4.isPair(Q)?n4.isScalar(Q.key)?Q.key.value:Q.key:Q}set(X,Z){if(typeof Z!=="boolean")throw Error(`Expected boolean value for set(key, value) in a YAML set, not ${typeof Z}`);let Q=o4.findPair(this.items,X);if(Q&&!Z)this.items.splice(this.items.indexOf(Q),1);else if(!Q&&Z)this.items.push(new i4.Pair(X))}toJSON(X,Z){return super.toJSON(X,Z,Set)}toString(X,Z,Q){if(!X)return JSON.stringify(this);if(this.hasAllNullValues(!0))return super.toString(Object.assign({},X,{allNullValues:!0}),Z,Q);else throw Error("Set items must all have null values")}static from(X,Z,Q){let{replacer:G}=Q,J=new this(X);if(Z&&Symbol.iterator in Object(Z))for(let Y of Z){if(typeof G==="function")Y=G.call(Z,Y,Y);J.items.push(i4.createPair(Y,null,Q))}return J}}i6.tag="tag:yaml.org,2002:set";var ij={collection:"map",identify:(X)=>X instanceof Set,nodeClass:i6,default:!1,tag:"tag:yaml.org,2002:set",createNode:(X,Z,Q)=>i6.from(X,Z,Q),resolve(X,Z){if(n4.isMap(X))if(X.hasAllNullValues(!0))return Object.assign(new i6,X);else Z("Set items must all have null values");else Z("Expected a mapping for this tag");return X}};oj.YAMLSet=i6;oj.set=ij});var RJ=D((ej)=>{var rj=f9();function bJ(X,Z){let Q=X[0],G=Q==="-"||Q==="+"?X.substring(1):X,J=($)=>Z?BigInt($):Number($),Y=G.replace(/_/g,"").split(":").reduce(($,z)=>$*J(60)+J(z),J(0));return Q==="-"?J(-1)*Y:Y}function qV(X){let{value:Z}=X,Q=($)=>$;if(typeof Z==="bigint")Q=($)=>BigInt($);else if(isNaN(Z)||!isFinite(Z))return rj.stringifyNumber(X);let G="";if(Z<0)G="-",Z*=Q(-1);let J=Q(60),Y=[Z%J];if(Z<60)Y.unshift(0);else if(Z=(Z-Y[0])/J,Y.unshift(Z%J),Z>=60)Z=(Z-Y[0])/J,Y.unshift(Z);return G+Y.map(($)=>String($).padStart(2,"0")).join(":").replace(/000000\d*$/,"")}var aj={identify:(X)=>typeof X==="bigint"||Number.isInteger(X),default:!0,tag:"tag:yaml.org,2002:int",format:"TIME",test:/^[-+]?[0-9][0-9_]*(?::[0-5]?[0-9])+$/,resolve:(X,Z,{intAsBigInt:Q})=>bJ(X,Q),stringify:qV},tj={identify:(X)=>typeof X==="number",default:!0,tag:"tag:yaml.org,2002:float",format:"TIME",test:/^[-+]?[0-9][0-9_]*(?::[0-5]?[0-9])+\.[0-9_]*$/,resolve:(X)=>bJ(X,!1),stringify:qV},EV={identify:(X)=>X instanceof Date,default:!0,tag:"tag:yaml.org,2002:timestamp",test:RegExp("^([0-9]{4})-([0-9]{1,2})-([0-9]{1,2})(?:(?:t|T|[ \\t]+)([0-9]{1,2}):([0-9]{1,2}):([0-9]{1,2}(\\.[0-9]+)?)(?:[ \\t]*(Z|[-+][012]?[0-9](?::[0-9]{2})?))?)?$"),resolve(X){let Z=X.match(EV.test);if(!Z)throw Error("!!timestamp expects a date, starting with yyyy-mm-dd");let[,Q,G,J,Y,$,z]=Z.map(Number),H=Z[7]?Number((Z[7]+"00").substr(1,3)):0,U=Date.UTC(Q,G-1,J,Y||0,$||0,z||0,H),L=Z[8];if(L&&L!=="Z"){let A=bJ(L,!1);if(Math.abs(A)<30)A*=60;U-=60000*A}return new Date(U)},stringify:({value:X})=>X?.toISOString().replace(/(T00:00:00)?\.000Z$/,"")??""};ej.floatTime=tj;ej.intTime=aj;ej.timestamp=EV});var jV=D((LD)=>{var GD=R9(),JD=u4(),YD=y9(),$D=hZ(),zD=PJ(),PV=KV(),yJ=MV(),s4=TV(),HD=R4(),UD=IJ(),WD=l4(),VD=SJ(),fJ=RJ(),BD=[GD.map,YD.seq,$D.string,JD.nullTag,PV.trueTag,PV.falseTag,s4.intBin,s4.intOct,s4.int,s4.intHex,yJ.floatNaN,yJ.floatExp,yJ.float,zD.binary,HD.merge,UD.omap,WD.pairs,VD.set,fJ.intTime,fJ.floatTime,fJ.timestamp];LD.schema=BD});var kV=D((qD)=>{var CV=R9(),FD=u4(),SV=y9(),OD=hZ(),wD=OJ(),kJ=KJ(),xJ=NJ(),KD=zV(),MD=UV(),bV=PJ(),pZ=R4(),RV=IJ(),yV=l4(),DV=jV(),fV=SJ(),r4=RJ(),IV=new Map([["core",KD.schema],["failsafe",[CV.map,SV.seq,OD.string]],["json",MD.schema],["yaml11",DV.schema],["yaml-1.1",DV.schema]]),_V={binary:bV.binary,bool:wD.boolTag,float:kJ.float,floatExp:kJ.floatExp,floatNaN:kJ.floatNaN,floatTime:r4.floatTime,int:xJ.int,intHex:xJ.intHex,intOct:xJ.intOct,intTime:r4.intTime,map:CV.map,merge:pZ.merge,null:FD.nullTag,omap:RV.omap,pairs:yV.pairs,seq:SV.seq,set:fV.set,timestamp:r4.timestamp},ND={"tag:yaml.org,2002:binary":bV.binary,"tag:yaml.org,2002:merge":pZ.merge,"tag:yaml.org,2002:omap":RV.omap,"tag:yaml.org,2002:pairs":yV.pairs,"tag:yaml.org,2002:set":fV.set,"tag:yaml.org,2002:timestamp":r4.timestamp};function TD(X,Z,Q){let G=IV.get(Z);if(G&&!X)return Q&&!G.includes(pZ.merge)?G.concat(pZ.merge):G.slice();let J=G;if(!J)if(Array.isArray(X))J=[];else{let Y=Array.from(IV.keys()).filter(($)=>$!=="yaml11").map(($)=>JSON.stringify($)).join(", ");throw Error(`Unknown schema "${Z}"; use one of ${Y} or define customTags array`)}if(Array.isArray(X))for(let Y of X)J=J.concat(Y);else if(typeof X==="function")J=X(J.slice());if(Q)J=J.concat(pZ.merge);return J.reduce((Y,$)=>{let z=typeof $==="string"?_V[$]:$;if(!z){let H=JSON.stringify($),U=Object.keys(_V).map((L)=>JSON.stringify(L)).join(", ");throw Error(`Unknown custom tag ${H}; use one of ${U}`)}if(!Y.includes(z))Y.push(z);return Y},[])}qD.coreKnownTags=ND;qD.getTags=TD});var gJ=D((CD)=>{var vJ=z0(),jD=R9(),DD=y9(),ID=hZ(),a4=kV(),_D=(X,Z)=>X.key<Z.key?-1:X.key>Z.key?1:0;class hJ{constructor({compat:X,customTags:Z,merge:Q,resolveKnownTags:G,schema:J,sortMapEntries:Y,toStringDefaults:$}){this.compat=Array.isArray(X)?a4.getTags(X,"compat"):X?a4.getTags(null,X):null,this.name=typeof J==="string"&&J||"core",this.knownTags=G?a4.coreKnownTags:{},this.tags=a4.getTags(Z,this.name,Q),this.toStringOptions=$??null,Object.defineProperty(this,vJ.MAP,{value:jD.map}),Object.defineProperty(this,vJ.SCALAR,{value:ID.string}),Object.defineProperty(this,vJ.SEQ,{value:DD.seq}),this.sortMapEntries=typeof Y==="function"?Y:Y===!0?_D:null}clone(){let X=Object.create(hJ.prototype,Object.getOwnPropertyDescriptors(this));return X.tags=this.tags.slice(),X}}CD.Schema=hJ});var xV=D((yD)=>{var bD=z0(),uJ=fZ(),dZ=bZ();function RD(X,Z){let Q=[],G=Z.directives===!0;if(Z.directives!==!1&&X.directives){let H=X.directives.toString(X);if(H)Q.push(H),G=!0;else if(X.directives.docStart)G=!0}if(G)Q.push("---");let J=uJ.createStringifyContext(X,Z),{commentString:Y}=J.options;if(X.commentBefore){if(Q.length!==1)Q.unshift("");let H=Y(X.commentBefore);Q.unshift(dZ.indentComment(H,""))}let $=!1,z=null;if(X.contents){if(bD.isNode(X.contents)){if(X.contents.spaceBefore&&G)Q.push("");if(X.contents.commentBefore){let L=Y(X.contents.commentBefore);Q.push(dZ.indentComment(L,""))}J.forceBlockIndent=!!X.comment,z=X.contents.comment}let H=z?void 0:()=>$=!0,U=uJ.stringify(X.contents,J,()=>z=null,H);if(z)U+=dZ.lineComment(U,"",Y(z));if((U[0]==="|"||U[0]===">")&&Q[Q.length-1]==="---")Q[Q.length-1]=`--- ${U}`;else Q.push(U)}else Q.push(uJ.stringify(X.contents,J));if(X.directives?.docEnd)if(X.comment){let H=Y(X.comment);if(H.includes(`
`))Q.push("..."),Q.push(dZ.indentComment(H,""));else Q.push(`... ${H}`)}else Q.push("...");else{let H=X.comment;if(H&&$)H=H.replace(/^\n+/,"");if(H){if((!$||z)&&Q[Q.length-1]!=="")Q.push("");Q.push(dZ.indentComment(Y(H),""))}}return Q.join(`
`)+`
`}yD.stringifyDocument=RD});var lZ=D((pD)=>{var kD=CZ(),k9=D4(),KX=z0(),xD=K6(),vD=F6(),hD=gJ(),gD=xV(),mJ=E4(),uD=$J(),mD=SZ(),pJ=YJ();class dJ{constructor(X,Z,Q){this.commentBefore=null,this.comment=null,this.errors=[],this.warnings=[],Object.defineProperty(this,KX.NODE_TYPE,{value:KX.DOC});let G=null;if(typeof Z==="function"||Array.isArray(Z))G=Z;else if(Q===void 0&&Z)Q=Z,Z=void 0;let J=Object.assign({intAsBigInt:!1,keepSourceTokens:!1,logLevel:"warn",prettyErrors:!0,strict:!0,stringKeys:!1,uniqueKeys:!0,version:"1.2"},Q);this.options=J;let{version:Y}=J;if(Q?._directives){if(this.directives=Q._directives.atDocument(),this.directives.yaml.explicit)Y=this.directives.yaml.version}else this.directives=new pJ.Directives({version:Y});this.setSchema(Y,Q),this.contents=X===void 0?null:this.createNode(X,G,Q)}clone(){let X=Object.create(dJ.prototype,{[KX.NODE_TYPE]:{value:KX.DOC}});if(X.commentBefore=this.commentBefore,X.comment=this.comment,X.errors=this.errors.slice(),X.warnings=this.warnings.slice(),X.options=Object.assign({},this.options),this.directives)X.directives=this.directives.clone();if(X.schema=this.schema.clone(),X.contents=KX.isNode(this.contents)?this.contents.clone(X.schema):this.contents,this.range)X.range=this.range.slice();return X}add(X){if(x9(this.contents))this.contents.add(X)}addIn(X,Z){if(x9(this.contents))this.contents.addIn(X,Z)}createAlias(X,Z){if(!X.anchor){let Q=mJ.anchorNames(this);X.anchor=!Z||Q.has(Z)?mJ.findNewAnchor(Z||"a",Q):Z}return new kD.Alias(X.anchor)}createNode(X,Z,Q){let G=void 0;if(typeof Z==="function")X=Z.call({"":X},"",X),G=Z;else if(Array.isArray(Z)){let T=(y)=>typeof y==="number"||y instanceof String||y instanceof Number,P=Z.filter(T).map(String);if(P.length>0)Z=Z.concat(P);G=Z}else if(Q===void 0&&Z)Q=Z,Z=void 0;let{aliasDuplicateObjects:J,anchorPrefix:Y,flow:$,keepUndefined:z,onTagObj:H,tag:U}=Q??{},{onAnchor:L,setAnchors:A,sourceObjects:F}=mJ.createNodeAnchors(this,Y||"a"),j={aliasDuplicateObjects:J??!0,keepUndefined:z??!1,onAnchor:L,onTagObj:H,replacer:G,schema:this.schema,sourceObjects:F},R=mD.createNode(X,U,j);if($&&KX.isCollection(R))R.flow=!0;return A(),R}createPair(X,Z,Q={}){let G=this.createNode(X,null,Q),J=this.createNode(Z,null,Q);return new xD.Pair(G,J)}delete(X){return x9(this.contents)?this.contents.delete(X):!1}deleteIn(X){if(k9.isEmptyPath(X)){if(this.contents==null)return!1;return this.contents=null,!0}return x9(this.contents)?this.contents.deleteIn(X):!1}get(X,Z){return KX.isCollection(this.contents)?this.contents.get(X,Z):void 0}getIn(X,Z){if(k9.isEmptyPath(X))return!Z&&KX.isScalar(this.contents)?this.contents.value:this.contents;return KX.isCollection(this.contents)?this.contents.getIn(X,Z):void 0}has(X){return KX.isCollection(this.contents)?this.contents.has(X):!1}hasIn(X){if(k9.isEmptyPath(X))return this.contents!==void 0;return KX.isCollection(this.contents)?this.contents.hasIn(X):!1}set(X,Z){if(this.contents==null)this.contents=k9.collectionFromPath(this.schema,[X],Z);else if(x9(this.contents))this.contents.set(X,Z)}setIn(X,Z){if(k9.isEmptyPath(X))this.contents=Z;else if(this.contents==null)this.contents=k9.collectionFromPath(this.schema,Array.from(X),Z);else if(x9(this.contents))this.contents.setIn(X,Z)}setSchema(X,Z={}){if(typeof X==="number")X=String(X);let Q;switch(X){case"1.1":if(this.directives)this.directives.yaml.version="1.1";else this.directives=new pJ.Directives({version:"1.1"});Q={resolveKnownTags:!1,schema:"yaml-1.1"};break;case"1.2":case"next":if(this.directives)this.directives.yaml.version=X;else this.directives=new pJ.Directives({version:X});Q={resolveKnownTags:!0,schema:"core"};break;case null:if(this.directives)delete this.directives;Q=null;break;default:{let G=JSON.stringify(X);throw Error(`Expected '1.1', '1.2' or null as first argument, but found: ${G}`)}}if(Z.schema instanceof Object)this.schema=Z.schema;else if(Q)this.schema=new hD.Schema(Object.assign(Q,Z));else throw Error("With a null YAML version, the { schema: Schema } option is required")}toJS({json:X,jsonArg:Z,mapAsMap:Q,maxAliasCount:G,onAnchor:J,reviver:Y}={}){let $={anchors:new Map,doc:this,keep:!X,mapAsMap:Q===!0,mapKeyWarned:!1,maxAliasCount:typeof G==="number"?G:100},z=vD.toJS(this.contents,Z??"",$);if(typeof J==="function")for(let{count:H,res:U}of $.anchors.values())J(U,H);return typeof Y==="function"?uD.applyReviver(Y,{"":z},"",z):z}toJSON(X,Z){return this.toJS({json:!0,jsonArg:X,mapAsMap:!1,onAnchor:Z})}toString(X={}){if(this.errors.length>0)throw Error("Document with errors cannot be stringified");if("indent"in X&&(!Number.isInteger(X.indent)||Number(X.indent)<=0)){let Z=JSON.stringify(X.indent);throw Error(`"indent" option must be a positive integer, not ${Z}`)}return gD.stringifyDocument(this,X)}}function x9(X){if(KX.isCollection(X))return!0;throw Error("Expected a YAML collection as document contents")}pD.Document=dJ});var cZ=D((cD)=>{class t4 extends Error{constructor(X,Z,Q,G){super();this.name=X,this.code=Q,this.message=G,this.pos=Z}}class vV extends t4{constructor(X,Z,Q){super("YAMLParseError",X,Z,Q)}}class hV extends t4{constructor(X,Z,Q){super("YAMLWarning",X,Z,Q)}}var lD=(X,Z)=>(Q)=>{if(Q.pos[0]===-1)return;Q.linePos=Q.pos.map((z)=>Z.linePos(z));let{line:G,col:J}=Q.linePos[0];Q.message+=` at line ${G}, column ${J}`;let Y=J-1,$=X.substring(Z.lineStarts[G-1],Z.lineStarts[G]).replace(/[\n\r]+$/,"");if(Y>=60&&$.length>80){let z=Math.min(Y-39,$.length-79);$=""+$.substring(z),Y-=z-1}if($.length>80)$=$.substring(0,79)+"";if(G>1&&/^ *$/.test($.substring(0,Y))){let z=X.substring(Z.lineStarts[G-2],Z.lineStarts[G-1]);if(z.length>80)z=z.substring(0,79)+`
`;$=z+$}if(/[^ ]/.test($)){let z=1,H=Q.linePos[1];if(H?.line===G&&H.col>J)z=Math.max(1,Math.min(H.col-J,80-Y));let U=" ".repeat(Y)+"^".repeat(z);Q.message+=`:

${$}
${U}
`}};cD.YAMLError=t4;cD.YAMLParseError=vV;cD.YAMLWarning=hV;cD.prettifyError=lD});var iZ=D((aD)=>{function rD(X,{flow:Z,indicator:Q,next:G,offset:J,onError:Y,parentIndent:$,startOnNewline:z}){let H=!1,U=z,L=z,A="",F="",j=!1,R=!1,T=null,P=null,y=null,M=null,K=null,_=null,x=null;for(let u of X){if(R){if(u.type!=="space"&&u.type!=="newline"&&u.type!=="comma")Y(u.offset,"MISSING_CHAR","Tags and anchors must be separated from the next token by white space");R=!1}if(T){if(U&&u.type!=="comment"&&u.type!=="newline")Y(T,"TAB_AS_INDENT","Tabs are not allowed as indentation");T=null}switch(u.type){case"space":if(!Z&&(Q!=="doc-start"||G?.type!=="flow-collection")&&u.source.includes("\t"))T=u;L=!0;break;case"comment":{if(!L)Y(u,"MISSING_CHAR","Comments must be separated from other tokens by white space characters");let A0=u.source.substring(1)||" ";if(!A)A=A0;else A+=F+A0;F="",U=!1;break}case"newline":if(U){if(A)A+=u.source;else if(!_||Q!=="seq-item-ind")H=!0}else F+=u.source;if(U=!0,j=!0,P||y)M=u;L=!0;break;case"anchor":if(P)Y(u,"MULTIPLE_ANCHORS","A node can have at most one anchor");if(u.source.endsWith(":"))Y(u.offset+u.source.length-1,"BAD_ALIAS","Anchor ending in : is ambiguous",!0);P=u,x??(x=u.offset),U=!1,L=!1,R=!0;break;case"tag":{if(y)Y(u,"MULTIPLE_TAGS","A node can have at most one tag");y=u,x??(x=u.offset),U=!1,L=!1,R=!0;break}case Q:if(P||y)Y(u,"BAD_PROP_ORDER",`Anchors and tags must be after the ${u.source} indicator`);if(_)Y(u,"UNEXPECTED_TOKEN",`Unexpected ${u.source} in ${Z??"collection"}`);_=u,U=Q==="seq-item-ind"||Q==="explicit-key-ind",L=!1;break;case"comma":if(Z){if(K)Y(u,"UNEXPECTED_TOKEN",`Unexpected , in ${Z}`);K=u,U=!1,L=!1;break}default:Y(u,"UNEXPECTED_TOKEN",`Unexpected ${u.type} token`),U=!1,L=!1}}let m=X[X.length-1],n=m?m.offset+m.source.length:J;if(R&&G&&G.type!=="space"&&G.type!=="newline"&&G.type!=="comma"&&(G.type!=="scalar"||G.source!==""))Y(G.offset,"MISSING_CHAR","Tags and anchors must be separated from the next token by white space");if(T&&(U&&T.indent<=$||G?.type==="block-map"||G?.type==="block-seq"))Y(T,"TAB_AS_INDENT","Tabs are not allowed as indentation");return{comma:K,found:_,spaceBefore:H,comment:A,hasNewline:j,anchor:P,tag:y,newlineAfterProp:M,end:n,start:x??n}}aD.resolveProps=rD});var e4=D((eD)=>{function lJ(X){if(!X)return null;switch(X.type){case"alias":case"scalar":case"double-quoted-scalar":case"single-quoted-scalar":if(X.source.includes(`
`))return!0;if(X.end){for(let Z of X.end)if(Z.type==="newline")return!0}return!1;case"flow-collection":for(let Z of X.items){for(let Q of Z.start)if(Q.type==="newline")return!0;if(Z.sep){for(let Q of Z.sep)if(Q.type==="newline")return!0}if(lJ(Z.key)||lJ(Z.value))return!0}return!1;default:return!0}}eD.containsNewline=lJ});var cJ=D((GI)=>{var ZI=e4();function QI(X,Z,Q){if(Z?.type==="flow-collection"){let G=Z.end[0];if(G.indent===X&&(G.source==="]"||G.source==="}")&&ZI.containsNewline(Z))Q(G,"BAD_INDENT","Flow end indicator should be more indented than parent",!0)}}GI.flowIndentCheck=QI});var iJ=D(($I)=>{var gV=z0();function YI(X,Z,Q){let{uniqueKeys:G}=X.options;if(G===!1)return!1;let J=typeof G==="function"?G:(Y,$)=>Y===$||gV.isScalar(Y)&&gV.isScalar($)&&Y.value===$.value;return Z.some((Y)=>J(Y.key,Q))}$I.mapIncludes=YI});var lV=D((BI)=>{var uV=K6(),HI=N6(),mV=iZ(),UI=e4(),pV=cJ(),WI=iJ(),dV="All mapping items must start at the same column";function VI({composeNode:X,composeEmptyNode:Z},Q,G,J,Y){let z=new(Y?.nodeClass??HI.YAMLMap)(Q.schema);if(Q.atRoot)Q.atRoot=!1;let H=G.offset,U=null;for(let L of G.items){let{start:A,key:F,sep:j,value:R}=L,T=mV.resolveProps(A,{indicator:"explicit-key-ind",next:F??j?.[0],offset:H,onError:J,parentIndent:G.indent,startOnNewline:!0}),P=!T.found;if(P){if(F){if(F.type==="block-seq")J(H,"BLOCK_AS_IMPLICIT_KEY","A block sequence may not be used as an implicit map key");else if("indent"in F&&F.indent!==G.indent)J(H,"BAD_INDENT",dV)}if(!T.anchor&&!T.tag&&!j){if(U=T.end,T.comment)if(z.comment)z.comment+=`
`+T.comment;else z.comment=T.comment;continue}if(T.newlineAfterProp||UI.containsNewline(F))J(F??A[A.length-1],"MULTILINE_IMPLICIT_KEY","Implicit keys need to be on a single line")}else if(T.found?.indent!==G.indent)J(H,"BAD_INDENT",dV);Q.atKey=!0;let y=T.end,M=F?X(Q,F,T,J):Z(Q,y,A,null,T,J);if(Q.schema.compat)pV.flowIndentCheck(G.indent,F,J);if(Q.atKey=!1,WI.mapIncludes(Q,z.items,M))J(y,"DUPLICATE_KEY","Map keys must be unique");let K=mV.resolveProps(j??[],{indicator:"map-value-ind",next:R,offset:M.range[2],onError:J,parentIndent:G.indent,startOnNewline:!F||F.type==="block-scalar"});if(H=K.end,K.found){if(P){if(R?.type==="block-map"&&!K.hasNewline)J(H,"BLOCK_AS_IMPLICIT_KEY","Nested mappings are not allowed in compact mappings");if(Q.options.strict&&T.start<K.found.offset-1024)J(M.range,"KEY_OVER_1024_CHARS","The : indicator must be at most 1024 chars after the start of an implicit block mapping key")}let _=R?X(Q,R,K,J):Z(Q,H,j,null,K,J);if(Q.schema.compat)pV.flowIndentCheck(G.indent,R,J);H=_.range[2];let x=new uV.Pair(M,_);if(Q.options.keepSourceTokens)x.srcToken=L;z.items.push(x)}else{if(P)J(M.range,"MISSING_CHAR","Implicit map keys need to be followed by map values");if(K.comment)if(M.comment)M.comment+=`
`+K.comment;else M.comment=K.comment;let _=new uV.Pair(M);if(Q.options.keepSourceTokens)_.srcToken=L;z.items.push(_)}}if(U&&U<H)J(U,"IMPOSSIBLE","Map comment with trailing content");return z.range=[G.offset,H,U??H],z}BI.resolveBlockMap=VI});var cV=D((KI)=>{var AI=T6(),FI=iZ(),OI=cJ();function wI({composeNode:X,composeEmptyNode:Z},Q,G,J,Y){let z=new(Y?.nodeClass??AI.YAMLSeq)(Q.schema);if(Q.atRoot)Q.atRoot=!1;if(Q.atKey)Q.atKey=!1;let H=G.offset,U=null;for(let{start:L,value:A}of G.items){let F=FI.resolveProps(L,{indicator:"seq-item-ind",next:A,offset:H,onError:J,parentIndent:G.indent,startOnNewline:!0});if(!F.found)if(F.anchor||F.tag||A)if(A?.type==="block-seq")J(F.end,"BAD_INDENT","All sequence items must start at the same column");else J(H,"MISSING_CHAR","Sequence item without - indicator");else{if(U=F.end,F.comment)z.comment=F.comment;continue}let j=A?X(Q,A,F,J):Z(Q,F.end,L,null,F,J);if(Q.schema.compat)OI.flowIndentCheck(G.indent,A,J);H=j.range[2],z.items.push(j)}return z.range=[G.offset,H,U??H],z}KI.resolveBlockSeq=wI});var v9=D((TI)=>{function NI(X,Z,Q,G){let J="";if(X){let Y=!1,$="";for(let z of X){let{source:H,type:U}=z;switch(U){case"space":Y=!0;break;case"comment":{if(Q&&!Y)G(z,"MISSING_CHAR","Comments must be separated from other tokens by white space characters");let L=H.substring(1)||" ";if(!J)J=L;else J+=$+L;$="";break}case"newline":if(J)$+=H;Y=!0;break;default:G(z,"UNEXPECTED_TOKEN",`Unexpected ${U} at node end`)}Z+=H.length}}return{comment:J,offset:Z}}TI.resolveEnd=NI});var nV=D((SI)=>{var EI=z0(),PI=K6(),iV=N6(),jI=T6(),DI=v9(),oV=iZ(),II=e4(),_I=iJ(),oJ="Block collections are not allowed within flow collections",nJ=(X)=>X&&(X.type==="block-map"||X.type==="block-seq");function CI({composeNode:X,composeEmptyNode:Z},Q,G,J,Y){let $=G.start.source==="{",z=$?"flow map":"flow sequence",U=new(Y?.nodeClass??($?iV.YAMLMap:jI.YAMLSeq))(Q.schema);U.flow=!0;let L=Q.atRoot;if(L)Q.atRoot=!1;if(Q.atKey)Q.atKey=!1;let A=G.offset+G.start.source.length;for(let P=0;P<G.items.length;++P){let y=G.items[P],{start:M,key:K,sep:_,value:x}=y,m=oV.resolveProps(M,{flow:z,indicator:"explicit-key-ind",next:K??_?.[0],offset:A,onError:J,parentIndent:G.indent,startOnNewline:!1});if(!m.found){if(!m.anchor&&!m.tag&&!_&&!x){if(P===0&&m.comma)J(m.comma,"UNEXPECTED_TOKEN",`Unexpected , in ${z}`);else if(P<G.items.length-1)J(m.start,"UNEXPECTED_TOKEN",`Unexpected empty item in ${z}`);if(m.comment)if(U.comment)U.comment+=`
`+m.comment;else U.comment=m.comment;A=m.end;continue}if(!$&&Q.options.strict&&II.containsNewline(K))J(K,"MULTILINE_IMPLICIT_KEY","Implicit keys of flow sequence pairs need to be on a single line")}if(P===0){if(m.comma)J(m.comma,"UNEXPECTED_TOKEN",`Unexpected , in ${z}`)}else{if(!m.comma)J(m.start,"MISSING_CHAR",`Missing , between ${z} items`);if(m.comment){let n="";X:for(let u of M)switch(u.type){case"comma":case"space":break;case"comment":n=u.source.substring(1);break X;default:break X}if(n){let u=U.items[U.items.length-1];if(EI.isPair(u))u=u.value??u.key;if(u.comment)u.comment+=`
`+n;else u.comment=n;m.comment=m.comment.substring(n.length+1)}}}if(!$&&!_&&!m.found){let n=x?X(Q,x,m,J):Z(Q,m.end,_,null,m,J);if(U.items.push(n),A=n.range[2],nJ(x))J(n.range,"BLOCK_IN_FLOW",oJ)}else{Q.atKey=!0;let n=m.end,u=K?X(Q,K,m,J):Z(Q,n,M,null,m,J);if(nJ(K))J(u.range,"BLOCK_IN_FLOW",oJ);Q.atKey=!1;let A0=oV.resolveProps(_??[],{flow:z,indicator:"map-value-ind",next:x,offset:u.range[2],onError:J,parentIndent:G.indent,startOnNewline:!1});if(A0.found){if(!$&&!m.found&&Q.options.strict){if(_)for(let $0 of _){if($0===A0.found)break;if($0.type==="newline"){J($0,"MULTILINE_IMPLICIT_KEY","Implicit keys of flow sequence pairs need to be on a single line");break}}if(m.start<A0.found.offset-1024)J(A0.found,"KEY_OVER_1024_CHARS","The : indicator must be at most 1024 chars after the start of an implicit flow sequence key")}}else if(x)if("source"in x&&x.source?.[0]===":")J(x,"MISSING_CHAR",`Missing space after : in ${z}`);else J(A0.start,"MISSING_CHAR",`Missing , or : between ${z} items`);let m0=x?X(Q,x,A0,J):A0.found?Z(Q,A0.end,_,null,A0,J):null;if(m0){if(nJ(x))J(m0.range,"BLOCK_IN_FLOW",oJ)}else if(A0.comment)if(u.comment)u.comment+=`
`+A0.comment;else u.comment=A0.comment;let s0=new PI.Pair(u,m0);if(Q.options.keepSourceTokens)s0.srcToken=y;if($){let $0=U;if(_I.mapIncludes(Q,$0.items,u))J(n,"DUPLICATE_KEY","Map keys must be unique");$0.items.push(s0)}else{let $0=new iV.YAMLMap(Q.schema);$0.flow=!0,$0.items.push(s0);let sX=(m0??u).range;$0.range=[u.range[0],sX[1],sX[2]],U.items.push($0)}A=m0?m0.range[2]:A0.end}}let F=$?"}":"]",[j,...R]=G.end,T=A;if(j?.source===F)T=j.offset+j.source.length;else{let P=z[0].toUpperCase()+z.substring(1),y=L?`${P} must end with a ${F}`:`${P} in block collection must be sufficiently indented and end with a ${F}`;if(J(A,L?"MISSING_CHAR":"BAD_INDENT",y),j&&j.source.length!==1)R.unshift(j)}if(R.length>0){let P=DI.resolveEnd(R,T,Q.options.strict,J);if(P.comment)if(U.comment)U.comment+=`
`+P.comment;else U.comment=P.comment;U.range=[G.offset,T,P.offset]}else U.range=[G.offset,T,T];return U}SI.resolveFlowCollection=CI});var sV=D((uI)=>{var RI=z0(),yI=y0(),fI=N6(),kI=T6(),xI=lV(),vI=cV(),hI=nV();function sJ(X,Z,Q,G,J,Y){let $=Q.type==="block-map"?xI.resolveBlockMap(X,Z,Q,G,Y):Q.type==="block-seq"?vI.resolveBlockSeq(X,Z,Q,G,Y):hI.resolveFlowCollection(X,Z,Q,G,Y),z=$.constructor;if(J==="!"||J===z.tagName)return $.tag=z.tagName,$;if(J)$.tag=J;return $}function gI(X,Z,Q,G,J){let Y=G.tag,$=!Y?null:Z.directives.tagName(Y.source,(F)=>J(Y,"TAG_RESOLVE_FAILED",F));if(Q.type==="block-seq"){let{anchor:F,newlineAfterProp:j}=G,R=F&&Y?F.offset>Y.offset?F:Y:F??Y;if(R&&(!j||j.offset<R.offset))J(R,"MISSING_CHAR","Missing newline after block sequence props")}let z=Q.type==="block-map"?"map":Q.type==="block-seq"?"seq":Q.start.source==="{"?"map":"seq";if(!Y||!$||$==="!"||$===fI.YAMLMap.tagName&&z==="map"||$===kI.YAMLSeq.tagName&&z==="seq")return sJ(X,Z,Q,J,$);let H=Z.schema.tags.find((F)=>F.tag===$&&F.collection===z);if(!H){let F=Z.schema.knownTags[$];if(F?.collection===z)Z.schema.tags.push(Object.assign({},F,{default:!1})),H=F;else{if(F)J(Y,"BAD_COLLECTION_TYPE",`${F.tag} used for ${z} collection, but expects ${F.collection??"scalar"}`,!0);else J(Y,"TAG_RESOLVE_FAILED",`Unresolved tag: ${$}`,!0);return sJ(X,Z,Q,J,$)}}let U=sJ(X,Z,Q,J,$,H),L=H.resolve?.(U,(F)=>J(Y,"TAG_RESOLVE_FAILED",F),Z.options)??U,A=RI.isNode(L)?L:new yI.Scalar(L);if(A.range=U.range,A.tag=$,H?.format)A.format=H.format;return A}uI.composeCollection=gI});var aJ=D((cI)=>{var rJ=y0();function pI(X,Z,Q){let G=Z.offset,J=dI(Z,X.options.strict,Q);if(!J)return{value:"",type:null,comment:"",range:[G,G,G]};let Y=J.mode===">"?rJ.Scalar.BLOCK_FOLDED:rJ.Scalar.BLOCK_LITERAL,$=Z.source?lI(Z.source):[],z=$.length;for(let T=$.length-1;T>=0;--T){let P=$[T][1];if(P===""||P==="\r")z=T;else break}if(z===0){let T=J.chomp==="+"&&$.length>0?`
`.repeat(Math.max(1,$.length-1)):"",P=G+J.length;if(Z.source)P+=Z.source.length;return{value:T,type:Y,comment:J.comment,range:[G,P,P]}}let H=Z.indent+J.indent,U=Z.offset+J.length,L=0;for(let T=0;T<z;++T){let[P,y]=$[T];if(y===""||y==="\r"){if(J.indent===0&&P.length>H)H=P.length}else{if(P.length<H)Q(U+P.length,"MISSING_CHAR","Block scalars with more-indented leading empty lines must use an explicit indentation indicator");if(J.indent===0)H=P.length;if(L=T,H===0&&!X.atRoot)Q(U,"BAD_INDENT","Block scalar values in collections must be indented");break}U+=P.length+y.length+1}for(let T=$.length-1;T>=z;--T)if($[T][0].length>H)z=T+1;let A="",F="",j=!1;for(let T=0;T<L;++T)A+=$[T][0].slice(H)+`
`;for(let T=L;T<z;++T){let[P,y]=$[T];U+=P.length+y.length+1;let M=y[y.length-1]==="\r";if(M)y=y.slice(0,-1);if(y&&P.length<H){let _=`Block scalar lines must not be less indented than their ${J.indent?"explicit indentation indicator":"first line"}`;Q(U-y.length-(M?2:1),"BAD_INDENT",_),P=""}if(Y===rJ.Scalar.BLOCK_LITERAL)A+=F+P.slice(H)+y,F=`
`;else if(P.length>H||y[0]==="\t"){if(F===" ")F=`
`;else if(!j&&F===`
`)F=`

`;A+=F+P.slice(H)+y,F=`
`,j=!0}else if(y==="")if(F===`
`)A+=`
`;else F=`
`;else A+=F+y,F=" ",j=!1}switch(J.chomp){case"-":break;case"+":for(let T=z;T<$.length;++T)A+=`
`+$[T][0].slice(H);if(A[A.length-1]!==`
`)A+=`
`;break;default:A+=`
`}let R=G+J.length+Z.source.length;return{value:A,type:Y,comment:J.comment,range:[G,R,R]}}function dI({offset:X,props:Z},Q,G){if(Z[0].type!=="block-scalar-header")return G(Z[0],"IMPOSSIBLE","Block scalar header not found"),null;let{source:J}=Z[0],Y=J[0],$=0,z="",H=-1;for(let F=1;F<J.length;++F){let j=J[F];if(!z&&(j==="-"||j==="+"))z=j;else{let R=Number(j);if(!$&&R)$=R;else if(H===-1)H=X+F}}if(H!==-1)G(H,"UNEXPECTED_TOKEN",`Block scalar header includes extra characters: ${J}`);let U=!1,L="",A=J.length;for(let F=1;F<Z.length;++F){let j=Z[F];switch(j.type){case"space":U=!0;case"newline":A+=j.source.length;break;case"comment":if(Q&&!U)G(j,"MISSING_CHAR","Comments must be separated from other tokens by white space characters");A+=j.source.length,L=j.source.substring(1);break;case"error":G(j,"UNEXPECTED_TOKEN",j.message),A+=j.source.length;break;default:{let R=`Unexpected token in block scalar header: ${j.type}`;G(j,"UNEXPECTED_TOKEN",R);let T=j.source;if(T&&typeof T==="string")A+=T.length}}}return{mode:Y,indent:$,chomp:z,comment:L,length:A}}function lI(X){let Z=X.split(/\n( *)/),Q=Z[0],G=Q.match(/^( *)/),Y=[G?.[1]?[G[1],Q.slice(G[1].length)]:["",Q]];for(let $=1;$<Z.length;$+=2)Y.push([Z[$],Z[$+1]]);return Y}cI.resolveBlockScalar=pI});var eJ=D((Z_)=>{var tJ=y0(),oI=v9();function nI(X,Z,Q){let{offset:G,type:J,source:Y,end:$}=X,z,H,U=(F,j,R)=>Q(G+F,j,R);switch(J){case"scalar":z=tJ.Scalar.PLAIN,H=sI(Y,U);break;case"single-quoted-scalar":z=tJ.Scalar.QUOTE_SINGLE,H=rI(Y,U);break;case"double-quoted-scalar":z=tJ.Scalar.QUOTE_DOUBLE,H=aI(Y,U);break;default:return Q(X,"UNEXPECTED_TOKEN",`Expected a flow scalar value, but found: ${J}`),{value:"",type:null,comment:"",range:[G,G+Y.length,G+Y.length]}}let L=G+Y.length,A=oI.resolveEnd($,L,Z,Q);return{value:H,type:z,comment:A.comment,range:[G,L,A.offset]}}function sI(X,Z){let Q="";switch(X[0]){case"\t":Q="a tab character";break;case",":Q="flow indicator character ,";break;case"%":Q="directive indicator character %";break;case"|":case">":{Q=`block scalar indicator ${X[0]}`;break}case"@":case"`":{Q=`reserved character ${X[0]}`;break}}if(Q)Z(0,"BAD_SCALAR_START",`Plain value cannot start with ${Q}`);return rV(X)}function rI(X,Z){if(X[X.length-1]!=="'"||X.length===1)Z(X.length,"MISSING_CHAR","Missing closing 'quote");return rV(X.slice(1,-1)).replace(/''/g,"'")}function rV(X){let Z,Q;try{Z=new RegExp(`(.*?)(?<![ 	])[ 	]*\r?
`,"sy"),Q=new RegExp(`[ 	]*(.*?)(?:(?<![ 	])[ 	]*)?\r?
`,"sy")}catch{Z=/(.*?)[ \t]*\r?\n/sy,Q=/[ \t]*(.*?)[ \t]*\r?\n/sy}let G=Z.exec(X);if(!G)return X;let J=G[1],Y=" ",$=Z.lastIndex;Q.lastIndex=$;while(G=Q.exec(X)){if(G[1]==="")if(Y===`
`)J+=Y;else Y=`
`;else J+=Y+G[1],Y=" ";$=Q.lastIndex}let z=/[ \t]*(.*)/sy;return z.lastIndex=$,G=z.exec(X),J+Y+(G?.[1]??"")}function aI(X,Z){let Q="";for(let G=1;G<X.length-1;++G){let J=X[G];if(J==="\r"&&X[G+1]===`
`)continue;if(J===`
`){let{fold:Y,offset:$}=tI(X,G);Q+=Y,G=$}else if(J==="\\"){let Y=X[++G],$=eI[Y];if($)Q+=$;else if(Y===`
`){Y=X[G+1];while(Y===" "||Y==="\t")Y=X[++G+1]}else if(Y==="\r"&&X[G+1]===`
`){Y=X[++G+1];while(Y===" "||Y==="\t")Y=X[++G+1]}else if(Y==="x"||Y==="u"||Y==="U"){let z={x:2,u:4,U:8}[Y];Q+=X_(X,G+1,z,Z),G+=z}else{let z=X.substr(G-1,2);Z(G-1,"BAD_DQ_ESCAPE",`Invalid escape sequence ${z}`),Q+=z}}else if(J===" "||J==="\t"){let Y=G,$=X[G+1];while($===" "||$==="\t")$=X[++G+1];if($!==`
`&&!($==="\r"&&X[G+2]===`
`))Q+=G>Y?X.slice(Y,G+1):J}else Q+=J}if(X[X.length-1]!=='"'||X.length===1)Z(X.length,"MISSING_CHAR",'Missing closing "quote');return Q}function tI(X,Z){let Q="",G=X[Z+1];while(G===" "||G==="\t"||G===`
`||G==="\r"){if(G==="\r"&&X[Z+2]!==`
`)break;if(G===`
`)Q+=`
`;Z+=1,G=X[Z+1]}if(!Q)Q=" ";return{fold:Q,offset:Z}}var eI={"0":"\x00",a:"\x07",b:"\b",e:"\x1B",f:"\f",n:`
`,r:"\r",t:"\t",v:"\v",N:"",_:"",L:"\u2028",P:"\u2029"," ":" ",'"':'"',"/":"/","\\":"\\","\t":"\t"};function X_(X,Z,Q,G){let J=X.substr(Z,Q),$=J.length===Q&&/^[0-9a-fA-F]+$/.test(J)?parseInt(J,16):NaN;if(isNaN($)){let z=X.substr(Z-2,Q+2);return G(Z-2,"BAD_DQ_ESCAPE",`Invalid escape sequence ${z}`),z}return String.fromCodePoint($)}Z_.resolveFlowScalar=nI});var tV=D((H_)=>{var o6=z0(),aV=y0(),G_=aJ(),J_=eJ();function Y_(X,Z,Q,G){let{value:J,type:Y,comment:$,range:z}=Z.type==="block-scalar"?G_.resolveBlockScalar(X,Z,G):J_.resolveFlowScalar(Z,X.options.strict,G),H=Q?X.directives.tagName(Q.source,(A)=>G(Q,"TAG_RESOLVE_FAILED",A)):null,U;if(X.options.stringKeys&&X.atKey)U=X.schema[o6.SCALAR];else if(H)U=$_(X.schema,J,H,Q,G);else if(Z.type==="scalar")U=z_(X,J,Z,G);else U=X.schema[o6.SCALAR];let L;try{let A=U.resolve(J,(F)=>G(Q??Z,"TAG_RESOLVE_FAILED",F),X.options);L=o6.isScalar(A)?A:new aV.Scalar(A)}catch(A){let F=A instanceof Error?A.message:String(A);G(Q??Z,"TAG_RESOLVE_FAILED",F),L=new aV.Scalar(J)}if(L.range=z,L.source=J,Y)L.type=Y;if(H)L.tag=H;if(U.format)L.format=U.format;if($)L.comment=$;return L}function $_(X,Z,Q,G,J){if(Q==="!")return X[o6.SCALAR];let Y=[];for(let z of X.tags)if(!z.collection&&z.tag===Q)if(z.default&&z.test)Y.push(z);else return z;for(let z of Y)if(z.test?.test(Z))return z;let $=X.knownTags[Q];if($&&!$.collection)return X.tags.push(Object.assign({},$,{default:!1,test:void 0})),$;return J(G,"TAG_RESOLVE_FAILED",`Unresolved tag: ${Q}`,Q!=="tag:yaml.org,2002:str"),X[o6.SCALAR]}function z_({atKey:X,directives:Z,schema:Q},G,J,Y){let $=Q.tags.find((z)=>(z.default===!0||X&&z.default==="key")&&z.test?.test(G))||Q[o6.SCALAR];if(Q.compat){let z=Q.compat.find((H)=>H.default&&H.test?.test(G))??Q[o6.SCALAR];if($.tag!==z.tag){let H=Z.tagString($.tag),U=Z.tagString(z.tag),L=`Value may be parsed as either ${H} or ${U}`;Y(J,"TAG_RESOLVE_FAILED",L,!0)}}return $}H_.composeScalar=Y_});var eV=D((V_)=>{function W_(X,Z,Q){if(Z){Q??(Q=Z.length);for(let G=Q-1;G>=0;--G){let J=Z[G];switch(J.type){case"space":case"comment":case"newline":X-=J.source.length;continue}J=Z[++G];while(J?.type==="space")X+=J.source.length,J=Z[++G];break}}return X}V_.emptyScalarPosition=W_});var QB=D((N_)=>{var L_=CZ(),A_=z0(),F_=sV(),XB=tV(),O_=v9(),w_=eV(),K_={composeNode:ZB,composeEmptyNode:X7};function ZB(X,Z,Q,G){let J=X.atKey,{spaceBefore:Y,comment:$,anchor:z,tag:H}=Q,U,L=!0;switch(Z.type){case"alias":if(U=M_(X,Z,G),z||H)G(Z,"ALIAS_PROPS","An alias node must not specify any properties");break;case"scalar":case"single-quoted-scalar":case"double-quoted-scalar":case"block-scalar":if(U=XB.composeScalar(X,Z,H,G),z)U.anchor=z.source.substring(1);break;case"block-map":case"block-seq":case"flow-collection":if(U=F_.composeCollection(K_,X,Z,Q,G),z)U.anchor=z.source.substring(1);break;default:{let A=Z.type==="error"?Z.message:`Unsupported token (type: ${Z.type})`;G(Z,"UNEXPECTED_TOKEN",A),U=X7(X,Z.offset,void 0,null,Q,G),L=!1}}if(z&&U.anchor==="")G(z,"BAD_ALIAS","Anchor cannot be an empty string");if(J&&X.options.stringKeys&&(!A_.isScalar(U)||typeof U.value!=="string"||U.tag&&U.tag!=="tag:yaml.org,2002:str"))G(H??Z,"NON_STRING_KEY","With stringKeys, all keys must be strings");if(Y)U.spaceBefore=!0;if($)if(Z.type==="scalar"&&Z.source==="")U.comment=$;else U.commentBefore=$;if(X.options.keepSourceTokens&&L)U.srcToken=Z;return U}function X7(X,Z,Q,G,{spaceBefore:J,comment:Y,anchor:$,tag:z,end:H},U){let L={type:"scalar",offset:w_.emptyScalarPosition(Z,Q,G),indent:-1,source:""},A=XB.composeScalar(X,L,z,U);if($){if(A.anchor=$.source.substring(1),A.anchor==="")U($,"BAD_ALIAS","Anchor cannot be an empty string")}if(J)A.spaceBefore=!0;if(Y)A.comment=Y,A.range[2]=H;return A}function M_({options:X},{offset:Z,source:Q,end:G},J){let Y=new L_.Alias(Q.substring(1));if(Y.source==="")J(Z,"BAD_ALIAS","Alias cannot be an empty string");if(Y.source.endsWith(":"))J(Z+Q.length-1,"BAD_ALIAS","Alias ending in : is ambiguous",!0);let $=Z+Q.length,z=O_.resolveEnd(G,$,X.strict,J);if(Y.range=[Z,$,z.offset],z.comment)Y.comment=z.comment;return Y}N_.composeEmptyNode=X7;N_.composeNode=ZB});var JB=D((I_)=>{var E_=lZ(),GB=QB(),P_=v9(),j_=iZ();function D_(X,Z,{offset:Q,start:G,value:J,end:Y},$){let z=Object.assign({_directives:Z},X),H=new E_.Document(void 0,z),U={atKey:!1,atRoot:!0,directives:H.directives,options:H.options,schema:H.schema},L=j_.resolveProps(G,{indicator:"doc-start",next:J??Y?.[0],offset:Q,onError:$,parentIndent:0,startOnNewline:!0});if(L.found){if(H.directives.docStart=!0,J&&(J.type==="block-map"||J.type==="block-seq")&&!L.hasNewline)$(L.end,"MISSING_CHAR","Block collection cannot start on same line with directives-end marker")}H.contents=J?GB.composeNode(U,J,L,$):GB.composeEmptyNode(U,L.end,G,null,L,$);let A=H.contents.range[2],F=P_.resolveEnd(Y,A,!1,$);if(F.comment)H.comment=F.comment;return H.range=[Q,A,F.offset],H}I_.composeDoc=D_});var Z7=D((f_)=>{var C_=p0("process"),S_=YJ(),b_=lZ(),oZ=cZ(),YB=z0(),R_=JB(),y_=v9();function nZ(X){if(typeof X==="number")return[X,X+1];if(Array.isArray(X))return X.length===2?X:[X[0],X[1]];let{offset:Z,source:Q}=X;return[Z,Z+(typeof Q==="string"?Q.length:1)]}function $B(X){let Z="",Q=!1,G=!1;for(let J=0;J<X.length;++J){let Y=X[J];switch(Y[0]){case"#":Z+=(Z===""?"":G?`

`:`
`)+(Y.substring(1)||" "),Q=!0,G=!1;break;case"%":if(X[J+1]?.[0]!=="#")J+=1;Q=!1;break;default:if(!Q)G=!0;Q=!1}}return{comment:Z,afterEmptyLine:G}}class zB{constructor(X={}){this.doc=null,this.atDirectives=!1,this.prelude=[],this.errors=[],this.warnings=[],this.onError=(Z,Q,G,J)=>{let Y=nZ(Z);if(J)this.warnings.push(new oZ.YAMLWarning(Y,Q,G));else this.errors.push(new oZ.YAMLParseError(Y,Q,G))},this.directives=new S_.Directives({version:X.version||"1.2"}),this.options=X}decorate(X,Z){let{comment:Q,afterEmptyLine:G}=$B(this.prelude);if(Q){let J=X.contents;if(Z)X.comment=X.comment?`${X.comment}
${Q}`:Q;else if(G||X.directives.docStart||!J)X.commentBefore=Q;else if(YB.isCollection(J)&&!J.flow&&J.items.length>0){let Y=J.items[0];if(YB.isPair(Y))Y=Y.key;let $=Y.commentBefore;Y.commentBefore=$?`${Q}
${$}`:Q}else{let Y=J.commentBefore;J.commentBefore=Y?`${Q}
${Y}`:Q}}if(Z)Array.prototype.push.apply(X.errors,this.errors),Array.prototype.push.apply(X.warnings,this.warnings);else X.errors=this.errors,X.warnings=this.warnings;this.prelude=[],this.errors=[],this.warnings=[]}streamInfo(){return{comment:$B(this.prelude).comment,directives:this.directives,errors:this.errors,warnings:this.warnings}}*compose(X,Z=!1,Q=-1){for(let G of X)yield*this.next(G);yield*this.end(Z,Q)}*next(X){if(C_.env.LOG_STREAM)console.dir(X,{depth:null});switch(X.type){case"directive":this.directives.add(X.source,(Z,Q,G)=>{let J=nZ(X);J[0]+=Z,this.onError(J,"BAD_DIRECTIVE",Q,G)}),this.prelude.push(X.source),this.atDirectives=!0;break;case"document":{let Z=R_.composeDoc(this.options,this.directives,X,this.onError);if(this.atDirectives&&!Z.directives.docStart)this.onError(X,"MISSING_CHAR","Missing directives-end/doc-start indicator line");if(this.decorate(Z,!1),this.doc)yield this.doc;this.doc=Z,this.atDirectives=!1;break}case"byte-order-mark":case"space":break;case"comment":case"newline":this.prelude.push(X.source);break;case"error":{let Z=X.source?`${X.message}: ${JSON.stringify(X.source)}`:X.message,Q=new oZ.YAMLParseError(nZ(X),"UNEXPECTED_TOKEN",Z);if(this.atDirectives||!this.doc)this.errors.push(Q);else this.doc.errors.push(Q);break}case"doc-end":{if(!this.doc){this.errors.push(new oZ.YAMLParseError(nZ(X),"UNEXPECTED_TOKEN","Unexpected doc-end without preceding document"));break}this.doc.directives.docEnd=!0;let Z=y_.resolveEnd(X.end,X.offset+X.source.length,this.doc.options.strict,this.onError);if(this.decorate(this.doc,!0),Z.comment){let Q=this.doc.comment;this.doc.comment=Q?`${Q}
${Z.comment}`:Z.comment}this.doc.range[2]=Z.offset;break}default:this.errors.push(new oZ.YAMLParseError(nZ(X),"UNEXPECTED_TOKEN",`Unsupported token ${X.type}`))}}*end(X=!1,Z=-1){if(this.doc)this.decorate(this.doc,!0),yield this.doc,this.doc=null;else if(X){let Q=Object.assign({_directives:this.directives},this.options),G=new b_.Document(void 0,Q);if(this.atDirectives)this.onError(Z,"MISSING_CHAR","Missing directives-end indicator line");G.range=[0,Z,Z],this.decorate(G,!1),yield G}}}f_.Composer=zB});var WB=D((d_)=>{var x_=aJ(),v_=eJ(),h_=cZ(),HB=yZ();function g_(X,Z=!0,Q){if(X){let G=(J,Y,$)=>{let z=typeof J==="number"?J:Array.isArray(J)?J[0]:J.offset;if(Q)Q(z,Y,$);else throw new h_.YAMLParseError([z,z+1],Y,$)};switch(X.type){case"scalar":case"single-quoted-scalar":case"double-quoted-scalar":return v_.resolveFlowScalar(X,Z,G);case"block-scalar":return x_.resolveBlockScalar({options:{strict:Z}},X,G)}}return null}function u_(X,Z){let{implicitKey:Q=!1,indent:G,inFlow:J=!1,offset:Y=-1,type:$="PLAIN"}=Z,z=HB.stringifyString({type:$,value:X},{implicitKey:Q,indent:G>0?" ".repeat(G):"",inFlow:J,options:{blockQuote:!0,lineWidth:-1}}),H=Z.end??[{type:"newline",offset:-1,indent:G,source:`
`}];switch(z[0]){case"|":case">":{let U=z.indexOf(`
`),L=z.substring(0,U),A=z.substring(U+1)+`
`,F=[{type:"block-scalar-header",offset:Y,indent:G,source:L}];if(!UB(F,H))F.push({type:"newline",offset:-1,indent:G,source:`
`});return{type:"block-scalar",offset:Y,indent:G,props:F,source:A}}case'"':return{type:"double-quoted-scalar",offset:Y,indent:G,source:z,end:H};case"'":return{type:"single-quoted-scalar",offset:Y,indent:G,source:z,end:H};default:return{type:"scalar",offset:Y,indent:G,source:z,end:H}}}function m_(X,Z,Q={}){let{afterKey:G=!1,implicitKey:J=!1,inFlow:Y=!1,type:$}=Q,z="indent"in X?X.indent:null;if(G&&typeof z==="number")z+=2;if(!$)switch(X.type){case"single-quoted-scalar":$="QUOTE_SINGLE";break;case"double-quoted-scalar":$="QUOTE_DOUBLE";break;case"block-scalar":{let U=X.props[0];if(U.type!=="block-scalar-header")throw Error("Invalid block scalar header");$=U.source[0]===">"?"BLOCK_FOLDED":"BLOCK_LITERAL";break}default:$="PLAIN"}let H=HB.stringifyString({type:$,value:Z},{implicitKey:J||z===null,indent:z!==null&&z>0?" ".repeat(z):"",inFlow:Y,options:{blockQuote:!0,lineWidth:-1}});switch(H[0]){case"|":case">":p_(X,H);break;case'"':Q7(X,H,"double-quoted-scalar");break;case"'":Q7(X,H,"single-quoted-scalar");break;default:Q7(X,H,"scalar")}}function p_(X,Z){let Q=Z.indexOf(`
`),G=Z.substring(0,Q),J=Z.substring(Q+1)+`
`;if(X.type==="block-scalar"){let Y=X.props[0];if(Y.type!=="block-scalar-header")throw Error("Invalid block scalar header");Y.source=G,X.source=J}else{let{offset:Y}=X,$="indent"in X?X.indent:-1,z=[{type:"block-scalar-header",offset:Y,indent:$,source:G}];if(!UB(z,"end"in X?X.end:void 0))z.push({type:"newline",offset:-1,indent:$,source:`
`});for(let H of Object.keys(X))if(H!=="type"&&H!=="offset")delete X[H];Object.assign(X,{type:"block-scalar",indent:$,props:z,source:J})}}function UB(X,Z){if(Z)for(let Q of Z)switch(Q.type){case"space":case"comment":X.push(Q);break;case"newline":return X.push(Q),!0}return!1}function Q7(X,Z,Q){switch(X.type){case"scalar":case"double-quoted-scalar":case"single-quoted-scalar":X.type=Q,X.source=Z;break;case"block-scalar":{let G=X.props.slice(1),J=Z.length;if(X.props[0].type==="block-scalar-header")J-=X.props[0].source.length;for(let Y of G)Y.offset+=J;delete X.props,Object.assign(X,{type:Q,source:Z,end:G});break}case"block-map":case"block-seq":{let J={type:"newline",offset:X.offset+Z.length,indent:X.indent,source:`
`};delete X.items,Object.assign(X,{type:Q,source:Z,end:[J]});break}default:{let G="indent"in X?X.indent:-1,J="end"in X&&Array.isArray(X.end)?X.end.filter((Y)=>Y.type==="space"||Y.type==="comment"||Y.type==="newline"):[];for(let Y of Object.keys(X))if(Y!=="type"&&Y!=="offset")delete X[Y];Object.assign(X,{type:Q,indent:G,source:Z,end:J})}}}d_.createScalarToken=u_;d_.resolveAsScalar=g_;d_.setScalarValue=m_});var VB=D((n_)=>{var o_=(X)=>("type"in X)?ZQ(X):XQ(X);function ZQ(X){switch(X.type){case"block-scalar":{let Z="";for(let Q of X.props)Z+=ZQ(Q);return Z+X.source}case"block-map":case"block-seq":{let Z="";for(let Q of X.items)Z+=XQ(Q);return Z}case"flow-collection":{let Z=X.start.source;for(let Q of X.items)Z+=XQ(Q);for(let Q of X.end)Z+=Q.source;return Z}case"document":{let Z=XQ(X);if(X.end)for(let Q of X.end)Z+=Q.source;return Z}default:{let Z=X.source;if("end"in X&&X.end)for(let Q of X.end)Z+=Q.source;return Z}}}function XQ({start:X,key:Z,sep:Q,value:G}){let J="";for(let Y of X)J+=Y.source;if(Z)J+=ZQ(Z);if(Q)for(let Y of Q)J+=Y.source;if(G)J+=ZQ(G);return J}n_.stringify=o_});var AB=D((a_)=>{var G7=Symbol("break visit"),r_=Symbol("skip children"),BB=Symbol("remove item");function n6(X,Z){if("type"in X&&X.type==="document")X={start:X.start,value:X.value};LB(Object.freeze([]),X,Z)}n6.BREAK=G7;n6.SKIP=r_;n6.REMOVE=BB;n6.itemAtPath=(X,Z)=>{let Q=X;for(let[G,J]of Z){let Y=Q?.[G];if(Y&&"items"in Y)Q=Y.items[J];else return}return Q};n6.parentCollection=(X,Z)=>{let Q=n6.itemAtPath(X,Z.slice(0,-1)),G=Z[Z.length-1][0],J=Q?.[G];if(J&&"items"in J)return J;throw Error("Parent collection not found")};function LB(X,Z,Q){let G=Q(Z,X);if(typeof G==="symbol")return G;for(let J of["key","value"]){let Y=Z[J];if(Y&&"items"in Y){for(let $=0;$<Y.items.length;++$){let z=LB(Object.freeze(X.concat([[J,$]])),Y.items[$],Q);if(typeof z==="number")$=z-1;else if(z===G7)return G7;else if(z===BB)Y.items.splice($,1),$-=1}if(typeof G==="function"&&J==="key")G=G(Z,X)}}return typeof G==="function"?G(Z,X):G}a_.visit=n6});var QQ=D((YC)=>{var J7=WB(),e_=VB(),XC=AB(),Y7="\uFEFF",$7="\x02",z7="\x18",H7="\x1F",ZC=(X)=>!!X&&("items"in X),QC=(X)=>!!X&&(X.type==="scalar"||X.type==="single-quoted-scalar"||X.type==="double-quoted-scalar"||X.type==="block-scalar");function GC(X){switch(X){case Y7:return"<BOM>";case $7:return"<DOC>";case z7:return"<FLOW_END>";case H7:return"<SCALAR>";default:return JSON.stringify(X)}}function JC(X){switch(X){case Y7:return"byte-order-mark";case $7:return"doc-mode";case z7:return"flow-error-end";case H7:return"scalar";case"---":return"doc-start";case"...":return"doc-end";case"":case`
`:case`\r
`:return"newline";case"-":return"seq-item-ind";case"?":return"explicit-key-ind";case":":return"map-value-ind";case"{":return"flow-map-start";case"}":return"flow-map-end";case"[":return"flow-seq-start";case"]":return"flow-seq-end";case",":return"comma"}switch(X[0]){case" ":case"\t":return"space";case"#":return"comment";case"%":return"directive-line";case"*":return"alias";case"&":return"anchor";case"!":return"tag";case"'":return"single-quoted-scalar";case'"':return"double-quoted-scalar";case"|":case">":return"block-scalar-header"}return null}YC.createScalarToken=J7.createScalarToken;YC.resolveAsScalar=J7.resolveAsScalar;YC.setScalarValue=J7.setScalarValue;YC.stringify=e_.stringify;YC.visit=XC.visit;YC.BOM=Y7;YC.DOCUMENT=$7;YC.FLOW_END=z7;YC.SCALAR=H7;YC.isCollection=ZC;YC.isScalar=QC;YC.prettyToken=GC;YC.tokenType=JC});var W7=D((TC)=>{var sZ=QQ();function RX(X){switch(X){case void 0:case" ":case`
`:case"\r":case"\t":return!0;default:return!1}}var FB=new Set("0123456789ABCDEFabcdef"),MC=new Set("0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz-#;/?:@&=+$_.!~*'()"),GQ=new Set(",[]{}"),NC=new Set(` ,[]{}
\r	`),U7=(X)=>!X||NC.has(X);class OB{constructor(){this.atEnd=!1,this.blockScalarIndent=-1,this.blockScalarKeep=!1,this.buffer="",this.flowKey=!1,this.flowLevel=0,this.indentNext=0,this.indentValue=0,this.lineEndPos=null,this.next=null,this.pos=0}*lex(X,Z=!1){if(X){if(typeof X!=="string")throw TypeError("source is not a string");this.buffer=this.buffer?this.buffer+X:X,this.lineEndPos=null}this.atEnd=!Z;let Q=this.next??"stream";while(Q&&(Z||this.hasChars(1)))Q=yield*this.parseNext(Q)}atLineEnd(){let X=this.pos,Z=this.buffer[X];while(Z===" "||Z==="\t")Z=this.buffer[++X];if(!Z||Z==="#"||Z===`
`)return!0;if(Z==="\r")return this.buffer[X+1]===`
`;return!1}charAt(X){return this.buffer[this.pos+X]}continueScalar(X){let Z=this.buffer[X];if(this.indentNext>0){let Q=0;while(Z===" ")Z=this.buffer[++Q+X];if(Z==="\r"){let G=this.buffer[Q+X+1];if(G===`
`||!G&&!this.atEnd)return X+Q+1}return Z===`
`||Q>=this.indentNext||!Z&&!this.atEnd?X+Q:-1}if(Z==="-"||Z==="."){let Q=this.buffer.substr(X,3);if((Q==="---"||Q==="...")&&RX(this.buffer[X+3]))return-1}return X}getLine(){let X=this.lineEndPos;if(typeof X!=="number"||X!==-1&&X<this.pos)X=this.buffer.indexOf(`
`,this.pos),this.lineEndPos=X;if(X===-1)return this.atEnd?this.buffer.substring(this.pos):null;if(this.buffer[X-1]==="\r")X-=1;return this.buffer.substring(this.pos,X)}hasChars(X){return this.pos+X<=this.buffer.length}setNext(X){return this.buffer=this.buffer.substring(this.pos),this.pos=0,this.lineEndPos=null,this.next=X,null}peek(X){return this.buffer.substr(this.pos,X)}*parseNext(X){switch(X){case"stream":return yield*this.parseStream();case"line-start":return yield*this.parseLineStart();case"block-start":return yield*this.parseBlockStart();case"doc":return yield*this.parseDocument();case"flow":return yield*this.parseFlowCollection();case"quoted-scalar":return yield*this.parseQuotedScalar();case"block-scalar":return yield*this.parseBlockScalar();case"plain-scalar":return yield*this.parsePlainScalar()}}*parseStream(){let X=this.getLine();if(X===null)return this.setNext("stream");if(X[0]===sZ.BOM)yield*this.pushCount(1),X=X.substring(1);if(X[0]==="%"){let Z=X.length,Q=X.indexOf("#");while(Q!==-1){let J=X[Q-1];if(J===" "||J==="\t"){Z=Q-1;break}else Q=X.indexOf("#",Q+1)}while(!0){let J=X[Z-1];if(J===" "||J==="\t")Z-=1;else break}let G=(yield*this.pushCount(Z))+(yield*this.pushSpaces(!0));return yield*this.pushCount(X.length-G),this.pushNewline(),"stream"}if(this.atLineEnd()){let Z=yield*this.pushSpaces(!0);return yield*this.pushCount(X.length-Z),yield*this.pushNewline(),"stream"}return yield sZ.DOCUMENT,yield*this.parseLineStart()}*parseLineStart(){let X=this.charAt(0);if(!X&&!this.atEnd)return this.setNext("line-start");if(X==="-"||X==="."){if(!this.atEnd&&!this.hasChars(4))return this.setNext("line-start");let Z=this.peek(3);if((Z==="---"||Z==="...")&&RX(this.charAt(3)))return yield*this.pushCount(3),this.indentValue=0,this.indentNext=0,Z==="---"?"doc":"stream"}if(this.indentValue=yield*this.pushSpaces(!1),this.indentNext>this.indentValue&&!RX(this.charAt(1)))this.indentNext=this.indentValue;return yield*this.parseBlockStart()}*parseBlockStart(){let[X,Z]=this.peek(2);if(!Z&&!this.atEnd)return this.setNext("block-start");if((X==="-"||X==="?"||X===":")&&RX(Z)){let Q=(yield*this.pushCount(1))+(yield*this.pushSpaces(!0));return this.indentNext=this.indentValue+1,this.indentValue+=Q,yield*this.parseBlockStart()}return"doc"}*parseDocument(){yield*this.pushSpaces(!0);let X=this.getLine();if(X===null)return this.setNext("doc");let Z=yield*this.pushIndicators();switch(X[Z]){case"#":yield*this.pushCount(X.length-Z);case void 0:return yield*this.pushNewline(),yield*this.parseLineStart();case"{":case"[":return yield*this.pushCount(1),this.flowKey=!1,this.flowLevel=1,"flow";case"}":case"]":return yield*this.pushCount(1),"doc";case"*":return yield*this.pushUntil(U7),"doc";case'"':case"'":return yield*this.parseQuotedScalar();case"|":case">":return Z+=yield*this.parseBlockScalarHeader(),Z+=yield*this.pushSpaces(!0),yield*this.pushCount(X.length-Z),yield*this.pushNewline(),yield*this.parseBlockScalar();default:return yield*this.parsePlainScalar()}}*parseFlowCollection(){let X,Z,Q=-1;do{if(X=yield*this.pushNewline(),X>0)Z=yield*this.pushSpaces(!1),this.indentValue=Q=Z;else Z=0;Z+=yield*this.pushSpaces(!0)}while(X+Z>0);let G=this.getLine();if(G===null)return this.setNext("flow");if(Q!==-1&&Q<this.indentNext&&G[0]!=="#"||Q===0&&(G.startsWith("---")||G.startsWith("..."))&&RX(G[3])){if(!(Q===this.indentNext-1&&this.flowLevel===1&&(G[0]==="]"||G[0]==="}")))return this.flowLevel=0,yield sZ.FLOW_END,yield*this.parseLineStart()}let J=0;while(G[J]===",")J+=yield*this.pushCount(1),J+=yield*this.pushSpaces(!0),this.flowKey=!1;switch(J+=yield*this.pushIndicators(),G[J]){case void 0:return"flow";case"#":return yield*this.pushCount(G.length-J),"flow";case"{":case"[":return yield*this.pushCount(1),this.flowKey=!1,this.flowLevel+=1,"flow";case"}":case"]":return yield*this.pushCount(1),this.flowKey=!0,this.flowLevel-=1,this.flowLevel?"flow":"doc";case"*":return yield*this.pushUntil(U7),"flow";case'"':case"'":return this.flowKey=!0,yield*this.parseQuotedScalar();case":":{let Y=this.charAt(1);if(this.flowKey||RX(Y)||Y===",")return this.flowKey=!1,yield*this.pushCount(1),yield*this.pushSpaces(!0),"flow"}default:return this.flowKey=!1,yield*this.parsePlainScalar()}}*parseQuotedScalar(){let X=this.charAt(0),Z=this.buffer.indexOf(X,this.pos+1);if(X==="'")while(Z!==-1&&this.buffer[Z+1]==="'")Z=this.buffer.indexOf("'",Z+2);else while(Z!==-1){let J=0;while(this.buffer[Z-1-J]==="\\")J+=1;if(J%2===0)break;Z=this.buffer.indexOf('"',Z+1)}let Q=this.buffer.substring(0,Z),G=Q.indexOf(`
`,this.pos);if(G!==-1){while(G!==-1){let J=this.continueScalar(G+1);if(J===-1)break;G=Q.indexOf(`
`,J)}if(G!==-1)Z=G-(Q[G-1]==="\r"?2:1)}if(Z===-1){if(!this.atEnd)return this.setNext("quoted-scalar");Z=this.buffer.length}return yield*this.pushToIndex(Z+1,!1),this.flowLevel?"flow":"doc"}*parseBlockScalarHeader(){this.blockScalarIndent=-1,this.blockScalarKeep=!1;let X=this.pos;while(!0){let Z=this.buffer[++X];if(Z==="+")this.blockScalarKeep=!0;else if(Z>"0"&&Z<="9")this.blockScalarIndent=Number(Z)-1;else if(Z!=="-")break}return yield*this.pushUntil((Z)=>RX(Z)||Z==="#")}*parseBlockScalar(){let X=this.pos-1,Z=0,Q;X:for(let J=this.pos;Q=this.buffer[J];++J)switch(Q){case" ":Z+=1;break;case`
`:X=J,Z=0;break;case"\r":{let Y=this.buffer[J+1];if(!Y&&!this.atEnd)return this.setNext("block-scalar");if(Y===`
`)break}default:break X}if(!Q&&!this.atEnd)return this.setNext("block-scalar");if(Z>=this.indentNext){if(this.blockScalarIndent===-1)this.indentNext=Z;else this.indentNext=this.blockScalarIndent+(this.indentNext===0?1:this.indentNext);do{let J=this.continueScalar(X+1);if(J===-1)break;X=this.buffer.indexOf(`
`,J)}while(X!==-1);if(X===-1){if(!this.atEnd)return this.setNext("block-scalar");X=this.buffer.length}}let G=X+1;Q=this.buffer[G];while(Q===" ")Q=this.buffer[++G];if(Q==="\t"){while(Q==="\t"||Q===" "||Q==="\r"||Q===`
`)Q=this.buffer[++G];X=G-1}else if(!this.blockScalarKeep)do{let J=X-1,Y=this.buffer[J];if(Y==="\r")Y=this.buffer[--J];let $=J;while(Y===" ")Y=this.buffer[--J];if(Y===`
`&&J>=this.pos&&J+1+Z>$)X=J;else break}while(!0);return yield sZ.SCALAR,yield*this.pushToIndex(X+1,!0),yield*this.parseLineStart()}*parsePlainScalar(){let X=this.flowLevel>0,Z=this.pos-1,Q=this.pos-1,G;while(G=this.buffer[++Q])if(G===":"){let J=this.buffer[Q+1];if(RX(J)||X&&GQ.has(J))break;Z=Q}else if(RX(G)){let J=this.buffer[Q+1];if(G==="\r")if(J===`
`)Q+=1,G=`
`,J=this.buffer[Q+1];else Z=Q;if(J==="#"||X&&GQ.has(J))break;if(G===`
`){let Y=this.continueScalar(Q+1);if(Y===-1)break;Q=Math.max(Q,Y-2)}}else{if(X&&GQ.has(G))break;Z=Q}if(!G&&!this.atEnd)return this.setNext("plain-scalar");return yield sZ.SCALAR,yield*this.pushToIndex(Z+1,!0),X?"flow":"doc"}*pushCount(X){if(X>0)return yield this.buffer.substr(this.pos,X),this.pos+=X,X;return 0}*pushToIndex(X,Z){let Q=this.buffer.slice(this.pos,X);if(Q)return yield Q,this.pos+=Q.length,Q.length;else if(Z)yield"";return 0}*pushIndicators(){switch(this.charAt(0)){case"!":return(yield*this.pushTag())+(yield*this.pushSpaces(!0))+(yield*this.pushIndicators());case"&":return(yield*this.pushUntil(U7))+(yield*this.pushSpaces(!0))+(yield*this.pushIndicators());case"-":case"?":case":":{let X=this.flowLevel>0,Z=this.charAt(1);if(RX(Z)||X&&GQ.has(Z)){if(!X)this.indentNext=this.indentValue+1;else if(this.flowKey)this.flowKey=!1;return(yield*this.pushCount(1))+(yield*this.pushSpaces(!0))+(yield*this.pushIndicators())}}}return 0}*pushTag(){if(this.charAt(1)==="<"){let X=this.pos+2,Z=this.buffer[X];while(!RX(Z)&&Z!==">")Z=this.buffer[++X];return yield*this.pushToIndex(Z===">"?X+1:X,!1)}else{let X=this.pos+1,Z=this.buffer[X];while(Z)if(MC.has(Z))Z=this.buffer[++X];else if(Z==="%"&&FB.has(this.buffer[X+1])&&FB.has(this.buffer[X+2]))Z=this.buffer[X+=3];else break;return yield*this.pushToIndex(X,!1)}}*pushNewline(){let X=this.buffer[this.pos];if(X===`
`)return yield*this.pushCount(1);else if(X==="\r"&&this.charAt(1)===`
`)return yield*this.pushCount(2);else return 0}*pushSpaces(X){let Z=this.pos-1,Q;do Q=this.buffer[++Z];while(Q===" "||X&&Q==="\t");let G=Z-this.pos;if(G>0)yield this.buffer.substr(this.pos,G),this.pos=Z;return G}*pushUntil(X){let Z=this.pos,Q=this.buffer[Z];while(!X(Q))Q=this.buffer[++Z];return yield*this.pushToIndex(Z,!1)}}TC.Lexer=OB});var V7=D((EC)=>{class wB{constructor(){this.lineStarts=[],this.addNewLine=(X)=>this.lineStarts.push(X),this.linePos=(X)=>{let Z=0,Q=this.lineStarts.length;while(Z<Q){let J=Z+Q>>1;if(this.lineStarts[J]<X)Z=J+1;else Q=J}if(this.lineStarts[Z]===X)return{line:Z+1,col:1};if(Z===0)return{line:0,col:X};let G=this.lineStarts[Z-1];return{line:Z,col:X-G+1}}}}EC.LineCounter=wB});var B7=D((IC)=>{var jC=p0("process"),KB=QQ(),DC=W7();function q6(X,Z){for(let Q=0;Q<X.length;++Q)if(X[Q].type===Z)return!0;return!1}function MB(X){for(let Z=0;Z<X.length;++Z)switch(X[Z].type){case"space":case"comment":case"newline":break;default:return Z}return-1}function TB(X){switch(X?.type){case"alias":case"scalar":case"single-quoted-scalar":case"double-quoted-scalar":case"flow-collection":return!0;default:return!1}}function JQ(X){switch(X.type){case"document":return X.start;case"block-map":{let Z=X.items[X.items.length-1];return Z.sep??Z.start}case"block-seq":return X.items[X.items.length-1].start;default:return[]}}function h9(X){if(X.length===0)return[];let Z=X.length;X:while(--Z>=0)switch(X[Z].type){case"doc-start":case"explicit-key-ind":case"map-value-ind":case"seq-item-ind":case"newline":break X}while(X[++Z]?.type==="space");return X.splice(Z,X.length)}function NB(X){if(X.start.type==="flow-seq-start"){for(let Z of X.items)if(Z.sep&&!Z.value&&!q6(Z.start,"explicit-key-ind")&&!q6(Z.sep,"map-value-ind")){if(Z.key)Z.value=Z.key;if(delete Z.key,TB(Z.value))if(Z.value.end)Array.prototype.push.apply(Z.value.end,Z.sep);else Z.value.end=Z.sep;else Array.prototype.push.apply(Z.start,Z.sep);delete Z.sep}}}class qB{constructor(X){this.atNewLine=!0,this.atScalar=!1,this.indent=0,this.offset=0,this.onKeyLine=!1,this.stack=[],this.source="",this.type="",this.lexer=new DC.Lexer,this.onNewLine=X}*parse(X,Z=!1){if(this.onNewLine&&this.offset===0)this.onNewLine(0);for(let Q of this.lexer.lex(X,Z))yield*this.next(Q);if(!Z)yield*this.end()}*next(X){if(this.source=X,jC.env.LOG_TOKENS)console.log("|",KB.prettyToken(X));if(this.atScalar){this.atScalar=!1,yield*this.step(),this.offset+=X.length;return}let Z=KB.tokenType(X);if(!Z){let Q=`Not a YAML token: ${X}`;yield*this.pop({type:"error",offset:this.offset,message:Q,source:X}),this.offset+=X.length}else if(Z==="scalar")this.atNewLine=!1,this.atScalar=!0,this.type="scalar";else{switch(this.type=Z,yield*this.step(),Z){case"newline":if(this.atNewLine=!0,this.indent=0,this.onNewLine)this.onNewLine(this.offset+X.length);break;case"space":if(this.atNewLine&&X[0]===" ")this.indent+=X.length;break;case"explicit-key-ind":case"map-value-ind":case"seq-item-ind":if(this.atNewLine)this.indent+=X.length;break;case"doc-mode":case"flow-error-end":return;default:this.atNewLine=!1}this.offset+=X.length}}*end(){while(this.stack.length>0)yield*this.pop()}get sourceToken(){return{type:this.type,offset:this.offset,indent:this.indent,source:this.source}}*step(){let X=this.peek(1);if(this.type==="doc-end"&&X?.type!=="doc-end"){while(this.stack.length>0)yield*this.pop();this.stack.push({type:"doc-end",offset:this.offset,source:this.source});return}if(!X)return yield*this.stream();switch(X.type){case"document":return yield*this.document(X);case"alias":case"scalar":case"single-quoted-scalar":case"double-quoted-scalar":return yield*this.scalar(X);case"block-scalar":return yield*this.blockScalar(X);case"block-map":return yield*this.blockMap(X);case"block-seq":return yield*this.blockSequence(X);case"flow-collection":return yield*this.flowCollection(X);case"doc-end":return yield*this.documentEnd(X)}yield*this.pop()}peek(X){return this.stack[this.stack.length-X]}*pop(X){let Z=X??this.stack.pop();if(!Z)yield{type:"error",offset:this.offset,source:"",message:"Tried to pop an empty stack"};else if(this.stack.length===0)yield Z;else{let Q=this.peek(1);if(Z.type==="block-scalar")Z.indent="indent"in Q?Q.indent:0;else if(Z.type==="flow-collection"&&Q.type==="document")Z.indent=0;if(Z.type==="flow-collection")NB(Z);switch(Q.type){case"document":Q.value=Z;break;case"block-scalar":Q.props.push(Z);break;case"block-map":{let G=Q.items[Q.items.length-1];if(G.value){Q.items.push({start:[],key:Z,sep:[]}),this.onKeyLine=!0;return}else if(G.sep)G.value=Z;else{Object.assign(G,{key:Z,sep:[]}),this.onKeyLine=!G.explicitKey;return}break}case"block-seq":{let G=Q.items[Q.items.length-1];if(G.value)Q.items.push({start:[],value:Z});else G.value=Z;break}case"flow-collection":{let G=Q.items[Q.items.length-1];if(!G||G.value)Q.items.push({start:[],key:Z,sep:[]});else if(G.sep)G.value=Z;else Object.assign(G,{key:Z,sep:[]});return}default:yield*this.pop(),yield*this.pop(Z)}if((Q.type==="document"||Q.type==="block-map"||Q.type==="block-seq")&&(Z.type==="block-map"||Z.type==="block-seq")){let G=Z.items[Z.items.length-1];if(G&&!G.sep&&!G.value&&G.start.length>0&&MB(G.start)===-1&&(Z.indent===0||G.start.every((J)=>J.type!=="comment"||J.indent<Z.indent))){if(Q.type==="document")Q.end=G.start;else Q.items.push({start:G.start});Z.items.splice(-1,1)}}}}*stream(){switch(this.type){case"directive-line":yield{type:"directive",offset:this.offset,source:this.source};return;case"byte-order-mark":case"space":case"comment":case"newline":yield this.sourceToken;return;case"doc-mode":case"doc-start":{let X={type:"document",offset:this.offset,start:[]};if(this.type==="doc-start")X.start.push(this.sourceToken);this.stack.push(X);return}}yield{type:"error",offset:this.offset,message:`Unexpected ${this.type} token in YAML stream`,source:this.source}}*document(X){if(X.value)return yield*this.lineEnd(X);switch(this.type){case"doc-start":{if(MB(X.start)!==-1)yield*this.pop(),yield*this.step();else X.start.push(this.sourceToken);return}case"anchor":case"tag":case"space":case"comment":case"newline":X.start.push(this.sourceToken);return}let Z=this.startBlockValue(X);if(Z)this.stack.push(Z);else yield{type:"error",offset:this.offset,message:`Unexpected ${this.type} token in YAML document`,source:this.source}}*scalar(X){if(this.type==="map-value-ind"){let Z=JQ(this.peek(2)),Q=h9(Z),G;if(X.end)G=X.end,G.push(this.sourceToken),delete X.end;else G=[this.sourceToken];let J={type:"block-map",offset:X.offset,indent:X.indent,items:[{start:Q,key:X,sep:G}]};this.onKeyLine=!0,this.stack[this.stack.length-1]=J}else yield*this.lineEnd(X)}*blockScalar(X){switch(this.type){case"space":case"comment":case"newline":X.props.push(this.sourceToken);return;case"scalar":if(X.source=this.source,this.atNewLine=!0,this.indent=0,this.onNewLine){let Z=this.source.indexOf(`
`)+1;while(Z!==0)this.onNewLine(this.offset+Z),Z=this.source.indexOf(`
`,Z)+1}yield*this.pop();break;default:yield*this.pop(),yield*this.step()}}*blockMap(X){let Z=X.items[X.items.length-1];switch(this.type){case"newline":if(this.onKeyLine=!1,Z.value){let Q="end"in Z.value?Z.value.end:void 0;if((Array.isArray(Q)?Q[Q.length-1]:void 0)?.type==="comment")Q?.push(this.sourceToken);else X.items.push({start:[this.sourceToken]})}else if(Z.sep)Z.sep.push(this.sourceToken);else Z.start.push(this.sourceToken);return;case"space":case"comment":if(Z.value)X.items.push({start:[this.sourceToken]});else if(Z.sep)Z.sep.push(this.sourceToken);else{if(this.atIndentedComment(Z.start,X.indent)){let G=X.items[X.items.length-2]?.value?.end;if(Array.isArray(G)){Array.prototype.push.apply(G,Z.start),G.push(this.sourceToken),X.items.pop();return}}Z.start.push(this.sourceToken)}return}if(this.indent>=X.indent){let Q=!this.onKeyLine&&this.indent===X.indent,G=Q&&(Z.sep||Z.explicitKey)&&this.type!=="seq-item-ind",J=[];if(G&&Z.sep&&!Z.value){let Y=[];for(let $=0;$<Z.sep.length;++$){let z=Z.sep[$];switch(z.type){case"newline":Y.push($);break;case"space":break;case"comment":if(z.indent>X.indent)Y.length=0;break;default:Y.length=0}}if(Y.length>=2)J=Z.sep.splice(Y[1])}switch(this.type){case"anchor":case"tag":if(G||Z.value)J.push(this.sourceToken),X.items.push({start:J}),this.onKeyLine=!0;else if(Z.sep)Z.sep.push(this.sourceToken);else Z.start.push(this.sourceToken);return;case"explicit-key-ind":if(!Z.sep&&!Z.explicitKey)Z.start.push(this.sourceToken),Z.explicitKey=!0;else if(G||Z.value)J.push(this.sourceToken),X.items.push({start:J,explicitKey:!0});else this.stack.push({type:"block-map",offset:this.offset,indent:this.indent,items:[{start:[this.sourceToken],explicitKey:!0}]});this.onKeyLine=!0;return;case"map-value-ind":if(Z.explicitKey)if(!Z.sep)if(q6(Z.start,"newline"))Object.assign(Z,{key:null,sep:[this.sourceToken]});else{let Y=h9(Z.start);this.stack.push({type:"block-map",offset:this.offset,indent:this.indent,items:[{start:Y,key:null,sep:[this.sourceToken]}]})}else if(Z.value)X.items.push({start:[],key:null,sep:[this.sourceToken]});else if(q6(Z.sep,"map-value-ind"))this.stack.push({type:"block-map",offset:this.offset,indent:this.indent,items:[{start:J,key:null,sep:[this.sourceToken]}]});else if(TB(Z.key)&&!q6(Z.sep,"newline")){let Y=h9(Z.start),$=Z.key,z=Z.sep;z.push(this.sourceToken),delete Z.key,delete Z.sep,this.stack.push({type:"block-map",offset:this.offset,indent:this.indent,items:[{start:Y,key:$,sep:z}]})}else if(J.length>0)Z.sep=Z.sep.concat(J,this.sourceToken);else Z.sep.push(this.sourceToken);else if(!Z.sep)Object.assign(Z,{key:null,sep:[this.sourceToken]});else if(Z.value||G)X.items.push({start:J,key:null,sep:[this.sourceToken]});else if(q6(Z.sep,"map-value-ind"))this.stack.push({type:"block-map",offset:this.offset,indent:this.indent,items:[{start:[],key:null,sep:[this.sourceToken]}]});else Z.sep.push(this.sourceToken);this.onKeyLine=!0;return;case"alias":case"scalar":case"single-quoted-scalar":case"double-quoted-scalar":{let Y=this.flowScalar(this.type);if(G||Z.value)X.items.push({start:J,key:Y,sep:[]}),this.onKeyLine=!0;else if(Z.sep)this.stack.push(Y);else Object.assign(Z,{key:Y,sep:[]}),this.onKeyLine=!0;return}default:{let Y=this.startBlockValue(X);if(Y){if(Y.type==="block-seq"){if(!Z.explicitKey&&Z.sep&&!q6(Z.sep,"newline")){yield*this.pop({type:"error",offset:this.offset,message:"Unexpected block-seq-ind on same line with key",source:this.source});return}}else if(Q)X.items.push({start:J});this.stack.push(Y);return}}}}yield*this.pop(),yield*this.step()}*blockSequence(X){let Z=X.items[X.items.length-1];switch(this.type){case"newline":if(Z.value){let Q="end"in Z.value?Z.value.end:void 0;if((Array.isArray(Q)?Q[Q.length-1]:void 0)?.type==="comment")Q?.push(this.sourceToken);else X.items.push({start:[this.sourceToken]})}else Z.start.push(this.sourceToken);return;case"space":case"comment":if(Z.value)X.items.push({start:[this.sourceToken]});else{if(this.atIndentedComment(Z.start,X.indent)){let G=X.items[X.items.length-2]?.value?.end;if(Array.isArray(G)){Array.prototype.push.apply(G,Z.start),G.push(this.sourceToken),X.items.pop();return}}Z.start.push(this.sourceToken)}return;case"anchor":case"tag":if(Z.value||this.indent<=X.indent)break;Z.start.push(this.sourceToken);return;case"seq-item-ind":if(this.indent!==X.indent)break;if(Z.value||q6(Z.start,"seq-item-ind"))X.items.push({start:[this.sourceToken]});else Z.start.push(this.sourceToken);return}if(this.indent>X.indent){let Q=this.startBlockValue(X);if(Q){this.stack.push(Q);return}}yield*this.pop(),yield*this.step()}*flowCollection(X){let Z=X.items[X.items.length-1];if(this.type==="flow-error-end"){let Q;do yield*this.pop(),Q=this.peek(1);while(Q?.type==="flow-collection")}else if(X.end.length===0){switch(this.type){case"comma":case"explicit-key-ind":if(!Z||Z.sep)X.items.push({start:[this.sourceToken]});else Z.start.push(this.sourceToken);return;case"map-value-ind":if(!Z||Z.value)X.items.push({start:[],key:null,sep:[this.sourceToken]});else if(Z.sep)Z.sep.push(this.sourceToken);else Object.assign(Z,{key:null,sep:[this.sourceToken]});return;case"space":case"comment":case"newline":case"anchor":case"tag":if(!Z||Z.value)X.items.push({start:[this.sourceToken]});else if(Z.sep)Z.sep.push(this.sourceToken);else Z.start.push(this.sourceToken);return;case"alias":case"scalar":case"single-quoted-scalar":case"double-quoted-scalar":{let G=this.flowScalar(this.type);if(!Z||Z.value)X.items.push({start:[],key:G,sep:[]});else if(Z.sep)this.stack.push(G);else Object.assign(Z,{key:G,sep:[]});return}case"flow-map-end":case"flow-seq-end":X.end.push(this.sourceToken);return}let Q=this.startBlockValue(X);if(Q)this.stack.push(Q);else yield*this.pop(),yield*this.step()}else{let Q=this.peek(2);if(Q.type==="block-map"&&(this.type==="map-value-ind"&&Q.indent===X.indent||this.type==="newline"&&!Q.items[Q.items.length-1].sep))yield*this.pop(),yield*this.step();else if(this.type==="map-value-ind"&&Q.type!=="flow-collection"){let G=JQ(Q),J=h9(G);NB(X);let Y=X.end.splice(1,X.end.length);Y.push(this.sourceToken);let $={type:"block-map",offset:X.offset,indent:X.indent,items:[{start:J,key:X,sep:Y}]};this.onKeyLine=!0,this.stack[this.stack.length-1]=$}else yield*this.lineEnd(X)}}flowScalar(X){if(this.onNewLine){let Z=this.source.indexOf(`
`)+1;while(Z!==0)this.onNewLine(this.offset+Z),Z=this.source.indexOf(`
`,Z)+1}return{type:X,offset:this.offset,indent:this.indent,source:this.source}}startBlockValue(X){switch(this.type){case"alias":case"scalar":case"single-quoted-scalar":case"double-quoted-scalar":return this.flowScalar(this.type);case"block-scalar-header":return{type:"block-scalar",offset:this.offset,indent:this.indent,props:[this.sourceToken],source:""};case"flow-map-start":case"flow-seq-start":return{type:"flow-collection",offset:this.offset,indent:this.indent,start:this.sourceToken,items:[],end:[]};case"seq-item-ind":return{type:"block-seq",offset:this.offset,indent:this.indent,items:[{start:[this.sourceToken]}]};case"explicit-key-ind":{this.onKeyLine=!0;let Z=JQ(X),Q=h9(Z);return Q.push(this.sourceToken),{type:"block-map",offset:this.offset,indent:this.indent,items:[{start:Q,explicitKey:!0}]}}case"map-value-ind":{this.onKeyLine=!0;let Z=JQ(X),Q=h9(Z);return{type:"block-map",offset:this.offset,indent:this.indent,items:[{start:Q,key:null,sep:[this.sourceToken]}]}}}return null}atIndentedComment(X,Z){if(this.type!=="comment")return!1;if(this.indent<=Z)return!1;return X.every((Q)=>Q.type==="newline"||Q.type==="space")}*documentEnd(X){if(this.type!=="doc-mode"){if(X.end)X.end.push(this.sourceToken);else X.end=[this.sourceToken];if(this.type==="newline")yield*this.pop()}}*lineEnd(X){switch(this.type){case"comma":case"doc-start":case"doc-end":case"flow-seq-end":case"flow-map-end":case"map-value-ind":yield*this.pop(),yield*this.step();break;case"newline":this.onKeyLine=!1;case"space":case"comment":default:if(X.end)X.end.push(this.sourceToken);else X.end=[this.sourceToken];if(this.type==="newline")yield*this.pop()}}}IC.Parser=qB});var IB=D((xC)=>{var EB=Z7(),CC=lZ(),rZ=cZ(),SC=VJ(),bC=z0(),RC=V7(),PB=B7();function jB(X){let Z=X.prettyErrors!==!1;return{lineCounter:X.lineCounter||Z&&new RC.LineCounter||null,prettyErrors:Z}}function yC(X,Z={}){let{lineCounter:Q,prettyErrors:G}=jB(Z),J=new PB.Parser(Q?.addNewLine),Y=new EB.Composer(Z),$=Array.from(Y.compose(J.parse(X)));if(G&&Q)for(let z of $)z.errors.forEach(rZ.prettifyError(X,Q)),z.warnings.forEach(rZ.prettifyError(X,Q));if($.length>0)return $;return Object.assign([],{empty:!0},Y.streamInfo())}function DB(X,Z={}){let{lineCounter:Q,prettyErrors:G}=jB(Z),J=new PB.Parser(Q?.addNewLine),Y=new EB.Composer(Z),$=null;for(let z of Y.compose(J.parse(X),!0,X.length))if(!$)$=z;else if($.options.logLevel!=="silent"){$.errors.push(new rZ.YAMLParseError(z.range.slice(0,2),"MULTIPLE_DOCS","Source contains multiple documents; please use YAML.parseAllDocuments()"));break}if(G&&Q)$.errors.forEach(rZ.prettifyError(X,Q)),$.warnings.forEach(rZ.prettifyError(X,Q));return $}function fC(X,Z,Q){let G=void 0;if(typeof Z==="function")G=Z;else if(Q===void 0&&Z&&typeof Z==="object")Q=Z;let J=DB(X,Q);if(!J)return null;if(J.warnings.forEach((Y)=>SC.warn(J.options.logLevel,Y)),J.errors.length>0)if(J.options.logLevel!=="silent")throw J.errors[0];else J.errors=[];return J.toJS(Object.assign({reviver:G},Q))}function kC(X,Z,Q){let G=null;if(typeof Z==="function"||Array.isArray(Z))G=Z;else if(Q===void 0&&Z)Q=Z;if(typeof Q==="string")Q=Q.length;if(typeof Q==="number"){let J=Math.round(Q);Q=J<1?void 0:J>8?{indent:8}:{indent:J}}if(X===void 0){let{keepUndefined:J}=Q??Z??{};if(!J)return}if(bC.isDocument(X)&&!G)return X.toString(Q);return new CC.Document(X,G,Q).toString(Q)}xC.parse=fC;xC.parseAllDocuments=yC;xC.parseDocument=DB;xC.stringify=kC});var nX=p8(jZ(),1);class DZ{constructor(X,Z,Q,G){this._uri=X,this._languageId=Z,this._version=Q,this._content=G,this._lineOffsets=void 0}get uri(){return this._uri}get languageId(){return this._languageId}get version(){return this._version}getText(X){if(X){let Z=this.offsetAt(X.start),Q=this.offsetAt(X.end);return this._content.substring(Z,Q)}return this._content}update(X,Z){for(let Q of X)if(DZ.isIncremental(Q)){let G=NW(Q.range),J=this.offsetAt(G.start),Y=this.offsetAt(G.end);this._content=this._content.substring(0,J)+Q.text+this._content.substring(Y,this._content.length);let $=Math.max(G.start.line,0),z=Math.max(G.end.line,0),H=this._lineOffsets,U=KW(Q.text,!1,J);if(z-$===U.length)for(let A=0,F=U.length;A<F;A++)H[A+$+1]=U[A];else if(U.length<1e4)H.splice($+1,z-$,...U);else this._lineOffsets=H=H.slice(0,$+1).concat(U,H.slice(z+1));let L=Q.text.length-(Y-J);if(L!==0)for(let A=$+1+U.length,F=H.length;A<F;A++)H[A]=H[A]+L}else if(DZ.isFull(Q))this._content=Q.text,this._lineOffsets=void 0;else throw Error("Unknown change event received");this._version=Z}getLineOffsets(){if(this._lineOffsets===void 0)this._lineOffsets=KW(this._content,!0);return this._lineOffsets}positionAt(X){X=Math.max(Math.min(X,this._content.length),0);let Z=this.getLineOffsets(),Q=0,G=Z.length;if(G===0)return{line:0,character:X};while(Q<G){let Y=Math.floor((Q+G)/2);if(Z[Y]>X)G=Y;else Q=Y+1}let J=Q-1;return X=this.ensureBeforeEOL(X,Z[J]),{line:J,character:X-Z[J]}}offsetAt(X){let Z=this.getLineOffsets();if(X.line>=Z.length)return this._content.length;else if(X.line<0)return 0;let Q=Z[X.line];if(X.character<=0)return Q;let G=X.line+1<Z.length?Z[X.line+1]:this._content.length,J=Math.min(Q+X.character,G);return this.ensureBeforeEOL(J,Q)}ensureBeforeEOL(X,Z){while(X>Z&&MW(this._content.charCodeAt(X-1)))X--;return X}get lineCount(){return this.getLineOffsets().length}static isIncremental(X){let Z=X;return Z!==void 0&&Z!==null&&typeof Z.text==="string"&&Z.range!==void 0&&(Z.rangeLength===void 0||typeof Z.rangeLength==="number")}static isFull(X){let Z=X;return Z!==void 0&&Z!==null&&typeof Z.text==="string"&&Z.range===void 0&&Z.rangeLength===void 0}}var I9;(function(X){function Z(J,Y,$,z){return new DZ(J,Y,$,z)}X.create=Z;function Q(J,Y,$){if(J instanceof DZ)return J.update(Y,$),J;else throw Error("TextDocument.update: document must be created by TextDocument.create")}X.update=Q;function G(J,Y){let $=J.getText(),z=QJ(Y.map(CT),(L,A)=>{let F=L.range.start.line-A.range.start.line;if(F===0)return L.range.start.character-A.range.start.character;return F}),H=0,U=[];for(let L of z){let A=J.offsetAt(L.range.start);if(A<H)throw Error("Overlapping edit");else if(A>H)U.push($.substring(H,A));if(L.newText.length)U.push(L.newText);H=J.offsetAt(L.range.end)}return U.push($.substr(H)),U.join("")}X.applyEdits=G})(I9||(I9={}));function QJ(X,Z){if(X.length<=1)return X;let Q=X.length/2|0,G=X.slice(0,Q),J=X.slice(Q);QJ(G,Z),QJ(J,Z);let Y=0,$=0,z=0;while(Y<G.length&&$<J.length)if(Z(G[Y],J[$])<=0)X[z++]=G[Y++];else X[z++]=J[$++];while(Y<G.length)X[z++]=G[Y++];while($<J.length)X[z++]=J[$++];return X}function KW(X,Z,Q=0){let G=Z?[Q]:[];for(let J=0;J<X.length;J++){let Y=X.charCodeAt(J);if(MW(Y)){if(Y===13&&J+1<X.length&&X.charCodeAt(J+1)===10)J++;G.push(Q+J+1)}}return G}function MW(X){return X===13||X===10}function NW(X){let{start:Z,end:Q}=X;if(Z.line>Q.line||Z.line===Q.line&&Z.character>Q.character)return{start:Q,end:Z};return X}function CT(X){let Z=NW(X.range);if(Z!==X.range)return{newText:X.newText,range:Z};return X}var G9=p8(jZ(),1);var mC=Z7(),pC=lZ(),dC=gJ(),L7=cZ(),lC=CZ(),E6=z0(),cC=K6(),iC=y0(),oC=N6(),nC=T6(),Qu=QQ(),sC=W7(),rC=V7(),aC=B7(),YQ=IB(),_B=IZ();var tC=mC.Composer,eC=pC.Document,XS=dC.Schema,ZS=L7.YAMLError,QS=L7.YAMLParseError,GS=L7.YAMLWarning,JS=lC.Alias,YS=E6.isAlias,$S=E6.isCollection,zS=E6.isDocument,MX=E6.isMap,HS=E6.isNode,P6=E6.isPair,j6=E6.isScalar,D6=E6.isSeq,US=cC.Pair,WS=iC.Scalar,VS=oC.YAMLMap,BS=nC.YAMLSeq;var LS=sC.Lexer,A7=rC.LineCounter,AS=aC.Parser,FS=YQ.parse,OS=YQ.parseAllDocuments,yX=YQ.parseDocument,wS=YQ.stringify,KS=_B.visit,MS=_B.visitAsync;var I6=(X)=>Array.isArray(X)?X:[X],CB=(X,Z)=>{let Q=[[],[]];for(let G of X)if(Z(G))Q[0].push(G);else Q[1].push(G);return Q},$Q=Array,NX=(X,Z)=>X.includes(Z),SB=(X,Z=0)=>[...Array(X)].map((Q,G)=>G+Z),G0=(X,Z,Q)=>{if(X===void 0)return Z===void 0?[]:Array.isArray(Z)?Z:[Z];if(Q?.prepend)if(Array.isArray(Z))X.unshift(...Z);else X.unshift(Z);else if(Array.isArray(Z))X.push(...Z);else X.push(Z);return X},J6=(X,Z)=>{if(Z===void 0||Z===null)return X??[];if(X===void 0||X===null)return I6(Z);return X.concat(Z)},bB=(...X)=>X.reduce(J6,[]),lX=(X,Z,Q)=>{if(X===void 0)return Array.isArray(Z)?Z:[Z];let G=Q?.isEqual??((J,Y)=>J===Y);for(let J of I6(Z))if(!X.some((Y)=>G(Y,J)))X.push(J);return X},RB=(X,Z)=>X.reduce((Q,G)=>{let J=G[Z];return Q[J]=G0(Q[J],G),Q},{}),Y6=(X,Z,Q)=>X.length===Z.length&&X.every(Q?.isEqual?(G,J)=>Q.isEqual(G,Z[J]):(G,J)=>G===Z[J]);var XX=(X,Z)=>x0(X)===Z,x0=(X)=>{let Z=typeof X;return Z==="object"?X===null?"null":"object":Z==="function"?"object":Z},ZX={boolean:"boolean",null:"null",undefined:"undefined",bigint:"a bigint",number:"a number",object:"an object",string:"a string",symbol:"a symbol"},yB={...ZX,function:"a function"};class fB extends Error{}var H0=(X)=>s6(X,fB),s6=(X,Z=Error)=>{throw new Z(X)};class aZ extends Error{name="ParseError"}var I=(X)=>s6(X,aZ),fX=(X)=>` ${X}`,kB="";var s=(X,Z)=>{let Q={},G=Array.isArray(X),J=!1;for(let[Y,$]of Object.entries(X).entries()){let z=G?Z(Y,$[1]):Z(...$,Y);J||=typeof z[0]==="number";let H=Array.isArray(z[0])||z.length===0?z:[z];for(let[U,L]of H)if(typeof U==="object")Q[U.group]=G0(Q[U.group],L);else Q[U]=L}return J?Object.values(Q):Q};var F7=Object.entries;var v0=(X,Z)=>(X in Z),g9=(X,Z)=>(Z in X);class O7{constructor(X){Object.assign(this,X)}}var xB=class{};class tZ extends xB{}var NS=(X,Z)=>{let Q={},G={},J;for(J in X)if(J in Z)Q[J]=X[J];else G[J]=X[J];return[Q,G]};var zQ=(X,Z)=>NS(X,Z)[1],cX=(X)=>Object.keys(X).length===0,r6=(X)=>[...Object.entries(X),...Object.getOwnPropertySymbols(X).map((Z)=>[Z,X[Z]])],vB=(X,Z)=>Object.defineProperties(X,Object.getOwnPropertyDescriptors(Z)),hB=(X)=>{let Z=Object.keys(X).sort(),Q={};for(let G=0;G<Z.length;G++)Q[Z[G]]=X[Z[G]];return Q};var QX=fX(`unset${kB}`),gB=(X)=>Object.values(X).filter((Z)=>{if(typeof Z==="number")return!0;return typeof X[Z]!=="number"});var w7={Array,Boolean,Date,Error,Function,Map,Number,Promise,RegExp,Set,String,WeakMap,WeakSet},K7=globalThis.File??Blob,M7={ArrayBuffer,Blob,File:K7,FormData,Headers,Request,Response,URL},TS={Int8Array,Uint8Array,Uint8ClampedArray,Int16Array,Uint16Array,Int32Array,Uint32Array,Float32Array,Float64Array,BigInt64Array,BigUint64Array},a6={...w7,...M7,...TS,String,Number,Boolean},eZ=(X)=>{let Z=Object.getPrototypeOf(X);while(Z?.constructor&&(!v0(Z.constructor.name,a6)||!(X instanceof a6[Z.constructor.name])))Z=Object.getPrototypeOf(Z);let Q=Z?.constructor?.name;if(Q===void 0||Q==="Object")return;return Q},X8=(X)=>typeof X==="object"&&X!==null?eZ(X)??"object":x0(X);var O0=Array.isArray,qS={Array:"an array",Function:"a function",Date:"a Date",RegExp:"a RegExp",Error:"an Error",Map:"a Map",Set:"a Set",String:"a String object",Number:"a Number object",Boolean:"a Boolean object",Promise:"a Promise",WeakMap:"a WeakMap",WeakSet:"a WeakSet"},ES={ArrayBuffer:"an ArrayBuffer instance",Blob:"a Blob instance",File:"a File instance",FormData:"a FormData instance",Headers:"a Headers instance",Request:"a Request instance",Response:"a Response instance",URL:"a URL instance"},PS={Int8Array:"an Int8Array",Uint8Array:"a Uint8Array",Uint8ClampedArray:"a Uint8ClampedArray",Int16Array:"an Int16Array",Uint16Array:"a Uint16Array",Int32Array:"an Int32Array",Uint32Array:"a Uint32Array",Float32Array:"a Float32Array",Float64Array:"a Float64Array",BigInt64Array:"a BigInt64Array",BigUint64Array:"a BigUint64Array"},uB={...qS,...ES,...PS},Z8=(X)=>{let Z=Object(X).name??null;return Z&&v0(Z,a6)&&a6[Z]===X?Z:null};var N7=(X,Z)=>{let Q=X.prototype;while(Q!==null){if(Q===Z.prototype)return!0;Q=Object.getPrototypeOf(Q)}return!1};var mB=(X)=>pB(X,new Map),pB=(X,Z)=>{if(typeof X!=="object"||X===null)return X;if(Z?.has(X))return Z.get(X);let Q=Z8(X.constructor);if(Q==="Date")return new Date(X.getTime());if(Q&&Q!=="Array")return X;let G=Array.isArray(X)?X.slice():Object.create(Object.getPrototypeOf(X)),J=Object.getOwnPropertyDescriptors(X);if(Z){Z.set(X,G);for(let Y in J){let $=J[Y];if("get"in $||"set"in $)continue;$.value=pB($.value,Z)}}return Object.defineProperties(G,J),G};var jS=(X)=>{let Z=QX;return()=>Z===QX?Z=X():Z},_6=(X)=>typeof X==="function"&&X.length===0;var dB=class extends Function{constructor(...X){let Z=X.slice(0,-1),Q=X[X.length-1];try{super(...Z,Q)}catch(G){return H0(`Encountered an unexpected error while compiling your definition:
                Message: ${G} 
                Source: (${X.slice(0,-1)}) => {
                    ${X[X.length-1]}
                }`)}}};class GX{constructor(X,...[Z]){return Object.assign(Object.setPrototypeOf(X.bind(Z?.bind??this),this.constructor.prototype),Z?.attach)}}var lB=jS(()=>{try{return Function("return false")()}catch{return!0}});var Eu=fX("brand");var cB=fX("arkInferred");var Du=fX("args");class o0{constructor(){}}var DS=()=>{try{return((Error().stack?.split(`
`)[2]?.trim()||"").match(/\(?(.+?)(?::\d+:\d+)?\)?$/)?.[1]||"unknown").replace(/^file:\/\//,"")}catch{return"unknown"}},IS=globalThis.process?.env??{},iB={fileName:DS,env:IS};var oB=(X)=>X[0].toUpperCase()+X.slice(1),nB=(X)=>X[0].toLowerCase()+X.slice(1),T7=(X)=>new RegExp(_S(X),typeof X==="string"?"":X.flags);var _S=(X)=>{return`^(?:${typeof X==="string"?X:X.source})$`};var $6={negativeLookahead:(X)=>`(?!${X})`,nonCapturingGroup:(X)=>`(?:${X})`},t6="\\",C6={" ":1,"\n":1,"\t":1};var CS=/^-0\.?0*$/.source,rB=/[1-9]\d*/.source,SS=/\.\d+/.source,bS=/\.\d*[1-9]/.source,aB=(X)=>T7($6.negativeLookahead(CS)+$6.nonCapturingGroup("-?"+$6.nonCapturingGroup($6.nonCapturingGroup("0|"+rB)+$6.nonCapturingGroup(X.decimalPattern)+"?")+(X.allowDecimalOnly?"|"+X.decimalPattern:"")+"?")),sB=aB({decimalPattern:bS,allowDecimalOnly:!1}),RS=sB.test.bind(sB),HQ=aB({decimalPattern:SS,allowDecimalOnly:!0}),yu=HQ.test.bind(HQ),yS=/^-?\d*\.?\d*$/,fS=(X)=>X.length!==0&&yS.test(X),Q8=T7($6.negativeLookahead("^-0$")+"-?"+$6.nonCapturingGroup($6.nonCapturingGroup("0|"+rB))),kS=Q8.test.bind(Q8),q7=/^-?\d+$/,xS=q7.test.bind(q7),tB={number:"a number",bigint:"a bigint",integer:"an integer"},eB=(X,Z)=>`'${X}' was parsed as ${tB[Z]} but could not be narrowed to a literal value. Avoid unnecessary leading or trailing zeros and other abnormal notation`,vS=(X,Z)=>Z==="number"?RS(X):kS(X),hS=(X,Z)=>Z==="number"?Number(X):Number.parseInt(X),gS=(X,Z)=>Z==="number"?fS(X):xS(X),X2=(X,Z)=>E7(X,"number",Z),Z2=(X,Z)=>E7(X,"number",{...Z,strict:!0}),Q2=(X,Z)=>E7(X,"integer",Z),E7=(X,Z,Q)=>{let G=hS(X,Z);if(!Number.isNaN(G)){if(gS(X,Z)){if(Q?.strict)return vS(X,Z)?G:I(eB(X,Z));return G}}return Q?.errorOnFail?I(Q?.errorOnFail===!0?`Failed to parse ${tB[Z]} from '${X}'`:Q?.errorOnFail):void 0},G2=(X)=>{if(X[X.length-1]!=="n")return;let Z=X.slice(0,-1),Q;try{Q=BigInt(Z)}catch{return}if(Q8.test(Z))return Q;if(q7.test(Z))return I(eB(X,"bigint"))};var uS="0.56.0",mS={version:uS,filename:iB.fileName(),FileConstructor:K7},e6=mS,J2=new Map,P7=Object.create(null),G8=(X)=>{let Z=J2.get(X);if(Z)return Z;let Q=pS(X);if(P7[Q])Q=`${Q}${P7[Q]++}`;else P7[Q]=1;return e6[Q]=X,J2.set(X,Q),Q},S6=(X)=>/^[$A-Z_a-z][\w$]*$/.test(X),pS=(X)=>{switch(typeof X){case"object":{if(X===null)break;let Z=eZ(X)??"object";return Z[0].toLowerCase()+Z.slice(1)}case"function":return S6(X.name)?X.name:"fn";case"symbol":return X.description&&S6(X.description)?X.description:"symbol"}return H0(`Unexpected attempt to register serializable value of type ${x0(X)}`)};var J8=(X)=>typeof X==="string"?JSON.stringify(X):typeof X==="bigint"?`${X}n`:`${X}`;var Y2=(X,Z={})=>Y8(X,{onUndefined:"$ark.undefined",onBigInt:(Q)=>`$ark.bigint-${Q}`,...Z},[]);var r=(X,Z)=>{switch(x0(X)){case"object":let Q=X,G=Q.constructor?.name??"Object";return G==="Object"||G==="Array"?Z?.quoteKeys===!1?UQ(Q,Z?.indent??0,""):JSON.stringify(Y8(Q,u9,[]),null,Z?.indent):UQ(Q,Z?.indent??0,"");case"symbol":return u9.onSymbol(X);default:return J8(X)}},UQ=(X,Z,Q)=>{if(typeof X==="function")return u9.onFunction(X);if(typeof X!=="object"||X===null)return J8(X);let G=Q+" ".repeat(Z);if(Array.isArray(X)){if(X.length===0)return"[]";let Y=X.map(($)=>UQ($,Z,G)).join(`,
`+G);return Z?`[
${G}${Y}
${Q}]`:`[${Y}]`}let J=X.constructor?.name??"Object";if(J==="Object"){let Y=r6(X).map(([$,z])=>{let H=typeof $==="symbol"?u9.onSymbol($):S6($)?$:JSON.stringify($),U=UQ(z,Z,G);return`${G}${H}: ${U}`});if(Y.length===0)return"{}";return Z?`{
${Y.join(`,
`)}
${Q}}`:`{${Y.join(", ")}}`}if(X instanceof Date)return X9(X);if("expression"in X&&typeof X.expression==="string")return X.expression;return J},u9={onCycle:()=>"(cycle)",onSymbol:(X)=>`Symbol(${G8(X)})`,onFunction:(X)=>`Function(${G8(X)})`},Y8=(X,Z,Q)=>{switch(x0(X)){case"object":{let G=X;if("toJSON"in G&&typeof G.toJSON==="function")return G.toJSON();if(typeof G==="function")return u9.onFunction(G);if(Q.includes(G))return"(cycle)";let J=[...Q,G];if(Array.isArray(G))return G.map(($)=>Y8($,Z,J));if(G instanceof Date)return G.toDateString();let Y={};for(let $ in G)Y[$]=Y8(G[$],Z,J);for(let $ of Object.getOwnPropertySymbols(G))Y[Z.onSymbol?.($)??$.toString()]=Y8(G[$],Z,J);return Y}case"symbol":return u9.onSymbol(X);case"bigint":return Z.onBigInt?.(X)??`${X}n`;case"undefined":return Z.onUndefined??"undefined";case"string":return X.replace(/\\/g,"\\\\");default:return X}},X9=(X)=>{let Z=X.getFullYear(),Q=X.getMonth(),G=X.getDate(),J=X.getHours(),Y=X.getMinutes(),$=X.getSeconds(),z=X.getMilliseconds();if(Q===0&&G===1&&J===0&&Y===0&&$===0&&z===0)return`${Z}`;let H=`${dS[Q]} ${G}, ${Z}`;if(J===0&&Y===0&&$===0&&z===0)return H;let U=X.toLocaleTimeString(),L=U.endsWith(" AM")||U.endsWith(" PM")?U.slice(-3):"";if(L)U=U.slice(0,-L.length);if(z)U+=`.${cS(z,3)}`;else if(lS.test(U))U=U.slice(0,-3);return`${U+L}, ${H}`},dS=["January","February","March","April","May","June","July","August","September","October","November","December"],lS=/:\d\d:00$/,cS=(X,Z)=>String(X).padStart(Z,"0");var $2=(X,Z,...[Q])=>{let G=Q?.stringifySymbol??r,J=X;switch(typeof Z){case"string":J=S6(Z)?X===""?Z:`${X}.${Z}`:`${X}[${JSON.stringify(Z)}]`;break;case"number":J=`${X}[${Z}]`;break;case"symbol":J=`${X}[${G(Z)}]`;break;default:if(Q?.stringifyNonKey)J=`${X}[${Q.stringifyNonKey(Z)}]`;else I(`${r(Z)} must be a PropertyKey or stringifyNonKey must be passed to options`)}return J},z6=(X,...Z)=>X.reduce((Q,G)=>$2(Q,G,...Z),"");class $8 extends $Q{cache={};constructor(...X){super();this.push(...X)}toJSON(){if(this.cache.json)return this.cache.json;this.cache.json=[];for(let X=0;X<this.length;X++)this.cache.json.push(typeof this[X]==="symbol"?r(this[X]):this[X]);return this.cache.json}stringify(){if(this.cache.stringify)return this.cache.stringify;return this.cache.stringify=z6(this)}stringifyAncestors(){if(this.cache.stringifyAncestors)return this.cache.stringifyAncestors;let X="",Z=[X];for(let Q of this)X=$2(X,Q),Z.push(X);return this.cache.stringifyAncestors=Z}}class z8{chars;i;def;constructor(X){this.def=X,this.chars=[...X],this.i=0}shift(){return this.chars[this.i++]??""}get lookahead(){return this.chars[this.i]??""}get nextLookahead(){return this.chars[this.i+1]??""}get length(){return this.chars.length}shiftUntil(X){let Z="";while(this.lookahead)if(X(this,Z))break;else Z+=this.shift();return Z}shiftUntilEscapable(X){let Z="";while(this.lookahead)if(this.lookahead===t6)if(this.shift(),X(this,Z))Z+=this.shift();else if(this.lookahead===t6)Z+=this.shift();else Z+=`${t6}${this.shift()}`;else if(X(this,Z))break;else Z+=this.shift();return Z}shiftUntilLookahead(X){return typeof X==="string"?this.shiftUntil((Z)=>Z.lookahead===X):this.shiftUntil((Z)=>(Z.lookahead in X))}shiftUntilNonWhitespace(){return this.shiftUntil(()=>!(this.lookahead in C6))}jumpToIndex(X){this.i=X<0?this.length+X:X}jumpForward(X){this.i+=X}get location(){return this.i}get unscanned(){return this.chars.slice(this.i,this.length).join("")}get scanned(){return this.chars.slice(0,this.i).join("")}sliceChars(X,Z){return this.chars.slice(X,Z).join("")}lookaheadIs(X){return this.lookahead===X}lookaheadIsIn(X){return this.lookahead in X}}var z2=(X,Z)=>`Unmatched ${X}${Z===""?"":` before ${Z}`}`,WQ=(X)=>`Missing ${X}`;var Jm=fX("implementedTraits");var j7="$ark",iS=2;while(j7 in globalThis)j7=`$ark${iS++}`;var H2=j7;globalThis[H2]=e6;var f=e6,oS=(X)=>`${H2}.${X}`,_0=(X)=>oS(G8(X));class VQ extends tZ{argNames;body="";constructor(...X){super();this.argNames=X;for(let Z of X){if(Z in this)throw Error(`Arg name '${Z}' would overwrite an existing property on FunctionBody`);this[Z]=Z}}indentation=0;indent(){return this.indentation+=4,this}dedent(){return this.indentation-=4,this}prop(X,Z=!1){return D7(X,Z)}index(X,Z=!1){return U2(`${X}`,Z)}line(X){return this.body+=`${" ".repeat(this.indentation)}${X}
`,this}const(X,Z){return this.line(`const ${X} = ${Z}`),this}let(X,Z){return this.line(`let ${X} = ${Z}`)}set(X,Z){return this.line(`${X} = ${Z}`)}if(X,Z){return this.block(`if (${X})`,Z)}elseIf(X,Z){return this.block(`else if (${X})`,Z)}else(X){return this.block("else",X)}for(X,Z,Q=0){return this.block(`for (let i = ${Q}; ${X}; i++)`,Z)}forIn(X,Z){return this.block(`for (const k in ${X})`,Z)}block(X,Z,Q=""){return this.line(`${X} {`),this.indent(),Z(this),this.dedent(),this.line(`}${Q}`)}return(X=""){return this.line(`return ${X}`)}write(X="anonymous",Z=0){return`${X}(${this.argNames.join(", ")}) { ${Z?this.body.split(`
`).map((Q)=>" ".repeat(Z)+`${Q}`).join(`
`):this.body} }`}compile(){return new dB(...this.argNames,this.body)}}var kX=(X)=>XX(X,"object")||typeof X==="symbol"?_0(X):J8(X),D7=(X,Z=!1)=>{if(typeof X==="string"&&S6(X))return`${Z?"?":""}.${X}`;return U2(nS(X),Z)},nS=(X)=>typeof X==="symbol"?_0(X):JSON.stringify(X),U2=(X,Z=!1)=>`${Z?"?.":""}[${X}]`;class H8 extends VQ{traversalKind;optimistic;constructor(X){super("data","ctx");this.traversalKind=X.kind,this.optimistic=X.optimistic===!0}invoke(X,Z){let Q=Z?.arg??this.data,G=typeof X==="string"?!0:this.requiresContextFor(X),J=typeof X==="string"?X:X.id;if(G)return`${this.referenceToId(J,Z)}(${Q}, ${this.ctx})`;return`${this.referenceToId(J,Z)}(${Q})`}referenceToId(X,Z){let Q=Z?.kind??this.traversalKind,G=`this.${X}${Q}`;return Z?.bind?`${G}.bind(${Z?.bind})`:G}requiresContextFor(X){return this.traversalKind==="Apply"||X.allowsRequiresContext}initializeErrorCount(){return this.const("errorCount","ctx.currentErrorCount")}returnIfFail(){return this.if("ctx.currentErrorCount > errorCount",()=>this.return())}returnIfFailFast(){return this.if("ctx.failFast && ctx.currentErrorCount > errorCount",()=>this.return())}traverseKey(X,Z,Q){let G=this.requiresContextFor(Q);if(G)this.line(`${this.ctx}.path.push(${X})`);if(this.check(Q,{arg:Z}),G)this.line(`${this.ctx}.path.pop()`);return this}check(X,Z){return this.traversalKind==="Allows"?this.if(`!${this.invoke(X,Z)}`,()=>this.return(!1)):this.line(this.invoke(X,Z))}}var BQ=(X)=>s(X,(Z,Q)=>[Z,O0(Q)?[...Q]:Q]),r0=fX("arkKind"),l=(X,Z)=>X?.[r0]===Z,M0=(X)=>l(X,"root")||l(X,"constraint");var W2=["unit","proto","domain"],m9=["required","optional","index","sequence"],I7=["pattern","divisor","exactLength","max","min","maxLength","minLength","before","after"],_7=[...I7,"structure","predicate"],LQ=[..._7,...m9],p9=["alias","union","morph","unit","intersection","proto","domain"],sS=[...p9,...LQ],AQ=s(LQ,(X,Z)=>[Z,1]),V2=s([...m9,"undeclared"],(X,Z)=>[Z,1]),B2=s(sS,(X,Z)=>[Z,X]),d9=(X)=>typeof X==="string"&&(X in B2);var l9=(X)=>B2[X],FQ=(X)=>p9.slice(l9(X)+1),mm=[...FQ("union"),"alias"],pm=[...FQ("morph"),"alias"],TX=(X)=>{if(typeof X==="string"||typeof X==="boolean"||X===null)return X;if(typeof X==="number"){if(Number.isNaN(X))return"NaN";if(X===Number.POSITIVE_INFINITY)return"Infinity";if(X===Number.NEGATIVE_INFINITY)return"-Infinity";return X}return kX(X)},b6=(X)=>{let Z="{ ";for(let[Q,G]of Object.entries(X))Z+=`${Q}: ${kX(G)}, `;return Z+" }"},t=(X)=>{let Z=X;if(Z.hasAssociatedError)Z.defaults.expected??=(Q)=>("description"in Q)?Q.description:Z.defaults.description(Q),Z.defaults.actual??=(Q)=>r(Q),Z.defaults.problem??=(Q)=>`must be ${Q.expected}${Q.actual?` (was ${Q.actual})`:""}`,Z.defaults.message??=(Q)=>{if(Q.path.length===0)return Q.problem;let G=`${Q.propString} ${Q.problem}`;if(G[0]==="[")return`value at ${G}`;return G};return Z};class L2 extends Error{name="ToJsonSchemaError";code;context;constructor(X,Z){super(r(Z,{quoteKeys:!1,indent:4}));this.code=X,this.context=Z}hasCode(X){return this.code===X}}var rS={target:"draft-2020-12",dialect:"https://json-schema.org/draft/2020-12/schema",useRefs:!1,fallback:{arrayObject:(X)=>q0.throw("arrayObject",X),arrayPostfix:(X)=>q0.throw("arrayPostfix",X),defaultValue:(X)=>q0.throw("defaultValue",X),domain:(X)=>q0.throw("domain",X),morph:(X)=>q0.throw("morph",X),patternIntersection:(X)=>q0.throw("patternIntersection",X),predicate:(X)=>q0.throw("predicate",X),proto:(X)=>q0.throw("proto",X),symbolKey:(X)=>q0.throw("symbolKey",X),unit:(X)=>q0.throw("unit",X),date:(X)=>q0.throw("date",X)}},q0={Error:L2,throw:(...X)=>{throw new q0.Error(...X)},throwInternalOperandError:(X,Z)=>H0(`Unexpected JSON Schema input for ${X}: ${r(Z)}`),defaultConfig:rS};f.config??={};var U8=(X,Z)=>{if(!Z)return X;let Q={...X},G;for(G in Z){let J={...X.keywords};if(G==="keywords"){for(let Y in Z[G]){let $=Z.keywords[Y];if($===void 0)continue;J[Y]=typeof $==="string"?{description:$}:$}Q.keywords=J}else if(G==="toJsonSchema")Q[G]=C7(X.toJsonSchema,Z.toJsonSchema);else if(d9(G))Q[G]={...X[G],...Z[G]};else Q[G]=Z[G]}return Q},aS={"draft-2020-12":"https://json-schema.org/draft/2020-12/schema","draft-07":"http://json-schema.org/draft-07/schema#"},C7=(X,Z)=>{if(!X)return A2(Z??{},void 0);if(!Z)return X;let Q={...X},G;for(G in Z)if(G==="fallback")Q.fallback=tS(X.fallback,Z.fallback);else Q[G]=Z[G];return A2(Q,Z)},A2=(X,Z)=>{if(Z?.dialect!==void 0)return X;if(Z?.target!==void 0)return{...X,dialect:aS[Z.target]};return X},tS=(X,Z)=>{X=F2(X),Z=F2(Z);let Q={},G;for(G in q0.defaultConfig.fallback)Q[G]=Z[G]??Z.default??X[G]??X.default??q0.defaultConfig.fallback[G];return Q},F2=(X)=>typeof X==="function"?{default:X}:X??{};class R6 extends tZ{[r0]="error";path;data;nodeConfig;input;ctx;constructor({prefixPath:X,relativePath:Z,...Q},G){super();this.input=Q,this.ctx=G,vB(this,Q);let J=G.data;if(Q.code==="union")Q.errors=Q.errors.flatMap(($)=>{let z=$.hasCode("union")?$.errors:[$];if(!X&&!Z)return z;return z.map((H)=>H.transform((U)=>({...U,path:bB(X,U.path,Z)})))});this.nodeConfig=G.config[this.code];let Y=[...Q.path??G.path];if(Z)Y.push(...Z);if(X)Y.unshift(...X);this.path=new $8(...Y),this.data="data"in Q?Q.data:J}transform(X){return new R6(X({data:this.data,path:this.path,...this.input}),this.ctx)}hasCode(X){return this.code===X}get propString(){return z6(this.path)}get expected(){if(this.input.expected)return this.input.expected;let X=this.meta?.expected??this.nodeConfig.expected;return typeof X==="function"?X(this.input):X}get actual(){if(this.input.actual)return this.input.actual;let X=this.meta?.actual??this.nodeConfig.actual;return typeof X==="function"?X(this.data):X}get problem(){if(this.input.problem)return this.input.problem;let X=this.meta?.problem??this.nodeConfig.problem;return typeof X==="function"?X(this):X}get message(){if(this.input.message)return this.input.message;let X=this.meta?.message??this.nodeConfig.message;return typeof X==="function"?X(this):X}get flat(){return this.hasCode("intersection")?[...this.errors]:[this]}toJSON(){return{data:this.data,path:this.path,...this.input,expected:this.expected,actual:this.actual,problem:this.problem,message:this.message}}toString(){return this.message}throw(){throw this}}class JX extends $Q{[r0]="errors";ctx;constructor(X){super();this.ctx=X}byPath=Object.create(null);get flatByPath(){return s(this.byPath,(X,Z)=>[X,Z.flat])}get flatProblemsByPath(){return s(this.byPath,(X,Z)=>[X,Z.flat.map((Q)=>Q.problem)])}byAncestorPath=Object.create(null);count=0;mutable=this;throw(){throw this.toTraversalError()}toTraversalError(){return new S7(this)}add(X){let Z=this.byPath[X.propString];if(Z){if(X===Z)return;if(Z.hasCode("union")&&Z.errors.length===0)return;let Q=X.hasCode("union")&&X.errors.length===0?X:new R6({code:"intersection",errors:Z.hasCode("intersection")?[...Z.errors,X]:[Z,X]},this.ctx),G=this.indexOf(Z);this.mutable[G===-1?this.length:G]=Q,this.byPath[X.propString]=Q,this.addAncestorPaths(X)}else this.byPath[X.propString]=X,this.addAncestorPaths(X),this.mutable.push(X);this.count++}transform(X){let Z=new JX(this.ctx);for(let Q of this)Z.add(X(Q));return Z}merge(X){for(let Z of X)this.add(new R6({...Z,path:[...this.ctx.path,...Z.path]},this.ctx))}affectsPath(X){if(this.length===0)return!1;return X.stringifyAncestors().some((Z)=>(Z in this.byPath))||X.stringify()in this.byAncestorPath}get summary(){return this.toString()}get issues(){return this}toJSON(){return[...this.map((X)=>X.toJSON())]}toString(){return this.join(`
`)}addAncestorPaths(X){for(let Z of X.path.stringifyAncestors())this.byAncestorPath[Z]=G0(this.byAncestorPath[Z],X)}}class S7 extends Error{name="TraversalError";constructor(X){if(X.length===1)super(X.summary);else super(`
`+X.map((Z)=>`   ${eS(Z)}`).join(`
`));Object.defineProperty(this,"arkErrors",{value:X,enumerable:!1})}}var eS=(X)=>X.toString().split(`
`).join(`
  `);class xX{path=[];errors=new JX(this);root;config;queuedMorphs=[];branches=[];seen={};constructor(X,Z){this.root=X,this.config=Z}get data(){let X=this.root;for(let Z of this.path)X=X?.[Z];return X}get propString(){return z6(this.path)}reject(X){return this.error(X),!1}mustBe(X){return this.error(X),!1}error(X){let Z=typeof X==="object"?X.code?X:{...X,code:"predicate"}:{code:"predicate",expected:X};return this.errorFromContext(Z)}hasError(){return this.currentErrorCount!==0}get currentBranch(){return this.branches[this.branches.length-1]}queueMorphs(X){let Z={path:new $8(...this.path),morphs:X};if(this.currentBranch)this.currentBranch.queuedMorphs.push(Z);else this.queuedMorphs.push(Z)}finalize(X){if(this.queuedMorphs.length){if(typeof this.root==="object"&&this.root!==null&&this.config.clone)this.root=this.config.clone(this.root);this.applyQueuedMorphs()}if(this.hasError())return X?X(this.errors):this.errors;return this.root}get currentErrorCount(){return this.currentBranch?this.currentBranch.error?1:0:this.errors.count}get failFast(){return this.branches.length!==0}pushBranch(){this.branches.push({error:void 0,queuedMorphs:[]})}popBranch(){return this.branches.pop()}get external(){return this}errorFromNodeContext(X){return this.errorFromContext(X)}errorFromContext(X){let Z=new R6(X,this);if(this.currentBranch)this.currentBranch.error=Z;else this.errors.add(Z);return Z}applyQueuedMorphs(){while(this.queuedMorphs.length){let X=this.queuedMorphs;this.queuedMorphs=[];for(let{path:Z,morphs:Q}of X){if(this.errors.affectsPath(Z))continue;this.applyMorphsAtPath(Z,Q)}}}applyMorphsAtPath(X,Z){let Q=X[X.length-1],G;if(Q!==void 0){G=this.root;for(let J=0;J<X.length-1;J++)G=G[X[J]]}for(let J of Z){this.path=[...X];let Y=M0(J),$=J(G===void 0?this.root:G[Q],this);if($ instanceof R6){if(!this.errors.includes($))this.errors.add($);break}if($ instanceof JX){if(!Y)this.errors.merge($);this.queuedMorphs=[];break}if(G===void 0)this.root=$;else G[Q]=$;this.applyQueuedMorphs()}}}var YX=(X,Z,Q)=>{if(!Q)return Z();Q.path.push(X);let G=Z();return Q.path.pop(),G};class V8 extends GX{attachments;$;onFail;includesTransform;includesContextualPredicate;isCyclic;allowsRequiresContext;rootApplyStrategy;contextFreeMorph;rootApply;referencesById;shallowReferences;flatRefs;flatMorphs;allows;get shallowMorphs(){return[]}constructor(X,Z){super((G,J,Y=this.onFail)=>{if(J)return this.traverseApply(G,J),J.hasError()?J.errors:J.data;return this.rootApply(G,Y)},{attach:X});this.attachments=X,this.$=Z,this.onFail=this.meta.onFail??this.$.resolvedConfig.onFail,this.includesTransform=this.hasKind("morph")||this.hasKind("structure")&&this.structuralMorph!==void 0||this.hasKind("sequence")&&this.inner.defaultables!==void 0,this.includesContextualPredicate=this.hasKind("predicate")&&this.inner.predicate.length!==1,this.isCyclic=this.kind==="alias",this.referencesById={[this.id]:this},this.shallowReferences=this.hasKind("structure")?[this,...this.children]:this.children.reduce((G,J)=>Gb(G,J.shallowReferences),[this]);let Q=this.isStructural();this.flatRefs=[],this.flatMorphs=[];for(let G=0;G<this.children.length;G++){if(this.includesTransform||=this.children[G].includesTransform,this.includesContextualPredicate||=this.children[G].includesContextualPredicate,this.isCyclic||=this.children[G].isCyclic,!Q){let J=this.children[G].flatRefs;for(let Y=0;Y<J.length;Y++){let $=J[Y];if(!this.flatRefs.some((z)=>w2(z,$))){this.flatRefs.push($);for(let z of $.node.branches)if(z.hasKind("morph")||z.hasKind("intersection")&&z.structure?.structuralMorph!==void 0)this.flatMorphs.push({path:$.path,propString:$.propString,node:z})}}}Object.assign(this.referencesById,this.children[G].referencesById)}this.flatRefs.sort((G,J)=>G.path.length>J.path.length?1:G.path.length<J.path.length?-1:G.propString>J.propString?1:G.propString<J.propString?-1:G.node.expression<J.node.expression?-1:1),this.allowsRequiresContext=this.includesContextualPredicate||this.isCyclic,this.rootApplyStrategy=!this.allowsRequiresContext&&this.flatMorphs.length===0?this.shallowMorphs.length===0?"allows":this.shallowMorphs.every((G)=>G.length===1||G.name==="$arkStructuralMorph")?this.hasKind("union")?this.branches.some((G)=>G.shallowMorphs.length>1)?"contextual":"branchedOptimistic":this.shallowMorphs.length>1?"contextual":"optimistic":"contextual":"contextual",this.rootApply=this.createRootApply(),this.allows=this.allowsRequiresContext?(G)=>this.traverseAllows(G,new xX(G,this.$.resolvedConfig)):(G)=>this.traverseAllows(G)}createRootApply(){switch(this.rootApplyStrategy){case"allows":return(Z,Q)=>{if(this.allows(Z))return Z;let G=new xX(Z,this.$.resolvedConfig);return this.traverseApply(Z,G),G.finalize(Q)};case"contextual":return(Z,Q)=>{let G=new xX(Z,this.$.resolvedConfig);return this.traverseApply(Z,G),G.finalize(Q)};case"optimistic":this.contextFreeMorph=this.shallowMorphs[0];let X=this.$.resolvedConfig.clone;return(Z,Q)=>{if(this.allows(Z))return this.contextFreeMorph(X&&(typeof Z==="object"&&Z!==null||typeof Z==="function")?X(Z):Z);let G=new xX(Z,this.$.resolvedConfig);return this.traverseApply(Z,G),G.finalize(Q)};case"branchedOptimistic":return this.createBranchedOptimisticRootApply();default:return this.rootApplyStrategy,H0(`Unexpected rootApplyStrategy ${this.rootApplyStrategy}`)}}compiledMeta=Qb(this.metaJson);cacheGetter(X,Z){return Object.defineProperty(this,X,{value:Z}),Z}get description(){return this.cacheGetter("description",this.meta?.description??this.$.resolvedConfig[this.kind].description(this))}get references(){return Object.values(this.referencesById)}precedence=l9(this.kind);precompilation;assert=(X,Z)=>this(X,Z,(Q)=>Q.throw());traverse(X,Z){return this(X,Z,null)}get in(){return this.cacheGetter("in",this.rawIn.isRoot()?this.$.finalize(this.rawIn):this.rawIn)}get rawIn(){return this.cacheGetter("rawIn",this.getIo("in"))}get out(){return this.cacheGetter("out",this.rawOut.isRoot()?this.$.finalize(this.rawOut):this.rawOut)}get rawOut(){return this.cacheGetter("rawOut",this.getIo("out"))}getIo(X){if(!this.includesTransform)return this;let Z={};for(let[Q,G]of this.innerEntries){let J=this.impl.keys[Q];if(J.reduceIo)J.reduceIo(X,Z,G);else if(J.child){let Y=G;Z[Q]=O0(Y)?Y.map(($)=>X==="in"?$.rawIn:$.rawOut):X==="in"?Y.rawIn:Y.rawOut}else Z[Q]=G}return this.$.node(this.kind,Z)}toJSON(){return this.json}toString(){return`Type<${this.expression}>`}equals(X){let Z=M0(X)?X:this.$.parseDefinition(X);return this.innerHash===Z.innerHash}ifEquals(X){return this.equals(X)?this:void 0}hasKind(X){return this.kind===X}assertHasKind(X){if(this.kind!==X)s6(`${this.kind} node was not of asserted kind ${X}`);return this}hasKindIn(...X){return X.includes(this.kind)}assertHasKindIn(...X){if(!NX(X,this.kind))s6(`${this.kind} node was not one of asserted kinds ${X}`);return this}isBasis(){return NX(W2,this.kind)}isConstraint(){return NX(LQ,this.kind)}isStructural(){return NX(m9,this.kind)}isRefinement(){return NX(_7,this.kind)}isRoot(){return NX(p9,this.kind)}isUnknown(){return this.hasKind("intersection")&&this.children.length===0}isNever(){return this.hasKind("union")&&this.children.length===0}hasUnit(X){return this.hasKind("unit")&&this.allows(X)}hasOpenIntersection(){return this.impl.intersectionIsOpen}get nestableExpression(){return this.expression}select(X){let Z=W8.normalize(X);return this._select(Z)}_select(X){let Z=W8.applyBoundary[X.boundary??"references"](this);if(X.kind)Z=Z.filter((Q)=>Q.kind===X.kind);if(X.where)Z=Z.filter(X.where);return W8.applyMethod[X.method??"filter"](Z,this,X)}transform(X,Z){return this._transform(X,this._createTransformContext(Z))}_createTransformContext(X){return{root:this,selected:void 0,seen:{},path:[],parseOptions:{prereduced:X?.prereduced??!1},undeclaredKeyHandling:void 0,...X}}_transform(X,Z){let Q=Z.bindScope??this.$;if(Z.seen[this.id])return this.$.lazilyResolve(Z.seen[this.id]);if(Z.shouldTransform?.(this,Z)===!1)return this;let G;if(Z.seen[this.id]=()=>G,this.hasKind("structure")&&this.undeclared!==Z.undeclaredKeyHandling)Z={...Z,undeclaredKeyHandling:this.undeclared};let J=s(this.inner,(U,L)=>{if(!this.impl.keys[U].child)return[U,L];let A=L;if(!O0(A)){let j=A._transform(X,Z);return j?[U,j]:[]}if(A.length===0)return[U,L];let F=A.flatMap((j)=>{return j._transform(X,Z)??[]});return F.length?[U,F]:[]});delete Z.seen[this.id];let Y=Object.assign(J,{meta:this.meta}),$=Z.selected&&!Z.selected.includes(this)?Y:X(this.kind,Y,Z);if($===null)return null;if(M0($))return G=$;let z=Object.keys($);if((z.length===0||z.length===1&&z[0]==="meta")&&!cX(this.inner))return null;if((this.kind==="required"||this.kind==="optional"||this.kind==="index")&&!("value"in $))return Z.undeclaredKeyHandling?{...$,value:f.intrinsic.unknown}:null;if(this.kind==="morph")$.in??=f.intrinsic.unknown;return G=Q.node(this.kind,$,Z.parseOptions)}configureReferences(X,Z="references"){let Q=W8.normalize(Z),G=typeof X==="string"?(z,H)=>({...H,meta:{...H.meta,description:X}}):typeof X==="function"?(z,H)=>({...H,meta:X(H.meta)}):(z,H)=>({...H,meta:{...H.meta,...X}});if(Q.boundary==="self")return this.$.node(this.kind,G(this.kind,{...this.inner,meta:this.meta}));let J=this._select(Q),Y=J&&I6(J),$=Q.boundary==="child"?(z,H)=>H.root.children.includes(z):Q.boundary==="shallow"?(z)=>z.kind!=="structure":()=>!0;return this.$.finalize(this.transform(G,{shouldTransform:$,selected:Y}))}}var W8={applyBoundary:{self:(X)=>[X],child:(X)=>[...X.children],shallow:(X)=>[...X.shallowReferences],references:(X)=>[...X.references]},applyMethod:{filter:(X)=>X,assertFilter:(X,Z,Q)=>{if(X.length===0)s6(O2(Z,Q));return X},find:(X)=>X[0],assertFind:(X,Z,Q)=>{if(X.length===0)s6(O2(Z,Q));return X[0]}},normalize:(X)=>typeof X==="function"?{boundary:"references",method:"filter",where:X}:typeof X==="string"?v0(X,W8.applyBoundary)?{method:"filter",boundary:X}:{boundary:"references",method:"filter",kind:X}:{boundary:"references",method:"filter",...X}},O2=(X,Z)=>`${X} had no references matching ${r(Z)}.`,Xb=(X)=>z6(X,{stringifyNonKey:(Z)=>Z.expression}),Zb=/"(\$ark\.[^"]+)"/g,Qb=(X)=>JSON.stringify(X).replace(Zb,"$1"),vX=(X,Z)=>({path:X,node:Z,propString:Xb(X)}),w2=(X,Z)=>X.propString===Z.propString&&X.node.equals(Z.node),b7=(X,Z)=>lX(X,Z,{isEqual:w2}),Gb=(X,Z)=>lX(X,Z,{isEqual:(Q,G)=>Q.equals(G)});class h extends Array{static init(X,Z,Q,G){return new h({kind:X,l:Z,r:Q,path:G?.path??[],optional:G?.optional??!1})}add(X,Z,Q,G){return this.push({kind:X,l:Z,r:Q,path:G?.path??[],optional:G?.optional??!1}),this}get summary(){return this.describeReasons()}describeReasons(){if(this.length===1){let{path:X,l:Z,r:Q}=this[0],G=z6(X);return y7(`Intersection${G&&` at ${G}`} of ${K2(Z,Q)}`)}return`The following intersections result in unsatisfiable types:
 ${this.map(({path:X,l:Z,r:Q})=>`${X}: ${K2(Z,Q)}`).join(`
 `)}`}throw(){return I(this.describeReasons())}invert(){let X=this.map((Z)=>({...Z,l:Z.r,r:Z.l}));if(!(X instanceof h))return new h(...X);return X}withPrefixKey(X,Z){return this.map((Q)=>({...Q,path:[X,...Q.path],optional:Q.optional||Z==="optional"}))}toNeverIfDisjoint(){return f.intrinsic.never}}var K2=(X,Z)=>`${R7(X)} and ${R7(Z)}`,R7=(X)=>M0(X)?X.expression:O0(X)?X.map(R7).join(" | ")||"never":String(X),y7=(X)=>`${X} results in an unsatisfiable type`;var c9={},$X=(X,Z,Q)=>N0(X,Z,{$:Q,invert:!1,pipe:!1}),B8=(X,Z,Q)=>N0(X,Z,{$:Q,invert:!1,pipe:!0}),N0=(X,Z,Q)=>{let G=Q.pipe?"|>":"&",J=`${X.hash}${G}${Z.hash}`;if(c9[J]!==void 0)return c9[J];if(!Q.pipe){let z=`${Z.hash}${G}${X.hash}`;if(c9[z]!==void 0){let H=c9[z],U=H instanceof h?H.invert():H;return c9[J]=U,U}}let Y=!Q.pipe||!X.includesTransform&&!Z.includesTransform;if(Y&&X.equals(Z))return X;let $=Y?f7(X,Z,Q):X.hasKindIn(...p9)?Jb(X,Z,Q):f7(X,Z,Q);if(M0($)){if(X.equals($))$=X;else if(Z.equals($))$=Z}return c9[J]=$,$},f7=(X,Z,Q)=>{let G=X.precedence<Z.precedence?X.kind:Z.kind,J=X.impl.intersections[Z.kind]??Z.impl.intersections[X.kind];if(J===void 0)return null;else if(G===X.kind)return J(X,Z,Q);else{let Y=J(Z,X,{...Q,invert:!Q.invert});if(Y instanceof h)Y=Y.invert();return Y}},Jb=(X,Z,Q)=>X.includesTransform||Z.includesTransform?Q.invert?M2(Z,X,Q):M2(X,Z,Q):f7(X,Z,Q),M2=(X,Z,Q)=>X.distribute((G)=>Yb(G,Z,Q),(G)=>{let J=G.filter(M0);if(J.length===0)return h.init("union",X.branches,Z.branches);if(J.length<X.branches.length||!X.branches.every((z,H)=>z.rawIn.equals(J[H].rawIn)))return Q.$.parseSchema(J);let Y;if(J.length===1){let z=J[0];if(!Y)return z;return Q.$.node("morph",{...z.inner,in:z.rawIn.configure(Y,"self")})}let $={branches:J};if(Y)$.meta=Y;return Q.$.parseSchema($)}),Yb=(X,Z,Q)=>{if(X.hasKind("morph")){let J=[...X.morphs];if(X.lastMorphIfNode){let Y=N0(X.lastMorphIfNode,Z,Q);if(Y instanceof h)return Y;J[J.length-1]=Y}else J.push(Z);return Q.$.node("morph",{morphs:J,in:X.inner.in})}if(Z.hasKind("morph")){let J=N0(X,Z.rawIn,Q);if(J instanceof h)return J;return Q.$.node("morph",{morphs:[Z],in:J})}return Q.$.node("morph",{morphs:[Z],in:X})};class qX extends V8{constructor(X,Z){super(X,Z);Object.defineProperty(this,r0,{value:"constraint",enumerable:!1})}impliedSiblings;intersect(X){return $X(this,X,this.$)}}class H6 extends qX{traverseApply=(X,Z)=>{if(!this.traverseAllows(X,Z))Z.errorFromNodeContext(this.errorContext)};compile(X){if(X.traversalKind==="Allows")X.return(this.compiledCondition);else X.if(this.compiledNegation,()=>X.line(`ctx.errorFromNodeContext(${this.compiledErrorContext})`))}get errorContext(){return{code:this.kind,description:this.description,meta:this.meta,...this.inner}}get compiledErrorContext(){return b6(this.errorContext)}}var n0=(X)=>(Z,Q)=>{if(O0(Z)){if(Z.length===0)return;let J=Z.map((Y)=>Q.$.node(X,Y));if(X==="predicate")return J;return J.sort((Y,$)=>Y.hash<$.hash?-1:1)}let G=Q.$.node(X,Z);return G.hasOpenIntersection()?[G]:G},i9=(X)=>{let Z=X.r.shift();if(!Z){let G=X.l.length===0&&X.kind==="structure"?f.intrinsic.unknown.internal:X.ctx.$.node(X.kind,Object.assign(X.baseInner,$b(X.l)),{prereduced:!0});for(let J of X.roots){if(G instanceof h)return G;G=N0(J,G,X.ctx)}return G}let Q=!1;for(let G=0;G<X.l.length;G++){let J=N0(X.l[G],Z,X.ctx);if(J===null)continue;if(J instanceof h)return J;if(J.isRoot())return X.roots.push(J),X.l.splice(G),i9(X);if(!Q)X.l[G]=J,Q=!0;else if(!X.l.includes(J))return H0(`Unexpectedly encountered multiple distinct intersection results for refinement ${Z}`)}if(!Q)X.l.push(Z);if(X.kind==="intersection"){if(Z.impliedSiblings)for(let G of Z.impliedSiblings)lX(X.r,G)}return i9(X)},o9=(X)=>{return Object.entries(X).flatMap(([Q,G])=>(Q in AQ)?G:[]).sort((Q,G)=>Q.precedence<G.precedence?-1:Q.precedence>G.precedence?1:Q.kind==="predicate"&&G.kind==="predicate"?0:Q.hash<G.hash?-1:1)},$b=(X)=>{let Z={};for(let Q of X)if(Q.hasOpenIntersection())Z[Q.kind]=G0(Z[Q.kind],Q);else{if(Z[Q.kind])return H0(`Unexpected intersection of closed refinements of kind ${Q.kind}`);Z[Q.kind]=Q}return Z},N2=(...X)=>I(T2(...X)),T2=(X,Z,Q)=>{let G=Q.hasKind("morph")?"a morph":Q.isUnknown()?"unknown":Q.exclude(Z).defaultShortDescription;return`${oB(X)} operand must be ${Z.description} (was ${G})`};var q2=(X,Z,Q)=>new y6(X,Z,Q,Q,null);class OQ extends GX{}class y6 extends GX{[r0]="generic";paramDefs;bodyDef;$;arg$;baseInstantiation;hkt;description;constructor(X,Z,Q,G,J){super((...Y)=>{let $=s(this.names,(z,H)=>{let U=this.arg$.parse(Y[z]);if(!U.extends(this.constraints[z]))I(zb(H,this.constraints[z].expression,U.expression));return[H,U]});if(this.defIsLazy()){let z=this.bodyDef($);return this.$.parse(z)}return this.$.parse(Z,{args:$})});this.paramDefs=X,this.bodyDef=Z,this.$=Q,this.arg$=G,this.hkt=J,this.description=J?new J().description??`a generic type for ${J.constructor.name}`:"a generic type",this.baseInstantiation=this(...this.constraints)}defIsLazy(){return this.bodyDef instanceof OQ}cacheGetter(X,Z){return Object.defineProperty(this,X,{value:Z}),Z}get json(){return this.cacheGetter("json",{params:this.params.map((X)=>X[1].isUnknown()?X[0]:[X[0],X[1].json]),body:Y2(this.bodyDef)})}get params(){return this.cacheGetter("params",this.paramDefs.map((X)=>typeof X==="string"?[X,f.intrinsic.unknown]:[X[0],this.$.parse(X[1])]))}get names(){return this.cacheGetter("names",this.params.map((X)=>X[0]))}get constraints(){return this.cacheGetter("constraints",this.params.map((X)=>X[1]))}get internal(){return this}get referencesById(){return this.baseInstantiation.internal.referencesById}get references(){return this.baseInstantiation.internal.references}}var zb=(X,Z,Q)=>`${X} must be assignable to ${Z} (was ${Q})`;var Hb=t({kind:"predicate",hasAssociatedError:!0,collapsibleKey:"predicate",keys:{predicate:{}},normalize:(X)=>typeof X==="function"?{predicate:X}:X,defaults:{description:(X)=>`valid according to ${X.predicate.name||"an anonymous predicate"}`},intersectionIsOpen:!0,intersections:{predicate:()=>null}});class E2 extends qX{serializedPredicate=_0(this.predicate);compiledCondition=`${this.serializedPredicate}(data, ctx)`;compiledNegation=`!${this.compiledCondition}`;impliedBasis=null;expression=this.serializedPredicate;traverseAllows=this.predicate;errorContext={code:"predicate",description:this.description,meta:this.meta};compiledErrorContext=b6(this.errorContext);traverseApply=(X,Z)=>{let Q=Z.currentErrorCount;if(!this.predicate(X,Z.external)&&Z.currentErrorCount===Q)Z.errorFromNodeContext(this.errorContext)};compile(X){if(X.traversalKind==="Allows"){X.return(this.compiledCondition);return}X.initializeErrorCount(),X.if(`${this.compiledNegation} && ctx.currentErrorCount === errorCount`,()=>X.line(`ctx.errorFromNodeContext(${this.compiledErrorContext})`))}reduceJsonSchema(X,Z){return Z.fallback.predicate({code:"predicate",base:X,predicate:this.predicate})}}var k7={implementation:Hb,Node:E2};var Ub=t({kind:"divisor",collapsibleKey:"rule",keys:{rule:{parse:(X)=>Number.isInteger(X)?X:I(Wb(X))}},normalize:(X)=>typeof X==="number"?{rule:X}:X,hasAssociatedError:!0,defaults:{description:(X)=>X.rule===1?"an integer":X.rule===2?"even":`a multiple of ${X.rule}`},intersections:{divisor:(X,Z,Q)=>Q.$.node("divisor",{rule:Math.abs(X.rule*Z.rule/Vb(X.rule,Z.rule))})},obviatesBasisDescription:!0});class P2 extends H6{traverseAllows=(X)=>X%this.rule===0;compiledCondition=`data % ${this.rule} === 0`;compiledNegation=`data % ${this.rule} !== 0`;impliedBasis=f.intrinsic.number.internal;expression=`% ${this.rule}`;reduceJsonSchema(X){if(X.type="integer",this.rule===1)return X;return X.multipleOf=this.rule,X}}var x7={implementation:Ub,Node:P2};var Wb=(X)=>`divisor must be an integer (was ${X})`,Vb=(X,Z)=>{let Q,G=X,J=Z;while(J!==0)Q=J,J=G%J,G=Q;return G};class VX extends H6{boundOperandKind=Fb[this.kind];compiledActual=this.boundOperandKind==="value"?"data":this.boundOperandKind==="length"?"data.length":"data.valueOf()";comparator=Ob(this.kind,this.exclusive);numericLimit=this.rule.valueOf();expression=`${this.comparator} ${this.rule}`;compiledCondition=`${this.compiledActual} ${this.comparator} ${this.numericLimit}`;compiledNegation=`${this.compiledActual} ${Bb[this.comparator]} ${this.numericLimit}`;stringLimit=this.boundOperandKind==="date"?wb(this.numericLimit):`${this.numericLimit}`;limitKind=this.comparator["0"]==="<"?"upper":"lower";isStricterThan(X){return(this.limitKind==="upper"?this.numericLimit<X.numericLimit:this.numericLimit>X.numericLimit)||this.numericLimit===X.numericLimit&&this.exclusive===!0&&!X.exclusive}overlapsRange(X){if(this.isStricterThan(X))return!1;if(this.numericLimit===X.numericLimit&&(this.exclusive||X.exclusive))return!1;return!0}overlapIsUnit(X){return this.numericLimit===X.numericLimit&&!this.exclusive&&!X.exclusive}}var Bb={"<":">=","<=":">",">":"<=",">=":"<"},Lb={min:"max",minLength:"maxLength",after:"before"},wQ={parse:(X)=>X||void 0},KQ=(X)=>(Z)=>{if(typeof Z==="number")return{rule:Z};let{exclusive:Q,...G}=Z;return Q?{...G,rule:X==="minLength"?G.rule+1:G.rule-1}:G},MQ=(X)=>(Z)=>{if(typeof Z==="number"||typeof Z==="string"||Z instanceof Date)return{rule:Z};let{exclusive:Q,...G}=Z;if(!Q)return G;let J=typeof G.rule==="number"?G.rule:typeof G.rule==="string"?new Date(G.rule).valueOf():G.rule.valueOf();return Q?{...G,rule:X==="after"?J+1:J-1}:G},NQ=(X)=>typeof X==="string"||typeof X==="number"?new Date(X):X,Ab=(X,Z)=>`${X} bound must be a positive integer (was ${Z})`,n9=(X)=>(Z)=>{if(!Number.isInteger(Z)||Z<0)I(Ab(X,Z));return Z},Fb={min:"value",max:"value",minLength:"length",maxLength:"length",after:"date",before:"date"},Ob=(X,Z)=>`${v0(X,Lb)?">":"<"}${Z?"":"="}`,wb=(X)=>typeof X==="string"?X:new Date(X).toLocaleString(),j2=(X)=>`Bounded expression ${X} must be exactly one of number, string, Array, or Date`;var Kb=t({kind:"after",collapsibleKey:"rule",hasAssociatedError:!0,keys:{rule:{parse:NQ,serialize:(X)=>X.toISOString()}},normalize:MQ("after"),defaults:{description:(X)=>`${X.collapsibleLimitString} or later`,actual:X9},intersections:{after:(X,Z)=>X.isStricterThan(Z)?X:Z}});class D2 extends VX{impliedBasis=f.intrinsic.Date.internal;collapsibleLimitString=X9(this.rule);traverseAllows=(X)=>X>=this.rule;reduceJsonSchema(X,Z){return Z.fallback.date({code:"date",base:X,after:this.rule})}}var v7={implementation:Kb,Node:D2};var Mb=t({kind:"before",collapsibleKey:"rule",hasAssociatedError:!0,keys:{rule:{parse:NQ,serialize:(X)=>X.toISOString()}},normalize:MQ("before"),defaults:{description:(X)=>`${X.collapsibleLimitString} or earlier`,actual:X9},intersections:{before:(X,Z)=>X.isStricterThan(Z)?X:Z,after:(X,Z,Q)=>X.overlapsRange(Z)?X.overlapIsUnit(Z)?Q.$.node("unit",{unit:X.rule}):null:h.init("range",X,Z)}});class I2 extends VX{collapsibleLimitString=X9(this.rule);traverseAllows=(X)=>X<=this.rule;impliedBasis=f.intrinsic.Date.internal;reduceJsonSchema(X,Z){return Z.fallback.date({code:"date",base:X,before:this.rule})}}var h7={implementation:Mb,Node:I2};var Nb=t({kind:"exactLength",collapsibleKey:"rule",keys:{rule:{parse:n9("exactLength")}},normalize:(X)=>typeof X==="number"?{rule:X}:X,hasAssociatedError:!0,defaults:{description:(X)=>`exactly length ${X.rule}`,actual:(X)=>`${X.length}`},intersections:{exactLength:(X,Z,Q)=>h.init("unit",Q.$.node("unit",{unit:X.rule}),Q.$.node("unit",{unit:Z.rule}),{path:["length"]}),minLength:(X,Z)=>X.rule>=Z.rule?X:h.init("range",X,Z),maxLength:(X,Z)=>X.rule<=Z.rule?X:h.init("range",X,Z)}});class _2 extends H6{traverseAllows=(X)=>X.length===this.rule;compiledCondition=`data.length === ${this.rule}`;compiledNegation=`data.length !== ${this.rule}`;impliedBasis=f.intrinsic.lengthBoundable.internal;expression=`== ${this.rule}`;reduceJsonSchema(X){switch(X.type){case"string":return X.minLength=this.rule,X.maxLength=this.rule,X;case"array":return X.minItems=this.rule,X.maxItems=this.rule,X;default:return q0.throwInternalOperandError("exactLength",X)}}}var g7={implementation:Nb,Node:_2};var Tb=t({kind:"max",collapsibleKey:"rule",hasAssociatedError:!0,keys:{rule:{},exclusive:wQ},normalize:(X)=>typeof X==="number"?{rule:X}:X,defaults:{description:(X)=>{if(X.rule===0)return X.exclusive?"negative":"non-positive";return`${X.exclusive?"less than":"at most"} ${X.rule}`}},intersections:{max:(X,Z)=>X.isStricterThan(Z)?X:Z,min:(X,Z,Q)=>X.overlapsRange(Z)?X.overlapIsUnit(Z)?Q.$.node("unit",{unit:X.rule}):null:h.init("range",X,Z)},obviatesBasisDescription:!0});class C2 extends VX{impliedBasis=f.intrinsic.number.internal;traverseAllows=this.exclusive?(X)=>X<this.rule:(X)=>X<=this.rule;reduceJsonSchema(X){if(this.exclusive)X.exclusiveMaximum=this.rule;else X.maximum=this.rule;return X}}var u7={implementation:Tb,Node:C2};var qb=t({kind:"maxLength",collapsibleKey:"rule",hasAssociatedError:!0,keys:{rule:{parse:n9("maxLength")}},reduce:(X,Z)=>X.rule===0?Z.node("exactLength",X):void 0,normalize:KQ("maxLength"),defaults:{description:(X)=>`at most length ${X.rule}`,actual:(X)=>`${X.length}`},intersections:{maxLength:(X,Z)=>X.isStricterThan(Z)?X:Z,minLength:(X,Z,Q)=>X.overlapsRange(Z)?X.overlapIsUnit(Z)?Q.$.node("exactLength",{rule:X.rule}):null:h.init("range",X,Z)}});class S2 extends VX{impliedBasis=f.intrinsic.lengthBoundable.internal;traverseAllows=(X)=>X.length<=this.rule;reduceJsonSchema(X){switch(X.type){case"string":return X.maxLength=this.rule,X;case"array":return X.maxItems=this.rule,X;default:return q0.throwInternalOperandError("maxLength",X)}}}var m7={implementation:qb,Node:S2};var Eb=t({kind:"min",collapsibleKey:"rule",hasAssociatedError:!0,keys:{rule:{},exclusive:wQ},normalize:(X)=>typeof X==="number"?{rule:X}:X,defaults:{description:(X)=>{if(X.rule===0)return X.exclusive?"positive":"non-negative";return`${X.exclusive?"more than":"at least"} ${X.rule}`}},intersections:{min:(X,Z)=>X.isStricterThan(Z)?X:Z},obviatesBasisDescription:!0});class b2 extends VX{impliedBasis=f.intrinsic.number.internal;traverseAllows=this.exclusive?(X)=>X>this.rule:(X)=>X>=this.rule;reduceJsonSchema(X){if(this.exclusive)X.exclusiveMinimum=this.rule;else X.minimum=this.rule;return X}}var p7={implementation:Eb,Node:b2};var Pb=t({kind:"minLength",collapsibleKey:"rule",hasAssociatedError:!0,keys:{rule:{parse:n9("minLength")}},reduce:(X)=>X.rule===0?f.intrinsic.unknown:void 0,normalize:KQ("minLength"),defaults:{description:(X)=>X.rule===1?"non-empty":`at least length ${X.rule}`,actual:(X)=>X.length===0?"":`${X.length}`},intersections:{minLength:(X,Z)=>X.isStricterThan(Z)?X:Z}});class R2 extends VX{impliedBasis=f.intrinsic.lengthBoundable.internal;traverseAllows=(X)=>X.length>=this.rule;reduceJsonSchema(X){switch(X.type){case"string":return X.minLength=this.rule,X;case"array":return X.minItems=this.rule,X;default:return q0.throwInternalOperandError("minLength",X)}}}var d7={implementation:Pb,Node:R2};var y2={min:p7.implementation,max:u7.implementation,minLength:d7.implementation,maxLength:m7.implementation,exactLength:g7.implementation,after:v7.implementation,before:h7.implementation},f2={min:p7.Node,max:u7.Node,minLength:d7.Node,maxLength:m7.Node,exactLength:g7.Node,after:v7.Node,before:h7.Node};var jb=t({kind:"pattern",collapsibleKey:"rule",keys:{rule:{},flags:{}},normalize:(X)=>typeof X==="string"?{rule:X}:X instanceof RegExp?X.flags?{rule:X.source,flags:X.flags}:{rule:X.source}:X,obviatesBasisDescription:!0,obviatesBasisExpression:!0,hasAssociatedError:!0,intersectionIsOpen:!0,defaults:{description:(X)=>`matched by ${X.rule}`},intersections:{pattern:()=>null}});class k2 extends H6{instance=new RegExp(this.rule,this.flags);expression=`${this.instance}`;traverseAllows=this.instance.test.bind(this.instance);compiledCondition=`${this.expression}.test(data)`;compiledNegation=`!${this.compiledCondition}`;impliedBasis=f.intrinsic.string.internal;reduceJsonSchema(X,Z){if(X.pattern)return Z.fallback.patternIntersection({code:"patternIntersection",base:X,pattern:this.rule});return X.pattern=this.rule,X}}var l7={implementation:jb,Node:k2};var L8=(X,Z)=>{let Q=Db(X);if(Z&&!Z.includes(Q))return I(`Root of kind ${Q} should be one of ${Z}`);return Q},Db=(X)=>{if(l(X,"root"))return X.kind;if(typeof X==="string")return X[0]==="$"?"alias":(X in ZX)?"domain":"proto";if(typeof X==="function")return"proto";if(typeof X!=="object"||X===null)return I(x2(X));if("morphs"in X)return"morph";if("branches"in X||O0(X))return"union";if("unit"in X)return"unit";if("reference"in X)return"alias";let Z=Object.keys(X);if(Z.length===0||Z.some((Q)=>(Q in AQ)))return"intersection";if("proto"in X)return"proto";if("domain"in X)return"domain";return I(x2(X))},x2=(X)=>`${r(X)} is not a valid type schema`,v2={},Ib=(X)=>O0(X)?X.map((Z)=>Z.collapsibleJson):X.collapsibleJson,a0={};f.nodesByRegisteredId=a0;var c7=(X)=>{return v2[X]??=0,`${X}${++v2[X]}`},i7=(X)=>{let Z=s9[X.kind],Q=Z.applyConfig?.(X.def,X.$.resolvedConfig)??X.def,G={},{meta:J,...Y}=Q,$=J===void 0?{}:typeof J==="string"?{description:J}:J,z=F7(Y).sort(([U],[L])=>d9(U)?d9(L)?l9(U)-l9(L):1:d9(L)?-1:U<L?-1:1).filter(([U,L])=>{if(U.startsWith("meta.")){let A=U.slice(5);return $[A]=L,!1}return!0});for(let U of z){let L=U[0],A=Z.keys[L];if(!A)return I(`Key ${L} is not valid on ${X.kind} schema`);let F=A.parse?A.parse(U[1],X):U[1];if(F!==QX&&(F!==void 0||A.preserveUndefined))G[L]=F}if(Z.reduce&&!X.prereduced){let U=Z.reduce(G,X.$);if(U){if(U instanceof h)return U.throw();return _b(U,$)}}return o7({id:X.id,kind:X.kind,inner:G,meta:$,$:X.$})},o7=({id:X,kind:Z,inner:Q,meta:G,$:J,ignoreCache:Y})=>{let $=s9[Z],z=F7(Q),H=[],U={};for(let[y,M]of z){let K=$.keys[y],_=K.serialize??(K.child?Ib:TX);if(U[y]=_(M),K.child===!0){let x=M;if(O0(x))H.push(...x);else H.push(x)}else if(typeof K.child==="function")H.push(...K.child(M))}if($.finalizeInnerJson)U=$.finalizeInnerJson(U);let L={...U},A={};if(!cX(G))A=s(G,(y,M)=>[y,y==="examples"?M:TX(M)]),L.meta=TQ(A,"description",!0);U=TQ(U,$.collapsibleKey,!1);let F=JSON.stringify({kind:Z,...U});L=TQ(L,$.collapsibleKey,!1);let j=TQ(L,$.collapsibleKey,!0),R=JSON.stringify({kind:Z,...L});if(J.nodesByHash[R]&&!Y)return J.nodesByHash[R];let T={id:X,kind:Z,impl:$,inner:Q,innerEntries:z,innerJson:U,innerHash:F,meta:G,metaJson:A,json:L,hash:R,collapsibleJson:j,children:H};if(Z!=="intersection"){for(let y in Q)if(y!=="in"&&y!=="out")T[y]=Q[y]}let P=new g2[Z](T,J);return J.nodesByHash[R]=P},h2=(X,Z)=>{if(X.id===Z)return X;if(M0(a0[Z]))H0(`Unexpected attempt to overwrite node id ${Z}`);return o7({id:Z,kind:X.kind,inner:X.inner,meta:X.meta,$:X.$,ignoreCache:!0})},_b=(X,Z,Q)=>{if(Q&&M0(a0[Q]))H0(`Unexpected attempt to overwrite node id ${Q}`);return o7({id:Q??c7(Z.alias??X.kind),kind:X.kind,inner:X.inner,meta:Z,$:X.$})},TQ=(X,Z,Q)=>{let G=Object.keys(X);if(G.length===1&&G[0]===Z){let J=X[Z];if(Q)return J;if(XX(J,"object")&&(Object.keys(J).length===1||Array.isArray(J)))return J}return X};var A8=(X,Z,Q)=>{if(X.key!==Z.key)return null;let G=X.key,J=N0(X.value,Z.value,Q),Y=X.required||Z.required?"required":"optional";if(J instanceof h)if(Y==="optional")J=f.intrinsic.never.internal;else return J.withPrefixKey(X.key,X.required&&Z.required?"required":"optional");if(Y==="required")return Q.$.node("required",{key:G,value:J});let $=X.hasDefault()?Z.hasDefault()?X.default===Z.default?X.default:I(n7(X.default,Z.default)):X.default:Z.hasDefault()?Z.default:QX;return Q.$.node("optional",{key:G,value:J,default:$})};class F8 extends qX{required=this.kind==="required";optional=this.kind==="optional";impliedBasis=f.intrinsic.object.internal;serializedKey=kX(this.key);compiledKey=typeof this.key==="string"?this.key:this.serializedKey;flatRefs=G0(this.value.flatRefs.map((X)=>vX([this.key,...X.path],X.node)),vX([this.key],this.value));_transform(X,Z){Z.path.push(this.key);let Q=super._transform(X,Z);return Z.path.pop(),Q}hasDefault(){return"default"in this.inner}traverseAllows=(X,Z)=>{if(this.key in X)return YX(this.key,()=>this.value.traverseAllows(X[this.key],Z),Z);return this.optional};traverseApply=(X,Z)=>{if(this.key in X)YX(this.key,()=>this.value.traverseApply(X[this.key],Z),Z);else if(this.hasKind("required"))Z.errorFromNodeContext(this.errorContext)};compile(X){if(X.if(`${this.serializedKey} in data`,()=>X.traverseKey(this.serializedKey,`data${X.prop(this.key)}`,this.value)),this.hasKind("required"))X.else(()=>X.traversalKind==="Apply"?X.line(`ctx.errorFromNodeContext(${this.compiledErrorContext})`):X.return(!1));if(X.traversalKind==="Allows")X.return(!0)}}var n7=(X,Z)=>`Invalid intersection of default values ${r(X)} & ${r(Z)}`;var Cb=t({kind:"optional",hasAssociatedError:!1,intersectionIsOpen:!0,keys:{key:{},value:{child:!0,parse:(X,Z)=>Z.$.parseSchema(X)},default:{preserveUndefined:!0}},normalize:(X)=>X,reduce:(X,Z)=>{if(Z.resolvedConfig.exactOptionalPropertyTypes===!1){if(!X.value.allows(void 0))return Z.node("optional",{...X,value:X.value.or(i.undefined)},{prereduced:!0})}},defaults:{description:(X)=>`${X.compiledKey}?: ${X.value.description}`},intersections:{optional:A8}});class u2 extends F8{constructor(...X){super(...X);if("default"in this.inner)w8(this.value,this.inner.default,this.key)}get rawIn(){let X=super.rawIn;if(!this.hasDefault())return X;return this.$.node("optional",zQ(X.inner,{default:!0}),{prereduced:!0})}get outProp(){if(!this.hasDefault())return this;let{default:X,...Z}=this.inner;return this.cacheGetter("outProp",this.$.node("required",Z,{prereduced:!0}))}expression=this.hasDefault()?`${this.compiledKey}: ${this.value.expression} = ${r(this.inner.default)}`:`${this.compiledKey}?: ${this.value.expression}`;defaultValueMorph=bb(this);defaultValueMorphRef=this.defaultValueMorph&&_0(this.defaultValueMorph)}var O8={implementation:Cb,Node:u2},Sb={},bb=(X)=>{if(!X.hasDefault())return;let Z=`{${X.compiledKey}: ${X.value.id} = ${TX(X.default)}}`;return Sb[Z]??=s7(X.key,X.value,X.default)},s7=(X,Z,Q)=>{if(typeof Q==="function")return Z.includesTransform?(J,Y)=>{return YX(X,()=>Z(J[X]=Q(),Y),Y),J}:(J)=>{return J[X]=Q(),J};let G=Z.includesTransform?Z.assert(Q):Q;return XX(G,"object")?(J,Y)=>{return YX(X,()=>Z(J[X]=Q,Y),Y),J}:(J)=>{return J[X]=G,J}},w8=(X,Z,Q)=>{let G=_6(Z);if(XX(Z,"object")&&!G)I(Rb(Q));let J=X.in(G?Z():Z);if(J instanceof JX){if(Q===null)I(`Default ${J.summary}`);let Y=J.transform(($)=>$.transform((z)=>({...z,prefixPath:[Q]})));I(`Default for ${Y.summary}`)}return Z},Rb=(X)=>{return`Non-primitive default ${X===null?"":typeof X==="number"?`for value at [${X}] `:`for ${kX(X)} `}must be specified as a function like () => ({my: 'object'})`};class EX extends V8{constructor(X,Z){super(X,Z);Object.defineProperty(this,r0,{value:"root",enumerable:!1})}get rawIn(){return super.rawIn}get rawOut(){return super.rawOut}get internal(){return this}get "~standard"(){return{vendor:"arktype",version:1,validate:(X)=>{let Z=this(X);if(Z instanceof JX)return Z;return{value:Z}},jsonSchema:{input:(X)=>this.rawIn.toJsonSchema({target:m2(X.target),...X.libraryOptions}),output:(X)=>this.rawOut.toJsonSchema({target:m2(X.target),...X.libraryOptions})}}}as(){return this}brand(X){if(X==="")return I(yb);return this}readonly(){return this}branches=this.hasKind("union")?this.inner.branches:[this];distribute(X,Z){let Q=this.branches.map(X);return Z?.(Q)??Q}get shortDescription(){return this.meta.description??this.defaultShortDescription}toJsonSchema(X={}){let Z=C7(this.$.resolvedConfig.toJsonSchema,X);Z.useRefs||=this.isCyclic;let Q=typeof Z.dialect==="string"?{$schema:Z.dialect}:{};if(Object.assign(Q,this.toJsonSchemaRecurse(Z)),Z.useRefs){let G=s(this.references,(J,Y)=>Y.isRoot()&&!Y.alwaysExpandJsonSchema?[Y.id,Y.toResolvedJsonSchema(Z)]:[]);if(Z.target==="draft-07")Object.assign(Q,{definitions:G});else Q.$defs=G}return Q}toJsonSchemaRecurse(X){if(X.useRefs&&!this.alwaysExpandJsonSchema)return{$ref:`#/${X.target==="draft-07"?"definitions":"$defs"}/${this.id}`};return this.toResolvedJsonSchema(X)}get alwaysExpandJsonSchema(){return this.isBasis()||this.kind==="alias"||this.hasKind("union")&&this.isBoolean}toResolvedJsonSchema(X){let Z=this.innerToJsonSchema(X);return Object.assign(Z,this.metaJson)}intersect(X){let Z=this.$.parseDefinition(X),Q=this.rawIntersect(Z);if(Q instanceof h)return Q;return this.$.finalize(Q)}rawIntersect(X){return $X(this,X,this.$)}toNeverIfDisjoint(){return this}and(X){let Z=this.intersect(X);return Z instanceof h?Z.throw():Z}rawAnd(X){let Z=this.rawIntersect(X);return Z instanceof h?Z.throw():Z}or(X){let Z=this.$.parseDefinition(X);return this.$.finalize(this.rawOr(Z))}rawOr(X){let Z=[...this.branches,...X.branches];return this.$.node("union",Z)}map(X){return this.$.schema(this.applyStructuralOperation("map",[X]))}pick(...X){return this.$.schema(this.applyStructuralOperation("pick",X))}omit(...X){return this.$.schema(this.applyStructuralOperation("omit",X))}required(){return this.$.schema(this.applyStructuralOperation("required",[]))}partial(){return this.$.schema(this.applyStructuralOperation("partial",[]))}_keyof;keyof(){if(this._keyof)return this._keyof;let X=this.applyStructuralOperation("keyof",[]).reduce((Z,Q)=>Z.intersect(Q).toNeverIfDisjoint(),f.intrinsic.unknown.internal);if(X.branches.length===0)I(y7(`keyof ${this.expression}`));return this._keyof=this.$.finalize(X)}get props(){if(this.branches.length!==1)return I(kb(this.expression));return[...this.applyStructuralOperation("props",[])[0]]}merge(X){let Z=this.$.parseDefinition(X);return this.$.schema(Z.distribute((Q)=>this.applyStructuralOperation("merge",[p2(Q)??I(d2("merge",Q.expression))])))}applyStructuralOperation(X,Z){return this.distribute((Q)=>{if(Q.equals(f.intrinsic.object)&&X!=="merge")return Q;let G=p2(Q);if(!G)I(d2(X,Q.expression));if(X==="keyof")return G.keyof();if(X==="get")return G.get(...Z);if(X==="props")return G.props;let J=X==="required"?"require":X==="partial"?"optionalize":X;return this.$.node("intersection",{domain:"object",structure:G[J](...Z)})})}get(...X){if(X[0]===void 0)return this;return this.$.schema(this.applyStructuralOperation("get",X))}extract(X){let Z=this.$.parseDefinition(X);return this.$.schema(this.branches.filter((Q)=>Q.extends(Z)))}exclude(X){let Z=this.$.parseDefinition(X);return this.$.schema(this.branches.filter((Q)=>!Q.extends(Z)))}array(){return this.$.schema(this.isUnknown()?{proto:Array}:{proto:Array,sequence:this},{prereduced:!0})}overlaps(X){return!(this.intersect(X)instanceof h)}extends(X){if(this.isNever())return!0;let Z=this.intersect(X);return!(Z instanceof h)&&this.equals(Z)}ifExtends(X){return this.extends(X)?this:void 0}subsumes(X){return this.$.parseDefinition(X).extends(this)}configure(X,Z="shallow"){return this.configureReferences(X,Z)}describe(X,Z="shallow"){return this.configure({description:X},Z)}optional(){return[this,"?"]}default(X){return w8(this,X,null),[this,"=",X]}from(X){return this.assert(X)}_pipe(...X){let Z=X.reduce((Q,G)=>Q.rawPipeOnce(G),this);return this.$.finalize(Z)}tryPipe(...X){let Z=X.reduce((Q,G)=>Q.rawPipeOnce(l(G,"root")?G:(J,Y)=>{try{return G(J,Y)}catch($){return Y.error({code:"predicate",predicate:G,actual:`aborted due to error:
    ${$}
`})}}),this);return this.$.finalize(Z)}pipe=Object.assign(this._pipe.bind(this),{try:this.tryPipe.bind(this)});to(X){return this.$.finalize(this.toNode(this.$.parseDefinition(X)))}toNode(X){let Z=B8(this,X,this.$);if(Z instanceof h)return Z.throw();return Z}rawPipeOnce(X){if(l(X,"root"))return this.toNode(X);return this.distribute((Z)=>Z.hasKind("morph")?this.$.node("morph",{in:Z.inner.in,morphs:[...Z.morphs,X]}):this.$.node("morph",{in:Z,morphs:[X]}),this.$.parseSchema)}narrow(X){return this.constrainOut("predicate",X)}constrain(X,Z){return this._constrain("root",X,Z)}constrainIn(X,Z){return this._constrain("in",X,Z)}constrainOut(X,Z){return this._constrain("out",X,Z)}_constrain(X,Z,Q){let G=this.$.node(Z,Q);if(G.isRoot())return G.isUnknown()?this:H0(`Unexpected constraint node ${G}`);let J=X==="root"?this:X==="in"?this.rawIn:this.rawOut;if(J.hasKind("morph")||G.impliedBasis&&!J.extends(G.impliedBasis))return N2(Z,G.impliedBasis,this);let Y=this.$.node("intersection",{[G.kind]:G}),$=X==="out"?B8(this,Y,this.$):$X(this,Y,this.$);if($ instanceof h)$.throw();return this.$.finalize($)}onUndeclaredKey(X){let Z=typeof X==="string"?X:X.rule,Q=typeof X==="string"?!1:X.deep;return this.$.finalize(this.transform((G,J)=>G==="structure"?Z==="ignore"?zQ(J,{undeclared:1}):{...J,undeclared:Z}:J,Q?void 0:{shouldTransform:(G)=>!NX(m9,G.kind)}))}hasEqualMorphs(X){if(!this.includesTransform&&!X.includesTransform)return!0;if(!Y6(this.shallowMorphs,X.shallowMorphs))return!1;if(!Y6(this.flatMorphs,X.flatMorphs,{isEqual:(Z,Q)=>Z.propString===Q.propString&&(Z.node.hasKind("morph")&&Q.node.hasKind("morph")?Z.node.hasEqualMorphs(Q.node):Z.node.hasKind("intersection")&&Q.node.hasKind("intersection")?Z.node.structure?.structuralMorphRef===Q.node.structure?.structuralMorphRef:!1)}))return!1;return!0}onDeepUndeclaredKey(X){return this.onUndeclaredKey({rule:X,deep:!0})}filter(X){return this.constrainIn("predicate",X)}divisibleBy(X){return this.constrain("divisor",X)}matching(X){return this.constrain("pattern",X)}atLeast(X){return this.constrain("min",X)}atMost(X){return this.constrain("max",X)}moreThan(X){return this.constrain("min",r9(X))}lessThan(X){return this.constrain("max",r9(X))}atLeastLength(X){return this.constrain("minLength",X)}atMostLength(X){return this.constrain("maxLength",X)}moreThanLength(X){return this.constrain("minLength",r9(X))}lessThanLength(X){return this.constrain("maxLength",r9(X))}exactlyLength(X){return this.constrain("exactLength",X)}atOrAfter(X){return this.constrain("after",X)}atOrBefore(X){return this.constrain("before",X)}laterThan(X){return this.constrain("after",r9(X))}earlierThan(X){return this.constrain("before",r9(X))}}var yb="Expected a non-empty brand name after #",l2=["draft-2020-12","draft-07"],fb=(X)=>`JSONSchema target '${X}' is not supported (must be ${l2.map((Z)=>`"${Z}"`).join(" or ")})`,m2=(X)=>{if(!NX(l2,X))I(fb(X));return X},r9=(X)=>typeof X==="object"&&!(X instanceof Date)?{...X,exclusive:!0}:{rule:X,exclusive:!0},K8=(X,Z)=>l(Z,"root")?l(X,"root")?X.extends(Z):Z.allows(X):l(X,"root")?X.hasUnit(Z):Z===X,p2=(X)=>{if(X.hasKind("morph"))return null;if(X.hasKind("intersection"))return X.inner.structure??(X.basis?.domain==="object"?X.$.bindReference(f.intrinsic.emptyStructure):null);if(X.isBasis()&&X.domain==="object")return X.$.bindReference(f.intrinsic.emptyStructure);return null},kb=(X)=>`Props cannot be extracted from a union. Use .distribute to extract props from each branch instead. Received:
${X}`,d2=(X,Z)=>`${X} operand must be an object (was ${Z})`;var iX=(X,Z)=>s(FQ(X),(Q,G)=>[G,Z]);var xb=(X)=>typeof X==="string"?{reference:X}:X,c2=(X)=>X instanceof h?f.intrinsic.never.internal:X,vb=t({kind:"alias",hasAssociatedError:!1,collapsibleKey:"reference",keys:{reference:{serialize:(X)=>X.startsWith("$")?X:`$ark.${X}`},resolve:{}},normalize:xb,defaults:{description:(X)=>X.reference},intersections:{alias:(X,Z,Q)=>Q.$.lazilyResolve(()=>c2(N0(X.resolution,Z.resolution,Q)),`${X.reference}${Q.pipe?"=>":"&"}${Z.reference}`),...iX("alias",(X,Z,Q)=>{if(Z.isUnknown())return X;if(Z.isNever())return Z;if(Z.isBasis()&&!Z.overlaps(f.intrinsic.object))return h.init("assignability",f.intrinsic.object,Z);return Q.$.lazilyResolve(()=>c2(N0(X.resolution,Z,Q)),`${X.reference}${Q.pipe?"=>":"&"}${Z.id}`)})}});class i2 extends EX{expression=this.reference;structure=void 0;get resolution(){let X=this._resolve();return a0[this.id]=X}_resolve(){if(this.resolve)return this.resolve();if(this.reference[0]==="$")return this.$.resolveRoot(this.reference.slice(1));let X=this.reference,Z=a0[X],Q=[];while(l(Z,"context")){if(Q.includes(Z.id))return I(hb(Z.id,Q));Q.push(Z.id),Z=a0[Z.id]}if(!l(Z,"root"))return H0(`Unexpected resolution for reference ${this.reference}
Seen: [${Q.join("->")}] 
Resolution: ${r(Z)}`);return Z}get resolutionId(){if(this.reference.includes("&")||this.reference.includes("=>"))return this.resolution.id;if(this.reference[0]!=="$")return this.reference;let X=this.reference.slice(1),Z=this.$.resolutions[X];if(typeof Z==="string")return Z;if(l(Z,"root"))return Z.id;return H0(`Unexpected resolution for reference ${this.reference}: ${r(Z)}`)}get defaultShortDescription(){return ZX.object}innerToJsonSchema(X){return this.resolution.toJsonSchemaRecurse(X)}traverseAllows=(X,Z)=>{let Q=Z.seen[this.reference];if(Q?.includes(X))return!0;return Z.seen[this.reference]=G0(Q,X),this.resolution.traverseAllows(X,Z)};traverseApply=(X,Z)=>{let Q=Z.seen[this.reference];if(Q?.includes(X))return;Z.seen[this.reference]=G0(Q,X),this.resolution.traverseApply(X,Z)};compile(X){let Z=this.resolutionId;X.if(`ctx.seen.${Z} && ctx.seen.${Z}.includes(data)`,()=>X.return(!0)),X.if(`!ctx.seen.${Z}`,()=>X.line(`ctx.seen.${Z} = []`)),X.line(`ctx.seen.${Z}.push(data)`),X.return(X.invoke(Z))}}var hb=(X,Z)=>`Alias '${X}' has a shallow resolution cycle: ${[...Z,X].join("->")}`,M8={implementation:vb,Node:i2};class Z9 extends EX{traverseApply=(X,Z)=>{if(!this.traverseAllows(X,Z))Z.errorFromNodeContext(this.errorContext)};get errorContext(){return{code:this.kind,description:this.description,meta:this.meta,...this.inner}}get compiledErrorContext(){return b6(this.errorContext)}compile(X){if(X.traversalKind==="Allows")X.return(this.compiledCondition);else X.if(this.compiledNegation,()=>X.line(`ctx.errorFromNodeContext(${this.compiledErrorContext})`))}}var gb=t({kind:"domain",hasAssociatedError:!0,collapsibleKey:"domain",keys:{domain:{},numberAllowsNaN:{}},normalize:(X)=>typeof X==="string"?{domain:X}:g9(X,"numberAllowsNaN")&&X.domain!=="number"?I(qQ.writeBadAllowNanMessage(X.domain)):X,applyConfig:(X,Z)=>X.numberAllowsNaN===void 0&&X.domain==="number"&&Z.numberAllowsNaN?{...X,numberAllowsNaN:!0}:X,defaults:{description:(X)=>ZX[X.domain],actual:(X)=>Number.isNaN(X)?"NaN":ZX[x0(X)]},intersections:{domain:(X,Z)=>X.domain==="number"&&Z.domain==="number"?X.numberAllowsNaN?Z:X:h.init("domain",X,Z)}});class o2 extends Z9{requiresNaNCheck=this.domain==="number"&&!this.numberAllowsNaN;traverseAllows=this.requiresNaNCheck?(X)=>typeof X==="number"&&!Number.isNaN(X):(X)=>x0(X)===this.domain;compiledCondition=this.domain==="object"?'((typeof data === "object" && data !== null) || typeof data === "function")':`typeof data === "${this.domain}"${this.requiresNaNCheck?" && !Number.isNaN(data)":""}`;compiledNegation=this.domain==="object"?'((typeof data !== "object" || data === null) && typeof data !== "function")':`typeof data !== "${this.domain}"${this.requiresNaNCheck?" || Number.isNaN(data)":""}`;expression=this.numberAllowsNaN?"number | NaN":this.domain;get nestableExpression(){return this.numberAllowsNaN?`(${this.expression})`:this.expression}get defaultShortDescription(){return ZX[this.domain]}innerToJsonSchema(X){if(this.domain==="bigint"||this.domain==="symbol")return X.fallback.domain({code:"domain",base:{},domain:this.domain});return{type:this.domain}}}var qQ={implementation:gb,Node:o2,writeBadAllowNanMessage:(X)=>`numberAllowsNaN may only be specified with domain "number" (was ${X})`};var ub=t({kind:"intersection",hasAssociatedError:!0,normalize:(X)=>{if(M0(X))return X;let{structure:Z,...Q}=X,G=!!Z,J=Z??{},Y=s(Q,($,z)=>{if(v0($,V2)){if(G)I(`Flattened structure key ${$} cannot be specified alongside a root 'structure' key.`);return J[$]=z,[]}return[$,z]});if(l(J,"constraint")||!cX(J))Y.structure=J;return Y},finalizeInnerJson:({structure:X,...Z})=>XX(X,"object")?{...X,...Z}:Z,keys:{domain:{child:!0,parse:(X,Z)=>Z.$.node("domain",X)},proto:{child:!0,parse:(X,Z)=>Z.$.node("proto",X)},structure:{child:!0,parse:(X,Z)=>Z.$.node("structure",X),serialize:(X)=>{if(!X.sequence?.minLength)return X.collapsibleJson;let{sequence:Z,...Q}=X.collapsibleJson,{minVariadicLength:G,...J}=Z,Y=J.variadic&&Object.keys(J).length===1?J.variadic:J;return{...Q,sequence:Y}}},divisor:{child:!0,parse:n0("divisor")},max:{child:!0,parse:n0("max")},min:{child:!0,parse:n0("min")},maxLength:{child:!0,parse:n0("maxLength")},minLength:{child:!0,parse:n0("minLength")},exactLength:{child:!0,parse:n0("exactLength")},before:{child:!0,parse:n0("before")},after:{child:!0,parse:n0("after")},pattern:{child:!0,parse:n0("pattern")},predicate:{child:!0,parse:n0("predicate")}},reduce:(X,Z)=>n2({},X,{$:Z,invert:!1,pipe:!1}),defaults:{description:(X)=>{if(X.children.length===0)return"unknown";if(X.structure)return X.structure.description;let Z=[];if(X.basis&&!X.prestructurals.some((Q)=>Q.impl.obviatesBasisDescription))Z.push(X.basis.description);if(X.prestructurals.length){let Q=X.prestructurals.slice().sort((G,J)=>G.kind==="min"&&J.kind==="max"?-1:0).map((G)=>G.description);Z.push(...Q)}if(X.inner.predicate)Z.push(...X.inner.predicate.map((Q)=>Q.description));return Z.join(" and ")},expected:(X)=>`   ${X.errors.map((Z)=>Z.expected).join(`
   `)}`,problem:(X)=>`(${X.actual}) must be...
${X.expected}`},intersections:{intersection:(X,Z,Q)=>n2(X.inner,Z.inner,Q),...iX("intersection",(X,Z,Q)=>{if(X.children.length===0)return Z;let{domain:G,proto:J,...Y}=X.inner,$=J??G,z=$?N0($,Z,Q):Z;return z instanceof h?z:X?.basis?.equals(z)?X:X.$.node("intersection",{...Y,[z.kind]:z},{prereduced:!0})})}});class s2 extends EX{basis=this.inner.domain??this.inner.proto??null;prestructurals=[];refinements=this.children.filter((X)=>{if(!X.isRefinement())return!1;if(NX(I7,X.kind))this.prestructurals.push(X);return!0});structure=this.inner.structure;expression=mb(this);get shallowMorphs(){return this.inner.structure?.structuralMorph?[this.inner.structure.structuralMorph]:[]}get defaultShortDescription(){return this.basis?.defaultShortDescription??"present"}innerToJsonSchema(X){return this.children.reduce((Z,Q)=>Q.isBasis()?Q.toJsonSchemaRecurse(X):Q.reduceJsonSchema(Z,X),{})}traverseAllows=(X,Z)=>this.children.every((Q)=>Q.traverseAllows(X,Z));traverseApply=(X,Z)=>{let Q=Z.currentErrorCount;if(this.basis){if(this.basis.traverseApply(X,Z),Z.currentErrorCount>Q)return}if(this.prestructurals.length){for(let G=0;G<this.prestructurals.length-1;G++)if(this.prestructurals[G].traverseApply(X,Z),Z.failFast&&Z.currentErrorCount>Q)return;if(this.prestructurals[this.prestructurals.length-1].traverseApply(X,Z),Z.currentErrorCount>Q)return}if(this.structure){if(this.structure.traverseApply(X,Z),Z.currentErrorCount>Q)return}if(this.inner.predicate){for(let G=0;G<this.inner.predicate.length-1;G++)if(this.inner.predicate[G].traverseApply(X,Z),Z.failFast&&Z.currentErrorCount>Q)return;this.inner.predicate[this.inner.predicate.length-1].traverseApply(X,Z)}};compile(X){if(X.traversalKind==="Allows"){for(let Z of this.children)X.check(Z);X.return(!0);return}if(X.initializeErrorCount(),this.basis){if(X.check(this.basis),this.children.length>1)X.returnIfFail()}if(this.prestructurals.length){for(let Z=0;Z<this.prestructurals.length-1;Z++)X.check(this.prestructurals[Z]),X.returnIfFailFast();if(X.check(this.prestructurals[this.prestructurals.length-1]),this.structure||this.inner.predicate)X.returnIfFail()}if(this.structure){if(X.check(this.structure),this.inner.predicate)X.returnIfFail()}if(this.inner.predicate){for(let Z=0;Z<this.inner.predicate.length-1;Z++)X.check(this.inner.predicate[Z]),X.returnIfFail();X.check(this.inner.predicate[this.inner.predicate.length-1])}}}var r7={implementation:ub,Node:s2},mb=(X)=>{if(X.structure?.expression)return X.structure.expression;let Z=X.basis&&!X.prestructurals.some((J)=>J.impl.obviatesBasisExpression)?X.basis.nestableExpression:"",Q=X.prestructurals.map((J)=>J.expression).join(" & "),G=`${Z}${Z?" ":""}${Q}`;if(G==="Array == 0")return"[]";return G||"unknown"},n2=(X,Z,Q)=>{let G={},J=X.proto??X.domain,Y=Z.proto??Z.domain,$=J?Y?N0(J,Y,Q):J:Y;if($ instanceof h)return $;if($)G[$.kind]=$;return i9({kind:"intersection",baseInner:G,l:o9(X),r:o9(Z),roots:[],ctx:Q})};var pb=t({kind:"morph",hasAssociatedError:!1,keys:{in:{child:!0,parse:(X,Z)=>Z.$.parseSchema(X)},morphs:{parse:I6,serialize:(X)=>X.map((Z)=>l(Z,"root")?Z.json:_0(Z))},declaredIn:{child:!1,serialize:(X)=>X.json},declaredOut:{child:!1,serialize:(X)=>X.json}},normalize:(X)=>X,defaults:{description:(X)=>`a morph from ${X.rawIn.description} to ${X.rawOut?.description??"unknown"}`},intersections:{morph:(X,Z,Q)=>{if(!X.hasEqualMorphs(Z))return I(db(X.expression,Z.expression));let G=N0(X.rawIn,Z.rawIn,Q);if(G instanceof h)return G;let J={morphs:X.morphs};if(X.declaredIn||Z.declaredIn){let Y=N0(X.rawIn,Z.rawIn,Q);if(Y instanceof h)return Y.throw();else J.declaredIn=Y}if(X.declaredOut||Z.declaredOut){let Y=N0(X.rawOut,Z.rawOut,Q);if(Y instanceof h)return Y.throw();else J.declaredOut=Y}return G.distribute((Y)=>Q.$.node("morph",{...J,in:Y}),Q.$.parseSchema)},...iX("morph",(X,Z,Q)=>{let G=X.inner.in?N0(X.inner.in,Z,Q):Z;return G instanceof h?G:G.equals(X.inner.in)?X:Q.$.node("morph",{...X.inner,in:G})})}});class r2 extends EX{serializedMorphs=this.morphs.map(_0);compiledMorphs=`[${this.serializedMorphs}]`;lastMorph=this.inner.morphs[this.inner.morphs.length-1];lastMorphIfNode=l(this.lastMorph,"root")?this.lastMorph:void 0;introspectableIn=this.inner.in;introspectableOut=this.lastMorphIfNode?Object.assign(this.referencesById,this.lastMorphIfNode.referencesById)&&this.lastMorphIfNode.rawOut:void 0;get shallowMorphs(){return Array.isArray(this.inner.in?.shallowMorphs)?[...this.inner.in.shallowMorphs,...this.morphs]:this.morphs}get rawIn(){return this.declaredIn??this.inner.in?.rawIn??f.intrinsic.unknown.internal}get rawOut(){return this.declaredOut??this.introspectableOut??f.intrinsic.unknown.internal}declareIn(X){return this.$.node("morph",{...this.inner,declaredIn:X})}declareOut(X){return this.$.node("morph",{...this.inner,declaredOut:X})}expression=`(In: ${this.rawIn.expression}) => ${this.lastMorphIfNode?"To":"Out"}<${this.rawOut.expression}>`;get defaultShortDescription(){return this.rawIn.meta.description??this.rawIn.defaultShortDescription}innerToJsonSchema(X){return X.fallback.morph({code:"morph",base:this.rawIn.toJsonSchemaRecurse(X),out:this.introspectableOut?.toJsonSchemaRecurse(X)??null})}compile(X){if(X.traversalKind==="Allows"){if(!this.introspectableIn)return;X.return(X.invoke(this.introspectableIn));return}if(this.introspectableIn)X.line(X.invoke(this.introspectableIn));X.line(`ctx.queueMorphs(${this.compiledMorphs})`)}traverseAllows=(X,Z)=>!this.introspectableIn||this.introspectableIn.traverseAllows(X,Z);traverseApply=(X,Z)=>{if(this.introspectableIn)this.introspectableIn.traverseApply(X,Z);Z.queueMorphs(this.morphs)};hasEqualMorphs(X){return Y6(this.morphs,X.morphs,{isEqual:(Z,Q)=>Z===Q||l(Z,"root")&&l(Q,"root")&&Z.equals(Q)})}}var a7={implementation:pb,Node:r2},db=(X,Z)=>`The intersection of distinct morphs at a single path is indeterminate:
Left: ${X}
Right: ${Z}`;var lb=t({kind:"proto",hasAssociatedError:!0,collapsibleKey:"proto",keys:{proto:{serialize:(X)=>Z8(X)??TX(X)},dateAllowsInvalid:{}},normalize:(X)=>{let Z=typeof X==="string"?{proto:a6[X]}:typeof X==="function"?M0(X)?X:{proto:X}:typeof X.proto==="string"?{...X,proto:a6[X.proto]}:X;if(typeof Z.proto!=="function")I(N8.writeInvalidSchemaMessage(Z.proto));if(g9(Z,"dateAllowsInvalid")&&Z.proto!==Date)I(N8.writeBadInvalidDateMessage(Z.proto));return Z},applyConfig:(X,Z)=>{if(X.dateAllowsInvalid===void 0&&X.proto===Date&&Z.dateAllowsInvalid)return{...X,dateAllowsInvalid:!0};return X},defaults:{description:(X)=>X.builtinName?uB[X.builtinName]:`an instance of ${X.proto.name}`,actual:(X)=>X instanceof Date&&X.toString()==="Invalid Date"?"an invalid Date":X8(X)},intersections:{proto:(X,Z)=>X.proto===Date&&Z.proto===Date?X.dateAllowsInvalid?Z:X:N7(X.proto,Z.proto)?X:N7(Z.proto,X.proto)?Z:h.init("proto",X,Z),domain:(X,Z)=>Z.domain==="object"?X:h.init("domain",f.intrinsic.object.internal,Z)}});class a2 extends Z9{builtinName=Z8(this.proto);serializedConstructor=this.json.proto;requiresInvalidDateCheck=this.proto===Date&&!this.dateAllowsInvalid;traverseAllows=this.requiresInvalidDateCheck?(X)=>X instanceof Date&&X.toString()!=="Invalid Date":(X)=>X instanceof this.proto;compiledCondition=`data instanceof ${this.serializedConstructor}${this.requiresInvalidDateCheck?' && data.toString() !== "Invalid Date"':""}`;compiledNegation=`!(${this.compiledCondition})`;innerToJsonSchema(X){switch(this.builtinName){case"Array":return{type:"array"};case"Date":return X.fallback.date?.({code:"date",base:{}})??X.fallback.proto({code:"proto",base:{},proto:this.proto});default:return X.fallback.proto({code:"proto",base:{},proto:this.proto})}}expression=this.dateAllowsInvalid?"Date | InvalidDate":this.proto.name;get nestableExpression(){return this.dateAllowsInvalid?`(${this.expression})`:this.expression}domain="object";get defaultShortDescription(){return this.description}}var N8={implementation:lb,Node:a2,writeBadInvalidDateMessage:(X)=>`dateAllowsInvalid may only be specified with constructor Date (was ${X.name})`,writeInvalidSchemaMessage:(X)=>`instanceOf operand must be a function (was ${x0(X)})`};var cb=t({kind:"union",hasAssociatedError:!0,collapsibleKey:"branches",keys:{ordered:{},branches:{child:!0,parse:(X,Z)=>{let Q=[];for(let G of X){let J=l(G,"root")?G.branches:Z.$.parseSchema(G).branches;for(let Y of J)if(Y.hasKind("morph")){let $=Q.findIndex((z)=>z.hasKind("morph")&&z.hasEqualMorphs(Y));if($===-1)Q.push(Y);else{let z=Q[$];Q[$]=Z.$.node("morph",{...z.inner,in:z.rawIn.rawOr(Y.rawIn)})}}else Q.push(Y)}if(!Z.def.ordered)Q.sort((G,J)=>G.hash<J.hash?-1:1);return Q}}},normalize:(X)=>O0(X)?{branches:X}:X,reduce:(X,Z)=>{let Q=ZR(X);if(Q.length===1)return Q[0];if(Q.length===X.branches.length)return;return Z.node("union",{...X,branches:Q},{prereduced:!0})},defaults:{description:(X)=>X.distribute((Z)=>Z.description,a9),expected:(X)=>{let Z=RB(X.errors,"propString"),Q=Object.entries(Z).map(([G,J])=>{let Y=[];for(let H of J)lX(Y,H.expected);let $=a9(Y),z=J.every((H)=>H.actual===J[0].actual)?J[0].actual:r(J[0].data);return`${G&&`${G} `}must be ${$}${z&&` (was ${z})`}`});return a9(Q)},problem:(X)=>X.expected,message:(X)=>{if(X.problem[0]==="[")return`value at ${X.problem}`;return X.problem}},intersections:{union:(X,Z,Q)=>{if(X.isNever!==Z.isNever)return h.init("presence",X,Z);let G;if(X.ordered){if(Z.ordered)I(GR(X.expression,Z.expression));if(G=t7(Z.branches,X.branches,Q),G instanceof h)G.invert()}else G=t7(X.branches,Z.branches,Q);if(G instanceof h)return G;return Q.$.parseSchema(X.ordered||Z.ordered?{branches:G,ordered:!0}:{branches:G})},...iX("union",(X,Z,Q)=>{let G=t7(X.branches,[Z],Q);if(G instanceof h)return G;if(G.length===1)return G[0];return Q.$.parseSchema(X.ordered?{branches:G,ordered:!0}:{branches:G})})}});class XL extends EX{isBoolean=this.branches.length===2&&this.branches[0].hasUnit(!1)&&this.branches[1].hasUnit(!0);get branchGroups(){let X=[],Z=-1;for(let Q of this.branches){if(Q.hasKind("unit")&&Q.domain==="boolean"){if(Z===-1)Z=X.length,X.push(Q);else X[Z]=f.intrinsic.boolean;continue}X.push(Q)}return X}unitBranches=this.branches.filter((X)=>X.rawIn.hasKind("unit"));discriminant=this.discriminate();discriminantJson=this.discriminant?tb(this.discriminant):null;expression=this.distribute((X)=>X.nestableExpression,XR);createBranchedOptimisticRootApply(){return(X,Z)=>{let Q=this.traverseOptimistic(X);if(Q!==QX)return Q;let G=new xX(X,this.$.resolvedConfig);return this.traverseApply(X,G),G.finalize(Z)}}get shallowMorphs(){return this.branches.reduce((X,Z)=>lX(X,Z.shallowMorphs),[])}get defaultShortDescription(){return this.distribute((X)=>X.defaultShortDescription,a9)}innerToJsonSchema(X){if(this.branchGroups.length===1&&this.branchGroups[0].equals(f.intrinsic.boolean))return{type:"boolean"};let Z=this.branchGroups.map((Q)=>Q.toJsonSchemaRecurse(X));if(Z.every((Q)=>Object.keys(Q).length===1&&g9(Q,"const")))return{enum:Z.map((Q)=>Q.const)};return{anyOf:Z}}traverseAllows=(X,Z)=>this.branches.some((Q)=>Q.traverseAllows(X,Z));traverseApply=(X,Z)=>{let Q=[];for(let G=0;G<this.branches.length;G++){if(Z.pushBranch(),this.branches[G].traverseApply(X,Z),!Z.hasError()){if(this.branches[G].includesTransform)return Z.queuedMorphs.push(...Z.popBranch().queuedMorphs);return Z.popBranch()}Q.push(Z.popBranch().error)}Z.errorFromNodeContext({code:"union",errors:Q,meta:this.meta})};traverseOptimistic=(X)=>{for(let Z=0;Z<this.branches.length;Z++){let Q=this.branches[Z];if(Q.traverseAllows(X)){if(Q.contextFreeMorph)return Q.contextFreeMorph(X);return X}}return QX};compile(X){if(!this.discriminant||this.unitBranches.length===this.branches.length&&this.branches.length===2)return this.compileIndiscriminable(X);let Z=this.discriminant.optionallyChainedPropString;if(this.discriminant.kind==="domain")Z=`typeof ${Z} === "object" ? ${Z} === null ? "null" : "object" : typeof ${Z} === "function" ? "object" : typeof ${Z}`;let Q=this.discriminant.cases,G=Object.keys(Q),{optimistic:J}=X;if(X.optimistic=!1,X.block(`switch(${Z})`,()=>{for(let U in Q){let L=Q[U],A=U==="default"?U:`case ${U}`,F;if(L===!0)F=J?"data":"true";else if(J)if(L.rootApplyStrategy==="branchedOptimistic")F=X.invoke(L,{kind:"Optimistic"});else if(L.contextFreeMorph)F=`${X.invoke(L)} ? ${_0(L.contextFreeMorph)}(data) : "${QX}"`;else F=`${X.invoke(L)} ? data : "${QX}"`;else F=X.invoke(L);X.line(`${A}: return ${F}`)}return X}),X.traversalKind==="Allows"){X.return(J?`"${QX}"`:!1);return}let Y=a9(this.discriminant.kind==="domain"?G.map((U)=>{let L=U.slice(1,-1);return L==="function"?ZX.object:ZX[L]}):G),$=this.discriminant.path.map((U)=>typeof U==="symbol"?_0(U):JSON.stringify(U)),z=JSON.stringify(Y),H=this.discriminant.kind==="domain"?`${rb}[${Z}]`:`${ab}(${Z})`;X.line(`ctx.errorFromNodeContext({
	code: "predicate",
	expected: ${z},
	actual: ${H},
	relativePath: [${$}],
	meta: ${this.compiledMeta}
})`)}compileIndiscriminable(X){if(X.traversalKind==="Apply"){X.const("errors","[]");for(let Z of this.branches)X.line("ctx.pushBranch()").line(X.invoke(Z)).if("!ctx.hasError()",()=>X.return(Z.includesTransform?"ctx.queuedMorphs.push(...ctx.popBranch().queuedMorphs)":"ctx.popBranch()")).line("errors.push(ctx.popBranch().error)");X.line(`ctx.errorFromNodeContext({ code: "union", errors, meta: ${this.compiledMeta} })`)}else{let{optimistic:Z}=X;X.optimistic=!1;for(let Q of this.branches)X.if(`${X.invoke(Q)}`,()=>X.return(Z?Q.contextFreeMorph?`${_0(Q.contextFreeMorph)}(data)`:"data":!0));X.return(Z?`"${QX}"`:!1)}}get nestableExpression(){return this.isBoolean?"boolean":`(${this.expression})`}discriminate(){if(this.branches.length<2||this.isCyclic)return null;if(this.unitBranches.length===this.branches.length){let J=s(this.unitBranches,(Y,$)=>[`${$.rawIn.serializedValue}`,$.hasKind("morph")?$:!0]);return{kind:"unit",path:[],optionallyChainedPropString:"data",cases:J}}let X=[];for(let J=0;J<this.branches.length-1;J++){let Y=this.branches[J];for(let $=J+1;$<this.branches.length;$++){let z=this.branches[$],H=$X(Y.rawIn,z.rawIn,Y.$);if(!(H instanceof h))continue;for(let U of H){if(!U.kind||U.optional)continue;let L,A;if(U.kind==="domain"){let{l:j,r:R}=U;L=`"${typeof j==="string"?j:j.domain}"`,A=`"${typeof R==="string"?R:R.domain}"`}else if(U.kind==="unit")L=U.l.serializedValue,A=U.r.serializedValue;else continue;let F=X.find((j)=>Y6(j.path,U.path)&&j.kind===U.kind);if(!F)X.push({kind:U.kind,cases:{[L]:{branchIndices:[J],condition:U.l},[A]:{branchIndices:[$],condition:U.r}},path:U.path});else{if(F.cases[L])F.cases[L].branchIndices=lX(F.cases[L].branchIndices,J);else F.cases[L]??={branchIndices:[J],condition:U.l};if(F.cases[A])F.cases[A].branchIndices=lX(F.cases[A].branchIndices,$);else F.cases[A]??={branchIndices:[$],condition:U.r}}}}}let Z=this.ordered?nb(X,this.branches):X;if(!Z.length)return null;let Q=ib(Z,this),G={};for(let J in Q.best.cases){let Y=ob(Q,J);if(Y===null){G[J]=!0;continue}if(Y.length===this.branches.length)return null;if(this.ordered)Y.sort((H,U)=>H.originalIndex-U.originalIndex);let $=Y.map((H)=>H.branch),z=$.length===1?$[0]:this.$.node("union",this.ordered?{branches:$,ordered:!0}:$);Object.assign(this.referencesById,z.referencesById),G[J]=z}if(Q.defaultEntries.length){let J=Q.defaultEntries.map((Y)=>Y.branch);G.default=this.$.node("union",this.ordered?{branches:J,ordered:!0}:J,{prereduced:!0}),Object.assign(this.referencesById,G.default.referencesById)}return Object.assign(Q.location,{cases:G})}}var ib=(X,Z)=>{let G=X.sort(($,z)=>$.path.length===z.path.length?Object.keys(z.cases).length-Object.keys($.cases).length:$.path.length-z.path.length)[0],J={kind:G.kind,path:G.path,optionallyChainedPropString:ZL(G.path)},Y=Z.branches.map(($,z)=>({originalIndex:z,branch:$}));return{best:G,location:J,defaultEntries:Y,node:Z}},ob=(X,Z)=>{let Q=X.best.cases[Z],G=sb(Q.condition,X.location.path,X.node.$),J=[],Y=[];for(let $=0;$<X.defaultEntries.length;$++){let z=X.defaultEntries[$];if(Q.branchIndices.includes(z.originalIndex)){let H=t2(X.node.branches[z.originalIndex],X.location);if(H===null)J=null;else J?.push({originalIndex:z.originalIndex,branch:H})}else if(z.branch.hasKind("alias")&&G.hasKind("domain")&&G.domain==="object")J?.push(z);else{if(z.branch.rawIn.overlaps(G)){let H=t2(z.branch,X.location);J?.push({originalIndex:z.originalIndex,branch:H})}Y.push(z)}}return X.defaultEntries=Y,J},nb=(X,Z)=>{return X.filter((G)=>{let J=Object.values(G.cases).map((Y)=>Y.branchIndices);for(let Y=0;Y<J.length-1;Y++){let $=J[Y];for(let z=Y+1;z<J.length;z++){let H=J[z];for(let U of $)for(let L of H)if(U>L){if(Z[U].overlaps(Z[L]))return!1}}}return!0})},sb=(X,Z,Q)=>{let G=X==="undefined"?Q.node("unit",{unit:void 0}):X==="null"?Q.node("unit",{unit:null}):X==="boolean"?Q.units([!0,!1]):X;for(let J=Z.length-1;J>=0;J--){let Y=Z[J];G=Q.node("intersection",typeof Y==="number"?{proto:"Array",sequence:[...SB(Y).map(($)=>({})),G]}:{domain:"object",required:[{key:Y,value:G}]})}return G},ZL=(X)=>X.reduce((Z,Q)=>Z+D7(Q,!0),"data"),rb=_0(yB),ab=_0(r),e7={implementation:cb,Node:XL},tb=(X)=>({kind:X.kind,path:X.path.map((Z)=>typeof Z==="string"?Z:kX(Z)),cases:s(X.cases,(Z,Q)=>[Z,Q===!0?Q:Q.hasKind("union")&&Q.discriminantJson?Q.discriminantJson:Q.json])}),eb={delimiter:" | ",finalDelimiter:" | "},XR=(X)=>a9(X,eb),a9=(X,Z)=>{let Q=Z?.delimiter??", ",G=Z?.finalDelimiter??" or ";if(X.length===0)return"never";if(X.length===1)return X[0];if(X.length===2&&X[0]==="false"&&X[1]==="true"||X[0]==="true"&&X[1]==="false")return"boolean";let J={},Y=X.filter((z)=>J[z]?!1:J[z]=!0),$=Y.pop();return`${Y.join(Q)}${Y.length?G:""}${$}`},t7=(X,Z,Q)=>{let G=Z.map(()=>[]);for(let Y=0;Y<X.length;Y++){let $={};for(let z=0;z<Z.length;z++){if(G[z]===null)continue;if(X[Y].equals(Z[z])){G[z]=null,$={};break}let H=N0(X[Y],Z[z],Q);if(H instanceof h)continue;if(H.equals(X[Y])){G[z].push(X[Y]),$={};break}if(H.equals(Z[z]))G[z]=null;else $[z]=H}for(let z in $)G[z][Y]=$[z]}let J=G.flatMap((Y,$)=>Y?.flatMap((z)=>z.branches)??Z[$]);return J.length===0?h.init("union",X,Z):J},ZR=({branches:X,ordered:Z})=>{if(X.length<2)return X;let Q=X.map(()=>!0);for(let G=0;G<X.length;G++)for(let J=G+1;J<X.length&&Q[G]&&Q[J];J++){if(X[G].equals(X[J])){Q[J]=!1;continue}let Y=$X(X[G].rawIn,X[J].rawIn,X[0].$);if(Y instanceof h)continue;if(!Z)QR(X[G],X[J]);if(Y.equals(X[G].rawIn))Q[G]=!!Z;else if(Y.equals(X[J].rawIn))Q[J]=!1}return X.filter((G,J)=>Q[J])},QR=(X,Z)=>{if(!X.includesTransform&&!Z.includesTransform)return;if(!Y6(X.shallowMorphs,Z.shallowMorphs))I(e2(X.expression,Z.expression));if(!Y6(X.flatMorphs,Z.flatMorphs,{isEqual:(Q,G)=>Q.propString===G.propString&&(Q.node.hasKind("morph")&&G.node.hasKind("morph")?Q.node.hasEqualMorphs(G.node):Q.node.hasKind("intersection")&&G.node.hasKind("intersection")?Q.node.structure?.structuralMorphRef===G.node.structure?.structuralMorphRef:!1)}))I(e2(X.expression,Z.expression))},t2=(X,Z)=>X.transform((Q,G)=>{if(Q==="domain"||Q==="unit")return null;return G},{shouldTransform:(Q,G)=>{let J=ZL(G.path);if(!Z.optionallyChainedPropString.startsWith(J))return!1;if(Q.hasKind("domain")&&Q.domain==="object")return!0;if((Q.hasKind("domain")||Z.kind==="unit")&&J===Z.optionallyChainedPropString)return!0;return Q.children.length!==0&&Q.kind!=="index"}}),e2=(X,Z)=>`An unordered union of a type including a morph and a type with overlapping input is indeterminate:
Left: ${X}
Right: ${Z}`,GR=(X,Z)=>`The intersection of two ordered unions is indeterminate:
Left: ${X}
Right: ${Z}`;var JR=t({kind:"unit",hasAssociatedError:!0,keys:{unit:{preserveUndefined:!0,serialize:(X)=>X instanceof Date?X.toISOString():TX(X)}},normalize:(X)=>X,defaults:{description:(X)=>r(X.unit),problem:({expected:X,actual:Z})=>`${X===Z?`must be reference equal to ${X} (serialized to the same value)`:`must be ${X} (was ${Z})`}`},intersections:{unit:(X,Z)=>h.init("unit",X,Z),...iX("unit",(X,Z)=>{if(Z.allows(X.unit))return X;let Q=Z.hasKind("intersection")?Z.basis:Z;if(Q){let G=Q.hasKind("domain")?Q:f.intrinsic.object;if(X.domain!==G.domain){let J=X.domain==="undefined"||X.domain==="null"||X.domain==="boolean"?X.domain:f.intrinsic[X.domain];return h.init("domain",J,G)}}return h.init("assignability",X,Z.hasKind("intersection")?Z.children.find((G)=>!G.allows(X.unit)):Z)})}});class GL extends Z9{compiledValue=this.json.unit;serializedValue=typeof this.unit==="string"||this.unit instanceof Date?JSON.stringify(this.compiledValue):`${this.compiledValue}`;compiledCondition=QL(this.unit,this.serializedValue);compiledNegation=QL(this.unit,this.serializedValue,"negated");expression=r(this.unit);domain=x0(this.unit);get defaultShortDescription(){return this.domain==="object"?ZX.object:this.description}innerToJsonSchema(X){return this.unit===null?{type:"null"}:f.intrinsic.jsonPrimitive.allows(this.unit)?{const:this.unit}:X.fallback.unit({code:"unit",base:{},unit:this.unit})}traverseAllows=this.unit instanceof Date?(X)=>X instanceof Date&&X.toISOString()===this.compiledValue:Number.isNaN(this.unit)?(X)=>Number.isNaN(X):(X)=>X===this.unit}var XY={implementation:JR,Node:GL},QL=(X,Z,Q)=>{if(X instanceof Date){let G=`data instanceof Date && data.toISOString() === ${Z}`;return Q?`!(${G})`:G}if(Number.isNaN(X))return`${Q?"!":""}Number.isNaN(data)`;return`data ${Q?"!":"="}== ${Z}`};var YR=t({kind:"index",hasAssociatedError:!1,intersectionIsOpen:!0,keys:{signature:{child:!0,parse:(X,Z)=>{let Q=Z.$.parseSchema(X);if(!Q.extends(f.intrinsic.key))return I(zR(Q.expression));let G=Q.branches.filter((J)=>J.hasKind("unit"));if(G.length)return I($R(G.map((J)=>r(J.unit))));return Q}},value:{child:!0,parse:(X,Z)=>Z.$.parseSchema(X)}},normalize:(X)=>X,defaults:{description:(X)=>`[${X.signature.expression}]: ${X.value.description}`},intersections:{index:(X,Z,Q)=>{if(X.signature.equals(Z.signature)){let G=N0(X.value,Z.value,Q),J=G instanceof h?f.intrinsic.never.internal:G;return Q.$.node("index",{signature:X.signature,value:J})}if(X.signature.extends(Z.signature)&&X.value.subsumes(Z.value))return Z;if(Z.signature.extends(X.signature)&&Z.value.subsumes(X.value))return X;return null}}});class JL extends qX{impliedBasis=f.intrinsic.object.internal;expression=`[${this.signature.expression}]: ${this.value.expression}`;flatRefs=G0(this.value.flatRefs.map((X)=>vX([this.signature,...X.path],X.node)),vX([this.signature],this.value));traverseAllows=(X,Z)=>r6(X).every((Q)=>{if(this.signature.traverseAllows(Q[0],Z))return YX(Q[0],()=>this.value.traverseAllows(Q[1],Z),Z);return!0});traverseApply=(X,Z)=>{for(let Q of r6(X))if(this.signature.traverseAllows(Q[0],Z))YX(Q[0],()=>this.value.traverseApply(Q[1],Z),Z)};_transform(X,Z){Z.path.push(this.signature);let Q=super._transform(X,Z);return Z.path.pop(),Q}compile(){}}var ZY={implementation:YR,Node:JL},$R=(X)=>`Index keys ${X.join(", ")} should be specified as named props.`,zR=(X)=>`Indexed key definition '${X}' must be a string or symbol`;var HR=t({kind:"required",hasAssociatedError:!0,intersectionIsOpen:!0,keys:{key:{},value:{child:!0,parse:(X,Z)=>Z.$.parseSchema(X)}},normalize:(X)=>X,defaults:{description:(X)=>`${X.compiledKey}: ${X.value.description}`,expected:(X)=>X.missingValueDescription,actual:()=>"missing"},intersections:{required:A8,optional:A8}});class YL extends F8{expression=`${this.compiledKey}: ${this.value.expression}`;errorContext=Object.freeze({code:"required",missingValueDescription:this.value.defaultShortDescription,relativePath:[this.key],meta:this.meta});compiledErrorContext=b6(this.errorContext)}var QY={implementation:HR,Node:YL};var UR=t({kind:"sequence",hasAssociatedError:!1,collapsibleKey:"variadic",keys:{prefix:{child:!0,parse:(X,Z)=>{if(X.length===0)return;return X.map((Q)=>Z.$.parseSchema(Q))}},optionals:{child:!0,parse:(X,Z)=>{if(X.length===0)return;return X.map((Q)=>Z.$.parseSchema(Q))}},defaultables:{child:(X)=>X.map((Z)=>Z[0]),parse:(X,Z)=>{if(X.length===0)return;return X.map((Q)=>{let G=Z.$.parseSchema(Q[0]);return w8(G,Q[1],null),[G,Q[1]]})},serialize:(X)=>X.map((Z)=>[Z[0].collapsibleJson,TX(Z[1])]),reduceIo:(X,Z,Q)=>{if(X==="in"){Z.optionals=Q.map((G)=>G[0].rawIn);return}Z.prefix=Q.map((G)=>G[0].rawOut);return}},variadic:{child:!0,parse:(X,Z)=>Z.$.parseSchema(X,Z)},minVariadicLength:{parse:(X)=>X===0?void 0:X},postfix:{child:!0,parse:(X,Z)=>{if(X.length===0)return;return X.map((Q)=>Z.$.parseSchema(Q))}}},normalize:(X)=>{if(typeof X==="string")return{variadic:X};if("variadic"in X||"prefix"in X||"defaultables"in X||"optionals"in X||"postfix"in X||"minVariadicLength"in X){if(X.postfix?.length){if(!X.variadic)return I(LR);if(X.optionals?.length||X.defaultables?.length)return I(JY)}if(X.minVariadicLength&&!X.variadic)return I("minVariadicLength may not be specified without a variadic element");return X}return{variadic:X}},reduce:(X,Z)=>{let Q=X.minVariadicLength??0,G=X.prefix?.slice()??[],J=X.defaultables?.slice()??[],Y=X.optionals?.slice()??[],$=X.postfix?.slice()??[];if(X.variadic){while(Y[Y.length-1]?.equals(X.variadic))Y.pop();if(Y.length===0&&J.length===0)while(G[G.length-1]?.equals(X.variadic))G.pop(),Q++;while($[0]?.equals(X.variadic))$.shift(),Q++}else if(Y.length===0&&J.length===0)G.push(...$.splice(0));if(Q!==X.minVariadicLength||X.prefix&&X.prefix.length!==G.length)return Z.node("sequence",{...X,prefix:G,defaultables:J,optionals:Y,postfix:$,minVariadicLength:Q},{prereduced:!0})},defaults:{description:(X)=>{if(X.isVariadicOnly)return`${X.variadic.nestableExpression}[]`;return`[${X.tuple.map((Q)=>Q.kind==="defaultables"?`${Q.node.nestableExpression} = ${r(Q.default)}`:Q.kind==="optionals"?`${Q.node.nestableExpression}?`:Q.kind==="variadic"?`...${Q.node.nestableExpression}[]`:Q.node.expression).join(", ")}]`}},intersections:{sequence:(X,Z,Q)=>{let G=T8({l:X.tuple,r:Z.tuple,disjoint:new h,result:[],fixedVariants:[],ctx:Q}),J=G.disjoint.length===0?[G,...G.fixedVariants]:G.fixedVariants;return J.length===0?G.disjoint:J.length===1?Q.$.node("sequence",$L(J[0].result)):Q.$.node("union",J.map((Y)=>({proto:Array,sequence:$L(Y.result)})))}}});class HL extends qX{impliedBasis=f.intrinsic.Array.internal;tuple=BR(this.inner);prefixLength=this.prefix?.length??0;defaultablesLength=this.defaultables?.length??0;optionalsLength=this.optionals?.length??0;postfixLength=this.postfix?.length??0;defaultablesAndOptionals=[];prevariadic=this.tuple.filter((X)=>{if(X.kind==="defaultables"||X.kind==="optionals")return this.defaultablesAndOptionals.push(X.node),!0;return X.kind==="prefix"});variadicOrPostfix=J6(this.variadic&&[this.variadic],this.postfix);flatRefs=this.addFlatRefs();addFlatRefs(){return b7(this.flatRefs,this.prevariadic.flatMap((X,Z)=>G0(X.node.flatRefs.map((Q)=>vX([`${Z}`,...Q.path],Q.node)),vX([`${Z}`],X.node)))),b7(this.flatRefs,this.variadicOrPostfix.flatMap((X)=>G0(X.flatRefs.map((Z)=>vX([f.intrinsic.nonNegativeIntegerString.internal,...Z.path],Z.node)),vX([f.intrinsic.nonNegativeIntegerString.internal],X)))),this.flatRefs}isVariadicOnly=this.prevariadic.length+this.postfixLength===0;minVariadicLength=this.inner.minVariadicLength??0;minLength=this.prefixLength+this.minVariadicLength+this.postfixLength;minLengthNode=this.minLength===0?null:this.$.node("minLength",this.minLength);maxLength=this.variadic?null:this.tuple.length;maxLengthNode=this.maxLength===null?null:this.$.node("maxLength",this.maxLength);impliedSiblings=this.minLengthNode?this.maxLengthNode?[this.minLengthNode,this.maxLengthNode]:[this.minLengthNode]:this.maxLengthNode?[this.maxLengthNode]:[];defaultValueMorphs=VR(this);defaultValueMorphsReference=this.defaultValueMorphs.length?_0(this.defaultValueMorphs):void 0;elementAtIndex(X,Z){if(Z<this.prevariadic.length)return this.tuple[Z];let Q=X.length-this.postfixLength;if(Z>=Q)return{kind:"postfix",node:this.postfix[Z-Q]};return{kind:"variadic",node:this.variadic??H0(`Unexpected attempt to access index ${Z} on ${this}`)}}traverseAllows=(X,Z)=>{for(let Q=0;Q<X.length;Q++)if(!this.elementAtIndex(X,Q).node.traverseAllows(X[Q],Z))return!1;return!0};traverseApply=(X,Z)=>{let Q=0;for(;Q<X.length;Q++)YX(Q,()=>this.elementAtIndex(X,Q).node.traverseApply(X[Q],Z),Z)};get element(){return this.cacheGetter("element",this.$.node("union",this.children))}compile(X){if(this.prefix)for(let[Z,Q]of this.prefix.entries())X.traverseKey(`${Z}`,`data[${Z}]`,Q);for(let[Z,Q]of this.defaultablesAndOptionals.entries()){let G=`${Z+this.prefixLength}`;X.if(`${G} >= data.length`,()=>X.traversalKind==="Allows"?X.return(!0):X.return()),X.traverseKey(G,`data[${G}]`,Q)}if(this.variadic){if(this.postfix)X.const("firstPostfixIndex",`data.length${this.postfix?`- ${this.postfix.length}`:""}`);if(X.for(`i < ${this.postfix?"firstPostfixIndex":"data.length"}`,()=>X.traverseKey("i","data[i]",this.variadic),this.prevariadic.length),this.postfix)for(let[Z,Q]of this.postfix.entries()){let G=`firstPostfixIndex + ${Z}`;X.traverseKey(G,`data[${G}]`,Q)}}if(X.traversalKind==="Allows")X.return(!0)}_transform(X,Z){Z.path.push(f.intrinsic.nonNegativeIntegerString.internal);let Q=super._transform(X,Z);return Z.path.pop(),Q}expression=this.description;reduceJsonSchema(X,Z){let Q=Z.target==="draft-07";if(this.prevariadic.length){let G=this.prevariadic.map((J)=>{let Y=J.node.toJsonSchemaRecurse(Z);if(J.kind==="defaultables"){let $=typeof J.default==="function"?J.default():J.default;Y.default=f.intrinsic.jsonData.allows($)?$:Z.fallback.defaultValue({code:"defaultValue",base:Y,value:$})}return Y});if(Q)X.items=G;else X.prefixItems=G}if(this.minLength)X.minItems=this.minLength;if(this.variadic){let G=this.variadic.toJsonSchemaRecurse(Z);if(Q&&this.prevariadic.length)X.additionalItems=G;else X.items=G;if(this.maxLength)X.maxItems=this.maxLength;if(this.postfix){let J=this.postfix.map((Y)=>Y.toJsonSchemaRecurse(Z));X=Z.fallback.arrayPostfix({code:"arrayPostfix",base:X,elements:J})}}else{if(Q)X.additionalItems=!1;else X.items=!1;delete X.maxItems}return X}}var WR={},VR=(X)=>{if(!X.defaultables)return[];let Z=[],Q="[",G=X.prefixLength+X.defaultablesLength-1;for(let J=X.prefixLength;J<=G;J++){let[Y,$]=X.defaultables[J-X.prefixLength];Z.push(s7(J,Y,$)),Q+=`${J}: ${Y.id} = ${TX($)}, `}return Q+="]",WR[Q]??=Z},GY={implementation:UR,Node:HL},BR=(X)=>{let Z=[];if(X.prefix)for(let Q of X.prefix)Z.push({kind:"prefix",node:Q});if(X.defaultables)for(let[Q,G]of X.defaultables)Z.push({kind:"defaultables",node:Q,default:G});if(X.optionals)for(let Q of X.optionals)Z.push({kind:"optionals",node:Q});if(X.variadic)Z.push({kind:"variadic",node:X.variadic});if(X.postfix)for(let Q of X.postfix)Z.push({kind:"postfix",node:Q});return Z},$L=(X)=>X.reduce((Z,Q)=>{if(Q.kind==="variadic")Z.variadic=Q.node;else if(Q.kind==="defaultables")Z.defaultables=G0(Z.defaultables,[[Q.node,Q.default]]);else Z[Q.kind]=G0(Z[Q.kind],Q.node);return Z},{}),JY="A postfix required element cannot follow an optional or defaultable element",LR="A postfix element requires a variadic element",T8=(X)=>{let[Z,...Q]=X.l,[G,...J]=X.r;if(!Z||!G)return X;let Y=Q[Q.length-1]?.kind==="postfix",$=J[J.length-1]?.kind==="postfix",z=Z.kind==="prefix"||G.kind==="prefix"?"prefix":Z.kind==="postfix"||G.kind==="postfix"?"postfix":Z.kind==="variadic"&&G.kind==="variadic"?"variadic":Y||$?"prefix":Z.kind==="defaultables"||G.kind==="defaultables"?"defaultables":"optionals";if(Z.kind==="prefix"&&G.kind==="variadic"&&$){let A=T8({...X,fixedVariants:[],r:J.map((F)=>({...F,kind:"prefix"}))});if(A.disjoint.length===0)X.fixedVariants.push(A)}else if(G.kind==="prefix"&&Z.kind==="variadic"&&Y){let A=T8({...X,fixedVariants:[],l:Q.map((F)=>({...F,kind:"prefix"}))});if(A.disjoint.length===0)X.fixedVariants.push(A)}let H=N0(Z.node,G.node,X.ctx);if(H instanceof h)if(z==="prefix"||z==="postfix")X.disjoint.push(...H.withPrefixKey(z==="prefix"?X.result.length:`-${Q.length+1}`,zL(Z)&&zL(G)?"required":"optional")),X.result=[...X.result,{kind:z,node:f.intrinsic.never.internal}];else if(z==="optionals"||z==="defaultables")return X;else return T8({...X,fixedVariants:[],l:Q.map((A)=>({...A,kind:"prefix"})),r:Q.map((A)=>({...A,kind:"prefix"}))});else if(z==="defaultables"){if(Z.kind==="defaultables"&&G.kind==="defaultables"&&Z.default!==G.default)I(n7(Z.default,G.default));X.result=[...X.result,{kind:z,node:H,default:Z.kind==="defaultables"?Z.default:G.kind==="defaultables"?G.default:H0(`Unexpected defaultable intersection from ${Z.kind} and ${G.kind} elements.`)}]}else X.result=[...X.result,{kind:z,node:H}];let U=X.l.length,L=X.r.length;if(Z.kind!=="variadic"||U>=L&&(G.kind==="variadic"||L===1))X.l=Q;if(G.kind!=="variadic"||L>=U&&(Z.kind==="variadic"||U===1))X.r=J;return T8(X)},zL=(X)=>X.kind==="prefix"||X.kind==="postfix";var BL=(X)=>(Z)=>{if(Z.props.length||Z.index){let Q=Z.index?.map((J)=>J[X])??[];for(let J of Z.props)Q.push(J[X]);if(Z.undeclared)Q.push(`+ (undeclared): ${Z.undeclared}`);let G=`{ ${Q.join(", ")} }`;return Z.sequence?`${G} & ${Z.sequence.description}`:G}return Z.sequence?.description??"{}"},AR=BL("description"),FR=BL("expression"),UL=(X,Z,Q)=>{let G=X.required?"required":"optional";if(!Z.signature.allows(X.key))return null;let J=$X(X.value,Z.value,Q);if(J instanceof h)return G==="optional"?Q.node("optional",{key:X.key,value:f.intrinsic.never.internal}):J.withPrefixKey(X.key,X.kind);return null},OR=t({kind:"structure",hasAssociatedError:!1,normalize:(X)=>X,applyConfig:(X,Z)=>{if(!X.undeclared&&Z.onUndeclaredKey!=="ignore")return{...X,undeclared:Z.onUndeclaredKey};return X},keys:{required:{child:!0,parse:n0("required"),reduceIo:(X,Z,Q)=>{Z.required=G0(Z.required,Q.map((G)=>X==="in"?G.rawIn:G.rawOut));return}},optional:{child:!0,parse:n0("optional"),reduceIo:(X,Z,Q)=>{if(X==="in"){Z.optional=Q.map((G)=>G.rawIn);return}for(let G of Q)Z[G.outProp.kind]=G0(Z[G.outProp.kind],G.outProp.rawOut)}},index:{child:!0,parse:n0("index")},sequence:{child:!0,parse:n0("sequence")},undeclared:{parse:(X)=>X==="ignore"?void 0:X,reduceIo:(X,Z,Q)=>{if(Q==="reject"){Z.undeclared="reject";return}if(X==="in")delete Z.undeclared;else Z.undeclared="reject"}}},defaults:{description:AR},intersections:{structure:(X,Z,Q)=>{let G={...X.inner},J={...Z.inner},Y=new h;if(X.undeclared){let H=X.keyof();for(let U of Z.requiredKeys)if(!H.allows(U))Y.add("presence",f.intrinsic.never.internal,Z.propsByKey[U].value,{path:[U]});if(J.optional)J.optional=J.optional.filter((U)=>H.allows(U.key));if(J.index)J.index=J.index.flatMap((U)=>{if(U.signature.extends(H))return U;let L=$X(H,U.signature,Q.$);if(L instanceof h)return[];let A=EQ(L,U.value,Q.$);if(A.required)J.required=J6(J.required,A.required);if(A.optional)J.optional=J6(J.optional,A.optional);return A.index??[]})}if(Z.undeclared){let H=Z.keyof();for(let U of X.requiredKeys)if(!H.allows(U))Y.add("presence",X.propsByKey[U].value,f.intrinsic.never.internal,{path:[U]});if(G.optional)G.optional=G.optional.filter((U)=>H.allows(U.key));if(G.index)G.index=G.index.flatMap((U)=>{if(U.signature.extends(H))return U;let L=$X(H,U.signature,Q.$);if(L instanceof h)return[];let A=EQ(L,U.value,Q.$);if(A.required)G.required=J6(G.required,A.required);if(A.optional)G.optional=J6(G.optional,A.optional);return A.index??[]})}let $={};if(X.undeclared||Z.undeclared)$.undeclared=X.undeclared==="reject"||Z.undeclared==="reject"?"reject":"delete";let z=i9({kind:"structure",baseInner:$,l:o9(G),r:o9(J),roots:[],ctx:Q});if(z instanceof h)Y.push(...z);if(Y.length)return Y;return z}},reduce:(X,Z)=>{if(!X.required&&!X.optional)return;let Q={},G=!1,J=X.optional?[...X.optional]:[];if(X.required)for(let Y=0;Y<X.required.length;Y++){let $=X.required[Y];if($.key in Q)I(VL($.key));if(Q[$.key]=!0,X.index)for(let z of X.index){let H=UL($,z,Z);if(H instanceof h)return H}}if(X.optional)for(let Y=0;Y<X.optional.length;Y++){let $=X.optional[Y];if($.key in Q)I(VL($.key));if(Q[$.key]=!0,X.index)for(let z of X.index){let H=UL($,z,Z);if(H instanceof h)return H;if(H!==null)J[Y]=H,G=!0}}if(G)return Z.node("structure",{...X,optional:J},{prereduced:!0})}});class LL extends qX{impliedBasis=f.intrinsic.object.internal;impliedSiblings=this.children.flatMap((X)=>X.impliedSiblings??[]);props=J6(this.required,this.optional);propsByKey=s(this.props,(X,Z)=>[Z.key,Z]);propsByKeyReference=_0(this.propsByKey);expression=FR(this);requiredKeys=this.required?.map((X)=>X.key)??[];optionalKeys=this.optional?.map((X)=>X.key)??[];literalKeys=[...this.requiredKeys,...this.optionalKeys];_keyof;keyof(){if(this._keyof)return this._keyof;let X=this.$.units(this.literalKeys).branches;if(this.index)for(let{signature:Z}of this.index)X=X.concat(Z.branches);return this._keyof=this.$.node("union",X)}map(X){return this.$.node("structure",this.props.flatMap(X).reduce((Z,Q)=>{let G=this.propsByKey[Q.key];if(M0(Q)){if(Q.kind!=="required"&&Q.kind!=="optional")return I(`Map result must have kind "required" or "optional" (was ${Q.kind})`);return Z[Q.kind]=G0(Z[Q.kind],Q),Z}let J=Q.kind??G?.kind??"required",Y=s(Q,($,z)=>($ in O8.implementation.keys)?[$,z]:[]);return Z[J]=G0(Z[J],this.$.node(J,Y)),Z},{}))}assertHasKeys(X){let Z=X.filter((Q)=>!K8(Q,this.keyof()));if(Z.length)return I(WL(this.expression,Z))}get(X,...Z){let Q,G=!1,J=NR(X);if((typeof J==="string"||typeof J==="symbol")&&this.propsByKey[J])Q=this.propsByKey[J].value,G=this.propsByKey[J].required;if(this.index){for(let $ of this.index)if(K8(J,$.signature))Q=Q?.and($.value)??$.value}if(this.sequence&&K8(J,f.intrinsic.nonNegativeIntegerString))if(l(J,"root")){if(this.sequence.variadic)Q=Q?.and(this.sequence.element)??this.sequence.element}else{let $=Number.parseInt(J);if($<this.sequence.prevariadic.length){let z=this.sequence.prevariadic[$].node;Q=Q?.and(z)??z,G||=$<this.sequence.prefixLength}else if(this.sequence.variadic){let z=this.$.node("union",this.sequence.variadicOrPostfix);Q=Q?.and(z)??z}}if(!Q){if(this.sequence?.variadic&&l(J,"root")&&J.extends(f.intrinsic.number))return I(TR(J.expression,this.sequence.expression));return I(WL(this.expression,[J]))}let Y=Q.get(...Z);return G?Y:Y.or(f.intrinsic.undefined)}pick(...X){return this.assertHasKeys(X),this.$.node("structure",this.filterKeys("pick",X))}omit(...X){return this.assertHasKeys(X),this.$.node("structure",this.filterKeys("omit",X))}optionalize(){let{required:X,...Z}=this.inner;return this.$.node("structure",{...Z,optional:this.props.map((Q)=>Q.hasKind("required")?this.$.node("optional",Q.inner):Q)})}require(){let{optional:X,...Z}=this.inner;return this.$.node("structure",{...Z,required:this.props.map((Q)=>Q.hasKind("optional")?{key:Q.key,value:Q.value}:Q)})}merge(X){let Z=this.filterKeys("omit",[X.keyof()]);if(X.required)Z.required=G0(Z.required,X.required);if(X.optional)Z.optional=G0(Z.optional,X.optional);if(X.index)Z.index=G0(Z.index,X.index);if(X.sequence)Z.sequence=X.sequence;if(X.undeclared)Z.undeclared=X.undeclared;else delete Z.undeclared;return this.$.node("structure",Z)}filterKeys(X,Z){let Q=BQ(this.inner),G=(J)=>{let Y=Z.some(($)=>K8(J,$));return X==="pick"?Y:!Y};if(Q.required)Q.required=Q.required.filter((J)=>G(J.key));if(Q.optional)Q.optional=Q.optional.filter((J)=>G(J.key));if(Q.index)Q.index=Q.index.filter((J)=>G(J.signature));return Q}traverseAllows=(X,Z)=>this._traverse("Allows",X,Z);traverseApply=(X,Z)=>this._traverse("Apply",X,Z);_traverse=(X,Z,Q)=>{let G=Q?.currentErrorCount??0;for(let J=0;J<this.props.length;J++)if(X==="Allows"){if(!this.props[J].traverseAllows(Z,Q))return!1}else if(this.props[J].traverseApply(Z,Q),Q.failFast&&Q.currentErrorCount>G)return!1;if(this.sequence){if(X==="Allows"){if(!this.sequence.traverseAllows(Z,Q))return!1}else if(this.sequence.traverseApply(Z,Q),Q.failFast&&Q.currentErrorCount>G)return!1}if(this.index||this.undeclared==="reject"){let J=Object.keys(Z);J.push(...Object.getOwnPropertySymbols(Z));for(let Y=0;Y<J.length;Y++){let $=J[Y];if(this.index){for(let z of this.index)if(z.signature.traverseAllows($,Q)){if(X==="Allows"){if(!YX($,()=>z.value.traverseAllows(Z[$],Q),Q))return!1}else if(YX($,()=>z.value.traverseApply(Z[$],Q),Q),Q.failFast&&Q.currentErrorCount>G)return!1}}if(this.undeclared==="reject"&&!this.declaresKey($)){if(X==="Allows")return!1;if(Q.errorFromNodeContext({code:"predicate",expected:"removed",actual:"",relativePath:[$],meta:this.meta}),Q.failFast)return!1}}}if(this.structuralMorph&&Q&&!Q.hasError())Q.queueMorphs([this.structuralMorph]);return!0};get defaultable(){return this.cacheGetter("defaultable",this.optional?.filter((X)=>X.hasDefault())??[])}declaresKey=(X)=>(X in this.propsByKey)||this.index?.some((Z)=>Z.signature.allows(X))||this.sequence!==void 0&&f.intrinsic.nonNegativeIntegerString.allows(X);_compileDeclaresKey(X){let Z=[];if(this.props.length)Z.push(`k in ${this.propsByKeyReference}`);if(this.index)for(let Q of this.index)Z.push(X.invoke(Q.signature,{kind:"Allows",arg:"k"}));if(this.sequence)Z.push("$ark.intrinsic.nonNegativeIntegerString.allows(k)");return Z.join(" || ")||"false"}get structuralMorph(){return this.cacheGetter("structuralMorph",KR(this))}structuralMorphRef=this.structuralMorph&&_0(this.structuralMorph);compile(X){if(X.traversalKind==="Apply")X.initializeErrorCount();for(let Z of this.props)if(X.check(Z),X.traversalKind==="Apply")X.returnIfFailFast();if(this.sequence){if(X.check(this.sequence),X.traversalKind==="Apply")X.returnIfFailFast()}if(this.index||this.undeclared==="reject")X.const("keys","Object.keys(data)"),X.line("keys.push(...Object.getOwnPropertySymbols(data))"),X.for("i < keys.length",()=>this.compileExhaustiveEntry(X));if(X.traversalKind==="Allows")return X.return(!0);if(this.structuralMorphRef)X.if("ctx && !ctx.hasError()",()=>{return X.line("ctx.queueMorphs(["),MR(X,this),X.line("])")})}compileExhaustiveEntry(X){if(X.const("k","keys[i]"),this.index)for(let Z of this.index)X.if(`${X.invoke(Z.signature,{arg:"k",kind:"Allows"})}`,()=>X.traverseKey("k","data[k]",Z.value));if(this.undeclared==="reject")X.if(`!(${this._compileDeclaresKey(X)})`,()=>{if(X.traversalKind==="Allows")return X.return(!1);return X.line(`ctx.errorFromNodeContext({ code: "predicate", expected: "removed", actual: "", relativePath: [k], meta: ${this.compiledMeta} })`).if("ctx.failFast",()=>X.return())});return X}reduceJsonSchema(X,Z){switch(X.type){case"object":return this.reduceObjectJsonSchema(X,Z);case"array":let Q=this.sequence?.reduceJsonSchema(X,Z)??X;if(this.props.length||this.index)return Z.fallback.arrayObject({code:"arrayObject",base:Q,object:this.reduceObjectJsonSchema({type:"object"},Z)});return Q;default:return q0.throwInternalOperandError("structure",X)}}reduceObjectJsonSchema(X,Z){if(this.props.length){X.properties={};for(let Q of this.props){let G=Q.value.toJsonSchemaRecurse(Z);if(typeof Q.key==="symbol"){Z.fallback.symbolKey({code:"symbolKey",base:X,key:Q.key,value:G,optional:Q.optional});continue}if(Q.hasDefault()){let J=typeof Q.default==="function"?Q.default():Q.default;G.default=f.intrinsic.jsonData.allows(J)?J:Z.fallback.defaultValue({code:"defaultValue",base:G,value:J})}X.properties[Q.key]=G}if(this.requiredKeys.length&&X.properties)X.required=this.requiredKeys.filter((Q)=>typeof Q==="string"&&(Q in X.properties))}if(this.index)for(let Q of this.index){let G=Q.value.toJsonSchemaRecurse(Z);if(Q.signature.equals(f.intrinsic.string)){X.additionalProperties=G;continue}for(let J of Q.signature.branches){if(!J.extends(f.intrinsic.string)){X=Z.fallback.symbolKey({code:"symbolKey",base:X,key:null,value:G,optional:!1});continue}let Y={type:"string"};if(J.hasKind("morph"))Y=Z.fallback.morph({code:"morph",base:J.rawIn.toJsonSchemaRecurse(Z),out:J.rawOut.toJsonSchemaRecurse(Z)});if(!J.hasKind("intersection"))return H0(`Unexpected index branch kind ${J.kind}.`);let{pattern:$}=J.inner;if($){let z=Object.assign(Y,{pattern:$[0].rule});for(let H=1;H<$.length;H++)Y=Z.fallback.patternIntersection({code:"patternIntersection",base:z,pattern:$[H].rule});X.patternProperties??={},X.patternProperties[z.pattern]=G}}}if(this.undeclared&&!X.additionalProperties)X.additionalProperties=!1;return X}}var YY={},wR=(X)=>{let Z="";for(let Q=0;Q<X.defaultable.length;Q++)Z+=X.defaultable[Q].defaultValueMorphRef;if(X.sequence?.defaultValueMorphsReference)Z+=X.sequence?.defaultValueMorphsReference;if(X.undeclared==="delete"){if(Z+="delete !(",X.required)for(let Q of X.required)Z+=Q.compiledKey+" | ";if(X.optional)for(let Q of X.optional)Z+=Q.compiledKey+" | ";if(X.index)for(let Q of X.index)Z+=Q.signature.id+" | ";if(X.sequence)if(X.sequence.maxLength===null)Z+=i.nonNegativeIntegerString.id;else for(let Q=0;Q<X.sequence.tuple.length;Q++)Z+=Q+" | ";Z+=")"}return Z},KR=(X)=>{let Z=wR(X);if(!Z)return;if(YY[Z])return YY[Z];let Q=(G,J)=>{for(let Y=0;Y<X.defaultable.length;Y++)if(!(X.defaultable[Y].key in G))X.defaultable[Y].defaultValueMorph(G,J);if(X.sequence?.defaultables)for(let Y=G.length-X.sequence.prefixLength;Y<X.sequence.defaultables.length;Y++)X.sequence.defaultValueMorphs[Y](G,J);if(X.undeclared==="delete"){for(let Y in G)if(!X.declaresKey(Y))delete G[Y]}return G};return YY[Z]=Q},MR=(X,Z)=>{let G=`(data${Z.defaultable.some((J)=>J.defaultValueMorph.length===2)||Z.sequence?.defaultValueMorphs.some((J)=>J.length===2)?", ctx":""})`;return X.block(`${G} => `,(J)=>{for(let Y=0;Y<Z.defaultable.length;Y++){let{serializedKey:$,defaultValueMorphRef:z}=Z.defaultable[Y];J.if(`!(${$} in data)`,(H)=>H.line(`${z}${G}`))}if(Z.sequence?.defaultables)J.for(`i < ${Z.sequence.defaultables.length}`,(Y)=>Y.set("data[i]",5),`data.length - ${Z.sequence.prefixLength}`);if(Z.undeclared==="delete")J.forIn("data",(Y)=>Y.if(`!(${Z._compileDeclaresKey(Y)})`,($)=>$.line("delete data[k]")));return J.return("data")})},$Y={implementation:OR,Node:LL},NR=(X)=>{if(l(X,"root")&&X.hasKind("unit"))X=X.unit;if(typeof X==="number")X=`${X}`;return X},TR=(X,Z)=>`${X} is not allowed as an array index on ${Z}. Use the 'nonNegativeIntegerString' keyword instead.`,EQ=(X,Z,Q)=>{let[G,J]=CB(X.branches,($)=>$.hasKind("unit"));if(!G.length)return{index:Q.node("index",{signature:X,value:Z})};let Y={};for(let $ of G){let z=Q.node("required",{key:$.unit,value:Z});Y[z.kind]=G0(Y[z.kind],z)}if(J.length)Y.index=Q.node("index",{signature:J,value:Z});return Y},qR=(X)=>l(X,"root")?X.expression:r(X),WL=(X,Z)=>`Key${Z.length===1?"":"s"} ${Z.map(qR).join(", ")} ${Z.length===1?"does":"do"} not exist on ${X}`,VL=(X)=>`Duplicate key ${kX(X)}`;var s9={...y2,alias:M8.implementation,domain:qQ.implementation,unit:XY.implementation,proto:N8.implementation,union:e7.implementation,morph:a7.implementation,intersection:r7.implementation,divisor:x7.implementation,pattern:l7.implementation,predicate:k7.implementation,required:QY.implementation,optional:O8.implementation,index:ZY.implementation,sequence:GY.implementation,structure:$Y.implementation};f.defaultConfig=hB(Object.assign(s(s9,(X,Z)=>[X,Z.defaults]),{jitless:lB(),clone:mB,onUndeclaredKey:"ignore",exactOptionalPropertyTypes:!0,numberAllowsNaN:!1,dateAllowsInvalid:!1,onFail:null,keywords:{},toJsonSchema:q0.defaultConfig}));f.resolvedConfig=U8(f.defaultConfig,f.config);var g2={...f2,alias:M8.Node,domain:qQ.Node,unit:XY.Node,proto:N8.Node,union:e7.Node,morph:a7.Node,intersection:r7.Node,divisor:x7.Node,pattern:l7.Node,predicate:k7.Node,required:QY.Node,optional:O8.Node,index:ZY.Node,sequence:GY.Node,structure:$Y.Node};class t9 extends O7{get[r0](){return"module"}}var zY=(X,Z)=>new t9(s(X,(Q,G)=>[Q,l(G,"module")?zY(G,Z):Z.bindReference(G)]));var ER=(X)=>O0(X)?X:("branches"in X)&&O0(X.branches)?X.branches:void 0,PR=(X,Z)=>I(`Node of kind ${Z} is not valid as a ${X} definition`),AL=(X)=>`#${X} duplicates public alias ${X}`,HY={};f.ambient??={};var FL,wL="function $",jR=(X)=>KL(X,ML(X)),KL=(X,Z)=>{let Q=Z.write(wL,4),G=Z.compile()();for(let J of X){if(J.precompilation)continue;if(J.traverseAllows=G[`${J.id}Allows`].bind(G),J.isRoot()&&!J.allowsRequiresContext)J.allows=J.traverseAllows;if(J.traverseApply=G[`${J.id}Apply`].bind(G),G[`${J.id}Optimistic`])J.traverseOptimistic=G[`${J.id}Optimistic`].bind(G);J.precompilation=Q}},ML=(X)=>new VQ().return(X.reduce((Z,Q)=>{let G=new H8({kind:"Allows"}).indent();Q.compile(G);let J=G.write(`${Q.id}Allows`),Y=new H8({kind:"Apply"}).indent();Q.compile(Y);let $=Y.write(`${Q.id}Apply`),z=`${Z}${J},
${$},
`;if(!Q.hasKind("union"))return z;let H=new H8({kind:"Allows",optimistic:!0}).indent();Q.compile(H);let U=H.write(`${Q.id}Optimistic`);return`${z}${U},
`},`{
`)+"}");class PQ{config;resolvedConfig;name;get[r0](){return"scope"}referencesById={};references=[];resolutions={};exportedNames=[];aliases={};resolved=!1;nodesByHash={};intrinsic;constructor(X,Z){if(this.config=U8(f.config,Z),this.resolvedConfig=U8(f.resolvedConfig,Z),this.name=this.resolvedConfig.name??`anonymousScope${Object.keys(HY).length}`,this.name in HY)I(`A Scope already named ${this.name} already exists`);HY[this.name]=this;let Q=Object.entries(X).map((G)=>this.preparseOwnAliasEntry(...G));for(let[G,J]of Q){let Y=G;if(G[0]==="#"){if(Y=G.slice(1),Y in this.aliases)I(AL(Y));this.aliases[Y]=J}else{if(Y in this.aliases)I(AL(G));this.aliases[Y]=J,this.exportedNames.push(Y)}if(!l(J,"module")&&!l(J,"generic")&&!_6(J)){let $=this.preparseOwnDefinitionFormat(J,{alias:Y});this.resolutions[Y]=l($,"root")?this.bindReference($):this.createParseContext($).id}}FL??=this.node("union",{branches:["string","number","object","bigint","symbol",{unit:!0},{unit:!1},{unit:void 0},{unit:null}]},{prereduced:!0}),this.nodesByHash[FL.hash]=this.node("intersection",{},{prereduced:!0}),this.intrinsic=f.intrinsic?s(f.intrinsic,(G,J)=>G.startsWith("json")?[]:[G,this.bindReference(J)]):{}}cacheGetter(X,Z){return Object.defineProperty(this,X,{value:Z}),Z}get internal(){return this}_json;get json(){if(!this._json)this.export();return this._json}defineSchema(X){return X}generic=(...X)=>{let Z=this;return(Q,G)=>new y6(X,G?new OQ(Q):Q,Z,Z,G??null)};units=(X,Z)=>{let Q=[];for(let J of X)if(!Q.includes(J))Q.push(J);let G=Q.map((J)=>this.node("unit",{unit:J},Z));return this.node("union",G,{...Z,prereduced:!0})};lazyResolutions=[];lazilyResolve(X,Z){let Q=this.node("alias",{reference:Z??"synthetic",resolve:X},{prereduced:!0});if(!this.resolved)this.lazyResolutions.push(Q);return Q}schema=(X,Z)=>this.finalize(this.parseSchema(X,Z));parseSchema=(X,Z)=>this.node(L8(X),X,Z);preparseNode(X,Z,Q){let G=typeof X==="string"?X:L8(Z,X);if(M0(Z)&&Z.kind===G)return Z;if(G==="alias"&&!Q?.prereduced){let{reference:$}=M8.implementation.normalize(Z,this);if($.startsWith("$")){let z=this.resolveRoot($.slice(1));Z=z,G=z.kind}}else if(G==="union"&&XX(Z,"object")){let $=ER(Z);if($?.length===1)Z=$[0],G=L8(Z)}if(M0(Z)&&Z.kind===G)return Z;let Y=s9[G].normalize?.(Z,this)??Z;if(M0(Y))return Y.kind===G?Y:PR(G,Y.kind);return{...Q,$:this,kind:G,def:Y,prefix:Q.alias??G}}bindReference(X){let Z;if(M0(X))Z=X.$===this?X:new X.constructor(X.attachments,this);else Z=X.$===this?X:new y6(X.params,X.bodyDef,X.$,this,X.hkt);if(!this.resolved)Object.assign(this.referencesById,Z.referencesById);return Z}resolveRoot(X){return this.maybeResolveRoot(X)??I(VY(X))}maybeResolveRoot(X){let Z=this.maybeResolve(X);if(l(Z,"generic"))return;return Z}maybeResolveSubalias(X){return UY(this.aliases,X)??UY(this.ambient,X)}get ambient(){return f.ambient}maybeResolve(X){let Z=this.resolutions[X];if(Z){if(typeof Z!=="string")return this.bindReference(Z);let G=a0[Z];if(l(G,"root"))return this.resolutions[X]=G;if(l(G,"context")){if(G.phase==="resolving")return this.node("alias",{reference:`$${X}`},{prereduced:!0});if(G.phase==="resolved")return H0(`Unexpected resolved context for was uncached by its scope: ${r(G)}`);G.phase="resolving";let J=this.bindReference(this.parseOwnDefinitionFormat(G.def,G));return G.phase="resolved",a0[J.id]=J,a0[G.id]=J,this.resolutions[X]=J}return H0(`Unexpected nodesById entry for ${Z}: ${r(G)}`)}let Q=this.aliases[X]??this.ambient?.[X];if(!Q)return this.maybeResolveSubalias(X);if(Q=this.normalizeRootScopeValue(Q),l(Q,"generic"))return this.resolutions[X]=this.bindReference(Q);if(l(Q,"module")){if(!Q.root)I(qL(X));return this.resolutions[X]=this.bindReference(Q.root)}return this.resolutions[X]=this.parse(Q,{alias:X})}createParseContext(X){let Z=X.id??c7(X.prefix);return a0[Z]=Object.assign(X,{[r0]:"context",$:this,id:Z,phase:"unresolved"})}traversal(X){return new xX(X,this.resolvedConfig)}import(...X){return new t9(s(this.export(...X),(Z,Q)=>[`#${Z}`,Q]))}precompilation;_exportedResolutions;_exports;export(...X){if(!this._exports){this._exports={};for(let Q of this.exportedNames){let G=this.aliases[Q];this._exports[Q]=l(G,"module")?zY(G,this):OL(this.maybeResolve(Q))}for(let Q of this.lazyResolutions)Q.resolution;if(this._exportedResolutions=TL(this,this._exports),this._json=NL(this._exportedResolutions),Object.assign(this.resolutions,this._exportedResolutions),this.references=Object.values(this.referencesById),!this.resolvedConfig.jitless){let Q=ML(this.references);this.precompilation=Q.write(wL,4),KL(this.references,Q)}this.resolved=!0}let Z=X.length?X:this.exportedNames;return new t9(s(Z,(Q,G)=>[G,this._exports[G]]))}resolve(X){return this.export()[X]}node=(X,Z,Q={})=>{let G=this.preparseNode(X,Z,Q);if(M0(G))return this.bindReference(G);let J=this.createParseContext(G),Y=i7(J),$=this.bindReference(Y);return a0[J.id]=$};parse=(X,Z={})=>this.finalize(this.parseDefinition(X,Z));parseDefinition(X,Z={}){if(l(X,"root"))return this.bindReference(X);let Q=this.preparseOwnDefinitionFormat(X,Z);if(l(Q,"root"))return this.bindReference(Q);let G=this.createParseContext(Q);a0[G.id]=G;let J=this.bindReference(this.parseOwnDefinitionFormat(X,G));if(J.isCyclic)J=h2(J,G.id);return a0[G.id]=J,J}finalize(X){if(OL(X),!X.precompilation&&!this.resolvedConfig.jitless)jR(X.references);return X}}class WY extends PQ{parseOwnDefinitionFormat(X,Z){return i7(Z)}preparseOwnDefinitionFormat(X,Z){return this.preparseNode(L8(X),X,Z)}preparseOwnAliasEntry(X,Z){return[X,Z]}normalizeRootScopeValue(X){return X}}var OL=(X)=>{let Z=X.references.filter((Q)=>Q.hasKind("alias"));for(let Q of Z){Object.assign(Q.referencesById,Q.resolution.referencesById);for(let G of X.references)if(Q.id in G.referencesById)Object.assign(G.referencesById,Q.referencesById)}return X},NL=(X)=>s(X,(Z,Q)=>[Z,l(Q,"root")||l(Q,"generic")?Q.json:l(Q,"module")?NL(Q):H0(`Unexpected resolution ${r(Q)}`)]),UY=(X,Z)=>{let Q=Z.indexOf(".");if(Q===-1)return;let G=Z.slice(0,Q),J=X[G];if(J===void 0)return;if(!l(J,"module"))return I(DR(G));let Y=Z.slice(Q+1),$=J[Y];if($===void 0)return UY(J,Y);if(l($,"root")||l($,"generic"))return $;if(l($,"module"))return $.root??I(qL(Z));H0(`Unexpected resolution for alias '${Z}': ${r($)}`)},jQ=(X,Z)=>new WY(X,Z),q8=new WY({});var TL=(X,Z)=>{let Q={};for(let G in Z){let J=Z[G];if(l(J,"module")){let Y=TL(X,J),$=s(Y,(z,H)=>[`${G}.${z}`,H]);Object.assign(Q,$)}else if(l(J,"root")||l(J,"generic"))Q[G]=J;else H0(`Unexpected scope resolution ${r(J)}`)}return Q},VY=(X)=>`'${X}' is unresolvable`,DR=(X)=>`'${X}' must reference a module to be accessed using dot syntax`,qL=(X)=>`Reference to submodule '${X}' must specify an alias`;q8.export();var{schema:W0,node:e9,defineSchema:ni,generic:PX}=q8;var BY="^(?:0|[1-9]\\d*)$",IR=new RegExp(BY),ai=_0(IR);var EL=jQ({bigint:"bigint",boolean:[{unit:!1},{unit:!0}],false:{unit:!1},never:[],null:{unit:null},number:"number",object:"object",string:"string",symbol:"symbol",true:{unit:!0},unknown:{},undefined:{unit:void 0},Array,Date},{prereducedAliases:!0}).export();f.intrinsic={...EL};var PL=jQ({integer:{domain:"number",divisor:1},lengthBoundable:["string",Array],key:["string","symbol"],nonNegativeIntegerString:{domain:"string",pattern:BY}},{prereducedAliases:!0}).export();Object.assign(f.intrinsic,PL);var _R=jQ({jsonPrimitive:["string","number",{unit:!0},{unit:!1},{unit:null}],jsonObject:{domain:"object",index:{signature:"string",value:"$jsonData"}},jsonData:["$jsonPrimitive","$jsonObject"]},{prereducedAliases:!0}).export(),i={...EL,...PL,..._R,emptyStructure:e9("structure",{},{prereduced:!0})};f.intrinsic={...i};var DQ=(X,Z)=>new RegExp(X,Z);Object.assign(DQ,{as:DQ});var DL=(X)=>typeof X==="string"&&X[0]==="d"&&(X[1]==="'"||X[1]==='"')&&X[X.length-1]===X[1],jL=(X)=>X.toString()!=="Invalid Date",IL=(X)=>X.slice(2,-1),LY=(X)=>`'${X}' could not be parsed by the Date constructor`,_L=(X,Z)=>CR(X,Z),CR=(X,Z)=>{let Q=new Date(X);if(jL(Q))return Q;let G=X2(X);if(G!==void 0){let J=new Date(G);if(jL(J))return J}return Z?I(Z===!0?LY(X):Z):void 0};var SR=W0({proto:"Array",sequence:"string",required:{key:"groups",value:["object",{unit:void 0}]}}),IQ=(X,Z)=>{let Q=X.scanner.shiftUntilEscapable(RR[bL[Z]]);if(X.scanner.lookahead==="")return X.error(fR(Q,Z));if(X.scanner.shift(),Z in SL){let G;try{G=new RegExp(Q)}catch(J){I(String(J))}if(X.root=X.ctx.$.node("intersection",{domain:"string",pattern:Q},{prereduced:!0}),Z==="x/")X.root=X.ctx.$.node("morph",{in:X.root,morphs:(J)=>G.exec(J),declaredOut:SR})}else if(v0(Z,AY))X.root=X.ctx.$.node("unit",{unit:Q});else{let G=_L(Q,LY(Q));X.root=X.ctx.$.node("unit",{meta:Q,unit:G})}},AY={"'":1,'"':1},CL={"/":1,"'":1,'"':1},bR={"d'":"'",'d"':'"',"'":"'",'"':'"'},SL={"/":"/","x/":"/"},bL={...bR,...SL},RR={"'":(X)=>X.lookahead==="'",'"':(X)=>X.lookahead==='"',"/":(X)=>X.lookahead==="/"},yR={'"':"double-quote","'":"single-quote","/":"forward slash"},fR=(X,Z)=>`${Z}${X} requires a closing ${yR[bL[Z]]}`;var RL=(X)=>`Private type references should not include '#'. Use '${X}' instead.`,_Q="Optional definitions like 'string?' are only valid as properties in an object or tuple",CQ="Defaultable definitions like 'number = 0' are only valid as properties in an object or tuple";var oX={"<":1,">":1,"=":1,"|":1,"&":1,")":1,"[":1,"%":1,",":1,":":1,"?":1,"#":1,...C6};var yL=(X,Z)=>X===">"?Z[0]==="="?Z[1]==="=":Z.trimStart()===""||v0(Z.trimStart()[0],oX):X==="="?Z[0]!=="=":X===","||X==="?";var fL=(X,Z,Q)=>kL(X,Z,Q,[]),kL=(X,Z,Q,G)=>{let J=Q.parseUntilFinalizer();if(G.push(J.root),J.finalizer===">"){if(G.length!==Z.params.length)return Q.error(FY(X,Z.names,G.map((Y)=>Y.expression)));return G}if(J.finalizer===",")return kL(X,Z,Q,G);return J.error(WQ(">"))},FY=(X,Z,Q)=>`${X}<${Z.join(", ")}> requires exactly ${Z.length} args (got ${Q.length}${Q.length===0?"":`: ${Q.join(", ")}`})`;var SQ=(X)=>{let Z=X.scanner.shiftUntilLookahead(oX);if(Z==="keyof")X.addPrefix("keyof");else X.root=xR(X,Z)},kR=(X,Z,Q)=>{if(Q.scanner.shiftUntilNonWhitespace(),Q.scanner.shift()!=="<")return Q.error(FY(X,Z.names,[]));let J=fL(X,Z,Q);return Z(...J)},xR=(X,Z)=>vR(X,Z)??hR(X,Z)??X.error(Z===""?X.scanner.lookahead==="#"?RL(X.shiftedBy(1).scanner.shiftUntilLookahead(oX)):OY(X):VY(Z)),vR=(X,Z)=>{if(X.ctx.args?.[Z]){let G=X.ctx.args[Z];if(typeof G!=="string")return G;return X.ctx.$.node("alias",{reference:G},{prereduced:!0})}let Q=X.ctx.$.maybeResolve(Z);if(l(Q,"root"))return Q;if(Q===void 0)return;if(l(Q,"generic"))return kR(Z,Q,X);return I(`Unexpected resolution ${r(Q)}`)},hR=(X,Z)=>{let Q=Z2(Z);if(Q!==void 0)return X.ctx.$.node("unit",{unit:Q});let G=G2(Z);if(G!==void 0)return X.ctx.$.node("unit",{unit:G})},OY=(X)=>{let Z=X.previousOperator();return Z?wY(Z,X.scanner.unscanned):gR(X.scanner.unscanned)},wY=(X,Z="")=>`Token '${X}' requires a right operand${Z?` before '${Z}'`:""}`,gR=(X)=>`Expected an expression${X?` before '${X}'`:""}`;var KY=(X)=>X.scanner.lookahead===""?X.error(OY(X)):X.scanner.lookahead==="("?X.shiftedBy(1).reduceGroupOpen():X.scanner.lookaheadIsIn(CL)?IQ(X,X.scanner.shift()):X.scanner.lookaheadIsIn(C6)?KY(X.shiftedBy(1)):X.scanner.lookahead==="d"?X.scanner.nextLookahead in AY?IQ(X,`${X.scanner.shift()}${X.scanner.shift()}`):SQ(X):X.scanner.lookahead==="x"?X.scanner.nextLookahead==="/"?X.shiftedBy(2)&&IQ(X,"x/"):SQ(X):SQ(X);var xL={">":!0,">=":!0},vL={"<":!0,"<=":!0};var XZ={"<":">",">":"<","<=":">=",">=":"<=","==":"=="},hL=(X,Z)=>`Left bounds are only valid when paired with right bounds (try ...${Z}${X})`,bQ=(X)=>`Left-bounded expressions must specify their limits using < or <= (was ${X})`,gL=(X,Z,Q,G)=>`An expression may have at most one left bound (parsed ${X}${XZ[Z]}, ${Q}${XZ[G]})`;var mL=(X,Z)=>{let Q=uR(X,Z);if(X.root.hasKind("unit")){if(typeof X.root.unit==="number"){X.reduceLeftBound(X.root.unit,Q),X.unsetRoot();return}if(X.root.unit instanceof Date){let G=`d'${X.root.description??X.root.unit.toISOString()}'`;X.unsetRoot(),X.reduceLeftBound(G,Q);return}}return pR(X,Q)},pL={"<":1,">":1,"=":1},uR=(X,Z)=>X.scanner.lookaheadIs("=")?`${Z}${X.scanner.shift()}`:Z;var uL=(X,Z,Q,G)=>{if(Q.extends(f.intrinsic.number)){if(typeof Z!=="number")return I(MY(X,Z,G));return X==="=="?["min","max"]:X[0]===">"?["min"]:["max"]}if(Q.extends(f.intrinsic.lengthBoundable)){if(typeof Z!=="number")return I(MY(X,Z,G));return X==="=="?["exactLength"]:X[0]===">"?["minLength"]:["maxLength"]}if(Q.extends(f.intrinsic.Date))return X==="=="?["after","before"]:X[0]===">"?["after"]:["before"];return I(j2(Q.expression))},mR=(X)=>({rule:DL(X.limit)?IL(X.limit):X.limit,exclusive:X.comparator.length===1}),pR=(X,Z)=>{let Q=X.unsetRoot(),G=X.scanner.location;X.parseOperand();let J=X.unsetRoot(),Y=X.scanner.sliceChars(G,X.scanner.location);if(X.root=Q,!J.hasKind("unit")||typeof J.unit!=="number"&&!(J.unit instanceof Date))return X.error(MY(Z,Y,"right"));let $=J.unit,z=Z.length===1,H=uL(Z,typeof $==="number"?$:Y,Q,"right");for(let L of H)X.constrainRoot(L,Z==="=="?{rule:$}:{rule:$,exclusive:z});if(!X.branches.leftBound)return;if(!v0(Z,vL))return X.error(bQ(Z));let U=uL(X.branches.leftBound.comparator,X.branches.leftBound.limit,Q,"left");X.constrainRoot(U[0],mR(X.branches.leftBound)),X.branches.leftBound=null},MY=(X,Z,Q)=>`Comparator ${Q==="left"?XZ[X]:X} must be ${Q==="left"?"preceded":"followed"} by a corresponding literal (was ${Z})`;var dL=(X)=>{X.scanner.shiftUntilNonWhitespace();let Z=X.scanner.shiftUntilLookahead(oX);X.root=X.root.brand(Z)};var cL=(X)=>{X.scanner.shiftUntilNonWhitespace();let Z=X.scanner.shiftUntilLookahead(oX),Q=Q2(Z,{errorOnFail:lL(Z)});if(Q===0)X.error(lL(0));X.root=X.root.constrain("divisor",Q)},lL=(X)=>`% operator must be followed by a non-zero integer literal (was ${X})`;var NY=(X)=>{let Z=X.scanner.shift();return Z===""?X.finalize(""):Z==="["?X.scanner.shift()==="]"?X.setRoot(X.root.array()):X.error(dR):Z==="|"?X.scanner.lookahead===">"?X.shiftedBy(1).pushRootToBranch("|>"):X.pushRootToBranch(Z):Z==="&"?X.pushRootToBranch(Z):Z===")"?X.finalizeGroup():yL(Z,X.scanner.unscanned)?X.finalize(Z):v0(Z,pL)?mL(X,Z):Z==="%"?cL(X):Z==="#"?dL(X):(Z in C6)?NY(X):X.error(RQ(Z))},RQ=(X,Z="")=>`'${X}' is not allowed here${Z&&` (should be ${Z})`}`,dR="Missing expected ']'";var iL=(X)=>{let Z=X.unsetRoot();X.parseOperand();let Q=X.unsetRoot();if(!Q.hasKind("unit"))return X.error(lR(Q.expression));let G=Q.unit instanceof Date?()=>new Date(Q.unit):Q.unit;return[Z,"=",G]},lR=(X)=>`Default value '${X}' must be a literal value`;var TY=(X,Z)=>{let Q=Z.$.maybeResolveRoot(X);if(Q)return Q;if(X.endsWith("[]")){let Y=Z.$.maybeResolveRoot(X.slice(0,-2));if(Y)return Y.array()}let G=new ZZ(new z8(X),Z),J=cR(G);if(G.finalizer===">")I(RQ(">"));return J},cR=(X)=>{X.parseOperand();let Z=E8(X).root;if(!Z)return H0(`Root was unexpectedly unset after parsing string '${X.scanner.scanned}'`);if(X.finalizer==="=")Z=iL(X);else if(X.finalizer==="?")Z=[Z,"?"];if(X.scanner.shiftUntilNonWhitespace(),X.scanner.lookahead)I(RQ(X.scanner.lookahead));return Z},E8=(X)=>{while(X.finalizer===void 0)iR(X);return X},iR=(X)=>X.hasRoot()?X.parseOperator():X.parseOperand();class ZZ{root;branches={prefixes:[],leftBound:null,intersection:null,union:null,pipe:null};finalizer;groups=[];scanner;ctx;constructor(X,Z){this.scanner=X,this.ctx=Z}error(X){return I(X)}hasRoot(){return this.root!==void 0}setRoot(X){this.root=X}unsetRoot(){let X=this.root;return this.root=void 0,X}constrainRoot(...X){this.root=this.root.constrain(X[0],X[1])}finalize(X){if(this.groups.length)return this.error(WQ(")"));this.finalizeBranches(),this.finalizer=X}reduceLeftBound(X,Z){let Q=XZ[Z];if(!v0(Q,xL))return this.error(bQ(Z));if(this.branches.leftBound)return this.error(gL(this.branches.leftBound.limit,this.branches.leftBound.comparator,X,Q));this.branches.leftBound={comparator:Q,limit:X}}finalizeBranches(){if(this.assertRangeUnset(),this.branches.pipe){this.pushRootToBranch("|>"),this.root=this.branches.pipe;return}if(this.branches.union){this.pushRootToBranch("|"),this.root=this.branches.union;return}if(this.branches.intersection){this.pushRootToBranch("&"),this.root=this.branches.intersection;return}this.applyPrefixes()}finalizeGroup(){this.finalizeBranches();let X=this.groups.pop();if(!X)return this.error(z2(")",this.scanner.unscanned));this.branches=X}addPrefix(X){this.branches.prefixes.push(X)}applyPrefixes(){while(this.branches.prefixes.length){let X=this.branches.prefixes.pop();this.root=X==="keyof"?this.root.keyof():H0(`Unexpected prefix '${X}'`)}}pushRootToBranch(X){this.assertRangeUnset(),this.applyPrefixes();let Z=this.root;if(this.root=void 0,this.branches.intersection=this.branches.intersection?.rawAnd(Z)??Z,X==="&")return;if(this.branches.union=this.branches.union?.rawOr(this.branches.intersection)??this.branches.intersection,this.branches.intersection=null,X==="|")return;this.branches.pipe=this.branches.pipe?.rawPipeOnce(this.branches.union)??this.branches.union,this.branches.union=null}parseUntilFinalizer(){return E8(new ZZ(this.scanner,this.ctx))}parseOperator(){return NY(this)}parseOperand(){return KY(this)}assertRangeUnset(){if(this.branches.leftBound)return this.error(hL(this.branches.leftBound.limit,this.branches.leftBound.comparator))}reduceGroupOpen(){this.groups.push(this.branches),this.branches={prefixes:[],leftBound:null,union:null,intersection:null,pipe:null}}previousOperator(){return this.branches.leftBound?.comparator??this.branches.prefixes[this.branches.prefixes.length-1]??(this.branches.intersection?"&":this.branches.union?"|":this.branches.pipe?"|>":void 0)}shiftedBy(X){return this.scanner.jumpForward(X),this}}var oR="An empty string is not a valid generic parameter name",yQ=(X,Z,Q)=>{X.shiftUntilNonWhitespace();let G=X.shiftUntilLookahead(oX);if(G===""){if(X.lookahead===""&&Z.length)return Z;return I(oR)}return X.shiftUntilNonWhitespace(),nR(X,G,Z,Q)},oL="extends ",nR=(X,Z,Q,G)=>{if(X.shiftUntilNonWhitespace(),X.unscanned.startsWith(oL))X.jumpForward(oL.length);else{if(X.lookahead===",")X.shift();return Q.push(Z),yQ(X,Q,G)}let J=E8(new ZZ(X,G));return Q.push([Z,J.root]),yQ(X,Q,G)};class qY extends GX{constructor(X){let Z={$:X,raw:X.fn};super((...Q)=>{let G=Q.indexOf(":"),J=G===-1?Q.length-1:G-1,Y=Q.slice(0,J+1),$=X.parse(Y).assertHasKind("intersection"),z=X.intrinsic.unknown;if(G!==-1){if(G!==Q.length-2)return I(sR);z=X.parse(Q[G+1])}return(H)=>new nL(H,$,z)},{attach:Z})}}class nL extends GX{raw;params;returns;expression;constructor(X,Z,Q){let G=`typed ${X.name}`,J={[G]:(...$)=>{let z=Z.assert($),H=X(...z);return Q.assert(H)}}[G];super(J);this.raw=X,this.params=Z,this.returns=Q;let Y=Z.expression;if(Y[0]==="["&&Y[Y.length-1]==="]")Y=Y.slice(1,-1);else if(Y.endsWith("[]"))Y=`...${Y}`;this.expression=`(${Y}) => ${Q?.expression??"unknown"}`}}var sR=`":" must be followed by exactly one return type e.g:
fn("string", ":", "number")(s => s.length)`;class EY extends GX{$;constructor(X){super((...Z)=>new P8(X)(...Z),{bind:X});this.$=X}in(X){return new P8(this.$,X===void 0?void 0:this.$.parse(X))}at(X,Z){return new P8(this.$).at(X,Z)}case(X,Z){return new P8(this.$).case(X,Z)}}class P8 extends GX{$;in;key;branches=[];constructor(X,Z){super((Q)=>this.caseEntries(Object.entries(Q).map(([G,J])=>G==="default"?[G,J]:[this.$.parse(G),J])));this.$=X,this.in=Z}at(X,Z){if(this.key)I(aR);if(this.branches.length)I(rR);return this.key=X,Z?this.match(Z):this}case(X,Z){return this.caseEntry(this.$.parse(X),Z)}caseEntry(X,Z){let G=(this.key?this.$.parse({[this.key]:X}):X).pipe(Z);return this.branches.push(G),this}match(X){return this(X)}strings(X){return this.caseEntries(Object.entries(X).map(([Z,Q])=>Z==="default"?[Z,Q]:[this.$.node("unit",{unit:Z}),Q]))}caseEntries(X){for(let Z=0;Z<X.length;Z++){let[Q,G]=X[Z];if(Q==="default"){if(Z!==X.length-1)I("default may only be specified as the last key of a switch definition");return this.default(G)}if(typeof G!=="function")return I(`Value for case "${Q}" must be a function (was ${x0(G)})`);this.caseEntry(Q,G)}return this}default(X){if(typeof X==="function")this.case(i.unknown,X);let Z={branches:this.branches,ordered:!0};if(X==="never"||X==="assert")Z.meta={onFail:sL};let Q=this.$.node("union",Z);if(!this.in)return this.$.finalize(Q);let G=this.in.pipe(Q);if(X==="never"||X==="assert")G=G.configureReferences({onFail:sL},"self");return this.$.finalize(G)}}var sL=(X)=>X.throw(),rR="A key matcher must be specified before the first case i.e. match.at('foo') or match.in<object>().at('bar')",aR="At most one key matcher may be specified per expression";var fQ=(X,Z)=>{if(O0(X)){if(X[1]==="=")return[Z.$.parseOwnDefinitionFormat(X[0],Z),"=",X[2]];if(X[1]==="?")return[Z.$.parseOwnDefinitionFormat(X[0],Z),"?"]}return kQ(X,Z)},rL="Only required keys may make their values optional, e.g. { [mySymbol]: ['number', '?'] }",aL="Only required keys may specify default values, e.g. { value: 'number = 0' }";var tL=(X,Z)=>{let Q,G={},J=r6(X);for(let[$,z]of J){let H=Xy($);if(H.kind==="spread"){if(!cX(G))return I(eR);let j=Z.$.parseOwnDefinitionFormat(z,Z);if(j.equals(i.object))continue;if(!j.hasKind("intersection")||!j.basis?.equals(i.object))return I(Zy(j.expression));Q=j.structure;continue}if(H.kind==="undeclared"){if(z!=="reject"&&z!=="delete"&&z!=="ignore")I(tR(z));G.undeclared=z;continue}let U=fQ(z,Z),L=H;if(H.kind==="required"){if(!O0(U))PY(G,"required",{key:H.normalized,value:U},Z);else PY(G,"optional",U[1]==="="?{key:H.normalized,value:U[0],default:U[2]}:{key:H.normalized,value:U[0]},Z);continue}if(O0(U)){if(U[1]==="?")I(rL);if(U[1]==="=")I(aL)}if(H.kind==="optional"){PY(G,"optional",{key:H.normalized,value:U},Z);continue}let A=Z.$.parseOwnDefinitionFormat(L.normalized,Z),F=EQ(A,U,Z.$);if(F.index)G.index=G0(G.index,F.index);if(F.required)G.required=G0(G.required,F.required)}let Y=Z.$.node("structure",G);return Z.$.parseSchema({domain:"object",structure:Q?.merge(Y)??Y})},PY=(X,Z,Q,G)=>{X[Z]=G0(X[Z],G.$.node(Z,Q))},tR=(X)=>`Value of '+' key must be 'reject', 'delete', or 'ignore' (was ${r(X)})`,eR="Spread operator may only be used as the first key in an object",Xy=(X)=>typeof X==="symbol"?{kind:"required",normalized:X}:X[X.length-1]==="?"?X[X.length-2]===t6?{kind:"required",normalized:`${X.slice(0,-2)}?`}:{kind:"optional",normalized:X.slice(0,-1)}:X[0]==="["&&X[X.length-1]==="]"?{kind:"index",normalized:X.slice(1,-1)}:X[0]===t6&&X[1]==="["&&X[X.length-1]==="]"?{kind:"required",normalized:X.slice(1)}:X==="..."?{kind:"spread"}:X==="+"?{kind:"undeclared"}:{kind:"required",normalized:X==="\\..."?"...":X==="\\+"?"+":X},Zy=(X)=>`Spread operand must resolve to an object literal type (was ${X})`;var XA=(X,Z)=>Vy(X)?JA[X[0]](X,Z):Uy(X)?GA[X[1]](X,Z):null,Qy=(X,Z)=>Z.$.parseOwnDefinitionFormat(X[1],Z).keyof(),jY=(X,Z)=>{if(X[2]===void 0)return I(wY(X[1],""));let Q=Z.$.parseOwnDefinitionFormat(X[0],Z),G=Z.$.parseOwnDefinitionFormat(X[2],Z);if(X[1]==="|")return Z.$.node("union",{branches:[Q,G]});let J=X[1]==="&"?$X(Q,G,Z.$):B8(Q,G,Z.$);if(J instanceof h)return J.throw();return J},Gy=(X,Z)=>Z.$.parseOwnDefinitionFormat(X[0],Z).array(),Jy=(X,Z)=>{if(typeof X[2]!=="function")return I(ZA("=>",X[2]));return Z.$.parseOwnDefinitionFormat(X[0],Z).pipe(X[2])},ZA=(X,Z)=>`${X===":"?"Narrow":"Morph"} expression requires a function following '${X}' (was ${typeof Z})`,Yy=(X,Z)=>{if(typeof X[2]!=="function")return I(ZA(":",X[2]));return Z.$.parseOwnDefinitionFormat(X[0],Z).constrain("predicate",X[2])},$y=(X,Z)=>Z.$.parseOwnDefinitionFormat(X[0],Z).configure(X[2],X[3]),QA=(X)=>X,zy=QA({"[]":Gy,"?":()=>I(_Q)}),Hy=QA({"|":jY,"&":jY,":":Yy,"=>":Jy,"|>":jY,"@":$y,"=":()=>I(CQ)}),GA={...zy,...Hy},Uy=(X)=>GA[X[1]]!==void 0,Wy=(X)=>X,JA=Wy({keyof:Qy,instanceof:(X,Z)=>{if(typeof X[1]!=="function")return I(eL(X8(X[1])));let Q=X.slice(1).map((G)=>typeof G==="function"?Z.$.node("proto",{proto:G}):I(eL(X8(G))));return Q.length===1?Q[0]:Z.$.node("union",{branches:Q})},"===":(X,Z)=>Z.$.units(X.slice(1))}),Vy=(X)=>JA[X[0]]!==void 0,eL=(X)=>`Expected a constructor following 'instanceof' operator (was ${X})`;var zA=(X,Z)=>{let Q=[{}],G=0;while(G<X.length){let J=!1;if(X[G]==="..."&&G<X.length-1)J=!0,G++;let Y=fQ(X[G],Z),[$,z,H]=!O0(Y)?[Y]:Y;if(G++,J){if(!$.extends(f.intrinsic.Array))return I(Ay($.expression));Q=Q.flatMap((U)=>$.distribute((L)=>Ly(BQ(U),L)))}else Q=Q.map((U)=>{if(z==="?")return HA(U,$);if(z==="=")return By(U,$,H);return DY(U,$)})}return Z.$.parseSchema(Q.map((J)=>cX(J)?{proto:Array,exactLength:0}:{proto:Array,sequence:J}))},DY=(X,Z)=>{if(X.defaultables||X.optionals)return I(X.variadic?JY:Fy);if(X.variadic)X.postfix=G0(X.postfix,Z);else X.prefix=G0(X.prefix,Z);return X},HA=(X,Z)=>{if(X.variadic)return I(UA);return X.optionals=G0(X.optionals,Z),X},By=(X,Z,Q)=>{if(X.variadic)return I(UA);if(X.optionals)return I(Oy);return X.defaultables=G0(X.defaultables,[[Z,Q]]),X},YA=(X,Z)=>{if(X.postfix)I($A);if(X.variadic){if(!X.variadic.equals(Z))I($A)}else X.variadic=Z.internal;return X},Ly=(X,Z)=>{let Q=Z.select({method:"find",kind:"sequence"});if(!Q)return YA(X,f.intrinsic.unknown);if(Q.prefix)for(let G of Q.prefix)DY(X,G);if(Q.optionals)for(let G of Q.optionals)HA(X,G);if(Q.variadic)YA(X,Q.variadic);if(Q.postfix)for(let G of Q.postfix)DY(X,G);return X},Ay=(X)=>`Spread element must be an array (was ${X})`,$A="A tuple may have at most one variadic element",Fy="A required element may not follow an optional element",UA="An optional element may not follow a variadic element";var Oy="A defaultable element may not follow an optional element without a default";var wy={},kQ=(X,Z)=>{if(typeof X==="string"){if(Z.args&&Object.keys(Z.args).some((G)=>X.includes(G)))return TY(X,Z);let Q=wy[Z.$.name]??={};return Q[X]??=TY(X,Z)}return XX(X,"object")?Ky(X,Z):I(IY(x0(X)))},Ky=(X,Z)=>{let Q=eZ(X);switch(Q){case void 0:if(l(X,"root"))return X;if("~standard"in X)return My(X,Z);return tL(X,Z);case"Array":return Ny(X,Z);case"RegExp":return Z.$.node("intersection",{domain:"string",pattern:X},{prereduced:!0});case"Function":{let G=_6(X)?X():X;if(l(G,"root"))return G;return I(IY("Function"))}default:return I(IY(Q??r(X)))}},My=(X,Z)=>Z.$.intrinsic.unknown.pipe((Q,G)=>{let J=X["~standard"].validate(Q);if(!J.issues)return J.value;for(let{message:Y,path:$}of J.issues)if($)if($.length)G.error({problem:nB(Y),relativePath:$.map((z)=>typeof z==="object"?z.key:z)});else G.error({message:Y});else G.error({message:Y})}),Ny=(X,Z)=>XA(X,Z)??zA(X,Z),IY=(X)=>`Type definitions must be strings or objects (was ${X})`;class _Y extends GX{constructor(X){let Z=Object.assign({errors:JX,hkt:o0,$:X,raw:X.parse,module:X.constructor.module,scope:X.constructor.scope,declare:X.declare,define:X.define,match:X.match,generic:X.generic,schema:X.schema,keywords:X.ambient,unit:X.unit,enumerated:X.enumerated,instanceOf:X.instanceOf,valueOf:X.valueOf,or:X.or,and:X.and,merge:X.merge,pipe:X.pipe,fn:X.fn},X.ambientAttachments);super((...Q)=>{if(Q.length===1)return X.parse(Q[0]);if(Q.length===2&&typeof Q[0]==="string"&&Q[0][0]==="<"&&Q[0][Q[0].length-1]===">"){let G=Q[0].slice(1,-1),J=X.parseGenericParams(G,{});return new y6(J,Q[1],X,X,null)}return X.parse(Q)},{attach:Z})}}var QZ=f;class xQ extends PQ{get ambientAttachments(){if(!QZ.typeAttachments)return;return this.cacheGetter("ambientAttachments",s(QZ.typeAttachments,(X,Z)=>[X,this.bindReference(Z)]))}preparseOwnAliasEntry(X,Z){let Q=X.indexOf("<");if(Q===-1){if(l(Z,"module")||l(Z,"generic"))return[X,Z];let Y=this.name==="ark"?X:X==="root"?this.name:`${this.name}.${X}`,$=this.resolvedConfig.keywords?.[Y];if($)Z=[Z,"@",$];return[X,Z]}if(X[X.length-1]!==">")I("'>' must be the last character of a generic declaration in a scope");let G=X.slice(0,Q),J=X.slice(Q+1,-1);return[G,()=>{let Y=this.parseGenericParams(J,{alias:G});return q2(Y,Z,this)}]}parseGenericParams(X,Z){return yQ(new z8(X),[],this.createParseContext({...Z,def:X,prefix:"generic"}))}normalizeRootScopeValue(X){if(_6(X)&&!l(X,"generic"))return X();return X}preparseOwnDefinitionFormat(X,Z){return{...Z,def:X,prefix:Z.alias??"type"}}parseOwnDefinitionFormat(X,Z){if(!(Z.alias&&(Z.alias in this.aliases))&&!Z.args)Z.args={this:Z.id};let G=kQ(X,Z);if(O0(G)){if(G[1]==="=")return I(CQ);if(G[1]==="?")return I(_Q)}return G}unit=(X)=>this.units([X]);valueOf=(X)=>this.units(gB(X));enumerated=(...X)=>this.units(X);instanceOf=(X)=>this.node("proto",{proto:X},{prereduced:!0});or=(...X)=>this.schema(X.map((Z)=>this.parse(Z)));and=(...X)=>X.reduce((Z,Q)=>Z.and(this.parse(Q)),this.intrinsic.unknown);merge=(...X)=>X.reduce((Z,Q)=>Z.merge(this.parse(Q)),this.intrinsic.object);pipe=(...X)=>this.intrinsic.unknown.pipe(...X);fn=new qY(this);match=new EY(this);declare=()=>({type:this.type});define(X){return X}type=new _Y(this);static scope=(X,Z={})=>new xQ(X,Z);static module=(X,Z={})=>this.scope(X,Z).export()}var j8=Object.assign(xQ.scope,{define:(X)=>X}),X0=xQ;class WA extends o0{description='merge an object\'s properties onto another like `Merge(User, { isAdmin: "true" })`'}var Ty=PX(["base",i.object],["props",i.object])((X)=>X.base.merge(X.props),WA),VA=X0.module({Key:i.key,Merge:Ty});class BA extends o0{}var qy=PX("element")((X)=>{let Z=X.element.exclude(i.Array),Q=Z.array();return Z.rawOr(Q).pipe(I6).distribute((G)=>G.assertHasKind("morph").declareOut(Q),W0)},BA),LA=X0.module({root:i.Array,readonly:"root",index:i.nonNegativeIntegerString,liftFrom:qy},{name:"Array"});var CY=W0(["string",e6.FileConstructor]),Ey=CY.rawOr(CY.array()),AA=W0({meta:"an object representing parsed form data",domain:"object",index:{signature:"string",value:Ey}}),FA=X0.module({root:["instanceof",FormData],value:CY,parsed:AA,parse:W0({in:FormData,morphs:(X)=>{let Z={};for(let[Q,G]of X)if(Q in Z){let J=Z[Q];if(typeof J==="string"||J instanceof e6.FileConstructor)Z[Q]=[J,G];else J.push(G)}else Z[Q]=G;return Z},declaredOut:AA})},{name:"FormData"});var OA=X0.module({Int8:["instanceof",Int8Array],Uint8:["instanceof",Uint8Array],Uint8Clamped:["instanceof",Uint8ClampedArray],Int16:["instanceof",Int16Array],Uint16:["instanceof",Uint16Array],Int32:["instanceof",Int32Array],Uint32:["instanceof",Uint32Array],Float32:["instanceof",Float32Array],Float64:["instanceof",Float64Array],BigInt64:["instanceof",BigInt64Array],BigUint64:["instanceof",BigUint64Array]},{name:"TypedArray"});var Py={Boolean:1,Number:1,String:1},wA=X0.module({...s({...w7,...M7},(X,Z)=>(X in Py)?[]:[X,["instanceof",Z]]),Array:LA,TypedArray:OA,FormData:FA});var jy=W0({domain:{domain:"number",meta:"a number representing a Unix timestamp"},divisor:{rule:1,meta:"an integer representing a Unix timestamp"},min:{rule:-8640000000000000,meta:"a Unix timestamp after -8640000000000000"},max:{rule:8640000000000000,meta:"a Unix timestamp before 8640000000000000"},meta:"an integer representing a safe Unix timestamp"}),Dy=W0({domain:"number",divisor:1}),vQ=X0.module({root:i.number,integer:Dy,epoch:jy,safe:W0({domain:{domain:"number",numberAllowsNaN:!1},min:Number.MIN_SAFE_INTEGER,max:Number.MAX_SAFE_INTEGER}),NaN:["===",Number.NaN],Infinity:["===",Number.POSITIVE_INFINITY],NegativeInfinity:["===",Number.NEGATIVE_INFINITY]},{name:"number"});var E0=(X,Z,Q)=>{let G={domain:"string",pattern:{rule:X.source,flags:X.flags,meta:Z}};if(Q)G.meta={format:Q};return e9("intersection",G)},KA=E0(Q8,"a well-formed integer string"),SA=X0.module({root:KA,parse:W0({in:KA,morphs:(X,Z)=>{let Q=Number.parseInt(X);return Number.isSafeInteger(Q)?Q:Z.error("an integer in the range Number.MIN_SAFE_INTEGER to Number.MAX_SAFE_INTEGER")},declaredOut:i.integer})},{name:"string.integer"}),Iy=E0(/^[\dA-Fa-f]+$/,"hex characters only"),_y=X0.module({root:E0(/^(?:[\d+/A-Za-z]{4})*(?:[\d+/A-Za-z]{2}==|[\d+/A-Za-z]{3}=)?$/,"base64-encoded"),url:E0(/^(?:[\w-]{4})*(?:[\w-]{2}(?:==|%3D%3D)?|[\w-]{3}(?:=|%3D)?)?$/,"base64url-encoded")},{name:"string.base64"}),MA=E0(/^[A-Z].*$/,"capitalized"),Cy=X0.module({root:W0({in:"string",morphs:(X)=>X.charAt(0).toUpperCase()+X.slice(1),declaredOut:MA}),preformatted:MA},{name:"string.capitalize"}),Sy=(X)=>{let Z=X.replace(/[ -]+/g,""),Q=0,G,J,Y=!1;for(let $=Z.length-1;$>=0;$--){if(G=Z.substring($,$+1),J=Number.parseInt(G,10),Y)J*=2,Q+=J>=10?J%10+1:J;else Q+=J;Y=!Y}return!!(Q%10===0?Z:!1)},by=/^(?:4\d{12}(?:\d{3,6})?|5[1-5]\d{14}|(222[1-9]|22[3-9]\d|2[3-6]\d{2}|27[01]\d|2720)\d{12}|6(?:011|5\d\d)\d{12,15}|3[47]\d{13}|3(?:0[0-5]|[68]\d)\d{11}|(?:2131|1800|35\d{3})\d{11}|6[27]\d{14}|^(81\d{14,17}))$/,Ry=W0({domain:"string",pattern:{meta:"a credit card number",rule:by.source},predicate:{meta:"a credit card number",predicate:Sy}});var yy=/^([+-]?\d{4}(?!\d{2}\b))((-?)((0[1-9]|1[0-2])(\3([12]\d|0[1-9]|3[01]))?|W([0-4]\d|5[0-3])(-?[1-7])?|(00[1-9]|0[1-9]\d|[12]\d{2}|3([0-5]\d|6[1-6])))(T((([01]\d|2[0-3])((:?)[0-5]\d)?|24:?00)([,.]\d+(?!:))?)?(\17[0-5]\d([,.]\d+)?)?([Zz]|([+-])([01]\d|2[0-3]):?([0-5]\d)?)?)?)?$/;var fy=(X)=>!Number.isNaN(new Date(X).valueOf()),NA=W0({domain:"string",predicate:{meta:"a parsable date",predicate:fy}}).assertHasKind("intersection"),TA=SA.root.internal.narrow((X,Z)=>{let Q=Number.parseInt(X),G=vQ.epoch(Q);if(G instanceof JX)return Z.errors.merge(G),!1;return!0}).configure({description:"an integer string representing a safe Unix timestamp"},"self").assertHasKind("intersection"),ky=X0.module({root:TA,parse:W0({in:TA,morphs:(X)=>new Date(X),declaredOut:i.Date})},{name:"string.date.epoch"}),qA=E0(yy,"an ISO 8601 (YYYY-MM-DDTHH:mm:ss.sssZ) date").internal.assertHasKind("intersection"),xy=X0.module({root:qA,parse:W0({in:qA,morphs:(X)=>new Date(X),declaredOut:i.Date})},{name:"string.date.iso"}),vy=X0.module({root:NA,parse:W0({declaredIn:NA,in:"string",morphs:(X,Z)=>{let Q=new Date(X);if(Number.isNaN(Q.valueOf()))return Z.error("a parsable date");return Q},declaredOut:i.Date}),iso:xy,epoch:ky},{name:"string.date"}),hy=E0(/^[\w%+.-]+@[\d.A-Za-z-]+\.[A-Za-z]{2,}$/,"an email address","email"),EA="(?:[0-9]|[1-9][0-9]|1[0-9][0-9]|2[0-4][0-9]|25[0-5])",f6=`(${EA}[.]){3}${EA}`,gy=new RegExp(`^${f6}$`),f0="(?:[0-9a-fA-F]{1,4})",uy=new RegExp(`^((?:${f0}:){7}(?:${f0}|:)|(?:${f0}:){6}(?:${f6}|:${f0}|:)|(?:${f0}:){5}(?::${f6}|(:${f0}){1,2}|:)|(?:${f0}:){4}(?:(:${f0}){0,1}:${f6}|(:${f0}){1,3}|:)|(?:${f0}:){3}(?:(:${f0}){0,2}:${f6}|(:${f0}){1,4}|:)|(?:${f0}:){2}(?:(:${f0}){0,3}:${f6}|(:${f0}){1,5}|:)|(?:${f0}:){1}(?:(:${f0}){0,4}:${f6}|(:${f0}){1,6}|:)|(?::((?::${f0}){0,5}:${f6}|(?::${f0}){1,7}|:)))(%[0-9a-zA-Z.]{1,})?$`),my=X0.module({root:["v4 | v6","@","an IP address"],v4:E0(gy,"an IPv4 address","ipv4"),v6:E0(uy,"an IPv6 address","ipv6")},{name:"string.ip"}),GZ="a JSON string",bA=(X)=>{if(!(X instanceof SyntaxError))throw X;return`must be ${GZ} (${X})`},py=W0({meta:GZ,domain:"string",predicate:{meta:GZ,predicate:(X,Z)=>{try{return JSON.parse(X),!0}catch(Q){return Z.reject({code:"predicate",expected:GZ,problem:bA(Q)})}}}}),dy=(X,Z)=>{if(X.length===0)return Z.error({code:"predicate",expected:GZ,actual:"empty"});try{return JSON.parse(X)}catch(Q){return Z.error({code:"predicate",expected:GZ,problem:bA(Q)})}},ly=X0.module({root:py,parse:W0({meta:"safe JSON string parser",in:"string",morphs:dy,declaredOut:i.jsonObject})},{name:"string.json"}),PA=E0(/^[a-z]*$/,"only lowercase letters"),cy=X0.module({root:W0({in:"string",morphs:(X)=>X.toLowerCase(),declaredOut:PA}),preformatted:PA},{name:"string.lower"}),RA=["NFC","NFD","NFKC","NFKD"],D8=s(RA,(X,Z)=>[Z,W0({domain:"string",predicate:(Q)=>Q.normalize(Z)===Q,meta:`${Z}-normalized unicode`})]),hQ=s(RA,(X,Z)=>[Z,W0({in:"string",morphs:(Q)=>Q.normalize(Z),declaredOut:D8[Z]})]),iy=X0.module({root:hQ.NFC,preformatted:D8.NFC},{name:"string.normalize.NFC"}),oy=X0.module({root:hQ.NFD,preformatted:D8.NFD},{name:"string.normalize.NFD"}),ny=X0.module({root:hQ.NFKC,preformatted:D8.NFKC},{name:"string.normalize.NFKC"}),sy=X0.module({root:hQ.NFKD,preformatted:D8.NFKD},{name:"string.normalize.NFKD"}),ry=X0.module({root:"NFC",NFC:iy,NFD:oy,NFKC:ny,NFKD:sy},{name:"string.normalize"}),jA=E0(HQ,"a well-formed numeric string"),ay=X0.module({root:jA,parse:W0({in:jA,morphs:(X)=>Number.parseFloat(X),declaredOut:i.number})},{name:"string.numeric"}),DA="a regex pattern",ty=W0({domain:"string",predicate:{meta:DA,predicate:(X,Z)=>{try{return new RegExp(X),!0}catch(Q){return Z.reject({code:"predicate",expected:DA,problem:String(Q)})}}},meta:{format:"regex"}}),ey=/^(0|[1-9]\d*)\.(0|[1-9]\d*)\.(0|[1-9]\d*)(?:-((?:0|[1-9]\d*|\d*[A-Za-z-][\dA-Za-z-]*)(?:\.(?:0|[1-9]\d*|\d*[A-Za-z-][\dA-Za-z-]*))*))?(?:\+([\dA-Za-z-]+(?:\.[\dA-Za-z-]+)*))?$/,Xf=E0(ey,"a semantic version (see https://semver.org/)"),IA=E0(/^\S.*\S$|^\S?$/,"trimmed"),Zf=X0.module({root:W0({in:"string",morphs:(X)=>X.trim(),declaredOut:IA}),preformatted:IA},{name:"string.trim"}),_A=E0(/^[A-Z]*$/,"only uppercase letters"),Qf=X0.module({root:W0({in:"string",morphs:(X)=>X.toUpperCase(),declaredOut:_A}),preformatted:_A},{name:"string.upper"}),Gf=(X)=>URL.canParse(X),CA=W0({domain:"string",predicate:{meta:"a URL string",predicate:Gf},meta:{format:"uri"}}),Jf=X0.module({root:CA,parse:W0({declaredIn:CA,in:"string",morphs:(X,Z)=>{try{return new URL(X)}catch{return Z.error("a URL string")}},declaredOut:W0(URL)})},{name:"string.url"}),Yf=X0.module({root:["versioned | nil | max","@",{description:"a UUID",format:"uuid"}],"#nil":"'00000000-0000-0000-0000-000000000000'","#max":"'ffffffff-ffff-ffff-ffff-ffffffffffff'","#versioned":/[\da-f]{8}-[\da-f]{4}-[1-8][\da-f]{3}-[89ab][\da-f]{3}-[\da-f]{12}/i,v1:E0(/^[\da-f]{8}-[\da-f]{4}-1[\da-f]{3}-[89ab][\da-f]{3}-[\da-f]{12}$/i,"a UUIDv1"),v2:E0(/^[\da-f]{8}-[\da-f]{4}-2[\da-f]{3}-[89ab][\da-f]{3}-[\da-f]{12}$/i,"a UUIDv2"),v3:E0(/^[\da-f]{8}-[\da-f]{4}-3[\da-f]{3}-[89ab][\da-f]{3}-[\da-f]{12}$/i,"a UUIDv3"),v4:E0(/^[\da-f]{8}-[\da-f]{4}-4[\da-f]{3}-[89ab][\da-f]{3}-[\da-f]{12}$/i,"a UUIDv4"),v5:E0(/^[\da-f]{8}-[\da-f]{4}-5[\da-f]{3}-[89ab][\da-f]{3}-[\da-f]{12}$/i,"a UUIDv5"),v6:E0(/^[\da-f]{8}-[\da-f]{4}-6[\da-f]{3}-[89ab][\da-f]{3}-[\da-f]{12}$/i,"a UUIDv6"),v7:E0(/^[\da-f]{8}-[\da-f]{4}-7[\da-f]{3}-[89ab][\da-f]{3}-[\da-f]{12}$/i,"a UUIDv7"),v8:E0(/^[\da-f]{8}-[\da-f]{4}-8[\da-f]{3}-[89ab][\da-f]{3}-[\da-f]{12}$/i,"a UUIDv8")},{name:"string.uuid"}),yA=X0.module({root:i.string,alpha:E0(/^[A-Za-z]*$/,"only letters"),alphanumeric:E0(/^[\dA-Za-z]*$/,"only letters and digits 0-9"),hex:Iy,base64:_y,capitalize:Cy,creditCard:Ry,date:vy,digits:E0(/^\d*$/,"only digits 0-9"),email:hy,integer:SA,ip:my,json:ly,lower:cy,normalize:ry,numeric:ay,regex:ty,semver:Xf,trim:Zf,upper:Qf,url:Jf,uuid:Yf},{name:"string"});var fA=X0.module({bigint:i.bigint,boolean:i.boolean,false:i.false,never:i.never,null:i.null,number:i.number,object:i.object,string:i.string,symbol:i.symbol,true:i.true,unknown:i.unknown,undefined:i.undefined}),kA=X0.module({root:i.unknown,any:i.unknown},{name:"unknown"}),$f=X0.module({root:i.jsonObject,stringify:e9("morph",{in:i.jsonObject,morphs:(X)=>JSON.stringify(X),declaredOut:i.string})},{name:"object.json"}),xA=X0.module({root:i.object,json:$f},{name:"object"});class vA extends o0{description='instantiate an object from an index signature and corresponding value type like `Record("string", "number")`'}var zf=PX(["K",i.key],"V")((X)=>({domain:"object",index:{signature:X.K,value:X.V}}),vA);class hA extends o0{description='pick a set of properties from an object like `Pick(User, "name | age")`'}var Hf=PX(["T",i.object],["K",i.key])((X)=>X.T.pick(X.K),hA);class gA extends o0{description='omit a set of properties from an object like `Omit(User, "age")`'}var Uf=PX(["T",i.object],["K",i.key])((X)=>X.T.omit(X.K),gA);class uA extends o0{description="make all named properties of an object optional like `Partial(User)`"}var Wf=PX(["T",i.object])((X)=>X.T.partial(),uA);class mA extends o0{description="make all named properties of an object required like `Required(User)`"}var Vf=PX(["T",i.object])((X)=>X.T.required(),mA);class pA extends o0{description='exclude branches of a union like `Exclude("boolean", "true")`'}var Bf=PX("T","U")((X)=>X.T.exclude(X.U),pA);class dA extends o0{description='extract branches of a union like `Extract("0 | false | 1", "number")`'}var Lf=PX("T","U")((X)=>X.T.extract(X.U),dA),lA=X0.module({Exclude:Bf,Extract:Lf,Omit:Uf,Partial:Wf,Pick:Hf,Record:zf,Required:Vf});var U6=j8({...fA,...lA,...wA,...VA,string:yA,number:vQ,object:xA,unknown:kA},{prereducedAliases:!0,name:"ark"}),h0=U6.export();Object.assign(QZ.ambient,h0);QZ.typeAttachments={string:h0.string.root,number:h0.number.root,bigint:h0.bigint,boolean:h0.boolean,symbol:h0.symbol,undefined:h0.undefined,null:h0.null,object:h0.object.root,unknown:h0.unknown.root,false:h0.false,true:h0.true,never:h0.never,arrayIndex:h0.Array.index,Key:h0.Key,Record:h0.Record,Array:h0.Array.root,Date:h0.Date};var SY=Object.assign(U6.type,QZ.typeAttachments),Af=U6.match,Ff=U6.fn,Of=U6.generic,br=U6.schema,wf=U6.define,Kf=U6.declare;var Q9=j8({Operator:"'EQ' | '==' | 'NEQ' | '!=' | 'GT' | '>' | 'GTE' | '>=' | 'LT' | '<' | 'LTE' | '<=' | 'IN' | 'NOT_IN' | 'CONTAINS' | 'MATCHES' | 'RANGE' | 'SINCE' | 'AFTER' | 'BEFORE' | 'UNTIL'",Condition:"RangeCondition | ListCondition | ContainsCondition | NumericCondition | RegexCondition | BasicCondition",RangeCondition:{field:"string > 0",operator:"'RANGE'",value:"unknown[] == 2"},ListCondition:{field:"string > 0",operator:"'IN' | 'NOT_IN'",value:"unknown[]"},ContainsCondition:{field:"string > 0",operator:"'CONTAINS'",value:"string | unknown[]"},NumericCondition:{field:"string > 0",operator:"'>' | '>=' | '<' | '<=' | 'GT' | 'GTE' | 'LT' | 'LTE'",value:"number | string"},RegexCondition:{field:"string > 0",operator:"'MATCHES'",value:"string"},BasicCondition:{field:"string > 0",operator:"Operator",value:"unknown"},ConditionGroup:{operator:"'AND' | 'OR'",conditions:"(Condition | ConditionGroup)[] >= 1"},RuleCondition:"Condition | ConditionGroup",Action:{type:"string > 0","params?":"object","delay?":"number.integer >= 0","probability?":"0 <= number <= 1"},ActionGroup:{"mode?":"'ALL' | 'EITHER' | 'SEQUENCE'",actions:"(Action | ActionGroup)[] >= 1"},RuleAction:"Action | ActionGroup",TriggerRule:{id:"string > 0","name?":"string","description?":"string","priority?":"number.integer","enabled?":"boolean","cooldown?":"number.integer >= 0","tags?":"string[]",on:"string > 0","if?":"RuleCondition | RuleCondition[]",do:"RuleAction | RuleAction[]","comment?":"string"}}).export(),sr=Q9.Operator,rr=Q9.Condition,ar=Q9.ConditionGroup,tr=Q9.RuleCondition,er=Q9.Action,Xa=Q9.ActionGroup,Mf=Q9.TriggerRule;class bY{static validate(X){let Z=Mf(X);if(Z instanceof SY.errors){let J=[];for(let Y of Z){let $=Y.path.join("."),z=Y.message,H=void 0;if($.endsWith("on")&&(z.includes("string")||z.includes("must be")))if(typeof X==="object"&&X&&X.on===!0)z="The 'on' field is incorrect (boolean true found).",H=`In YAML, 'on' is a boolean keyword (true). Quote it: "on": "EventName"`;else H="Ensure 'on' is a string event name.";J.push({path:$,message:z,suggestion:H,severity:"error"})}return{valid:!1,issues:J}}let Q=Z,G=[];if(this.validateConditionsRecursive(Q.if,G,"if"),G.length>0)return{valid:!1,issues:G};return{valid:!0,rule:Q}}static validateConditionsRecursive(X,Z,Q){if(!X)return;if(Array.isArray(X)){X.forEach((G,J)=>{this.validateConditionsRecursive(G,Z,`${Q}.${J}`)});return}if("conditions"in X&&Array.isArray(X.conditions)){X.conditions.forEach((G,J)=>{this.validateConditionsRecursive(G,Z,`${Q}.conditions.${J}`)});return}if("operator"in X&&"value"in X)this.validateConditionValue(X,Z,Q)}static validateConditionValue(X,Z,Q){let{operator:G,value:J}=X;if(["IN","NOT_IN","RANGE","CONTAINS"].includes(G)){if(G==="CONTAINS"){if(typeof J!=="string"&&!Array.isArray(J))Z.push({path:`${Q}.value`,message:`Incorrect value type: Operator 'CONTAINS' expects a String or List (Array), but received ${typeof J}.`,suggestion:"Use a substring or a list of items.",severity:"error"});return}if(!Array.isArray(J)){Z.push({path:`${Q}.value`,message:`Incorrect value type: Operator '${G}' expects a List (Array), but received ${typeof J}.`,suggestion:G==="RANGE"?"Use format [min, max]":"Use format [item1, item2]",severity:"error"});return}if(G==="RANGE"){if(J.length!==2)Z.push({path:`${Q}.value`,message:"Invalid Range: Operator 'RANGE' requires exactly 2 values (min and max).",suggestion:"Use format [min, max], e.g. [1, 10]",severity:"error"});else if(typeof J[0]!=="number"&&typeof J[0]!=="string")Z.push({path:`${Q}.value`,message:"Incorrect range type: Range values must be numbers or expression strings.",severity:"error"})}}else if(G==="MATCHES")if(typeof J!=="string")Z.push({path:`${Q}.value`,message:`Incorrect value type: Operator 'MATCHES' expects a string (regex pattern), but received ${typeof J}.`,severity:"error"});else try{new RegExp(J)}catch(Y){Z.push({path:`${Q}.value`,message:`Invalid Regex pattern: ${Y.message}`,severity:"error"})}else if(["GT","GTE","LT","LTE",">",">=","<","<="].includes(G)){if(typeof J!=="number"&&typeof J!=="string")Z.push({path:`${Q}.value`,message:`Incorrect value type: Operator '${G}' expects a number or expression string, but received ${typeof J}.`,severity:"error"})}}}import{dirname as Nf,join as cA}from"path";function gQ(X){let Q=X.getText().split(`
`),G=[],J=!0;for(let Y=0;Y<Q.length;Y++){let z=(Q[Y]||"").trim();if(!z.startsWith("#"))continue;let H=z.match(/#\s*@([\w-]+)(?:\s+(.+))?/);if(!H)continue;let[,U,L]=H,A=Tf(U,L,Y);if(A){if(G.push(A),A.type==="disable-lint")J=!1;else if(A.type==="enable-lint")J=!0}}if(!J&&G.length>0){let Y=G.find(($)=>$.type==="disable-lint");if(Y){let $=Y.line,z=Q.length-1;Y.affectedLines=Array.from({length:z-$+1},(H,U)=>$+U)}}return G}function Tf(X,Z,Q){let G=X;switch(G){case"disable-lint":return{type:G,line:Q,affectedLines:[Q]};case"enable-lint":return{type:G,line:Q,affectedLines:[]};case"disable-next-line":return{type:G,line:Q,affectedLines:[Q+1]};case"disable-line":return{type:G,line:Q,affectedLines:[Q]};case"disable-rule":case"enable-rule":let J=Z?.split(",").map((H)=>H.trim()).filter(Boolean);return{type:G,line:Q,rules:J,affectedLines:[Q+1]};case"import":if(!Z)return null;let Y=Z.match(/^\s*(\w+)\s+from\s+['"](.+)['"]\s*$/);if(!Y)return null;let[,$,z]=Y;return{type:G,line:Q,importAlias:$,importPath:z,affectedLines:[]};default:return null}}function JZ(X,Z,Q){for(let G of Z){if(!G.affectedLines.includes(X))continue;switch(G.type){case"disable-lint":return!0;case"disable-next-line":case"disable-line":return!0;case"disable-rule":if(G.rules&&Q)return G.rules.some((J)=>Q.includes(J)||J.includes(Q));return!1;default:continue}}return!1}function iA(X){let Z=[],Q=null;for(let G=0;G<X.length;G++){let J=X[G];if(J.type==="disable-lint")Q=J,Z.push(J);else if(J.type==="enable-lint"&&Q){Q.affectedLines=[];for(let Y=Q.line;Y<J.line;Y++)Q.affectedLines.push(Y);Q=null,Z.push(J)}else Z.push(J)}return Z}function uQ(X,Z){let Q=gQ(X),G=[];for(let J of Q)if(J.type==="import"&&J.importAlias&&J.importPath)try{let Y;if(Z==="file://test"||Z==="file:///test")Y=cA(process.cwd(),"tests","rules","examples"),console.log(`[LSP] Test document detected in getImportDirectives, using test directory: ${Y}`);else{let z=decodeURIComponent(Z),H;if(z.startsWith("file:///"))if(H=z.substring(8),H.match(/^[A-Za-z]:/))H=H.replace(/\//g,"\\");else if(H.match(/^\/[A-Za-z]:/))H=H.substring(1).replace(/\//g,"\\");else H=H.replace(/\//g,"/");else H=z.replace("file:///","");Y=Nf(H)}let $=cA(Y,J.importPath);G.push({alias:J.importAlias,path:$}),console.log(`[LSP] Import directive resolved: ${J.importAlias} -> ${$}`)}catch(Y){console.error("[LSP] Error resolving import directive:",Y)}return G}import{existsSync as oA}from"fs";import{join as nA,dirname as qf,extname as Ef}from"path";async function rA(X){let Z=[],Q=I9.create("file://test","yaml",1,X),G=iA(gQ(Q)),J=yX(X);if(J.errors.length>0)for(let H of J.errors){let U={severity:G9.DiagnosticSeverity.Error,range:{start:Q.positionAt(H.pos[0]),end:Q.positionAt(H.pos[1])},message:H.message,source:"yaml-parser"},L=U.range.start.line;if(!JZ(L,G,"yaml-parser"))Z.push(U)}let Y=X.split(`
`),$=!1;for(let H=0;H<Y.length;H++){let U=Y[H]?.trim()||"";if(H===0&&U==="---"){$=!0;continue}if(U==="---"&&$){let L=X.split(`
`).slice(0,H).join(`
`).length+(H>0?1:0);if(!JZ(H,G,"trigger-best-practices"))Z.push({severity:G9.DiagnosticSeverity.Information,range:{start:Q.positionAt(L),end:Q.positionAt(L+U.length)},message:"Multi-document YAML detected. Consider using list format (- id: ...) for better compatibility and clearer semantics.",source:"trigger-best-practices",tags:[1]});break}if(U.length>0&&!U.startsWith("#"))$=!0}let z=jf(Q,X);for(let H of z){let U=H.range.start.line;if(!JZ(U,G,"trigger-import-validator"))Z.push(H)}try{let H=J.toJS();if(H&&typeof H==="object"){let U=[],L=!Array.isArray(H)&&H.rules&&Array.isArray(H.rules),A=Array.isArray(H);if(L)U=H.rules;else U=A?H:[H];U.forEach((F,j)=>{if(F&&typeof F==="object"&&!F.id){let T=["id"];if(L)T.unshift(String(j)),T.unshift("rules");else if(A)T.unshift(String(j));let P=sA(J.contents,T.slice(0,-1),Q),y=P.start.line;if(!JZ(y,G,"trigger-validator"))Z.push({severity:G9.DiagnosticSeverity.Error,range:P,message:"Rule is missing required field: id. Every rule must have a unique identifier.",source:"trigger-validator"})}if(F&&typeof F==="object"&&F.actions&&!F.do)F.do=F.actions;let R=bY.validate(F);if(!R.valid)for(let T of R.issues){let P=T.path.split(".");if(L)P.unshift(String(j)),P.unshift("rules");else if(A)P.unshift(String(j));let y=sA(J.contents,P,Q),M=y.start.line;if(!JZ(M,G,"trigger-validator"))Z.push({severity:G9.DiagnosticSeverity.Error,range:y,message:T.message+(T.suggestion?` (Suggestion: ${T.suggestion})`:""),source:"trigger-validator"})}})}}catch(H){}return Z}function sA(X,Z,Q){let G=X,J=null,Y=-1;for(let $=0;$<Z.length;$++){let z=Z[$];if(!G)break;if(J=G,Y=$,MX(G)){let H=G.items.find((U)=>{if(Pf(U.key)&&String(U.key.value)===z)return!0;return!1});if(H&&H.value)G=H.value;else{G=null;break}}else if(D6(G)){let H=parseInt(z);if(!isNaN(H)&&G.items[H])G=G.items[H];else{G=null;break}}else{G=null;break}}if(G&&G.range)return{start:Q.positionAt(G.range[0]),end:Q.positionAt(G.range[1])};if(J&&J.range){let $=Z[Y+1];if(MX(J)&&$){let z=J.items[J.items.length-1];if(z&&"value"in z&&z.value){let H=z.value;if(H.range){let U=Q.positionAt(H.range[1]);return{start:U,end:U}}}}if("range"in J&&J.range)return{start:Q.positionAt(J.range[0]),end:Q.positionAt(J.range[0])}}if(Z.length>0&&!isNaN(parseInt(Z[0]))){let $=parseInt(Z[0]);if(D6(X)&&X.items[$]){let z=X.items[$];if(z&&"range"in z&&z.range)return{start:Q.positionAt(z.range[0]),end:Q.positionAt(z.range[0])}}}return{start:Q.positionAt(0),end:Q.positionAt(0)}}function Pf(X){return X&&X.type!==void 0&&(X.type==="SCALAR"||X.type==="QUOTE_DOUBLE"||X.type==="QUOTE_SINGLE"||typeof X.value<"u")}function jf(X,Z){let Q=[],G=gQ(X);for(let J of G)if(J.type==="import"&&J.importPath)try{let Y;if(X.uri==="file://test"||X.uri==="file:///test")Y=nA(process.cwd(),"tests","rules","examples"),console.log(`[LSP] Test document detected, using test directory: ${Y}`);else{let U=decodeURIComponent(X.uri),L;if(U.startsWith("file:///"))if(L=U.substring(8),L.match(/^[A-Za-z]:/))L=L.replace(/\//g,"\\");else if(L.match(/^\/[A-Za-z]:/))L=L.substring(1).replace(/\//g,"\\");else L=L.replace(/\//g,"/");else L=U.replace("file:///","");Y=qf(L)}let $=nA(Y,J.importPath);if(console.log("[LSP] Import validation debug:"),console.log(`[LSP]   Document URI: ${X.uri}`),console.log(`[LSP]   Document dir: ${Y}`),console.log(`[LSP]   Import path: ${J.importPath}`),console.log(`[LSP]   Resolved path: ${$}`),console.log(`[LSP]   File exists: ${oA($)}`),!oA($)){let L=Z.split(`
`)[J.line]||"",A=L.match(new RegExp(`['"]${J.importPath.replace(/[.*+?^${}()|[\]\\]/g,"\\$&")}['"]`)),F=L.indexOf(J.importPath),j=F+J.importPath.length;if(A)F=A.index||F,j=F+A[0].length;Q.push({severity:G9.DiagnosticSeverity.Error,range:{start:{line:J.line,character:F},end:{line:J.line,character:j}},message:`Import file not found: ${J.importPath}`,source:"trigger-import-validator",data:{suggestion:`Check that the file exists at the specified path: ${$}`}});continue}let z=Ef($).toLowerCase();if(![".json",".yaml",".yml"].includes(z)){let L=Z.split(`
`)[J.line]||"",A=L.match(new RegExp(`['"]${J.importPath.replace(/[.*+?^${}()|[\]\\]/g,"\\$&")}['"]`)),F=L.indexOf(J.importPath),j=F+J.importPath.length;if(A)F=A.index||F,j=F+A[0].length;Q.push({severity:G9.DiagnosticSeverity.Error,range:{start:{line:J.line,character:F},end:{line:J.line,character:j}},message:`Invalid file type for import: ${z}. Only JSON and YAML files are supported.`,source:"trigger-import-validator",data:{suggestion:"Use a .json, .yaml, or .yml file for data imports."}})}}catch(Y){console.error("[LSP] Error validating import directive:",Y)}return Q}var S=p8(jZ(),1);import{readFileSync as Df}from"fs";class RY{data={};schema={};loadFromFile(X){try{let Z=Df(X,"utf-8");if(X.endsWith(".json"))this.data=JSON.parse(Z);else if(X.endsWith(".yaml")||X.endsWith(".yml")){let Q=yX(Z);this.data=Q.toJS()||{}}this.buildSchema(this.data)}catch(Z){console.error(`Failed to load data context from ${X}:`,Z)}}loadFromObject(X){this.data=X,this.buildSchema(this.data)}getValue(X){if(!X)return this.data;let Z=X.split("."),Q=this.data;for(let G of Z)if(Q&&typeof Q==="object"&&G in Q)Q=Q[G];else return;return Q}getFields(X=""){if(!X||X==="")return Object.keys(this.data).map((Q)=>({name:Q,type:this.getTypeOf(this.data[Q]),value:this.data[Q]}));let Z=this.getValue(X);if(Z&&typeof Z==="object"&&!Array.isArray(Z))return Object.keys(Z).map((Q)=>({name:Q,type:this.getTypeOf(Z[Q]),value:Z[Q]}));return[]}hasPath(X){return this.getValue(X)!==void 0}getTypeOf(X){if(X===null)return"null";if(Array.isArray(X))return"array";return typeof X}buildSchema(X,Z=""){if(!X||typeof X!=="object")return;for(let Q in X){let G=Z?`${Z}.${Q}`:Q,J=X[Q];if(this.schema[G]=this.getTypeOf(J),J&&typeof J==="object"&&!Array.isArray(J))this.buildSchema(J,G)}}getFormattedValue(X){if(X===null)return"null";if(X===void 0)return"undefined";if(typeof X==="string")return`"${X}"`;if(typeof X==="object")return JSON.stringify(X,null,2);return String(X)}clear(){this.data={},this.schema={}}}var zX=new RY;function mQ(X){zX.clear();let Z={};for(let Q of X)try{let G=new RY;G.loadFromFile(Q.path);let J=G.getValue("");if(J&&typeof J==="object")Z[Q.alias]=J;console.log(`Loaded data from import: ${Q.alias} -> ${Q.path}`)}catch(G){console.error(`Failed to load import ${Q.alias} from ${Q.path}:`,G)}if(Object.keys(Z).length>0)zX.loadFromObject(Z)}import{existsSync as If}from"fs";import{join as _f,dirname as yY,extname as Cf}from"path";var aA=[{label:"id",kind:S.CompletionItemKind.Field,detail:"Unique identifier for the rule"},{label:"name",kind:S.CompletionItemKind.Field,detail:"Human readable name"},{label:"description",kind:S.CompletionItemKind.Field,detail:"What this rule does"},{label:"on",kind:S.CompletionItemKind.Keyword,detail:"The event that triggers this rule"},{label:"if",kind:S.CompletionItemKind.Keyword,detail:"Conditions that must be met"},{label:"do",kind:S.CompletionItemKind.Keyword,detail:"Actions to perform when triggered"},{label:"priority",kind:S.CompletionItemKind.Property,detail:"Rule execution priority (higher = first)"},{label:"enabled",kind:S.CompletionItemKind.Property,detail:"Whether this rule is active"},{label:"cooldown",kind:S.CompletionItemKind.Property,detail:"Wait time in ms between executions"},{label:"tags",kind:S.CompletionItemKind.Property,detail:"Categorization tags"},{label:"comment",kind:S.CompletionItemKind.Text,detail:"Internal developer note"}],Sf=[{label:"minecraft:player_join",kind:S.CompletionItemKind.Event},{label:"minecraft:player_quit",kind:S.CompletionItemKind.Event},{label:"minecraft:chat",kind:S.CompletionItemKind.Event},{label:"tiktok:chat",kind:S.CompletionItemKind.Event},{label:"tiktok:gift",kind:S.CompletionItemKind.Event},{label:"tiktok:like",kind:S.CompletionItemKind.Event},{label:"twitch:chat",kind:S.CompletionItemKind.Event},{label:"twitch:follow",kind:S.CompletionItemKind.Event},{label:"bopl:webhook",kind:S.CompletionItemKind.Event},{label:"ANY_EVENT",kind:S.CompletionItemKind.Event},{label:"USER_LOGIN",kind:S.CompletionItemKind.Event},{label:"GAME_OVER",kind:S.CompletionItemKind.Event},{label:"COMMAND",kind:S.CompletionItemKind.Event},{label:"ALERT",kind:S.CompletionItemKind.Event}],bf=[{label:"EQ",kind:S.CompletionItemKind.Operator,detail:"Equal (==)"},{label:"NEQ",kind:S.CompletionItemKind.Operator,detail:"Not Equal (!=)"},{label:"GT",kind:S.CompletionItemKind.Operator,detail:"Greater Than (>)"},{label:"GTE",kind:S.CompletionItemKind.Operator,detail:"Greater Than Equals (>=)"},{label:"LT",kind:S.CompletionItemKind.Operator,detail:"Less Than (<)"},{label:"LTE",kind:S.CompletionItemKind.Operator,detail:"Less Than Equals (<=)"},{label:"IN",kind:S.CompletionItemKind.Operator,detail:"Value exists in the provided list"},{label:"NOT_IN",kind:S.CompletionItemKind.Operator,detail:"Value does not exist in the list"},{label:"CONTAINS",kind:S.CompletionItemKind.Operator,detail:"String contains substring or List contains item"},{label:"MATCHES",kind:S.CompletionItemKind.Operator,detail:"Regex pattern match"},{label:"RANGE",kind:S.CompletionItemKind.Operator,detail:"Numeric value between [min, max]"},{label:"SINCE",kind:S.CompletionItemKind.Operator,detail:"Date is after or equal to value"},{label:"AFTER",kind:S.CompletionItemKind.Operator,detail:"Alias for SINCE"},{label:"BEFORE",kind:S.CompletionItemKind.Operator,detail:"Date is before value"},{label:"UNTIL",kind:S.CompletionItemKind.Operator,detail:"Alias for BEFORE"},{label:"AND",kind:S.CompletionItemKind.Operator,detail:"Logical AND (for groups)"},{label:"OR",kind:S.CompletionItemKind.Operator,detail:"Logical OR (for groups)"}],Rf=[{label:"log",kind:S.CompletionItemKind.EnumMember,detail:"Print message to console"},{label:"execute",kind:S.CompletionItemKind.EnumMember,detail:"Run local command"},{label:"forward",kind:S.CompletionItemKind.EnumMember,detail:"Forward event to URL"},{label:"response",kind:S.CompletionItemKind.EnumMember,detail:"Return HTTP response"},{label:"STATE_SET",kind:S.CompletionItemKind.EnumMember,detail:"Save value to global state"},{label:"STATE_INCREMENT",kind:S.CompletionItemKind.EnumMember,detail:"Increment numeric state key"},{label:"EMIT_EVENT",kind:S.CompletionItemKind.EnumMember,detail:"Trigger another event internally"}],tA=[{label:"field",kind:S.CompletionItemKind.Field,detail:"Path to context data (e.g. data.user)"},{label:"operator",kind:S.CompletionItemKind.Field,detail:"Comparison operator (EQ, GT, etc.)"},{label:"value",kind:S.CompletionItemKind.Value,detail:"The value to compare against"},{label:"conditions",kind:S.CompletionItemKind.Field,detail:"Sub-conditions for grouping"}],eA=[{label:"type",kind:S.CompletionItemKind.Field,detail:"The type of action to perform"},{label:"params",kind:S.CompletionItemKind.Variable,detail:"Configuration for the action"},{label:"delay",kind:S.CompletionItemKind.Property,detail:"Delay in ms (integer)"},{label:"probability",kind:S.CompletionItemKind.Property,detail:"Execution chance (0-1)"},{label:"mode",kind:S.CompletionItemKind.Property,detail:"Grouping mode (ALL, SEQUENCE, EITHER)"},{label:"actions",kind:S.CompletionItemKind.Property,detail:"List of sub-actions"}],yf={log:[{label:"message",kind:S.CompletionItemKind.Property},{label:"content",kind:S.CompletionItemKind.Property},{label:"level",kind:S.CompletionItemKind.Property,detail:"info, warn, error"}],execute:[{label:"command",kind:S.CompletionItemKind.Property},{label:"safe",kind:S.CompletionItemKind.Property,detail:"boolean (default: false)"},{label:"dir",kind:S.CompletionItemKind.Property,detail:"working directory"}],forward:[{label:"url",kind:S.CompletionItemKind.Property},{label:"method",kind:S.CompletionItemKind.Property,detail:"POST, GET, PUT..."},{label:"headers",kind:S.CompletionItemKind.Property},{label:"body",kind:S.CompletionItemKind.Property}],response:[{label:"content",kind:S.CompletionItemKind.Property},{label:"statusCode",kind:S.CompletionItemKind.Property,detail:"200, 404, etc."},{label:"contentType",kind:S.CompletionItemKind.Property,detail:"application/json"}],STATE_SET:[{label:"key",kind:S.CompletionItemKind.Property},{label:"value",kind:S.CompletionItemKind.Property},{label:"ttl",kind:S.CompletionItemKind.Property,detail:"Time to live in ms"}],STATE_INCREMENT:[{label:"key",kind:S.CompletionItemKind.Property},{label:"amount",kind:S.CompletionItemKind.Property}],EMIT_EVENT:[{label:"event",kind:S.CompletionItemKind.Property},{label:"data",kind:S.CompletionItemKind.Property}]},XF=[{label:"trigger_rule",kind:S.CompletionItemKind.Snippet,insertText:`- id: \${1:rule-id}
  on: \${2:EVENT}
  if:
    field: \${3:data.field}
    operator: \${4:EQ}
    value: \${5:target}
  do:
    type: \${6:log}
    params:
      message: \${7:Done}`,insertTextFormat:S.InsertTextFormat.Snippet,detail:"New rule template"},{label:"log_action",kind:S.CompletionItemKind.Snippet,insertText:`type: log
params:
  message: \${1:message}`,insertTextFormat:S.InsertTextFormat.Snippet,detail:"Log action template"},{label:"condition_nested",kind:S.CompletionItemKind.Snippet,insertText:"operator: ${1|AND,OR|}\nconditions:\n  - field: ${2:data.x}\n    operator: ${3:EQ}\n    value: ${4:val}",insertTextFormat:S.InsertTextFormat.Snippet,detail:"Nested condition group"}];function GF(X,Z){console.log(`[LSP] getCompletionItems called for document: ${X.uri}`),console.log(`[LSP] Position: line ${Z.line}, character ${Z.character}`);let Q=uQ(X,X.uri);if(console.log(`[LSP] Found ${Q.length} import directives`),Q.length>0){console.log("[LSP] Loading data from imports:",Q),mQ(Q);let F=zX.getValue("");console.log("[LSP] Data loaded in context:",F),console.log("[LSP] Available top-level keys:",F?Object.keys(F):"none")}else console.log("[LSP] No imports found, clearing data context"),zX.clear();let G=X.getText(),J=yX(G),$=G.split(`
`)[Z.line]||"",z=X.offsetAt(Z);if(console.log(`[LSP] Current line: "${$}"`),console.log(`[LSP] Offset: ${z}`),$.trim().startsWith("#")){let F=uf($,Z.character,X);if(F.length>0)return F}let H=ff($,Z.character);if(H)return kf(H);let U=$.indexOf(":");if(U!==-1&&Z.character>U){let F=$.substring(0,U).trim().replace(/^- /,""),j=YZ(J.contents,z)||[];return xf(F,j)}let L=YZ(J.contents,z)||[],A=vf(L,$);if(console.log(`[LSP] Returning ${A.length} completion items`),A.length>0)console.log("[LSP] First few items:",A.slice(0,3).map((F)=>F.label));return A}function ff(X,Z){console.log(`[LSP] checkTemplateVariable - line: "${X}", character: ${Z}`);let Q=/\$\{([^}]*)\}/g,G;while((G=Q.exec(X))!==null){let z=G.index,H=G.index+G[0].length;if(console.log(`[LSP] Found template: "${G[0]}" at positions ${z}-${H}`),Z>=z&&Z<=H){let U=G[1]||"",L=U.lastIndexOf(".");return console.log(`[LSP] Cursor inside template, content: "${U}", dotIndex: ${L}`),{prefix:L>=0?U.substring(0,L+1):U,inTemplate:!0}}}let J=X.substring(0,Z),Y=J.lastIndexOf("${"),$=J.lastIndexOf("}");if(console.log(`[LSP] Checking for incomplete template - lastDollarBrace: ${Y}, lastCloseBrace: ${$}`),Y>$){let z=J.substring(Y+2),H=z.lastIndexOf(".");return console.log(`[LSP] Found incomplete template, content: "${z}", dotIndex: ${H}`),{prefix:H>=0?z.substring(0,H+1):z,inTemplate:!0}}if(Z>0){let z=X[Z-1];if(z==="$"||z==="{")return console.log(`[LSP] Found $ or { at position ${Z-1}`),{prefix:"",inTemplate:!0}}if(Z<X.length){let z=X.substring(Z);if(z.startsWith("${")||z.startsWith("{"))return console.log("[LSP] Found potential template start at current position"),{prefix:"",inTemplate:!0}}return console.log("[LSP] No template found"),null}function kf(X){let Z=X.prefix.trim();console.log(`[LSP] Template variable completion - prefix: "${Z}"`);let Q=zX.getValue("");if(console.log("[LSP] Current data context:",Q),!Q||typeof Q!=="object")return console.log("[LSP] No data available in context"),[{label:"data",kind:S.CompletionItemKind.Variable,detail:"No imported data available",documentation:"Add a data import directive like: # @import data from ./data.json"}];let G=Z.replace("${","").replace(/\.$/,"");if(console.log(`[LSP] Clean prefix: "${G}"`),!G||G===""){let $=Object.keys(Q).map((z)=>{let H=Q[z],U=Array.isArray(H)?"array":typeof H,L=U==="object"?JSON.stringify(H).substring(0,50)+"...":String(H);return{label:z,kind:S.CompletionItemKind.Variable,detail:`${U} (imported data)`,documentation:`Sample value: ${L}`,insertText:z}});return console.log("[LSP] Root level suggestions:",$.map((z)=>z.label)),$}let J=zX.getFields(G);if(console.log(`[LSP] Fields for prefix "${G}":`,J.map(($)=>$.name)),J.length>0){let $=J.map((z)=>{let H=z.type==="object"?JSON.stringify(z.value).substring(0,50)+"...":zX.getFormattedValue(z.value);return{label:z.name,kind:z.type==="object"?S.CompletionItemKind.Module:S.CompletionItemKind.Field,detail:`${z.type} (imported data)`,documentation:`Sample value: ${H}`,insertText:z.name}});return console.log("[LSP] Field suggestions:",$.map((z)=>z.label)),$}console.log(`[LSP] No suggestions found for prefix "${Z}"`);let Y=Object.keys(Q);if(Y.length>0)return[{label:G,kind:S.CompletionItemKind.Text,detail:"Path not found in imported data",documentation:`Available top-level keys: ${Y.join(", ")}`,insertText:G}];return[]}function xf(X,Z){switch(X){case"on":return Sf;case"operator":return bf;case"type":return Rf;case"mode":return[{label:"ALL",kind:S.CompletionItemKind.EnumMember,detail:"Execute all"},{label:"SEQUENCE",kind:S.CompletionItemKind.EnumMember,detail:"Wait for each"},{label:"EITHER",kind:S.CompletionItemKind.EnumMember,detail:"Random choice"}];case"enabled":return[{label:"true",kind:S.CompletionItemKind.Value},{label:"false",kind:S.CompletionItemKind.Value}];case"field":return zX.getFields("data").map((G)=>({label:G.name,kind:S.CompletionItemKind.Field,detail:`${G.type}${G.value!==void 0?` = ${zX.getFormattedValue(G.value)}`:""}`}));case"value":return gf(Z)}return[]}function vf(X,Z){if(Z.trim().startsWith("-")){let J=ZF(X);if(J){let Y=String(J.key.value);if(Y==="do"||Y==="actions")return eA;if(Y==="if"||Y==="conditions")return tA}return XF.length>0?[XF[0]]:[]}let Q=ZF(X);if(!Q)return aA;let G=String(Q.key.value);if(G==="if"||G==="conditions")return tA;if(G==="do"||G==="actions")return eA;if(G==="params"){let J=hf(X);if(J){let Y=J.items.find(($)=>P6($)&&String($.key.value)==="type");if(Y&&j6(Y.value))return yf[String(Y.value.value)]||[]}}return aA}function ZF(X){for(let Z=X.length-1;Z>=0;Z--){let Q=X[Z];if(P6(Q))return Q}return null}function hf(X){for(let Z=X.length-1;Z>=0;Z--){let Q=X[Z];if(MX(Q)){if(Q.items.some((J)=>P6(J)&&String(J.key.value)==="type"))return Q}}return null}function gf(X){let Z=X.slice().reverse().find((J)=>MX(J));if(!Z)return[];let Q=Z.items.find((J)=>P6(J)&&String(J.key.value)==="operator");if(!Q||!j6(Q.value))return[];switch(String(Q.value.value)){case"RANGE":return[{label:"[min, max]",kind:S.CompletionItemKind.Snippet,insertText:"[$1, $2]",insertTextFormat:S.InsertTextFormat.Snippet}];case"IN":case"NOT_IN":return[{label:"[item1, item2]",kind:S.CompletionItemKind.Snippet,insertText:"[$1, $2]",insertTextFormat:S.InsertTextFormat.Snippet}];case"MATCHES":return[{label:'"regex"',kind:S.CompletionItemKind.Snippet,insertText:'"^$1$"',insertTextFormat:S.InsertTextFormat.Snippet}]}return[]}function YZ(X,Z,Q=[]){if(!X)return null;let G=X.range;if(G){if(Z<G[0]||Z>G[1]+1);}let J=[...Q,X];if(MX(X)){for(let Y of X.items)if(P6(Y)){let $=Y.range;if($&&Z>=$[0]&&Z<=$[1]+1)return YZ(Y,Z,J)}return J}if(D6(X)){for(let Y of X.items){let $=Y.range;if($&&Z>=$[0]&&Z<=$[1]+1)return YZ(Y,Z,J)}return J}if(P6(X)){let Y=X.key?.range;if(Y&&Z>=Y[0]&&Z<=Y[1]+1)return YZ(X.key,Z,J);if(X.value){let $=X.value?.range;if($&&Z>=$[0]&&Z<=$[1]+1)return YZ(X.value,Z,J)}return J}return J}function uf(X,Z,Q){console.log(`[LSP] Checking directive completions for line: "${X}" at character ${Z}`);let G=X.match(/#\s*@?([\w-]*)$/);if(!G)return[];let J=G[1]||"";if(console.log(`[LSP] Partial directive: "${J}"`),J.startsWith("import")||X.includes("@import")){let $=X.match(/@import\s+\w+\s+from\s+['"]?([^'"]*)$/);if($){let z=$[1]||"";return mf(Q.uri,z)}}if(J===""||X.match(/#\s*$/))return QF();return QF().filter(($)=>$.label.toLowerCase().startsWith(J.toLowerCase()))}function QF(){return[{label:"import",kind:S.CompletionItemKind.Function,detail:"Import data from JSON/YAML file",insertText:"import ${1:alias} from ${2:./path/to/file.json}",insertTextFormat:S.InsertTextFormat.Snippet,documentation:"Imports data from a JSON or YAML file for use in autocompletion and validation. Example: @import data from ./data.json",data:{category:"import",color:"macro"}},{label:"disable-lint",kind:S.CompletionItemKind.Module,detail:"Disable all linting for subsequent lines",insertText:"disable-lint",documentation:"Disables all linting and validation for the rest of the document or until @enable-lint is encountered",data:{category:"global-control",color:"namespace"}},{label:"enable-lint",kind:S.CompletionItemKind.Module,detail:"Enable all linting (default state)",insertText:"enable-lint",documentation:"Enables linting and validation (this is the default state)",data:{category:"global-control",color:"namespace"}},{label:"disable-next-line",kind:S.CompletionItemKind.EnumMember,detail:"Disable lint for the next line only",insertText:"disable-next-line",documentation:"Disables linting and validation for the next line only",data:{category:"line-control",color:"enumMember"}},{label:"disable-line",kind:S.CompletionItemKind.EnumMember,detail:"Disable lint for current line",insertText:"disable-line",documentation:"Disables linting and validation for the current line",data:{category:"line-control",color:"enumMember"}},{label:"disable-rule",kind:S.CompletionItemKind.TypeParameter,detail:"Disable specific rule(s)",insertText:"disable-rule ${1:rule-name}",insertTextFormat:S.InsertTextFormat.Snippet,documentation:"Disables specific validation rules. Example: @disable-rule missing-id, invalid-operator",data:{category:"rule-control",color:"type"}},{label:"enable-rule",kind:S.CompletionItemKind.TypeParameter,detail:"Enable specific rule(s)",insertText:"enable-rule ${1:rule-name}",insertTextFormat:S.InsertTextFormat.Snippet,documentation:"Enables specific validation rules that were previously disabled",data:{category:"rule-control",color:"type"}}]}function mf(X,Z){let Q=[];try{let G=decodeURIComponent(X),J=yY(G.replace("file:///","").replace(/^\/([A-Z]:)/,"$1")),Y=Z.includes("/")?yY(_f(J,Z)):J,$=p0("fs");if(If(Y)){let z=$.readdirSync(Y),H=[".json",".yaml",".yml"];z.forEach((U)=>{let L=Cf(U).toLowerCase();if(H.includes(L)){let A="./"+(Z.includes("/")?yY(Z)+"/"+U:U);Q.push({label:A,kind:S.CompletionItemKind.File,detail:`${L.toUpperCase()} data file`,insertText:`"${A}"`})}})}}catch(G){console.log("[LSP] Error getting file completions:",G)}return Q}var JF=p8(jZ(),1);var YF={tokenTypes:["property","keyword","function","string","number","operator","variable","parameter","comment","type","macro","namespace","enumMember"],tokenModifiers:["declaration","readonly"]},BX={property:0,keyword:1,function:2,string:3,number:4,operator:5,variable:6,parameter:7,comment:8,type:9,macro:10,namespace:11,enumMember:12};function $F(X){let Z=new A7,Q=yX(X,{lineCounter:Z}),G=new JF.SemanticTokensBuilder;if(Q.contents)fY(Q.contents,G,Z);return pf(X,G,Z),G.build().data}function pf(X,Z,Q){let G=X.split(`
`);for(let J=0;J<G.length;J++){let Y=G[J]||"";if(!Y.trim().startsWith("#"))continue;let $=/@([\w-]+)/g,z;while((z=$.exec(Y))!==null){let U=z[1],L=z.index,A=L+z[0].length,F=0;for(let T=0;T<J;T++){let P=G[T]||"";F+=P.length+1}F+=L;let j=Q.linePos(F),R=BX.keyword;switch(U){case"import":R=BX.macro;break;case"disable-lint":case"enable-lint":R=BX.namespace;break;case"disable-next-line":case"disable-line":R=BX.enumMember;break;case"disable-rule":case"enable-rule":R=BX.type;break;default:R=BX.keyword}Z.push(j.line-1,j.col-1,A-L,R,0)}let H=/@/g;while((z=H.exec(Y))!==null){let U=z.index,L=J*(Y.length+1)+U,A=Q.linePos(L);Z.push(A.line-1,A.col-1,1,BX.operator,0)}}}function fY(X,Z,Q){if(!X)return;if(MX(X))for(let G of X.items)df(G,Z,Q);else if(D6(X))for(let G of X.items)fY(G,Z,Q)}function df(X,Z,Q){let G=X.key;if(G&&G.range){let J=String(G.value),Y=BX.property;if(["if","when","conditions","match"].includes(J))Y=BX.keyword;else if(["do","actions","then","execute"].includes(J))Y=BX.function;else if(["id","rule","name"].includes(J))Y=BX.variable;else if(["on","trigger","events"].includes(J))Y=BX.parameter;else if(["operator","op"].includes(J))Y=BX.operator;let $=Q.linePos(G.range[0]);Z.push($.line-1,$.col-1,G.range[1]-G.range[0],Y,0)}if(X.value)fY(X.value,Z,Q)}var lf={id:{description:"Unique identifier for this rule",examples:["my-rule-1","donation-handler","user-login-tracker"]},name:{description:"Human-readable name for the rule",examples:["Donation Handler","User Login Tracker"]},description:{description:"Detailed description of what this rule does"},on:{description:"The event name that triggers this rule",values:"String event name (e.g., `Donation`, `UserLogin`, `minecraft:player_join`)",examples:["Donation","UserLogin","minecraft:player_join","COMMAND"]},if:{description:"Condition(s) that must be met for the rule to execute",values:"Single condition object, array of conditions, or condition group with AND/OR operator"},do:{description:"Action(s) to execute when conditions are met",values:"Single action object, array of actions, or action group with mode (ALL, SEQUENCE, EITHER)"},priority:{description:"Execution priority (higher values execute first)",values:"Integer number",examples:["1","10","100"]},enabled:{description:"Whether this rule is active",values:"Boolean: `true` or `false`",examples:["true","false"]},cooldown:{description:"Minimum time in milliseconds between executions",values:"Non-negative integer (milliseconds)",examples:["1000","5000","60000"]},tags:{description:"Tags for categorizing and organizing rules",values:"Array of strings",examples:['["gameplay", "monetization"]','["debug", "test"]']},comment:{description:"Internal developer note (not used in execution)"}},zF={EQ:{description:"Equal to (==)",valueType:"Any value",examples:["value: 100",'value: "hello"',"value: true"]},"==":{description:"Equal to (same as EQ)",valueType:"Any value",examples:["value: 100",'value: "hello"']},NEQ:{description:"Not equal to (!=)",valueType:"Any value",examples:["value: 0",'value: "goodbye"']},"!=":{description:"Not equal to (same as NEQ)",valueType:"Any value",examples:["value: 0"]},GT:{description:"Greater than (>)",valueType:"Number or expression string",examples:["value: 100",'value: "${state.count}"']},">":{description:"Greater than (same as GT)",valueType:"Number or expression string",examples:["value: 50"]},GTE:{description:"Greater than or equal to (>=)",valueType:"Number or expression string",examples:["value: 100"]},">=":{description:"Greater than or equal to (same as GTE)",valueType:"Number or expression string",examples:["value: 100"]},LT:{description:"Less than (<)",valueType:"Number or expression string",examples:["value: 100"]},"<":{description:"Less than (same as LT)",valueType:"Number or expression string",examples:["value: 50"]},LTE:{description:"Less than or equal to (<=)",valueType:"Number or expression string",examples:["value: 100"]},"<=":{description:"Less than or equal to (same as LTE)",valueType:"Number or expression string",examples:["value: 100"]},IN:{description:"Value is in the given list",valueType:"Array of values",examples:["value: [1, 2, 3]",'value: ["a", "b", "c"]']},NOT_IN:{description:"Value is not in the given list",valueType:"Array of values",examples:["value: [0, null]"]},CONTAINS:{description:"String contains substring, or array includes item",valueType:"String (for substring) or Array (for item check)",examples:['value: "hello"','value: ["item1", "item2"]']},MATCHES:{description:"Value matches the regular expression pattern",valueType:"String (regex pattern)",examples:['value: "^[A-Z].*"','value: "\\\\d{3}-\\\\d{4}"']},RANGE:{description:"Value is within the specified range [min, max] (inclusive)",valueType:"Array of exactly 2 numbers: [min, max]",examples:["value: [0, 100]","value: [1, 10]"]},SINCE:{description:"Date/time is after or equal to the specified value",valueType:"Date string or timestamp",examples:['value: "2024-01-01"']},AFTER:{description:"Date/time is after the specified value (alias for SINCE)",valueType:"Date string or timestamp",examples:['value: "2024-01-01T00:00:00Z"']},BEFORE:{description:"Date/time is before the specified value",valueType:"Date string or timestamp",examples:['value: "2024-12-31"']},UNTIL:{description:"Date/time is before or equal to the specified value (alias for BEFORE)",valueType:"Date string or timestamp",examples:['value: "2024-12-31T23:59:59Z"']},AND:{description:"Logical AND - all conditions must be true",valueType:"Used in condition groups",examples:[`operator: AND
conditions:
  - field: data.x
    operator: GT
    value: 0`]},OR:{description:"Logical OR - at least one condition must be true",valueType:"Used in condition groups",examples:[`operator: OR
conditions:
  - field: data.x
    operator: EQ
    value: 1`]}},cf={field:{description:"The field path to check (e.g., `data.amount`, `event.user.id`)",values:"String path using dot notation"},operator:{description:"The comparison operator to use",values:"One of: EQ, ==, NEQ, !=, GT, >, GTE, >=, LT, <, LTE, <=, IN, NOT_IN, CONTAINS, MATCHES, RANGE, SINCE, AFTER, BEFORE, UNTIL"},value:{description:"The value to compare against (type depends on operator)",values:"Varies by operator - see operator documentation for details"},conditions:{description:"Array of sub-conditions for AND/OR groups",values:"Array of condition objects"}},of={type:{description:"The type of action to perform",values:"String action type (e.g., `log`, `execute`, `http`, `STATE_SET`, `EMIT_EVENT`)"},params:{description:"Parameters for the action (varies by action type)",values:"Object with action-specific parameters"},delay:{description:"Delay in milliseconds before executing this action",values:"Non-negative integer (milliseconds)"},probability:{description:"Probability of executing this action (0.0 to 1.0)",values:"Number between 0 and 1 (e.g., 0.5 for 50% chance)"},mode:{description:"Execution mode for action groups",values:"ALL (execute all), SEQUENCE (execute in order), or EITHER (execute one randomly)"},actions:{description:"Array of sub-actions for action groups",values:"Array of action objects"}};function HF(X,Z){let Q=uQ(X,X.uri);if(Q.length>0)mQ(Q);else zX.clear();let G=X.getText(),J=X.offsetAt(Z),Y=yX(G);if(!Y.contents)return null;let z=G.split(`
`)[Z.line]||"",H=nf(z,Z.character);if(H)return H;let U=pQ(Y.contents,J);if(!U||U.length===0)return null;let L=U[U.length-1];if("key"in L&&L.key){let A=L.key;if(j6(A)&&A.range){let[F,j]=A.range;if(J>=F&&J<=j){let R=String(A.value),T=sf(R,U);if(T)return{contents:T}}}}if(j6(L)&&L.range){let[A,F]=L.range;if(J>=A&&J<=F){let j=String(L.value);if(zF[j]){let R=zF[j];return{contents:{kind:"markdown",value:[`**Operator: \`${j}\`**`,"",R.description,"",`**Value Type:** ${R.valueType}`,...R.examples?["","**Examples:**",...R.examples.map((P)=>`\`\`\`yaml
${P}
\`\`\``)]:[]].join(`
`)}}}}}return null}function nf(X,Z){let Q=/\$\{([^}]+)\}/g,G;while((G=Q.exec(X))!==null){let J=G.index,Y=G.index+G[0].length;if(Z>=J&&Z<=Y){let $=G[1].trim(),z=zX.getValue($);if(z!==void 0){let H=zX.getFormattedValue(z),U=typeof z==="object"&&z!==null?Array.isArray(z)?"array":"object":typeof z;return{contents:{kind:"markdown",value:[`**Template Variable: \`\${${$}}\`**`,"",`**Type:** \`${U}\``,"","**Test Value:**","```json",H,"```"].join(`
`)}}}else return{contents:{kind:"markdown",value:[`**Template Variable: \`\${${$}}\`**`,"","_No test data available for this variable._","","Add a `data.json` or `data.yaml` file in your workspace to provide test values."].join(`
`)}}}}return null}function sf(X,Z){let Q=rf(Z),G;if(Q==="action")G=of[X];else if(Q==="condition")G=cf[X];if(!G)G=lf[X];if(!G)return null;let J=[`**${X}**`,"",G.description];if(G.values)J.push("",`**Allowed Values:** ${G.values}`);if(G.examples&&G.examples.length>0)J.push("","**Examples:**"),G.examples.forEach((Y)=>{J.push(`\`\`\`yaml
${Y}
\`\`\``)});return{kind:"markdown",value:J.join(`
`)}}function rf(X){for(let Z=X.length-1;Z>=0;Z--){let Q=X[Z];if(!("key"in Q)||!Q.key)continue;if(!j6(Q.key))continue;let G=String(Q.key.value);if(G==="if"||G==="conditions")return"condition";if(G==="do"||G==="actions")return"action"}return"rule"}function pQ(X,Z,Q=[]){if(!X)return null;if(((z)=>("key"in z)&&("value"in z))(X)){let z=X,H=[...Q,X];if(z.key&&typeof z.key==="object"&&"range"in z.key){let U=z.key;if(U.range){let[L,A]=U.range;if(Z>=L&&Z<=A)return H}}if(z.value){let U=pQ(z.value,Z,H);if(U)return U}return null}if(!("range"in X)||!X.range)return null;let[J,Y]=X.range;if(Z<J||Z>Y)return null;let $=[...Q,X];if(MX(X)){for(let z of X.items){let H=pQ(z,Z,$);if(H)return H}return $}if("items"in X&&Array.isArray(X.items)){for(let z of X.items){let H=pQ(z,Z,$);if(H)return H}return $}return $}import{existsSync as af}from"fs";import{join as UF,dirname as tf}from"path";var C0=nX.createConnection(nX.ProposedFeatures.all),$Z=new nX.TextDocuments(I9),xY=!1,kY=!1;C0.onInitialize((X)=>{C0.console.log("Trigger System LSP Server initializing...");let Z=X.capabilities;xY=!!(Z.workspace&&!!Z.workspace.configuration),kY=!!(Z.workspace&&!!Z.workspace.workspaceFolders),C0.console.log(`Configuration capability: ${xY}`),C0.console.log(`Workspace folder capability: ${kY}`);let Q={capabilities:{textDocumentSync:nX.TextDocumentSyncKind.Incremental,completionProvider:{resolveProvider:!0,triggerCharacters:[":"," ","-","$","{",".","[","@"]},hoverProvider:!0,definitionProvider:!0,semanticTokensProvider:{legend:YF,full:!0}}};if(C0.console.log(`Server capabilities registered: ${JSON.stringify(Q.capabilities,null,2)}`),kY)Q.capabilities.workspace={workspaceFolders:{supported:!0}};return Q});C0.onInitialized(()=>{if(xY)C0.client.register(nX.DidChangeConfigurationNotification.type,void 0)});$Z.onDidChangeContent((X)=>{ef(X.document)});async function ef(X){let Z=X.getText(),Q=await rA(Z);C0.sendDiagnostics({uri:X.uri,diagnostics:Q})}C0.onDidChangeWatchedFiles((X)=>{C0.console.log("We received an file change event")});C0.onCompletion((X)=>{C0.console.log(`Completion requested for document: ${X.textDocument.uri}`),C0.console.log(`Position: line ${X.position.line}, character ${X.position.character}`);let Z=$Z.get(X.textDocument.uri);if(!Z)return C0.console.log("Document not found"),[];C0.console.log("Document found, getting completions...");let Q=GF(Z,X.position);return C0.console.log(`Found ${Q.length} completion items`),Q});C0.onCompletionResolve((X)=>{return X});C0.languages.semanticTokens.on((X)=>{let Z=$Z.get(X.textDocument.uri);if(!Z)return{data:[]};let Q=Z.getText();return{data:$F(Q)}});C0.onHover((X)=>{let Z=$Z.get(X.textDocument.uri);if(!Z)return null;return HF(Z,X.position)});C0.onDefinition((X)=>{let Z=$Z.get(X.textDocument.uri);if(!Z)return null;let Q=Z.getText(),G=X.position,J=Z.offsetAt(G),Y=Q.split(`
`),$=0,z=0,H=0;for(let T=0;T<Y.length;T++){let P=Y[T];if(!P)continue;let y=P.length+1;if($+y>J){z=T,H=$;break}$+=y}let U=Y[z]||"",L=J-H,A=U.match(/#\s*@import\s+\w+\s+from\s+['"]([^'"]+)['"]/);if(!A||!A[1])return null;let F=A[1],j=U.indexOf(F),R=j+F.length;if(L<j||L>R)return null;try{let T;if(Z.uri==="file://test"||Z.uri==="file:///test")T=UF(process.cwd(),"tests","rules","examples");else{let M=decodeURIComponent(Z.uri),K;if(M.startsWith("file:///"))if(K=M.substring(8),K.match(/^[A-Za-z]:/))K=K.replace(/\//g,"\\");else if(K.match(/^\/[A-Za-z]:/))K=K.substring(1).replace(/\//g,"\\");else K=K.replace(/\//g,"/");else K=M.replace("file:///","");T=tf(K)}let P=UF(T,F);if(!af(P))return null;let y;if(process.platform==="win32")y=`file:///${P.replace(/\\/g,"/")}`;else y=`file://${P}`;return{uri:y,range:{start:{line:0,character:0},end:{line:0,character:0}}}}catch(T){return C0.console.log(`Error resolving import path: ${T}`),null}});$Z.listen(C0);C0.listen();

//# debugId=58603DE9339E2DAC64756E2164756E21
//# sourceMappingURL=server.bundle.js.map
